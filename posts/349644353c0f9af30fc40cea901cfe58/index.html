<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>电脑版微信每天自动发送 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="电脑版微信每天自动发送" />
<meta property="og:description" content="1.电脑24小时不关机，微信一直在线，将发送对象激活成单独窗口，并将任务栏图标置于第一格的位置，如下：
横坐标约190左右。
2.编写程序代码。（附后）
3.将代码打包成exe.
4.设定计划任务。
搞定。
附代码：
# coding = utf-8
import win32api,win32gui,win32con
import win32clipboard as clipboard
import time
from PIL import Image
from io import BytesIO #python3,新增字节流
import requests
###############################
# 微信发送（文本及图片）
###############################
#定义指定图片文件复制到剪贴板函数##########
def pic_ctrl_c(pathfile):
img = Image.open(pathfile)
output = BytesIO()#如是StringIO分引起TypeError: string argument expected, got &#39;bytes&#39;
img.convert(&#34;RGB&#34;).save(output, &#34;BMP&#34;)# 以BMP格式保存流
data = output.getvalue()[14:]#bmp文件头14个字节丢弃
output.close()
clipboard.OpenClipboard() #打开剪贴板
clipboard.EmptyClipboard() #先清空剪贴板
clipboard.SetClipboardData(win32con.CF_DIB, data) #将图片放入剪贴板
clipboard.CloseClipboard()
return
def send_m():
# 以下为“CTRL&#43;V”组合键,回车发送，（方法一）
win32api.keybd_event(17, 0, 0, 0) # 有效，按下CTRL" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/349644353c0f9af30fc40cea901cfe58/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-04-12T18:17:44+08:00" />
<meta property="article:modified_time" content="2019-04-12T18:17:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">电脑版微信每天自动发送</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.电脑24小时不关机，微信一直在线，将发送对象激活成单独窗口，并将任务栏图标置于第一格的位置，如下：</p> 
<p><img alt="" class="has" height="108" src="https://images2.imgbox.com/1e/61/fzgRDnGe_o.png" width="210"></p> 
<p>横坐标约190左右。</p> 
<p>2.编写程序代码。（附后）</p> 
<p>3.将代码打包成exe.</p> 
<p><img alt="" class="has" height="76" src="https://images2.imgbox.com/93/38/yEA7oUaE_o.png" width="542"></p> 
<p>4.设定计划任务。</p> 
<p><img alt="" class="has" height="134" src="https://images2.imgbox.com/90/8e/McaWiETP_o.png" width="261"><img alt="" class="has" height="129" src="https://images2.imgbox.com/36/f0/4yLhhxMu_o.png" width="371"></p> 
<p><img alt="" class="has" height="102" src="https://images2.imgbox.com/74/7a/IuZ9pT3X_o.png" width="298"></p> 
<p>搞定。</p> 
<p>附代码：</p> 
<p># coding = utf-8<br> import win32api,win32gui,win32con<br> import win32clipboard as clipboard<br> import time<br> from PIL import Image<br> from io import BytesIO #python3,新增字节流<br> import requests</p> 
<p>###############################<br> #  微信发送（文本及图片）<br> ###############################</p> 
<p>#定义指定图片文件复制到剪贴板函数##########<br> def pic_ctrl_c(pathfile):<br>     img = Image.open(pathfile)<br>     output = BytesIO()#如是StringIO分引起TypeError: string argument expected, got 'bytes'<br>     img.convert("RGB").save(output, "BMP")# 以BMP格式保存流<br>     data = output.getvalue()[14:]#bmp文件头14个字节丢弃<br>     output.close()<br>     clipboard.OpenClipboard() #打开剪贴板<br>     clipboard.EmptyClipboard()  #先清空剪贴板<br>     clipboard.SetClipboardData(win32con.CF_DIB, data)  #将图片放入剪贴板<br>     clipboard.CloseClipboard()<br>     return</p> 
<p>def send_m():<br>     # 以下为“CTRL+V”组合键,回车发送，（方法一）<br>     win32api.keybd_event(17, 0, 0, 0)  # 有效，按下CTRL<br>     time.sleep(1)  # 需要延时<br>     win32gui.SendMessage(win, win32con.WM_KEYDOWN, 86, 0)  # V<br>     win32api.keybd_event(17, 0, win32con.KEYEVENTF_KEYUP, 0)  # 放开CTRL<br>     time.sleep(1)  # 缓冲时间<br>     win32gui.SendMessage(win, win32con.WM_KEYDOWN, win32con.VK_RETURN, 0)  # 回车发送<br>     return</p> 
<p>def txt_ctrl_v(txt_str):<br>     #定义文本信息,将信息缓存入剪贴板<br>     clipboard.OpenClipboard()<br>     clipboard.EmptyClipboard()<br>     clipboard.SetClipboardData(win32con.CF_UNICODETEXT,txt_str)<br>     clipboard.CloseClipboard()<br>     return</p> 
<p>def day_english():<br>     #获取金山词霸每日一句<br>     url = 'http://open.iciba.com/dsapi'<br>     r = requests.get(url)<br>     content = r.json()['content']<br>     note = r.json()['note']<br>     print(content+note)<br>     return  content+note</p> 
<p>#######################发送过程=================<br> #查找微信窗口，如果最小化则还原（需要固定位置）<br> title_name='马云大哥'#单独打开，好友名称<br> win = win32gui.FindWindow('ChatWnd',title_name)<br> print("找到句柄：%x" % win)<br> if win!=0:<br>     left, top, right, bottom = win32gui.GetWindowRect(win)<br>     print(left, top, right, bottom)#最小化为负数<br>     #<br>     #最小化时点击还原，下面为单个窗口<br>     if top&lt;0:<br>         #鼠标点击，还原窗口<br>         win32api.SetCursorPos([190, 1040])  # 鼠标定位到(190,1040)<br>         # 执行左单键击，若需要双击则延时几毫秒再点击一次即可<br>         win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | win32con.MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0)<br>         ######点击完成一次<br>     time.sleep(0.5)<br>     left, top, right, bottom = win32gui.GetWindowRect(win)#取数<br>     #<br>     #最小时点击还原窗口，下面一节为多个窗口，依次点击打开。<br>     k=1040#最小化后的纵坐标，横坐标约为190<br>     while top&lt;0 and k&gt;800:#并设定最多6次，防止死循环<br>         time.sleep(1)<br>         win32api.SetCursorPos([180, k-40])  # 鼠标定位菜单第一个<br>         win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | win32con.MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0)<br>         ######点击完成一次<br>         time.sleep(1)#等待窗口出现<br>         left, top, right, bottom = win32gui.GetWindowRect(win)#取数<br>         if top&gt;0 :#判断是否还原<br>             break<br>         else:<br>             k-=40#菜单上移一格<br>             win32api.SetCursorPos([190, 1040])  # 重新打开菜单<br>             win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | win32con.MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0)<br>     win32gui.SetForegroundWindow(win)#获取控制<br>     time.sleep(0.5)<br> else:<br>     print('请注意：找不到【%s】这个人（或群），请激活窗口！'%title_name)<br> #<br> ##开始发送图片<br> pic_ctrl_c('D:/2018bigdata/jz2018tv.png')#第一张图片<br> time.sleep(1)<br> send_m()<br> pic_ctrl_c('D:/2018bigdata/jz2018.png')#第二张图片<br> time.sleep(1)<br> send_m()<br> pic_ctrl_c('D:/2018bigdata/jz2018net.png')#第三张图片<br> time.sleep(1)<br> send_m()<br> #开始发送文本<br> str=day_english()<br> txt_ctrl_v(str)<br> send_m()<br> #<br> #############################微信发送结束================</p> 
<p>#############################其它备注====================<br> #<br> # #模拟键盘CTRL+V，方法二<br> # keyboard.press(Key.ctrl)<br> # keyboard.press('v')#大写不行列<br> # keyboard.release('v')<br> # keyboard.release(Key.ctrl)<br> #<br> ##鼠标操作可忽略<br> # in_xy=[right-50,bottom-50]<br> # win32api.SetCursorPos(in_xy)<br> # mouse.press(Button.left)<br> # mouse.release(Button.left)<br> #<br> #from pynput.mouse import Button, Controller as mController<br> #from pynput.keyboard import Key, Controller as kController<br> #mouse = mController()<br> #keyboard = kController()<br> #print(type(keyboard))<br> # keyboard.type(str1) # 发送消息,需要pip install pynput<br> # time.sleep(1)#缓冲时间<br> #<br> # title_name='微信'#这个不分对象，瞎发。<br> # win = win32gui.FindWindow('WeChatMainWndForPC',title_name)</p> 
<p><br>  </p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3f713dbbd96e1a23b3ef28e38071fa2f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MATLAB使用窍门——常用快捷键和调试程序的快捷键使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e1f6650269b86e391433bb2fd9e667b8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于python传参引发的一些思考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>