<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux 查找木马文件,Linux木马pscan2查找与清除步骤，linuxpscan2 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux 查找木马文件,Linux木马pscan2查找与清除步骤，linuxpscan2" />
<meta property="og:description" content="Linux木马pscan2查找与清除步骤，linuxpscan2
这篇文章主要介绍了Linux木马pscan2查找与清除步骤,需要的朋友可以参考下
一、现象
AH现场的程序是分布式部署，除了程序的配置文件不同外，并无其他不同。最近地市sz频繁发生工单处理错误的故障，而其他地市运行一直很稳定。
二、 因此，对sz的主机进行了检查，步骤如下：1、重启应用，发现应用的端口3456已经被占用，通过命令 lsof -i:3456 ，发现是用户tel的进程占用了该端口。
2、通过命令ps，发现用户tel的进程熟非常多，但在我们的系统中，并未创建过用户tel。
3、使用top命令，结果如下：
top - 09:58:54 up 524 days, 14:31, 4 users, load average: 3.44, 4.98, 5.75
Tasks: 1715 total, 7 running, 1699 sleeping, 0 stopped, 9 zombie
Cpu(s): 23.3% us, 12.3% sy, 0.0% ni, 64.4% id, 0.0% wa, 0.0% hi, 0.0% si
Mem: 4147208k total, 2740256k used, 1406952k free, 23976k buffers
Swap: 4079600k total, 779100k used, 3300500k free, 638748k cached" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a83726770e96bf1438e39546194c6116/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-29T01:50:38+08:00" />
<meta property="article:modified_time" content="2021-04-29T01:50:38+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux 查找木马文件,Linux木马pscan2查找与清除步骤，linuxpscan2</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>Linux木马pscan2查找与清除步骤，linuxpscan2</p> 
 <p>这篇文章主要介绍了Linux木马pscan2查找与清除步骤,需要的朋友可以参考下</p> 
 <p>一、现象</p> 
 <p>AH现场的程序是分布式部署，除了程序的配置文件不同外，并无其他不同。最近地市sz频繁发生工单处理错误的故障，而其他地市运行一直很稳定。</p> 
 <p>二、 因此，对sz的主机进行了检查，步骤如下：1、重启应用，发现应用的端口3456已经被占用，通过命令 lsof -i:3456 ，发现是用户tel的进程占用了该端口。</p> 
 <p>2、通过命令ps，发现用户tel的进程熟非常多，但在我们的系统中，并未创建过用户tel。</p> 
 <p>3、使用top命令，结果如下：</p> 
 <p>top - 09:58:54 up 524 days, 14:31, 4 users, load average: 3.44, 4.98, 5.75</p> 
 <p>Tasks: 1715 total, 7 running, 1699 sleeping, 0 stopped, 9 zombie</p> 
 <p>Cpu(s): 23.3% us, 12.3% sy, 0.0% ni, 64.4% id, 0.0% wa, 0.0% hi, 0.0% si</p> 
 <p>Mem: 4147208k total, 2740256k used, 1406952k free, 23976k buffers</p> 
 <p>Swap: 4079600k total, 779100k used, 3300500k free, 638748k cached</p> 
 <p>PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND</p> 
 <p>24201 tel 25 0 1468 476 396 R 100 0.0 0:58.78 pscan2</p> 
 <p>24510 root 17 0 4336 1916 760 R 4 0.0 0:00.30 top</p> 
 <p>发现tel用户的进程pscan2，占用CPU资源达到100%，通过网上查找资料，发现pscan2是一个老美的木马，他重要特征是占用CPU非常大。</p> 
 <p>因此推断：主机被攻破，并被植入木马pscan。</p> 
 <p>三、查找木马pscan2</p> 
 <p>用root帐号su到tel，查看该用户目录，发现一个隐藏目录，名称是 “...” ，哦，名字比较迷惑人</p> 
 <p>，稍一大意就可能看不到，呵呵。进入目录查看，木马程序pscan2就是植入到这个目录下了。</p> 
 <p>#ls -al</p> 
 <p>总用量 84</p> 
 <p>drwx------ 5 503 503 4096 8月 24 10:26 .</p> 
 <p>drwxr-xr-x 4 root root 4096 2007-08-30 ..</p> 
 <p>drwxrwxr-x 6 503 503 4096 8月 24 09:54 ...</p> 
 <p>-rw------- 1 503 503 6936 8月 24 10:45 .bash_history</p> 
 <p>-rw-r--r-- 1 503 503 24 2006-11-03 .bash_logout</p> 
 <p>-rw-r--r-- 1 503 503 191 2006-11-03 .bash_profile</p> 
 <p>四、清除木马pscan，步骤如下：</p> 
 <p>1、删除用户tel所有进程</p> 
 <p>#pkill -9 -U tel</p> 
 <p>2、删除用户tel</p> 
 <p>#userdel tel</p> 
 <p>3、删除用户组时报错</p> 
 <p>#groupdel tel</p> 
 <p>groupdel: cannot remove user's primary group.</p> 
 <p>4、查找passwd、group文件，发现仍然有个用户bossnm属于tel用户组</p> 
 <p>group文件存在如下一行，其中503是用户组ID</p> 
 <p>tel:x:503:</p> 
 <p>在passwd中存在如下一行，其中503表示这个用户属于组ID为503的用户组</p> 
 <p>bossnm:x:500:503::/export/home/bossnm</p> 
 <p>5、删除bossnm用户及tel用户组</p> 
 <p>#userdel bossnm</p> 
 <p>#groupdel tel</p> 
 <p>6、删除tel用户下所有的木马文件</p> 
 <p>经过处理，系统已经恢复正常。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eceef4d0c936a31d08c33bce9423eda9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">linux重启网卡的命令行,linux系统怎么重启网卡？linux重启网卡的三种教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/69f870481342abf4d2a3589f10ef7da3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">linux下jcmd命令没找到,Linux exec 命令 command not found exec 命令详解 exec 命令未找到 exec 命令安装 - CommandNotFound ⚡️ ...</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>