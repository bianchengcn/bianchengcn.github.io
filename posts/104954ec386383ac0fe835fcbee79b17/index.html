<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YOLO系列之YOLO V1 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="YOLO系列之YOLO V1" />
<meta property="og:description" content=" 文章目录 1.写在前面2. 模型介绍3.原理讲解4.写在最后 1.写在前面 这是我发布的目标检测系列论文之二，前面一个章节，我们已经讨论过了目标检测系列中最基础的东西，常见指标以及相关的一些概念。那么本次，我将介绍一下YOLO系列的初代版本，YOLO V1
论文链接点击直达
2. 模型介绍 前面我们已经说过了，One-Stage算法具有实时检测的FPS，实用性特别的好，因此作为YOLO系列的第一代版本，论文的名字就已经说明了一切You only Look Once
我们先来看一下效果：
再来看看YOLO V1在当时的性能如何？
我们可以看到YOLO在损失比较小mAP的情况下，带来了极大的FPS增益效果，因此在当时还是引发了不小的轰动，所以我们来看看他是怎么实现的吧！
3.原理讲解 那么作者是怎么做的呢？首先我们来看一张图片：
这张图像很好得诠释了YOLO V1的模型，它先把图像resize成448x448的大小，然后将这个图像分割成SxS的大小，也就是说哈，我拿一个刀，将图像切成一个个的豆腐块。
再之后，每个豆腐块（网格）需要预测B个bounding box(论文中指出，B=2)，除了预测位置信息之外，还要预测一个confidence参数，表示该候选框能有多大的把握框中了物体。
这里可能有小伙伴就迷糊了，你一个豆腐块你怎么预测候选框(bounding box)呢？其实意思是这样的，就是你可以理解成以豆腐块为中心，画B个框出来，然后如果有物体就逐步调整和Ground truth最大IOU的那个框，直到这个框和ground truth 的IOU最大。还是不理解就看下面的图：
A,B这两个格子是SxS格子中的任意两个，以A为中心，画出了一个绿色一个黄色连个框框，同样B也是如此。之后我们发现。，B这个格子里好像没有物体欸，那么他的confidence必然很低，那么我们不管他，我们看A这个格子，直观上看，确实是框中了物体，所以他的confidence必然高。那么我们继续看，明显绿色这个框要比黄色这个框要好，因为啥？因为绿色框和Ground Truth的IOU高呀！那么我们就舍弃黄色的框，保留绿色的框。
那么明白了之后，我们就要分析每个豆腐块会预测出多少个数字了，这很重要！
首先，对于一个豆腐块，我要知道候选框的框框左上角的x,y值，以及这个框的宽和高吧
然后刚才说了，还要有一个置信度吧，表示这个框有多大可能圈中了物体
并且每个豆腐块产出B个框，如图，粉色和橙红色的框。
那么就有B*5个数了，然后这个豆腐块还要预测我框出的是什么类别，因为pascal voc数据集一共有20个类别，那么我们还要带上20个类别概率，表示当前框框框中的是当前类别的概率是多少。就像这样：
好了，接下来我们来讨论一下是如何调整候选框，使得候选框的IOU最大的呢？这时候不得不提到它的损失函数：
首先我们看位置误差。
如图：对于这个函数，当时小物体的时候，你移动非常小的距离，他变化的很快，但是对于大物体，你移动比较大的距离，他变得很小。不敏感。
然后我们再来看看置信误差，这里为什么含有obj的误差和不含obj的误差分开来算呢？
这是因为呀，在图像中，一般前景比较少，背景比较多，那如果两者一起算了，很容易出现负样本过多，正负比例不均衡！所以要加一个 λ n o o b j \lambda_{noobj} λnoobj​作为惩罚因子！
最后的分类误差就是简单的MSE Loss，在这里不再赘述。
总结一下：
一共有SxS个格子，然后每个格子会画两个框根据置信度，看看哪些框圈中了物体再比较框和Grouth Truth 的IOU大小，保留大的通过Loss逐步调整候选框的大小 4.写在最后 这次我们分析了yolo 的第一个版本，他虽然有诸多优点，比如快速简单，但是还是存在如下缺点：
每个Cell（豆腐块）只预测一个类别，如果重叠那么就无解小物体效果检测很一般，候选框长宽比可选但是单一 " />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/104954ec386383ac0fe835fcbee79b17/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-19T22:50:18+08:00" />
<meta property="article:modified_time" content="2023-03-19T22:50:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YOLO系列之YOLO V1</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><ul><li><a href="#1_1" rel="nofollow">1.写在前面</a></li><li><a href="#2__6" rel="nofollow">2. 模型介绍</a></li><li><a href="#3_16" rel="nofollow">3.原理讲解</a></li><li><a href="#4_57" rel="nofollow">4.写在最后</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h4><a id="1_1"></a>1.写在前面</h4> 
<p>这是我发布的目标检测系列论文之二，前面一个章节，我们已经讨论过了目标检测系列中最基础的东西，<strong>常见指标</strong>以及<strong>相关的一些概念</strong>。那么本次，我将介绍一下YOLO系列的初代版本，<strong>YOLO V1</strong></p> 
<p>论文链接<a href="http://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Redmon_You_Only_Look_CVPR_2016_paper.pdf" rel="nofollow">点击直达</a></p> 
<h4><a id="2__6"></a>2. 模型介绍</h4> 
<p>前面我们已经说过了，One-Stage算法具有实时检测的FPS，实用性特别的好，因此作为YOLO系列的第一代版本，论文的名字就已经说明了一切<strong>You only Look Once</strong></p> 
<p>我们先来看一下效果：<br> <img src="https://images2.imgbox.com/da/26/4Mtastpr_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/a2/b6/qh3aLyer_o.png" alt="在这里插入图片描述"><br> 再来看看YOLO V1在当时的性能如何？<br> <img src="https://images2.imgbox.com/d9/b0/bb8p6LKs_o.png" alt="在这里插入图片描述"><br> 我们可以看到YOLO在损失比较小<code>mAP</code>的情况下，带来了极大的<code>FPS</code>增益效果，因此在当时还是引发了不小的轰动，所以我们来看看他是怎么实现的吧！</p> 
<h4><a id="3_16"></a>3.原理讲解</h4> 
<p>那么作者是怎么做的呢？首先我们来看一张图片：<br> <img src="https://images2.imgbox.com/47/33/BVLqO6XV_o.png" alt="在这里插入图片描述"><br> 这张图像很好得诠释了YOLO V1的模型，它先把图像resize成448x448的大小，然后将这个图像分割成SxS的大小，也就是说哈，我拿一个刀，将图像切成一个个的豆腐块。</p> 
<p>再之后，每个豆腐块（网格）需要预测B个bounding box(论文中指出，B=2)，除了预测位置信息之外，还要预测一个<code>confidence</code>参数，表示该候选框能有多大的把握框中了物体。</p> 
<p><strong>这里可能有小伙伴就迷糊了，你一个豆腐块你怎么预测候选框(bounding box)呢？<strong>其实意思是这样的，就是你可以理解成以豆腐块为中心，画B个框出来，然后如果有物体就逐步调整和Ground truth最大IOU的那个框，直到这个框和ground truth 的IOU最大。还是不理解就看下面的图：<br> <img src="https://images2.imgbox.com/bf/83/aFbg3JxW_o.png" alt="在这里插入图片描述"><br> A,B这两个格子是SxS格子中的任意两个，以A为中心，画出了一个绿色一个黄色连个框框，同样B也是如此。之后我们发现。，B这个格子里好像没有物体欸，那么他的</strong>confidence</strong>必然很低，那么我们不管他，我们看A这个格子，直观上看，确实是框中了物体，所以他的<strong>confidence</strong>必然高。那么我们继续看，明显绿色这个框要比黄色这个框要好，因为啥？因为绿色框和Ground Truth的IOU高呀！那么我们就舍弃黄色的框，保留绿色的框。<br> 那么明白了之后，我们就要分析每个豆腐块会预测出多少个数字了，这很重要！<br> <img src="https://images2.imgbox.com/54/b2/tltMyApD_o.png" alt="在这里插入图片描述"><br> 首先，对于一个豆腐块，我要知道候选框的框框左上角的x,y值，以及这个框的宽和高吧</p> 
<p>然后刚才说了，还要有一个置信度吧，表示这个框有多大可能圈中了物体</p> 
<p>并且每个豆腐块产出B个框，如图，粉色和橙红色的框。</p> 
<p>那么就有<strong>B*5</strong>个数了，然后这个豆腐块还要预测我框出的是什么类别，因为pascal voc数据集一共有20个类别，那么我们还要带上20个类别概率，表示当前框框框中的是当前类别的概率是多少。就像这样：<br> <img src="https://images2.imgbox.com/f7/de/qfbGDGRE_o.png" alt="在这里插入图片描述"><br> 好了，接下来我们来讨论一下是如何调整候选框，使得候选框的IOU最大的呢？这时候不得不提到它的损失函数：<br> <img src="https://images2.imgbox.com/34/a5/XdxAVL4X_o.png" alt="在这里插入图片描述"></p> 
<p>首先我们看位置误差。<br> <img src="https://images2.imgbox.com/40/a6/XjZluf5k_o.png" alt="在这里插入图片描述"><br> 如图：对于这个函数，当时小物体的时候，你移动非常小的距离，他变化的很快，但是对于大物体，你移动比较大的距离，他变得很小。不敏感。<br> <img src="https://images2.imgbox.com/3b/ef/kEyo95oH_o.png" alt="在这里插入图片描述"><br> 然后我们再来看看置信误差，这里为什么含有obj的误差和不含obj的误差分开来算呢？</p> 
<blockquote> 
 <p>这是因为呀，在图像中，一般前景比较少，背景比较多，那如果两者一起算了，很容易出现负样本过多，正负比例不均衡！所以要加一个<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           λ 
          
          
          
            n 
           
          
            o 
           
          
            o 
           
          
            b 
           
          
            j 
           
          
         
        
       
         \lambda_{noobj} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3361em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">oo</span><span class="mord mathnormal mtight" style="margin-right: 0.0572em;">bj</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>作为惩罚因子！<br> <img src="https://images2.imgbox.com/9f/cf/DpDCxMVc_o.png" alt="在这里插入图片描述"><br> 最后的分类误差就是简单的MSE Loss，在这里不再赘述。</p> 
</blockquote> 
<p>总结一下：</p> 
<ol><li>一共有SxS个格子，然后每个格子会画两个框</li><li>根据置信度，看看哪些框圈中了物体</li><li>再比较框和Grouth Truth 的IOU大小，保留大的</li><li>通过Loss逐步调整候选框的大小</li></ol> 
<h4><a id="4_57"></a>4.写在最后</h4> 
<p>这次我们分析了yolo 的第一个版本，他虽然有诸多优点，比如快速简单，但是还是存在如下缺点：</p> 
<ul><li>每个Cell（豆腐块）只预测一个类别，如果重叠那么就无解</li><li>小物体效果检测很一般，候选框长宽比可选但是单一</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4c3fef910c8095b290edf05dc3627fc0/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Android】【移动应用开发】基础知识</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/889060f230d83bf884ba538192c85c60/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【MySQL进阶】深入理解InnoDB数据页结构</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>