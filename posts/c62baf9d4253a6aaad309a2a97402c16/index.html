<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在 Windows 系统下常用的 bat 脚本分享 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在 Windows 系统下常用的 bat 脚本分享" />
<meta property="og:description" content="以网络配置举例说明，网络连接默认情况下都是 DHCP（自动获取 IP 和 DNS 地址） 模式，但很多情况下，需要我们设置为指定的静态 IP 和 DNS 地址。在 Windows 系统中通常我们都是在系统托盘中右键网络图标，点击 打开网络和共享中心 → 更改适配器设置 → 右键 以太网（WLAN...） 属性 → IPv4 属性 这样一步一步的来修改，即繁琐又浪费时间，所以在这里将自己常用的 bat 脚本分享出来，使用后多多少少能节省一点时间，提高工作效率。
1. WLAN（以太网等）静态 IP / DHCP 快速配置脚本 因鄙人所在公司的网络是进行了监控和限制了的，每个人都分有一个连接互联网的 IP 地址，就连 QQ 也是限制登录了的，只要使用公司的网络就只有登记的工作 QQ 可以登录的上去。因为在公司用的是自己的电脑，在家的时候都是使用自动获取 IP 的模式，到公司就得改成静态 IP，所以使用 bat 脚本一键修改 IP 可以节约很多时间。废话有点多了...上图：
586 x 501
使用方法：
312 x 217
绿色框线部分设为自己常用的静态 IP 配置，使用时直接选择第 2 项回车即可。变量 Nic 对应网络连接中的 WLAN 或 以太网 （Win7 以前的应该叫 本地连接）：
702 x 186 798 x 212" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/c62baf9d4253a6aaad309a2a97402c16/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-11T23:53:31+08:00" />
<meta property="article:modified_time" content="2019-10-11T23:53:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在 Windows 系统下常用的 bat 脚本分享</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>以网络配置举例说明，网络连接默认情况下都是 DHCP（自动获取 IP 和 DNS 地址） 模式，但很多情况下，需要我们设置为指定的静态 IP 和 DNS 地址。在 Windows 系统中通常我们都是在系统托盘中右键网络图标，点击 <code>打开网络和共享中心</code> → <code>更改适配器设置</code> → <code> 右键 以太网（WLAN...） 属性</code> → <code>IPv4 属性</code> 这样一步一步的来修改，即繁琐又浪费时间，所以在这里将自己常用的 bat 脚本分享出来，使用后多多少少能节省一点时间，提高工作效率。</p> 
<p> </p> 
<h4 id="toc_h3_0">1. WLAN（以太网等）静态 IP / DHCP 快速配置脚本</h4> 
<p>因鄙人所在公司的网络是进行了监控和限制了的，每个人都分有一个连接互联网的 IP 地址，就连 QQ 也是限制登录了的，只要使用公司的网络就只有登记的工作 QQ 可以登录的上去。因为在公司用的是自己的电脑，在家的时候都是使用自动获取 IP 的模式，到公司就得改成静态 IP，所以使用 bat 脚本一键修改 IP 可以节约很多时间。废话有点多了...上图：</p> 
<blockquote> 
 <p><img alt="静态IP / DHCP 快速配置" class="has" src="https://images2.imgbox.com/58/fa/Xq7BaWPB_o.png"></p> 
 <p>586 x 501</p> 
</blockquote> 
<p><strong>使用方法：</strong></p> 
<blockquote> 
 <p><img alt="IPChange使用方法" class="has" src="https://images2.imgbox.com/be/03/2q1fbiH0_o.png"></p> 
 <p>312 x 217</p> 
 <p>绿色框线部分设为自己常用的静态 IP 配置，使用时直接选择第 2 项回车即可。变量 <code>Nic</code> 对应网络连接中的 <code>WLAN</code> 或 <code>以太网</code> （Win7 以前的应该叫 本地连接）：<br><img alt="网络连接" class="has" src="https://images2.imgbox.com/2f/82/BsHbizj5_o.png"></p> 
 <p>702 x 186 798 x 212</p> 
 <p><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fwww.itanken.cn%2Fdocs%2Fbat%2FIP%25E5%25BF%25AB%25E9%2580%259F%25E9%2585%258D%25E7%25BD%25AE%25E5%25B7%25A5%25E5%2585%25B7.rar" rel="nofollow">iTanken官方下载地址</a><br><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fres.zixizixi.cn%2Ffile%2F2017%2F4%2Fd60d159878a541c98aa41f7b0db6bc64-IP.rar" rel="nofollow">七牛云备用下载地址</a></p> 
</blockquote> 
<h4 id="toc_h3_1">2. MySQL（SQL Server 等）服务快速启动关闭脚本</h4> 
<p>用来快速启动和关闭 MySQL / SQL Server(默认实例的服务名为 MSSQLSERVER)等服务，和快速打开 MySQL 的管理程序 SQLyog（SQL Server 为 SSMS，即 SQL Server Management Studio）：</p> 
<blockquote> 
 <p><strong>MySQL 快速启动：</strong><br> 我安装的是 MySQL 5.7,服务名为 <code> MySQL57</code>,打开脚本时会先启动或关闭服务，然后再显示选择菜单。<br><img alt="MYSQL 服务" class="has" src="https://images2.imgbox.com/0f/93/cpqvvhBS_o.png"></p> 
 <p>510 x 333</p> 
 <p><strong>SQL Server 服务快速启动：</strong><br> 与 MySQL 的启动方式一致，默认的服务名为 <code>MSSQLSERVER</code>，我之前在自己的电脑上安装的实例名为 SSS，服务名为 MSSQL$SSS，因为重装系统后只安装了 SSMS，没有安装数据库实例，所以下图中会显示服务名无效。一会下面会介绍查看服务名的方法。<br><img alt="MSSQL 服务" class="has" src="https://images2.imgbox.com/11/5b/7hhRxP2o_o.png"><br> 图中的 <code>打开 SQL Server</code> 意思是打开 SQL Server Management Studio，使用了 SSMS 快捷命令。第 3 项 <code>重新运行命令</code> 的意思是，如果服务已经启动则关闭，否则启动相应的服务。</p> 
 <p>查看 Windows 系统服务名的方法：</p> 
 <ol><li> <p>打开系统 <code>服务</code> 界面，可在运行窗口中使用 <code>services.msc</code> 快捷命令：<br><img alt="打开服务界面" class="has" src="https://images2.imgbox.com/bc/65/2GcfULAr_o.png"></p> <p>413 x 237</p> </li><li> <p>右键对应的服务查看 <code>属性</code>：<br><img alt="查看服务属性" class="has" src="https://images2.imgbox.com/3c/97/LWLwxHCu_o.png"></p> <p>670 x 490 820 x 600</p> <br> 需要查看的就是蓝色框线中的 <code>服务名称</code>。</li></ol> 
 <p>直接在运行窗口中运行服务可使用命令 <code>net start 服务名</code> 来启动相应的服务。</p> 
 <p><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fwww.itanken.cn%2Fdocs%2Fbat%2FMySql%25E5%2592%258CMSSQL%25E6%259C%258D%25E5%258A%25A1%25E5%25BF%25AB%25E9%2580%259F%25E5%2590%25AF%25E5%258A%25A8%25E5%2585%25B3%25E9%2597%25AD%25E5%25B7%25A5%25E5%2585%25B7.rar" rel="nofollow">iTanken官方下载地址</a><br><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fres.zixizixi.cn%2Ffile%2F2017%2F4%2F5a588884291b4087ad2c3eef901c1836-MySqlMSSQL.rar" rel="nofollow">七牛云备用下载地址</a></p> 
</blockquote> 
<h4 id="toc_h3_3">3. Nginx 服务管理功能脚本</h4> 
<p>Windows 版 Nginx 的快速管理工具，可以一键启动、关闭、重启、验证配置文件等：</p> 
<blockquote> 
 <p><img alt="Nginx 管理工具" class="has" src="https://images2.imgbox.com/44/f6/45CCQvOK_o.png"></p> 
 <p>670 x 433</p> 
 <p>这里的重启是先关闭，再启动；这里的刷新是 Nginx 的 reload 命令。</p> 
 <p><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fwww.itanken.cn%2Fdocs%2Fbat%2FNginx%25E7%25AE%25A1%25E7%2590%2586%25E5%25B7%25A5%25E5%2585%25B7.rar" rel="nofollow">iTanken官方下载地址</a><br><a href="https://hacpai.com/forward?goto=https%3A%2F%2Fres.zixizixi.cn%2Ffile%2F2017%2F4%2F43b5d33d341449b69625ad8296aecdbb-Nginx.rar" rel="nofollow">七牛云备用下载地址</a></p> 
</blockquote> 
<h4 id="toc_h3_4">4. sfc 一键修复命令</h4> 
<p>sfc 全称为 SystemFileChecker，是用来检查和修复系统文件的比较有用的一个命令，但我也不太常用。需要的话直接复制下面的代码新建保存为 .bat 格式的文件使用。</p> 
<blockquote> 
 <pre><code class="language-html hljs"> </code></pre> 
 <p>@echo off color 0f title Windows 一键修复 @echo. @echo 右键 以管理员身份运行(A) C:\WINDOWS\system32\sfc.exe /scannow @echo. @echo Done. rem shutdown @echo. @pause</p> 
 <code>@echo off color 0f title Windows 一键修复 @echo. @echo 右键 以管理员身份运行(A) C:\WINDOWS\system32\sfc.exe /scannow @echo. @echo Done. rem shutdown @echo. @pause </code> 
</blockquote> 
<h4 id="toc_h3_5">5. 一键清理垃圾文件</h4> 
<p>用来清除 Windows 系统下的缓存文件、日志文件、回收站文件和备份文件等垃圾文件。个人不太常用，在网上都能查的到。</p> 
<blockquote> 
 <pre><code class="language-html hljs"> </code></pre> 
 <p>@echo off title 一键清除系统垃圾 echo 正在清除系统垃圾文件，请稍等...... echo. del /f /s /q %systemdrive%\*.tmp del /f /s /q %systemdrive%\*._mp del /f /s /q %systemdrive%\*.log del /f /s /q %systemdrive%\*.gid del /f /s /q %systemdrive%\*.chk del /f /s /q %systemdrive%\*.old del /f /s /q %systemdrive%\recycled\*.* del /f /s /q %windir%\*.bak del /f /s /q %windir%\prefetch\*.* rd /s /q %windir%\temp &amp; md %windir%\temp del /f /q %userprofile%\cookies\*.* del /f /q %userprofile%\recent\*.* del /f /s /q "%userprofile%\Local Settings\Temporary Internet Files\*.*" del /f /s /q "%userprofile%\Local Settings\Temp\*.*" del /f /s /q "%userprofile%\recent\*.*" echo. echo 清除系统垃圾完成！ echo. &amp; pause</p> 
 <code>@echo off title 一键清除系统垃圾 echo 正在清除系统垃圾文件，请稍等...... echo. del /f /s /q %systemdrive%\*.tmp del /f /s /q %systemdrive%\*._mp del /f /s /q %systemdrive%\*.log del /f /s /q %systemdrive%\*.gid del /f /s /q %systemdrive%\*.chk del /f /s /q %systemdrive%\*.old del /f /s /q %systemdrive%\recycled\*.* del /f /s /q %windir%\*.bak del /f /s /q %windir%\prefetch\*.* rd /s /q %windir%\temp &amp; md %windir%\temp del /f /q %userprofile%\cookies\*.* del /f /q %userprofile%\recent\*.* del /f /s /q "%userprofile%\Local Settings\Temporary Internet Files\*.*" del /f /s /q "%userprofile%\Local Settings\Temp\*.*" del /f /s /q "%userprofile%\recent\*.*" echo. echo 清除系统垃圾完成！ echo. &amp; pause </code> 
</blockquote> 
<h4 id="toc_h3_6">6. Windows 快捷运行小技巧</h4> 
<p>在 Windows 中，已经习惯了用 Win + R 运行命令的方式快速打开应用程序，通常我会创建一个专用的文件夹，配置在环境变量的 Path 里，将常用的程序的快捷方式和 bat 脚本等放在该目录中后修改成一个简短的名称，就可以通过这个简短的名称直接运行相应的程序或 bat 脚本了，比如最常用的一个命令 <code>ipconfig</code>，查看 IP 配置信息，我会创建一个名为 IP.bat 的文件，内容如下：</p> 
<blockquote> 
 <pre><code class="language-html hljs"> </code></pre> 
 <p>@echo off color 0f title 查看本机 IP 配置信息 ipconfig /all echo. pause</p> 
 <code>@echo off color 0f title 查看本机 IP 配置信息 ipconfig /all echo. pause </code> 
</blockquote> 
<p>然后按 Win + R 输入 <code>IP</code> 直接回车即可查看 IP 配置信息。</p> 
<blockquote> 
 <p><strong>运行目录：</strong><br><img alt="运行目录" class="has" src="https://images2.imgbox.com/7a/d5/evo4abYy_o.png"></p> 
 <p>702 x 520 889 x 659</p> 
 <p><strong>环境变量：</strong><br><img alt="环境变量" class="has" src="https://images2.imgbox.com/2f/59/ox67j6ue_o.png"></p> 
 <p>632 x 666</p> 
 <p><strong>小提示：Windows 系统下选中文件或文件夹，按住 Alt 键，直接拖动到相应的位置，即可在当前位置创建快捷方式。</strong></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6120a0c4bb021b3206b5f70c8ab79b4e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MUI混合开发——更新下载app时，系统状态栏显示下载进度</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9789175ee54add890c4289d380967144/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">五分钟快速过完Verilog HDL基本概念(5)数据类型</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>