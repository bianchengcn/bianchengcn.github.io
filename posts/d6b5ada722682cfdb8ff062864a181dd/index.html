<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Visual Studio 2019：引用动态DLL项目 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Visual Studio 2019：引用动态DLL项目" />
<meta property="og:description" content="前文：Visual Studio 2019：创建动态DLL库
创建客户端应用 1、在菜单栏上，选择“文件”&gt;“新建”&gt;“项目”，打开“创建新项目”对话框 。
2、在对话框顶部，将“语言” 设置为“C&#43;&#43;” ，将“平台” 设置为“Windows” ，并将“项目类型” 设置为“控制台” ，选择“控制台应用”，然后选择“下一步” 。
3、在“配置新项目”页面，在“项目名称”框中输入“MathClient”
接下来，要在源代码中调用 MathLibrary 函数，你的项目必须包括 MathLibrary.h 文件 。
可以将此头文件复制到客户端应用项目中，然后将其作为现有项添加到项目中。对于第三方库，此方法可能是一个不错的选择。但是，如果同时处理 DLL 的代码和客户端的代码，则头文件可能会变为不同步。要避免此问题，请设置项目中的“附加包含目录” 路径，使其包含指向原始头文件的路径。 将 DLL 头文件添加到包含路径 1、右键单击“解决方案资源管理器” 中的“MathClient” 节点以打开“属性页” 对话框。
2、在“配置”下拉框中，选择“所有配置”，在左窗格中，选择“配置属性” &gt; “C/C&#43;&#43;” &gt; “常规” 。在属性窗格中，选择“附加包含目录” 编辑框旁的下拉控件，然后选择“编辑” 。
3、修改MathClient.cpp
// MathClient.cpp : Client app for MathLibrary DLL. // #include &#34;pch.h&#34; Uncomment for Visual Studio 2017 and earlier #include &lt;iostream&gt; #include &#34;MathLibrary.h&#34; int main() { // Initialize a Fibonacci relation sequence." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d6b5ada722682cfdb8ff062864a181dd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-18T11:06:41+08:00" />
<meta property="article:modified_time" content="2021-01-18T11:06:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Visual Studio 2019：引用动态DLL项目</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><a href="https://blog.csdn.net/zhizhengguan/article/details/104904207">前文：Visual Studio 2019：创建动态DLL库</a></p> 
</blockquote> 
<h2><a id="_2"></a>创建客户端应用</h2> 
<p>1、在菜单栏上，选择“文件”&gt;“新建”&gt;“项目”，打开“创建新项目”对话框 。<br> <img src="https://images2.imgbox.com/fc/f5/YuKrBvaA_o.png" alt="在这里插入图片描述"></p> 
<p>2、在对话框顶部，将“语言” 设置为“C++” ，将“平台” 设置为“Windows” ，并将“项目类型” 设置为“控制台” ，选择“控制台应用”，然后选择“下一步” 。<br> <img src="https://images2.imgbox.com/47/ee/FAjOraz1_o.png" alt="在这里插入图片描述"></p> 
<p>3、在“配置新项目”页面，在“项目名称”框中输入“MathClient”<br> <img src="https://images2.imgbox.com/3f/03/elzZ2XbU_o.png" alt="在这里插入图片描述"><br> 接下来，要在源代码中调用 MathLibrary 函数，你的项目必须包括 MathLibrary.h 文件 。</p> 
<ul><li>可以将<strong>此头文件复制到客户端应用项目中</strong>，然后将其作为现有项添加到项目中。对于第三方库，此方法可能是一个不错的选择。</li><li>但是，如果同时处理 DLL 的代码和客户端的代码，则头文件可能会变为不同步。要避免此问题，请设置项目中的“附加包含目录” 路径，使其包含指向原始头文件的路径。</li></ul> 
<h2><a id="_DLL__17"></a>将 DLL 头文件添加到包含路径</h2> 
<p>1、右键单击“解决方案资源管理器” 中的“MathClient” 节点以打开“属性页” 对话框。<br> <img src="https://images2.imgbox.com/f2/ae/1OYINeK8_o.png" alt="在这里插入图片描述"><br> 2、在“配置”下拉框中，选择“所有配置”，在左窗格中，选择“配置属性” &gt; “C/C++” &gt; “常规” 。在属性窗格中，选择“附加包含目录” 编辑框旁的下拉控件，然后选择“编辑” 。<br> <img src="https://images2.imgbox.com/e8/f8/vAMB6WdE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/83/6a/Ew31TOA8_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/25/ab/IqHIW8Qt_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/95/4d/4jvC8jjF_o.png" alt="在这里插入图片描述"></p> 
<p>3、修改<code>MathClient.cpp</code></p> 
<pre><code class="prism language-cpp"><span class="token comment">// MathClient.cpp : Client app for MathLibrary DLL.</span>
<span class="token comment">// #include "pch.h" Uncomment for Visual Studio 2017 and earlier</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"MathLibrary.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token comment">// Initialize a Fibonacci relation sequence.</span>
    <span class="token function">fibonacci_init</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Write out the sequence values until overflow.</span>
    <span class="token keyword">do</span> <span class="token punctuation">{<!-- --></span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">fibonacci_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span>
            <span class="token operator">&lt;&lt;</span> <span class="token function">fibonacci_current</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">fibonacci_next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Report count of values written before overflow.</span>
    std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">fibonacci_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span>
        <span class="token string">" Fibonacci sequence values fit in an "</span> <span class="token operator">&lt;&lt;</span>
        <span class="token string">"unsigned 64-bit integer."</span> <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>4、生成解决方案<br> <img src="https://images2.imgbox.com/87/7f/DqKLrSOs_o.png" alt="在这里插入图片描述"></p> 
<p>此代码可进行编译，但不能链接。 如果现在生成客户端应用，则错误列表会显示几个 LNK2019 错误。 这是因为项目丢失了一些信息：你尚未指定项目在 MathLibrary.lib 库上有依赖项 。 而且，你尚未告诉链接器如何查找 MathLibrary.lib 文件 。<br> <img src="https://images2.imgbox.com/f9/c9/6iNbBa9I_o.png" alt="在这里插入图片描述"><br> 要解决此问题，可以直接将库文件复制到客户端应用项目中。 链接器将自动查找并使用它。 但是，如果库和客户端应用都处于开发过程中，则可能会导致一个副本中的更改未在另一个副本中显示。 要避免此问题，可以设置“附加依赖项”属性，告诉生成系统项目依赖于 MathLibrary.lib 。 此外，还可设置项目中的“附加库目录” 路径，使其在链接时包含指向原始库的路径。</p> 
<h2><a id="_DLL__57"></a>将 DLL 导入库添加到项目中</h2> 
<p>1、右键单击“解决方案资源管理器”中的“MathClient”节点，然后选择“属性”以打开“属性页”对话框 。<br> <img src="https://images2.imgbox.com/7d/ff/1bTD9UaK_o.png" alt="在这里插入图片描述"></p> 
<p>2、在“配置”下拉框中，选择“所有配置”（如果尚未选择） 。 <strong>它可确保任何属性更改同时应用于调试和发布版本。</strong><br> <img src="https://images2.imgbox.com/6a/22/4KlT6gXG_o.png" alt="在这里插入图片描述"></p> 
<p>3、在左窗格中，选择“配置属性” &gt; “链接器” &gt; “输入” 。 在属性窗格中，选择“附加依赖项” 编辑框旁的下拉控件，然后选择“编辑” 。<br> <img src="https://images2.imgbox.com/64/02/dTMbiofE_o.png" alt="在这里插入图片描述"><br> 4、在“附加依赖项”对话框中，将 【MathLibrary.lib 】这个名字复制黏贴到顶部编辑控件的列表中 。选择“确定” 返回到“属性页” 对话框。<font color="red">注意是.lib而不是.dll</font>， 否则编译时：<strong>LNK1107 文件无效或损坏: 无法在 0x350 处读取</strong></p> 
<p><img src="https://images2.imgbox.com/dc/42/aKxUBwep_o.png" alt="在这里插入图片描述"></p> 
<p>5、在左窗格中，选择“配置属性” &gt; “链接器” &gt; “常规” 。 在属性窗格中，选择“附加库目录” 编辑框旁的下拉控件，然后选择“编辑” 。<br> <img src="https://images2.imgbox.com/10/4e/bC2g7tHq_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/26/dd/f1AVvR7h_o.png" alt="在这里插入图片描述"><br> 6、生成解决方案<br> <img src="https://images2.imgbox.com/b0/44/myM7NZg1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f5/9e/ykEVDD9B_o.png" alt="在这里插入图片描述"><br> 客户端应用现在可以成功编译和链接</p> 
<p>7、运行<br> <img src="https://images2.imgbox.com/90/12/xRq0mehq_o.png" alt="在这里插入图片描述"><br> 仍未具备运行所需的全部条件。 当操作系统加载应用时，它会查找 MathLibrary DLL。 如果在某些系统目录、环境路径或本地应用目录中找不到 DLL，则加载会失败：<br> <img src="https://images2.imgbox.com/e2/2a/HMjukyF9_o.png" alt="在这里插入图片描述"><br> 避免此问题的一种方法是将 DLL 复制到包含客户端可执行文件的目录中，作为生成过程的一部分。 可将“后期生成事件”添加到项目中，以此添加一条命令，将 DLL 复制到生成输出目录 。 此处指定的命令仅在 DLL 丢失或发生更改时才复制它。 此命令使用宏根据生成配置在调试或发布位置之间进行复制。</p> 
<h2><a id="_DLL_86"></a>在生成后事件中复制 DLL</h2> 
<p>1、右键单击“解决方案资源管理器”中的“MathClient”节点，然后选择“属性”以打开“属性页”对话框 。<br> <img src="https://images2.imgbox.com/24/f1/fWmsRZCU_o.png" alt="在这里插入图片描述"></p> 
<p>2、在“配置”下拉框中，选择“所有配置”（如果尚未选择） 。 <strong>它可确保任何属性更改同时应用于调试和发布版本。</strong><br> <img src="https://images2.imgbox.com/38/43/ZWqUa3RV_o.png" alt="在这里插入图片描述"><br> 3、在左窗格中，选择“配置属性” &gt; “生成事件” &gt; “生成后事件” 。</p> 
<p>4、在属性窗格中，在“命令行”字段中选择编辑控件 。 如果已按照指示将客户端项目置于 DLL 项目的单独解决方案中，则输入以下命令：<br> <code>xcopy /y /d "..\..\MathLibrary\$(IntDir)MathLibrary.dll" "$(OutDir)"</code></p> 
<p>如果 DLL 和客户端项目在其他目录中，请更改 DLL 的相对路径以进行匹配。<br> <img src="https://images2.imgbox.com/10/23/8bkEthqY_o.png" alt="在这里插入图片描述"><br> 5、在菜单栏上，选择“调试” &gt; “启动而不调试”<br> <img src="https://images2.imgbox.com/ce/e2/PXk42iAM_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/caadc25bddf4a2e880598838d38ebbca/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Java练习】判断数组元素是否有序（递增）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0da31ba5d3da8a1eb103a8ff86cf8dba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql text 最大长度_MySQL TEXT数据类型的最大长度</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>