<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>定时器输出比较&amp;输入捕获 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="定时器输出比较&amp;输入捕获" />
<meta property="og:description" content="1.1 定时器的输出比较功能
1.1.1 什么意思？
所谓的输出比较就是计数器的值与比较寄存器的值进行比较，大于输出一种电平，小于输出另一种电平。
选择PWM1模式的时候，计数器的值小于设置的值输出有效电平（低电平有效），大于就是无效电平。
怎么让它们与灯关联上？？输出比较通道的概念
PB0在原理图上连接的是LED3，在引脚映射上描述是可以作为定时器3的通道3，如果我使用定时器3的通道3作为PWM输出，LED3就会接收到PWM输出的波形。
LED3会显示成什么样子？？PWM是有效电平和无效电平的一个占比，灯是低电平有效，高电平无效，如果有效电平时间长灯亮度高，有效时间短灯暗。
配置示例：
如果我们改变占空比（PWM）就可以实现灯慢慢亮，慢慢灭，怎么调节？？改变比较寄存器里面的值。
我们这里选择使用每次更新后改变比较寄存器的值。
总结：
1）什么是PWM？有效电平和无效电平的占空比
2）什么是输出比较？大于（比较寄存器）的极性是什么，小于极性又是什么
3）实现PWM输出配置有哪些？定时器配置好，PWM模式选择、极性选择、通道选择、比较寄存器的值，通道对应引脚映射。
1.2 定时器的输入捕获功能
1.2.1 什么是输入捕获？
字面意思捕获输入的信号，怎么捕获？为什么要捕获？？检测通道上的高低电平变化，可以及时快速的获取到通道上的状态。
找一个现象学习这种功能，我们这里使用按键去测试，按键按下被捕获，松手又会捕获，计算两次之间的时间，得到按下的时长。
​​​​​​​1.2.2 配置输入捕获
在库函数中可以看到如下函数。
这个函数需要的配置参数如下：从上到下分别是通道选择、捕获边沿设置、寄存器映射、分频设置、滤波等级设置。 我们根据之前的了解，将它们进行如下设置即可使用了（定时器3的配置不变，加上下面代码再启动就可以了）。
设置完成之后，我们进行测试，这里先测试是否能够捕获到上升沿和下降沿。
测试是完全没问题的，按键按下可以检测到，松手也能检测到（按下输出一次，松手又是一次）。 但是，这样检测不及时，最好还是开中断去做，所以我们把定时器3的中断打开。 然后在中断中放置同样的代码进行测试，发现也是没有问题的，可以正常检测。
​​​​​​​
1.2.3 按下到松手的时长计算" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/db48a506e586091c41bd461f3844ef0c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-17T20:09:19+08:00" />
<meta property="article:modified_time" content="2023-03-17T20:09:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">定时器输出比较&amp;输入捕获</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>1.1 <strong><strong>定时器的输出比较功能</strong></strong></strong></p> 
<p><strong><strong><strong>1.1.1 </strong></strong></strong><strong><strong><strong>什么意思？</strong></strong></strong></p> 
<p><img alt="" height="192" src="https://images2.imgbox.com/7f/7d/PZQksfAH_o.png" width="487"></p> 
<p><img alt="" height="195" src="https://images2.imgbox.com/c1/b9/BHFFLMNP_o.png" width="446"> </p> 
<p>所谓的输出比较就是计数器的值与比较寄存器的值进行比较，大于输出一种电平，小于输出另一种电平。</p> 
<p><img alt="" height="118" src="https://images2.imgbox.com/9b/1f/IluYqgRP_o.png" width="622"> </p> 
<p style="margin-left:.0001pt;text-align:justify;">选择PWM1模式的时候，计数器的值小于设置的值输出有效电平（低电平有效），大于就是无效电平。</p> 
<p style="margin-left:.0001pt;text-align:justify;">怎么让它们与灯关联上？？输出比较通道的概念</p> 
<p> <img alt="" height="156" src="https://images2.imgbox.com/46/0c/xw8X3VUs_o.png" width="556"></p> 
<p style="margin-left:.0001pt;text-align:justify;">PB0在原理图上连接的是LED3，在引脚映射上描述是可以作为定时器3的通道3，如果我使用定时器3的通道3作为PWM输出，LED3就会接收到PWM输出的波形。</p> 
<p style="margin-left:.0001pt;text-align:justify;">LED3会显示成什么样子？？PWM是有效电平和无效电平的一个占比，灯是低电平有效，高电平无效，如果有效电平时间长灯亮度高，有效时间短灯暗。</p> 
<p style="margin-left:.0001pt;text-align:justify;">配置示例：</p> 
<p> <img alt="" height="365" src="https://images2.imgbox.com/2e/ba/2Nnyfrxe_o.png" width="623"></p> 
<p style="margin-left:.0001pt;text-align:justify;">如果我们改变占空比（PWM）就可以实现灯慢慢亮，慢慢灭，怎么调节？？改变比较寄存器里面的值。</p> 
<p style="margin-left:.0001pt;text-align:justify;">我们这里选择使用每次更新后改变比较寄存器的值。</p> 
<p> <img alt="" height="156" src="https://images2.imgbox.com/2e/47/GVqwzHMn_o.png" width="421"></p> 
<p style="margin-left:.0001pt;text-align:justify;">总结：</p> 
<p style="margin-left:.0001pt;text-align:justify;">1）什么是PWM？有效电平和无效电平的占空比</p> 
<p style="margin-left:.0001pt;text-align:justify;">2）什么是输出比较？大于（比较寄存器）的极性是什么，小于极性又是什么</p> 
<p style="margin-left:.0001pt;text-align:justify;">3）实现PWM输出配置有哪些？定时器配置好，PWM模式选择、极性选择、通道选择、比较寄存器的值，通道对应引脚映射。</p> 
<p> </p> 
<p><strong>1.2 <strong><strong>定时器的输入捕获功能</strong></strong></strong></p> 
<p><strong><strong><strong>1.2.1 </strong></strong></strong><strong><strong><strong>什么是输入捕获？</strong></strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">字面意思捕获输入的信号，怎么捕获？为什么要捕获？？检测通道上的高低电平变化，可以及时快速的获取到通道上的状态。</p> 
<p style="margin-left:.0001pt;text-align:justify;"><img alt="" height="227" src="https://images2.imgbox.com/71/1b/XpBBZGu6_o.png" width="490"></p> 
<p>找一个现象学习这种功能，我们这里使用按键去测试，按键按下被捕获，松手又会捕获，计算两次之间的时间，得到按下的时长。</p> 
<p>​​​​​​​<strong>1.2.2</strong> <strong><strong><strong>配置输入捕获</strong></strong></strong></p> 
<p style="margin-left:.0001pt;text-align:justify;">在库函数中可以看到如下函数。</p> 
<p> <img alt="" height="231" src="https://images2.imgbox.com/44/7f/06MWuHdG_o.png" width="508"></p> 
<p>这个函数需要的配置参数如下：从上到下分别是通道选择、捕获边沿设置、寄存器映射、分频设置、滤波等级设置。 </p> 
<p><img alt="" height="111" src="https://images2.imgbox.com/71/72/orupgkIF_o.png" width="526"></p> 
<p><img alt="" height="62" src="https://images2.imgbox.com/ff/f3/XlJQ4jFs_o.png" width="529"> </p> 
<p><img alt="" height="336" src="https://images2.imgbox.com/44/a4/zBmhF7LL_o.png" width="531"> </p> 
<p><img alt="" height="53" src="https://images2.imgbox.com/a9/5c/yBvpx1VC_o.png" width="524"> </p> 
<p>我们根据之前的了解，将它们进行如下设置即可使用了（定时器3的配置不变，加上下面代码再启动就可以了）。</p> 
<p><img alt="" height="103" src="https://images2.imgbox.com/2f/9a/EgTgeWIo_o.png" width="585"> </p> 
<p>设置完成之后，我们进行测试，这里先测试是否能够捕获到上升沿和下降沿。</p> 
<p><img alt="" height="149" src="https://images2.imgbox.com/00/97/jOdhZNcb_o.png" width="509"> </p> 
<p>测试是完全没问题的，按键按下可以检测到，松手也能检测到（按下输出一次，松手又是一次）。 </p> 
<p><img alt="" height="350" src="https://images2.imgbox.com/d2/49/VUy4Fa2h_o.png" width="445"></p> 
<p>但是，这样检测不及时，最好还是开中断去做，所以我们把定时器3的中断打开。 </p> 
<p><img alt="" height="131" src="https://images2.imgbox.com/7f/c6/MiWUqy5P_o.png" width="553"></p> 
<p>然后在中断中放置同样的代码进行测试，发现也是没有问题的，可以正常检测。</p> 
<p><img alt="" height="153" src="https://images2.imgbox.com/1b/87/5BQFrBaf_o.png" width="512"> ​​​​​​​</p> 
<p><strong><strong><strong>1.2.3 按下到松手的时长计算</strong></strong></strong></p> 
<p> <img alt="" height="389" src="https://images2.imgbox.com/f5/b6/A15PE7Iv_o.png" width="582"></p> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/62167d5a6f9460448b065abb2dc749dd/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【MyBatis-Plus】记录一次挺蠢的BUG。。。ServiceImpl＜M extends BaseMapper＜T＞, T＞，其他类注入后不生效</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9297030e2cf0ae44087641df2cfe51c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">25. K 个一组翻转链表(Java)，详细注释</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>