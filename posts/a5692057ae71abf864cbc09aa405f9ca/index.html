<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python】外文PDF阅读助手-使用win32clipboard实现去除剪切板(Clipboard)内容的换行符 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Python】外文PDF阅读助手-使用win32clipboard实现去除剪切板(Clipboard)内容的换行符" />
<meta property="og:description" content="1. 实现效果 在阅读外文PDF时，需要复制文字，会发现粘贴出来的文字都出现很奇怪的换行。
使用该Python脚本，可直接替换掉 剪切板 内的换行。再 Ctrl &#43; V，完美。
2. 脚本代码 改自：CSDN博客（Windows下利用win32clipboard实现Python的剪切板(Clipboard)操作）。
修改：中文windows下中文输出乱码。
原理：
1. Python3 默认编码是unicode，Windows环境默认是gbk编码。二者需要转换。
2. 从剪切板取字符串时，python3 会自动将文字以 utf-8 的编码保存到内部，所以再发送给 剪切板之前，要显式转为 gbk，再递给剪切板。否则会出现：英文正确，而汉字乱码的奇怪情况。
3. 此代码需自行安装 pywin32 库。（太久已忘当时如何装的了，可以试试CMD命令：pip3 install pywin32 ）
# clipboard.py #coding:utf-8 import win32clipboard as wc import win32con def stripClipboard(): # 开始剪切板操作 wc.OpenClipboard() # 尝试将剪切板内容读取为Unicode文本 txt = wc.GetClipboardData(win32con.CF_UNICODETEXT) #用unicode读 txt = str(txt).strip() # 字符串按行分割 txt = txt.splitlines() n = len(txt) # 用空格拼接每行 txt = &#39; &#39;.join(txt) # 将所有长度大于1的空白符转为1个空格 txt = &#39; &#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a5692057ae71abf864cbc09aa405f9ca/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-03-26T00:21:44+08:00" />
<meta property="article:modified_time" content="2020-03-26T00:21:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python】外文PDF阅读助手-使用win32clipboard实现去除剪切板(Clipboard)内容的换行符</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p> </p> 
<h3>1. 实现效果</h3> 
<p> </p> 
<p>在阅读外文PDF时，需要复制文字，会发现粘贴出来的文字都出现很奇怪的换行。</p> 
<p>使用该Python脚本，可直接替换掉 剪切板 内的换行。再 Ctrl + V，完美。</p> 
<p> </p> 
<h3>2. 脚本代码</h3> 
<p> </p> 
<p>改自：<a href="https://blog.csdn.net/u010555997/article/details/76474556">CSDN博客（Windows下利用win32clipboard实现Python的剪切板(Clipboard)操作）</a>。</p> 
<p>修改：中文windows下中文输出乱码。</p> 
<p>原理：</p> 
<p>1. Python3 默认编码是unicode，Windows环境默认是gbk编码。二者需要转换。</p> 
<p>2. 从剪切板取字符串时，python3 会自动将文字以 utf-8 的编码保存到内部，所以再发送给 剪切板之前，要显式转为 gbk，再递给剪切板。否则会出现：英文正确，而汉字乱码的奇怪情况。</p> 
<p>3. 此代码需自行安装 pywin32 库。（太久已忘当时如何装的了，可以试试CMD命令：pip3 install pywin32 ）</p> 
<p> </p> 
<pre><code class="language-python"># clipboard.py

#coding:utf-8

import win32clipboard as wc
import win32con


def stripClipboard():
    # 开始剪切板操作
    wc.OpenClipboard()
    # 尝试将剪切板内容读取为Unicode文本
    txt = wc.GetClipboardData(win32con.CF_UNICODETEXT)  #用unicode读
    txt = str(txt).strip()
    # 字符串按行分割
    txt = txt.splitlines()
    n = len(txt)
    # 用空格拼接每行
    txt = ' '.join(txt)
    # 将所有长度大于1的空白符转为1个空格
    txt = ' '.join(txt.split())
    # 清空剪切板
    wc.EmptyClipboard()
    # 尝试将处理完的字符以Unicode文本形式放入剪切板
    wc.SetClipboardData(win32con.CF_TEXT, txt.encode('gbk'))   #转为gbk再发给粘贴板
    # 关闭剪切板
    wc.CloseClipboard()
    print('delete {} return signal.\n'.format(n))
    print(txt+'\n')


stripClipboard()</code></pre> 
<p>效果如下。</p> 
<p> </p> 
<p>复制出的PDF：</p> 
<pre><code class="language-html">You either luck out that your idea goes viral (which happens to
maybe 1 out of 10,000 startups) or that your idea is so
brilliantly conceived and executed that people clamor to find
their wallets because you have solved their problem so well.
你好，我是谁？？我
在哪儿？</code></pre> 
<p>代码执行后：</p> 
<pre><code>You either luck out that your idea goes viral (which happens to maybe 1 out of 10,000 startups) or that your idea is so brilliantly conceived and executed that people clamor to find their wallets because you've solved their problem so well. 你好，我是谁？？我 在哪儿？</code></pre> 
<p> </p> 
<p>到此，也繁琐。每 Ctrl + C 一次，都需要手动双击 此 Python 脚本，不友好。</p> 
<p>若你的工作量大，可尝试 进阶方法，见 3。</p> 
<p> </p> 
<p> </p> 
<h4>3. 进阶：使用AutoHotkey</h4> 
<p> </p> 
<p>AutoHotkey 是一个热键工具软件，需要自行安装。可自定义热键及对应的功能。</p> 
<p>使用以下脚本，可实现 Ctrl + C，再 Ctrl + Alt +1，再Ctrl + V，就能生产出优美的文字了。</p> 
<pre><code class="language-bash">^!1::
RunWait, C:\Program Files\Python37\Python.exe "C:\code\py\clipboard.py", , Hide</code></pre> 
<p>该代码含义：</p> 
<p>定义热键： Ctrl + Alt + 1::</p> 
<p>运行命令  Python.exe pyfile.py ，并且隐藏运行窗口。</p> 
<p> </p> 
<p>如果不带 Hide 参数，会出现Python脚本运行时黑色窗口一闪而过，影响体验。Hide前面的空参数，是用来指定 命令 的工作目录，此处无用，留空。</p> 
<p> </p> 
<hr> 
<p> </p> 
<p>参考资料：</p> 
<p><strong>1. </strong><a href="https://www.cnblogs.com/yunguoxiaoqiao/p/7588725.html" rel="nofollow">Python3默认编码是unicode；而Python2是ASCII码。Windows环境默认是gbk编码</a></p> 
<p> </p> 
<hr> 
<p> </p> 
<p>最后，突然发现 有道词典 可以截图翻译。。。好吧，直接一步到位了。我之前还粘贴到网页翻译中去，这下直接省了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f95f0a419f823425ee90d1c3048b9fb2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java之MVC模式实现注册登录功能</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a1a336e156e4fbb4d4add7eb0308e96/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">HTML基础知识巩固你的基础</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>