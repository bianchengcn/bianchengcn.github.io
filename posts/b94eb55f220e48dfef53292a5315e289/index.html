<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在VMware中安装ArchLinux - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="在VMware中安装ArchLinux" />
<meta property="og:description" content="在VMware中安装ArchLinux 1、安装VMware 2、下载ArchLinux镜像文件 前往https://www.archlinux.org/download/下载自己需要的版本的镜像文件，建议下载最新版。
3、新建虚拟机 这一步没有太多坑，下面是简要步骤：
新建虚拟机 --&gt; 版本选择为其他Linux 5.x 64位 --&gt; 硬盘大小根据实际情况给定，我这里给的是50G --&gt; 其他配置根据自己的情况设置即可 --&gt; 点击“编辑虚拟机的设置” --&gt; 点击“选项” --&gt; 选择点击“高级” --&gt; 在固件类型中选择UEFI并确定 --&gt; 网络设置中选择NAT模式，这样只要主机能上网，虚拟机将自动配置上网 --&gt; 光驱选择下载好的镜像文件 --&gt; 保存设置后开启虚拟机
4、硬盘分区 1）这里给出我的分区方案，仅供参考： 分区名称大小作用后面分区盘标/mnt43G安装系统和软件/dev/sda1/boot1G存储启动信息/dev/sda2/swap6G交换分区/dev/sda3 上面的单个分区是必须的。还可以再添加/home、/efi等分区，但是没有也可以，所以我这里就只分了上面的三个。
2）分区 # 先查看硬盘的初始分区状态 lsblk # 如果/dev/sda没有子分区。就在/dev/sda下分区，/dev/sda是在新建虚拟机的时候创建的虚拟硬盘 # 分区命令 cfdisk /dev/sda # 之后会有提示，根据提示把/dev/sda依次分成43G、1G、6G大小三部分，选择write选项，再选择quit选项退出 # 注意，在退出之前，一定要先选择write选项并回车，确保前面的分区操作生效 # 格式化分区 mkfs.ext4 /dev/sda1 mkfs.vfat -F32 /dev/sda2 mkswap /dev/sda3 # 挂载分区 ## 挂载mnt分区(这里的mnt目录, 就是Arch的根目录) mount /dev/sda1 /mnt ## 创建boot文件夹,挂载boot分区 mkdir /mnt/boot mount /dev/sda2 /mnt/boot ## swap分区无需挂载, 但需要启用 swapon /dev/sda3 # 展示挂载后的四个分区 lsblk 5、修改镜像源文件 # 在修改镜像源文件之前，确保虚拟机有网络，ArchLinux的安装必须要有网络，最好使用有线网 # ping一下百度，检查网络 ping -c 5 www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/b94eb55f220e48dfef53292a5315e289/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-05T00:04:41+08:00" />
<meta property="article:modified_time" content="2023-04-05T00:04:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在VMware中安装ArchLinux</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="VMwareArchLinux_0"></a>在<code>VMware</code>中安装<code>ArchLinux</code></h3> 
<h4><a id="1VMware_3"></a>1、安装<code>VMware</code></h4> 
<h4><a id="2ArchLinux_6"></a>2、下载<code>ArchLinux</code>镜像文件</h4> 
<p> 前往<a href="https://archlinux.org/download/" rel="nofollow">https://www.archlinux.org/download/</a>下载自己需要的版本的镜像文件，建议下载最新版。</p> 
<h4><a id="3_10"></a>3、新建虚拟机</h4> 
<p> 这一步没有太多坑，下面是简要步骤：</p> 
<p>新建虚拟机 --&gt; 版本选择为其他Linux 5.x 64位 --&gt; 硬盘大小根据实际情况给定，我这里给的是50G --&gt; 其他配置根据自己的情况设置即可 --&gt; 点击“编辑虚拟机的设置” --&gt; 点击“选项” --&gt; 选择点击“高级” --&gt; 在固件类型中选择<code>UEFI</code>并确定 --&gt; 网络设置中选择NAT模式，这样只要主机能上网，虚拟机将自动配置上网 --&gt; 光驱选择下载好的镜像文件 --&gt; 保存设置后开启虚拟机</p> 
<h4><a id="4_16"></a>4、硬盘分区</h4> 
<h5><a id="1_18"></a>1）这里给出我的分区方案，仅供参考：</h5> 
<table><thead><tr><th align="center">分区名称</th><th align="center">大小</th><th align="center">作用</th><th align="center">后面分区盘标</th></tr></thead><tbody><tr><td align="center">/mnt</td><td align="center">43G</td><td align="center">安装系统和软件</td><td align="center">/dev/sda1</td></tr><tr><td align="center">/boot</td><td align="center">1G</td><td align="center">存储启动信息</td><td align="center">/dev/sda2</td></tr><tr><td align="center">/swap</td><td align="center">6G</td><td align="center">交换分区</td><td align="center">/dev/sda3</td></tr></tbody></table> 
<p><strong>上面的单个分区是必须的。还可以再添加<code>/home</code>、<code>/efi</code>等分区，但是没有也可以，所以我这里就只分了上面的三个。</strong></p> 
<h5><a id="2_28"></a>2）分区</h5> 
<pre><code class="prism language-shell"><span class="token comment"># 先查看硬盘的初始分区状态</span>
lsblk
<span class="token comment"># 如果/dev/sda没有子分区。就在/dev/sda下分区，/dev/sda是在新建虚拟机的时候创建的虚拟硬盘</span>
<span class="token comment"># 分区命令</span>
<span class="token function">cfdisk</span> /dev/sda
<span class="token comment"># 之后会有提示，根据提示把/dev/sda依次分成43G、1G、6G大小三部分，选择write选项，再选择quit选项退出</span>
<span class="token comment"># 注意，在退出之前，一定要先选择write选项并回车，确保前面的分区操作生效</span>

<span class="token comment"># 格式化分区</span>
mkfs.ext4 /dev/sda1
mkfs.vfat -F32 /dev/sda2
<span class="token function">mkswap</span> /dev/sda3

<span class="token comment"># 挂载分区</span>
<span class="token comment">## 挂载mnt分区(这里的mnt目录, 就是Arch的根目录)</span>
<span class="token function">mount</span> /dev/sda1 /mnt
<span class="token comment">## 创建boot文件夹,挂载boot分区</span>
<span class="token function">mkdir</span> /mnt/boot
<span class="token function">mount</span> /dev/sda2 /mnt/boot
<span class="token comment">## swap分区无需挂载, 但需要启用</span>
<span class="token function">swapon</span> /dev/sda3

<span class="token comment"># 展示挂载后的四个分区</span>
lsblk
</code></pre> 
<h4><a id="5_57"></a>5、修改镜像源文件</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 在修改镜像源文件之前，确保虚拟机有网络，ArchLinux的安装必须要有网络，最好使用有线网</span>
<span class="token comment"># ping一下百度，检查网络</span>
<span class="token function">ping</span> -c <span class="token number">5</span> www.baidu.com

<span class="token comment"># 修改镜像源地址文件</span>
<span class="token function">vim</span> /etc/pacman.d/mirrorlist

<span class="token comment"># 一般这里有所有的镜像源地址，把出了中国的全部删掉</span>
<span class="token comment"># 保存退出</span>

<span class="token comment"># 更新镜像源</span>
pacman -Syy
</code></pre> 
<h4><a id="6_74"></a>6、安装基本包</h4> 
<pre><code class="prism language-shell">pacstrap /mnt base base-devel linux linux-firmware dhcpcd
</code></pre> 
<h4><a id="7Fstab_80"></a>7、配置<code>Fstab</code></h4> 
<pre><code class="prism language-shell"><span class="token comment"># 生成自动挂载分区的fstab文件，执行以下命令：</span>
genfstab -L /mnt <span class="token operator">&gt;&gt;</span> /mnt/etc/fstab

<span class="token comment"># 检查是否正确，文件系统被正确挂载</span>
<span class="token function">cat</span> /mnt/etc/fstab
</code></pre> 
<h4><a id="8Chroot_90"></a>8、<code>Chroot</code></h4> 
<pre><code class="prism language-shell"><span class="token comment"># Chroot意为Change root，相当于把操纵权交给我们新安装（或已经存在）的Linux系统，执行了这步以后，我们的操作都相当于在磁盘上新装的系统中进行。如果以后我们的系统出现了问题，只要插入U盘并启动， 将我们的系统根分区挂载到了/mnt下（如果有efi分区也要挂载到/mnt/boot下），再通过这条命令就可以进入我们的系统进行修复操作。</span>
arch-chroot /mnt
</code></pre> 
<h4><a id="9_97"></a>9、设置时区</h4> 
<pre><code class="prism language-shell"><span class="token function">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</code></pre> 
<h4><a id="10Locale_103"></a>10、设置Locale，语言选项</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 在此之前，先安装vim，因为ArchLinux现在的版本没有自带vim</span>
pacman -S <span class="token function">vim</span>

<span class="token comment"># 设置</span>
<span class="token function">vim</span> /etc/locale.gen
<span class="token comment"># 找到zh_CN.UTF-8 UTF-8  en_US.UTF-8 UTF-8  这两行，去掉行首的#号，保存并退出</span>
<span class="token comment"># 更新</span>
locale-gen
<span class="token comment"># 打开</span>
<span class="token function">vim</span> /etc/locale.conf
<span class="token comment"># 添加</span>
<span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_US.UTF-8
</code></pre> 
<h4><a id="11_120"></a>11、网络配置，主机名</h4> 
<pre><code class="prism language-shell"><span class="token function">vim</span> /etc/hostname
<span class="token comment"># 在文件的第一行输入你自己设定的一个myhostname,这个myhostname就是计算机名</span>
<span class="token comment"># 添加对应的信息到 hosts</span>
<span class="token function">vim</span> /etc/hosts
<span class="token comment"># 添加如下内容（将myhostname替换成你自己设定的主机名）</span>
<span class="token number">127.0</span>.0.1    localhost
::1          localhost
<span class="token number">127.0</span>.1.1    myhostname.localdomain    myhostname
</code></pre> 
<h4><a id="12root_133"></a>12、设置<code>root</code>密码</h4> 
<pre><code class="prism language-shell"><span class="token function">passwd</span>
<span class="token comment"># 注意，#代表以Root用户执行命令，$代表以普通用户执行命令</span>
</code></pre> 
<h4><a id="13grub__140"></a>13、安装系统引导工具<code>grub</code>, 并生成引导文件</h4> 
<pre><code class="prism language-shell">pacman -S grub
grub-install --force /dev/sda
<span class="token comment"># 这个时候可能会报错，提示找不到efi文件夹，那么可能原因是没有efi，或者是没有挂载efi</span>
<span class="token comment"># 下面就创建efi文件夹，并挂载</span>
<span class="token function">mkdir</span>  -p  /mnt/boot/efi
<span class="token function">mount</span>  /dev/sda1  /mnt/boot/efi		<span class="token comment"># 这里的/dev/sda1是前面boot所在的分区</span>
pacman -S  grub  efibootmgr
grub-install --efi-directory<span class="token operator">=</span>/mnt/boot/efi --bootloader-id<span class="token operator">=</span>Arch --recheck

<span class="token comment"># 生成默认配置文件</span>
<span class="token function">grub-mkconfig</span> -o /boot/grub/grub.cfg
</code></pre> 
<h4><a id="14_156"></a>14、配置网络</h4> 
<pre><code class="prism language-shell">systemctl <span class="token builtin class-name">enable</span> dhcpcd.service
</code></pre> 
<h4><a id="15_162"></a>15、退出重启</h4> 
<pre><code class="prism language-shell"><span class="token comment"># 退出已经暂时配置好的系统</span>
<span class="token builtin class-name">exit</span>

<span class="token comment"># 解除u盘挂载, 重启虚拟机</span>
<span class="token function">umount</span> -R /mnt
<span class="token function">reboot</span>
</code></pre> 
<h4><a id="16_173"></a>16、安装之后的一些配置</h4> 
<h5><a id="1root_175"></a>1）重启后出现登录提示，使用<code>root</code>用户登录</h5> 
<h4><a id="2_177"></a>2）新建普通用户</h4> 
<pre><code class="prism language-shell"><span class="token function">useradd</span> -m -G wheel username （替换username为要新建的普通用户名）

<span class="token comment"># 为新用户设置一个密码，执行如下命令：</span>
<span class="token function">passwd</span> username （请自行替换username为你的用户名）
<span class="token comment"># 根据提示输入两次密码就可以了，注意，这是你的用户密码，推荐与之前设置的root用户的密码不同。</span>
</code></pre> 
<h4><a id="3sudo_187"></a>3）配置<code>sudo</code></h4> 
<pre><code class="prism language-shell"><span class="token comment"># 安装sudo</span>
pacman -S <span class="token function">sudo</span>

<span class="token comment">## 使用专门的visudo命令来编辑sudo的配置文件</span>
<span class="token comment"># 创建vim到vi的软链接避免找不到vi编辑器。实际上就是vim的操作，使用它是为了对编辑后的文件进行检查防止格式的错误。</span>
<span class="token function">ln</span> -s /usr/bin/vim /usr/bin/vi

visudo
<span class="token comment"># 在文件中找到 # %wheel ALL=(ALL)ALL,去掉之前的#注释符，保存并退出。</span>
<span class="token comment"># 这里的%wheel就是代表wheel组，意味着wheel组中的所有用户都可以使用sudo命令。当然为了安全使用sudo命令还是需要输入当前用户的密码的。</span>
<span class="token comment"># 配置好sudo以后，我们进行一次重启，执行：</span>
<span class="token function">reboot</span>
<span class="token comment"># 重启以后输入你刚创建的用户名与密码来登录,就进入了刚才新建的普通用户</span>
<span class="token comment"># 为了安全，不建议使用root用户登录进行各种操作，尽量使用普通用户登录操作，在需要的时候再通过sudo命令使用超级用户权限执行命令</span>
</code></pre> 
<h4><a id="4Arch_206"></a>4）为<code>Arch</code>安装图形界面</h4> 
<h6><a id="aXorg_208"></a>a、安装<code>Xorg</code></h6> 
<pre><code class="prism language-shell"><span class="token comment"># Xorg是Linux下的一个著名的开源图形服务，我们的桌面环境需要Xorg的支持。执行如下命令安装Xorg及相关组件：</span>
<span class="token function">sudo</span> pacman -S xorg
<span class="token comment"># 不知道选择哪些组件的话，就什么都不选，直接回车，安装所有组件</span>
</code></pre> 
<h6><a id="b_216"></a>b、安装桌面环境</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 安装Xfce</span>
<span class="token comment"># 直接安装软件包组（包含了很多软件包）即可：</span>
<span class="token function">sudo</span> pacman -S xfce4 xfce4-goodies 

<span class="token comment"># 安装KDE(Plasma)</span>
<span class="token comment"># 直接安装软件包组（包含了很多软件包）即可：</span>
<span class="token function">sudo</span> pacman -S plasma kde-applications
</code></pre> 
<h6><a id="c_228"></a>c、安装桌面管理器</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 安装好了桌面环境包以后，我们需要安装一个图形化的桌面管理器来帮助我们登录并且选择我们使用的桌面环境。</span>
<span class="token comment"># 安装sddm</span>
<span class="token function">sudo</span> pacman -S sddm

<span class="token comment"># 设置开机启动sddm服务</span>
<span class="token comment"># Arch下用于管理系统服务的命令systemctl，为我们提供特定的服务，比如sddm就为我们提供了启动xorg与管理桌面环境的服务。</span>
<span class="token function">sudo</span> systemctl start   服务名 （启动一项服务）
<span class="token function">sudo</span> systemctl stop    服务名 （停止一项服务）
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span>  服务名 （开机启动一项服务）
<span class="token function">sudo</span> systemctl disable 服务名 （取消开机启动一项服务） 

<span class="token comment"># 执行下面命令来设置开机启动sddm：</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> sddm
</code></pre> 
<h6><a id="d_246"></a>d、配置网络</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 启用NetworkManager：</span>
<span class="token function">sudo</span> pacman -S networkmanager
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> NetworkManager （注意大小写）

<span class="token comment"># 同时你可能需要安装工具栏工具来显示网络设置图标（某些桌面环境已经装了，但是为了保险可以再装一下）：</span>
<span class="token function">sudo</span> pacman -S network-manager-applet

<span class="token comment"># 重新启动，选择你需要的桌面环境并输入用户名与密码登陆</span>
</code></pre> 
<h6><a id="eVMwarmtools_259"></a>e、安装<code>VMwarm-tools</code></h6> 
<pre><code class="prism language-shell"><span class="token comment"># 通过虚拟机软件挂载VMwarm-tools</span>
<span class="token comment"># 挂载安装程序</span>
<span class="token function">mount</span> /dev/cdrom /mnt

<span class="token comment"># 解压到桌面</span>
<span class="token function">tar</span> xf /mnt/VMwareTools*.tar.gz -C /home/myhostname/Desktop		<span class="token comment"># myhostname替换成自己的用户名</span>
<span class="token comment"># 手动创建文件夹</span>
<span class="token builtin class-name">cd</span> /etc
<span class="token function">mkdir</span> init.d
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">mkdir</span> /etc/init.d/rc<span class="token variable">$i</span>.d<span class="token punctuation">;</span> <span class="token keyword">done</span>

<span class="token comment"># 在init.d中新建rc0.d - rc6.d   7个文件夹</span>
<span class="token comment"># 返回桌面, 执行安装脚本</span>
<span class="token comment"># 找到解压文件存放的位置</span>
<span class="token builtin class-name">cd</span> /home/myhostname/Desktop/vmware-distrid		<span class="token comment"># myhostname替换成自己的用户名</span>
<span class="token comment"># 执行安装脚本</span>
./vmware-install.pl

<span class="token comment"># 重启</span>
<span class="token function">reboot</span>
</code></pre> 
<h6><a id="fArch_Linux_284"></a>f、Arch Linux中文乱码解决</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 安装中文字体    </span>
pacman -S wqy-zenhei ttf-fireflysung 
<span class="token comment"># 在/etc/locale.conf中设置LANG=zh_CN.UTF8，通过vim来修改配置文件即可</span>

<span class="token comment"># 执行下面命令看看是否配置好了中文编码：</span>
locale-gen 
locale
locale -a
</code></pre> 
<h6><a id="h_297"></a>h、中文输入法</h6> 
<pre><code class="prism language-shell"><span class="token comment"># 安装</span>
pacman -S fcitx-im fcitx-googlepinyin

<span class="token comment"># 设置 IM 环境变量，修改~/.pam_environment</span>
<span class="token comment"># 添加</span>
GTK_IM_MODULE <span class="token assign-left variable">DEFAULT</span><span class="token operator">=</span>fcitx
QT_IM_MODULE  <span class="token assign-left variable">DEFAULT</span><span class="token operator">=</span>fcitx
<span class="token environment constant">XMODIFIERS</span>    <span class="token assign-left variable">DEFAULT</span><span class="token operator">=</span>@im<span class="token operator">=</span>fcitx
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/90e6bc0289ee01fc8f7d15ad20b8a5c2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">服务器环境配置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/decd509e472add4586d2668d9bd9cff9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot&#43;vue&#43;elementsUI 实现分角色注册登录界面</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>