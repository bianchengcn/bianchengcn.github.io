<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Server服务器修改时间,如何在 Windows Server 中配置权威时间服务器 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Server服务器修改时间,如何在 Windows Server 中配置权威时间服务器" />
<meta property="og:description" content="Windows 包含 W32Time，它是 Kerberos 身份验证协议所需的时间服务工具。Windows 时间服务的目的是确保组织中运行 Microsoft Windows 2000 或更高版本的所有计算机都使用同一个时间。
为确保合理地使用公共时间，Windows 时间服务使用层级关系来控制授权，并且不允许出现循环。默认情况下，基于 Windows 的计算机使用下面的层级：
所有客户端桌面计算机都提名身份验证域控制器作为其入站时间伙伴。
所有成员服务器都遵循与客户端桌面计算机相同的过程。
域中的所有域控制器都提名主域控制器 (PDC) 操作主机作为其入站时间伙伴。
所有 PDC 操作主机都遵循域的层级来选择其入站时间伙伴。
在此层级中，位于林根的 PDC
操作主机成为组织的权威时间服务器。我们极力建议您将权威时间服务器配置为从硬件源收集时间。当您将权威时间服务器配置为与 Internet
时间源同步时，不会有任何身份验证。我们还建议您降低服务器和独立客户端的时间校准设置。这些建议可以为您的域提供更准确的时间和更高的安全性。
配置 Windows 时间服务以使用内部硬件时钟
若要让我们为您配置 Windows 时间服务使用内部硬件时钟，请转到“
帮我修复此问题
若要自动修复此问题，请单击“修复此问题”按钮或链接。在“文件下载”对话框中，单击“运行”，然后按照“修复此问题”向导中的步骤操作。
修复此问题
Microsoft Fix it 50394
注意
此向导可能只适用于英文版本。但是，Windows 的其他语言版本也提供自动修复功能。
如果所使用的计算机中并未出现此问题，则可将修复问题解决方案保存至闪存驱动器或 CD 中，然后在出现此问题的计算机上运行该解决方案。
我自己修复此问题
重要说明：
此部分、方法或任务包含有关如何修改注册表的步骤。但是，注册表修改不当可能会出现严重问题。因此，请一定严格按照下列步骤操作。为了获得进一步保护，请
在修改注册表之前对其进行备份。这样就可以在出现问题时还原注册表。有关如何备份和还原注册表的更多信息，请单击下面的文章编号，以查看
Microsoft 知识库中相应的文章：
322756
如何在 Windows 中备份和还原注册表
要将 PDC
主机配置为不使用外部时间源，请更改 PDC 主机上的公告标志。PDC 主机是存放域的林根 PDC 主机角色的服务器。这种配置会强制 PDC
主机将它自身宣布为可靠的时间源，从而使用内置的互补金属氧化物半导体 (CMOS) 时钟。要将 PDC" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d3caac1a64680ce704cbcaa159fc30f8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-10T15:20:45+08:00" />
<meta property="article:modified_time" content="2021-08-10T15:20:45+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Server服务器修改时间,如何在 Windows Server 中配置权威时间服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>Windows 包含 W32Time，它是 Kerberos 身份验证协议所需的时间服务工具。Windows 时间服务的目的是确保组织中运行 Microsoft Windows 2000 或更高版本的所有计算机都使用同一个时间。</p> 
 <p>为确保合理地使用公共时间，Windows 时间服务使用层级关系来控制授权，并且不允许出现循环。默认情况下，基于 Windows 的计算机使用下面的层级：</p> 
 <p>所有客户端桌面计算机都提名身份验证域控制器作为其入站时间伙伴。</p> 
 <p>所有成员服务器都遵循与客户端桌面计算机相同的过程。</p> 
 <p>域中的所有域控制器都提名主域控制器 (PDC) 操作主机作为其入站时间伙伴。</p> 
 <p>所有 PDC 操作主机都遵循域的层级来选择其入站时间伙伴。</p> 
 <p>在此层级中，位于林根的 PDC</p> 
 <p>操作主机成为组织的权威时间服务器。我们极力建议您将权威时间服务器配置为从硬件源收集时间。当您将权威时间服务器配置为与 Internet</p> 
 <p>时间源同步时，不会有任何身份验证。我们还建议您降低服务器和独立客户端的时间校准设置。这些建议可以为您的域提供更准确的时间和更高的安全性。</p> 
 <p>配置 Windows 时间服务以使用内部硬件时钟</p> 
 <p>若要让我们为您配置 Windows 时间服务使用内部硬件时钟，请转到“</p> 
 <p>帮我修复此问题</p> 
 <p>若要自动修复此问题，请单击“修复此问题”按钮或链接。在“文件下载”对话框中，单击“运行”，然后按照“修复此问题”向导中的步骤操作。</p> 
 <p>修复此问题</p> 
 <p>Microsoft Fix it 50394</p> 
 <p>注意</p> 
 <p>此向导可能只适用于英文版本。但是，Windows 的其他语言版本也提供自动修复功能。</p> 
 <p>如果所使用的计算机中并未出现此问题，则可将修复问题解决方案保存至闪存驱动器或 CD 中，然后在出现此问题的计算机上运行该解决方案。</p> 
 <p>我自己修复此问题</p> 
 <p>重要说明：</p> 
 <p>此部分、方法或任务包含有关如何修改注册表的步骤。但是，注册表修改不当可能会出现严重问题。因此，请一定严格按照下列步骤操作。为了获得进一步保护，请</p> 
 <p>在修改注册表之前对其进行备份。这样就可以在出现问题时还原注册表。有关如何备份和还原注册表的更多信息，请单击下面的文章编号，以查看</p> 
 <p>Microsoft 知识库中相应的文章：</p> 
 <p>322756</p> 
 <p>如何在 Windows 中备份和还原注册表</p> 
 <p>要将 PDC</p> 
 <p>主机配置为不使用外部时间源，请更改 PDC 主机上的公告标志。PDC 主机是存放域的林根 PDC 主机角色的服务器。这种配置会强制 PDC</p> 
 <p>主机将它自身宣布为可靠的时间源，从而使用内置的互补金属氧化物半导体 (CMOS) 时钟。要将 PDC</p> 
 <p>主机配置为使用内部硬件时钟，请按照下列步骤操作：</p> 
 <p>单击“开始”，单击“运行”，键入 regedit，然后单击“确定”。</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config\AnnounceFlags</p> 
 <p>在右窗格中，右键单击“AnnounceFlags”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 A，然后单击“确定”。</p> 
 <p>退出注册表编辑器。</p> 
 <p>在命令提示符处，键入以下命令以重新启动 Windows 时间服务，然后按 Enter：</p> 
 <p>net stop w32time &amp;&amp; net start w32time</p> 
 <p>注意：决不能将 PDC 主机配置为与它自身同步。有关不得将 PDC 主机配置为与其自己同步的详细信息，请访问以下网站以查看 Request For Comment (RFC) 1305：</p> 
 <p>事件类型：信息</p> 
 <p>事件来源：W32Time</p> 
 <p>事件类别：无</p> 
 <p>事件 ID： 38</p> 
 <p>计算机：ComputerName</p> 
 <p>描述：时间提供程序 NtpClient 不能访问，或当前正在从 NTP_server_IP_Address 接收无效的时间数据。有关更多信息，请参阅位于 http://support.microsoft.com 的帮助和支持中心。</p> 
 <p>事件类型：警告</p> 
 <p>事件来源：W32Time</p> 
 <p>事件类别：无</p> 
 <p>事件 ID： 47</p> 
 <p>计算机：ComputerName</p> 
 <p>描述：时间提供程序 NtpClient: 在尝试联系它 8 次以后没有收到来自手动配置的对等端 NTP_server_IP_Address 的有效响应。此对等端将不再被作为时间源，并且 NtpClient 将尝试用此 DNS 名称发现一个新的对等端。有关更多信息，请参阅位于 http://support.microsoft.com 的帮助和支持中心。</p> 
 <p>事件类型：错误</p> 
 <p>事件来源：W32Time</p> 
 <p>事件类别：无</p> 
 <p>事件 ID： 29</p> 
 <p>计算机：ComputerName</p> 
 <p>描述：时间提供程序 NtpClient</p> 
 <p>被配置为从一个或多个时间源获得时间，但是当前这些源没有一个是可以访问的。在 15 分钟内不会进行联系时间源的尝试。NtpClient</p> 
 <p>没有一个能够提供准确时间的时间源。有关更多信息，请参阅位于 http://support.microsoft.com 的帮助和支持中心。</p> 
 <p>如果 PDC 主机在没有使用外部时间源的情况下运行，应用程序日志中会记录以下事件：</p> 
 <p>事件类型：错误</p> 
 <p>事件来源：W32Time</p> 
 <p>事件类别：无</p> 
 <p>事件 ID：12</p> 
 <p>描述：时间提供程序 NtpClient: 此机器配置为用域层级确定它的时间源，但它已经是林的根目录域的 PDC</p> 
 <p>模拟器，因此在域层级没有机器在它上面以用作时间源。建议您在根域上配置一个可靠的时间服务，或者手动配置 PDC</p> 
 <p>与外部时间源同步。否则，此机器将作为域层级中的权威时间源。如果没有为此计算机配置或使用外部时间源，您可以选择禁用 NtpClient。</p> 
 <p>这段文本是为了提醒您使用外部时间源，您可以忽略它。</p> 
 <p>帮我修复此问题</p> 
 <p>若要自动修复此问题，请单击“修复此问题”按钮或链接。在“文件下载”对话框中，单击“运行”，然后按照“修复此问题”向导中的步骤操作。</p> 
 <p>Microsoft Fix it 50395</p> 
 <p>注意</p> 
 <p>此向导可能只适用于英文版本。但是，Windows 的其他语言版本也提供自动修复功能。</p> 
 <p>如果所使用的计算机中并未出现此问题，则可将修复问题解决方案保存至闪存驱动器或 CD 中，然后在出现此问题的计算机上运行该解决方案。</p> 
 <p>我自己修复此问题</p> 
 <p>若要将内部时间服务器配置为与外部时间源同步，请按照下列步骤操作：</p> 
 <p>将服务器类型更改为 NTP。为此，请按照下列步骤操作：</p> 
 <p>单击“开始”，单击“运行”，键入 regedit，然后单击“确定”。</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters\Type</p> 
 <p>在右窗格中，右键单击“Type”，然后单击“修改”。</p> 
 <p>在“编辑值”的“数值数据”框中键入 NTP，然后单击“确定”。</p> 
 <p>将 AnnounceFlags 设置为 5。为此，请按照下列步骤操作：</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config\AnnounceFlags</p> 
 <p>在右窗格中，右键单击“AnnounceFlags”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 5，然后单击“确定”。</p> 
 <p>启用 NTPServer。为此，请按照下列步骤操作：</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer</p> 
 <p>在右窗格中，右键单击“Enabled”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 1，然后单击“确定”。</p> 
 <p>指定时间源。为此，请按照下列步骤操作：</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters</p> 
 <p>在右窗格中，右键单击“NtpServer”，然后单击“修改”。</p> 
 <p>在“编辑值”的“数值数据”框中键入 Peers，然后单击“确定”。</p> 
 <p>注意：Peers 是一个占位符，应替换为您的计算机从中获取时间戳的对等端列表(以空格分隔)。列出的每个 DNS 名称都必须是唯一的。必须在每个 DNS 名称后面附加 ,0x1。如果不在每个 DNS 名称后面附加 ,0x1，则在步骤 5 中所做的更改将不会生效。</p> 
 <p>选择轮询间隔。为此，请按照下列步骤操作：</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient\SpecialPollInterval</p> 
 <p>在右窗格中，右键单击“SpecialPollInterval”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 TimeInSeconds，然后单击“确定”。</p> 
 <p>注意：TimeInSeconds 是一个占位符，应替换为您希望各次轮询之间的间隔秒数。建议值为 900(十进制)。该值将时间服务器配置为每隔 15 分钟轮询一次。</p> 
 <p>配置时间校准设置。为此，请按照下列步骤操作：</p> 
 <p>找到并单击以下注册表子项：</p> 
 <p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config\MaxPosPhaseCorrection</p> 
 <p>在右窗格中，右键单击“MaxPosPhaseCorrection”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“基数”框中单击以选择“十进制”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 TimeInSeconds，然后单击“确定”。</p> 
 <p>注意：TimeInSeconds 是一个占位符，应替换为适当的值，如 1 小时 (3600) 或 30 分钟 (1800)。您选择的值将因轮询间隔、网络状况和外部时间源而异。</p> 
 <p>找到并单击下面的注册表子项：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config\MaxNegPhaseCorrection</p> 
 <p>在右窗格中，右键单击“MaxNegPhaseCorrection”，然后单击“修改”。</p> 
 <p>在“编辑 DWORD 值”的“基数”框中单击以选择“十进制”。</p> 
 <p>在“编辑 DWORD 值”的“数值数据”框中键入 TimeInSeconds，然后单击“确定”。</p> 
 <p>注意：TimeInSeconds 是一个占位符，应替换为适当的值，如 1 小时 (3600) 或 30 分钟 (1800)。您选择的值将因轮询间隔、网络状况和外部时间源而异。</p> 
 <p>退出注册表编辑器。</p> 
 <p>在命令提示符处，键入以下命令以重新启动 Windows 时间服务，然后按 Enter：</p> 
 <p>net stop w32time &amp;&amp; net start w32time</p> 
 <p>疑难解答</p> 
 <p>若要使 Windows 时间服务能够正常运行，网络基础结构必须正常运行。影响 Windows 时间服务的最常见问题包括以下这些：</p> 
 <p>TCP/IP 连接存在问题，如出现死网关。</p> 
 <p>名称解析服务未正确运行。</p> 
 <p>网络出现高延迟，尤其是在通过高延迟的广域网 (WAN) 链接进行同步时。</p> 
 <p>Windows 时间服务尝试与不准确的时间源同步。</p> 
 <p>建</p> 
 <p>议您使用 Netdiag.exe 实用工具解决与网络有关的问题。Netdiag.exe 是 Windows Server 2003</p> 
 <p>支持工具包的一部分。请参见工具的“帮助”，获取您可以与 Netdiag.exe 一起使用的命令行参数的完整列表。如果问题仍未得到解决，您可以打开</p> 
 <p>Windows 时间服务调试日志。由于调试日志可能包含非常详细的信息，建议您在打开 Windows 时间服务调试日志后与 Microsoft</p> 
 <p>产品支持服务联系。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4ece8076bea0441568ae3d078f7c97c9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sql怎么修改服务器角色,sql角色服务器的设置</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/adf79f1fd8318f0cf3ed49782c589323/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">libtorch cmakelist cmake安装报错 FindPackageHandleStandardArgs.cmake find_package(Torch REQUIRED)错误 解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>