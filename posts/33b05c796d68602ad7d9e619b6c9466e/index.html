<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>linux配置LVM，磁盘扩容 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="linux配置LVM，磁盘扩容" />
<meta property="og:description" content="一、说明 本文章转载自知乎：一篇看懂！Linux磁盘的管理（分区、格式化、挂载），LVM逻辑卷；如有错误，欢迎留言指正！
二、基础过程 这里我们使用一台虚拟机来演示过程
1、分配磁盘 2、磁盘相关命令 2.1 查看磁盘信息 可以看到，我们这台虚拟机现在有三块磁盘： /dev/sdb /dev/sdc /dev/sdd 未作任何操作的
fdisk -l [root@localhost ~]# fdisk -l Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk label type: dos Disk identifier: 0x0004a0b9 Device Boot Start End Blocks Id System /dev/sda1 * 2048 2099199 1048576 83 Linux /dev/sda2 2099200 41943039 19921920 8e Linux LVM Disk /dev/sdb: 10." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/33b05c796d68602ad7d9e619b6c9466e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-13T14:45:22+08:00" />
<meta property="article:modified_time" content="2022-02-13T14:45:22+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">linux配置LVM，磁盘扩容</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>一、说明</h3> 
<p>本文章转载自知乎：<a href="https://zhuanlan.zhihu.com/p/296777898" rel="nofollow">一篇看懂！Linux磁盘的管理（分区、格式化、挂载），LVM逻辑卷</a>；如有错误，欢迎留言指正！</p> 
<h3><a id="_2"></a>二、基础过程</h3> 
<p>这里我们使用一台虚拟机来演示过程</p> 
<h4><a id="1_4"></a>1、分配磁盘</h4> 
<p><img src="https://images2.imgbox.com/e5/51/ND0ysvqn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_7"></a>2、磁盘相关命令</h4> 
<h5><a id="21__8"></a>2.1 查看磁盘信息</h5> 
<p>可以看到，我们这台虚拟机现在有三块磁盘： /dev/sdb /dev/sdc /dev/sdd 未作任何操作的</p> 
<pre><code class="prism language-bash"><span class="token function">fdisk</span> -l
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># fdisk -l</span>

Disk /dev/sda: <span class="token number">21.5</span> GB, <span class="token number">21474836480</span> bytes, <span class="token number">41943040</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
Disk label type: dos
Disk identifier: 0x0004a0b9

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *        <span class="token number">2048</span>     <span class="token number">2099199</span>     <span class="token number">1048576</span>   <span class="token number">83</span>  Linux
/dev/sda2         <span class="token number">2099200</span>    <span class="token number">41943039</span>    <span class="token number">19921920</span>   8e  Linux LVM

Disk /dev/sdb: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/sdc: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/sdd: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/mapper/centos-root: <span class="token number">18.2</span> GB, <span class="token number">18249416704</span> bytes, <span class="token number">35643392</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/mapper/centos-swap: <span class="token number">2147</span> MB, <span class="token number">2147483648</span> bytes, <span class="token number">4194304</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
</code></pre> 
<h5><a id="22__57"></a>2.2 查看磁盘挂载信息</h5> 
<pre><code class="prism language-bash"><span class="token function">df</span> -h
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># df -h</span>
Filesystem               Size  Used Avail Use% Mounted on
devtmpfs                 <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev
tmpfs                    <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev/shm
tmpfs                    <span class="token number">1</span>.9G   12M  <span class="token number">1</span>.9G   <span class="token number">1</span>% /run
tmpfs                    <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /sys/fs/cgroup
/dev/mapper/centos-root   17G  <span class="token number">4</span>.3G   13G  <span class="token number">25</span>% /
/dev/sda1               1014M  157M  858M  <span class="token number">16</span>% /boot
tmpfs                    378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/0
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<h5><a id="23__75"></a>2.3 查看磁盘容量</h5> 
<pre><code class="prism language-bash"><span class="token function">du</span> -sh *
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># du -sh *</span>
<span class="token number">0</span>	bin
124M	boot
<span class="token number">0</span>	dev
39M	etc
132K	home
<span class="token number">0</span>	lib
<span class="token number">0</span>	lib64
<span class="token number">0</span>	media
<span class="token number">0</span>	mnt
107M	<span class="token function">mount</span>
<span class="token number">0</span>	nohup.out
169M	opt
du: cannot access ‘proc/1/task/1/fdinfo/13’: No such <span class="token function">file</span> or directory
du: cannot access ‘proc/2536/task/2536/fd/3’: No such <span class="token function">file</span> or directory
du: cannot access ‘proc/2536/task/2536/fdinfo/3’: No such <span class="token function">file</span> or directory
du: cannot access ‘proc/2536/fd/3’: No such <span class="token function">file</span> or directory
du: cannot access ‘proc/2536/fdinfo/3’: No such <span class="token function">file</span> or directory
<span class="token number">0</span>	proc
60K	root
12M	run
<span class="token number">0</span>	sbin
<span class="token number">0</span>	srv
<span class="token number">0</span>	sys
<span class="token number">0</span>	tmp
<span class="token number">3</span>.4G	usr
456M	var
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<h4><a id="3_111"></a>3、磁盘分区</h4> 
<p>这里我们先将前两块盘分区</p> 
<h5><a id="31__113"></a>3.1 分区</h5> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># fdisk /dev/sdb </span>
Welcome to <span class="token function">fdisk</span> <span class="token punctuation">(</span>util-linux <span class="token number">2.23</span>.2<span class="token punctuation">)</span>.

Changes will remain <span class="token keyword">in</span> memory only, <span class="token keyword">until</span> you decide to <span class="token function">write</span> them.
Be careful before using the <span class="token function">write</span> command.

Device does not contain a recognized partition table
Building a new DOS disklabel with disk identifier 0x187080d4.

Command <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: n
Partition type:
   p   primary <span class="token punctuation">(</span><span class="token number">0</span> primary, <span class="token number">0</span> extended, <span class="token number">4</span> <span class="token function">free</span><span class="token punctuation">)</span>
   e   extended
Select <span class="token punctuation">(</span>default p<span class="token punctuation">)</span>: 
Using default response p
Partition number <span class="token punctuation">(</span><span class="token number">1</span>-4, default <span class="token number">1</span><span class="token punctuation">)</span>: 
First sector <span class="token punctuation">(</span><span class="token number">2048</span>-20971519, default <span class="token number">2048</span><span class="token punctuation">)</span>: 
Using default value <span class="token number">2048</span>
Last sector, +sectors or +size<span class="token punctuation">{<!-- --></span>K,M,G<span class="token punctuation">}</span> <span class="token punctuation">(</span><span class="token number">2048</span>-20971519, default <span class="token number">20971519</span><span class="token punctuation">)</span>: 
Using default value <span class="token number">20971519</span>
Partition <span class="token number">1</span> of <span class="token builtin class-name">type</span> Linux and of size <span class="token number">10</span> GiB is <span class="token builtin class-name">set</span>

Command <span class="token punctuation">(</span>m <span class="token keyword">for</span> <span class="token builtin class-name">help</span><span class="token punctuation">)</span>: w
The partition table has been altered<span class="token operator">!</span>

Calling ioctl<span class="token punctuation">(</span><span class="token punctuation">)</span> to re-read partition table.
Syncing disks.
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre> 
<h5><a id="32__146"></a>3.2 再次查看磁盘信息</h5> 
<p>可以看到 sdb–》sdb1分区 sdc–&gt;sdc1分区</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># clear</span>
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># fdisk -l</span>

Disk /dev/sda: <span class="token number">21.5</span> GB, <span class="token number">21474836480</span> bytes, <span class="token number">41943040</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
Disk label type: dos
Disk identifier: 0x0004a0b9

   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *        <span class="token number">2048</span>     <span class="token number">2099199</span>     <span class="token number">1048576</span>   <span class="token number">83</span>  Linux
/dev/sda2         <span class="token number">2099200</span>    <span class="token number">41943039</span>    <span class="token number">19921920</span>   8e  Linux LVM

Disk /dev/sdb: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
Disk label type: dos
Disk identifier: 0x187080d4

   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1            <span class="token number">2048</span>    <span class="token number">20971519</span>    <span class="token number">10484736</span>   <span class="token number">83</span>  Linux

Disk /dev/sdc: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
Disk label type: dos
Disk identifier: 0x8d82881d

   Device Boot      Start         End      Blocks   Id  System
/dev/sdc1            <span class="token number">2048</span>    <span class="token number">20971519</span>    <span class="token number">10484736</span>   <span class="token number">83</span>  Linux

Disk /dev/sdd: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/mapper/centos-root: <span class="token number">18.2</span> GB, <span class="token number">18249416704</span> bytes, <span class="token number">35643392</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes


Disk /dev/mapper/centos-swap: <span class="token number">2147</span> MB, <span class="token number">2147483648</span> bytes, <span class="token number">4194304</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
</code></pre> 
<h4><a id="4PV_200"></a>4、创建物理卷（PV）</h4> 
<p>命令</p> 
<pre><code class="prism language-bash">pvcreate /dev/sdb1 /dev/sdc1
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># pvcreate /dev/sdb1 /dev/sdc1</span>
  Physical volume <span class="token string">"/dev/sdb1"</span> successfully created.
  Physical volume <span class="token string">"/dev/sdc1"</span> successfully created.
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<p>查看pv</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># pvs</span>
  PV         VG     Fmt  Attr PSize   PFree  
  /dev/sda2  centos lvm2 a--  <span class="token operator">&lt;</span><span class="token number">19</span>.00g      <span class="token number">0</span> 
  /dev/sdb1         lvm2 ---  <span class="token operator">&lt;</span><span class="token number">10</span>.00g <span class="token operator">&lt;</span><span class="token number">10</span>.00g
  /dev/sdc1         lvm2 ---  <span class="token operator">&lt;</span><span class="token number">10</span>.00g <span class="token operator">&lt;</span><span class="token number">10</span>.00g
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<h4><a id="5VG_220"></a>5、创建卷组（VG）</h4> 
<p>创建名为<strong>miniovg</strong>的卷组 ，并将 /dev/sdb1 /dev/sdc1 两个物理卷（pv）加入到卷组中</p> 
<pre><code class="prism language-bash">vgcreate miniovg /dev/sdb1 /dev/sdc1 
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># vgcreate miniovg /dev/sdb1 /dev/sdc1 </span>
  Volume group <span class="token string">"miniovg"</span> successfully created
</code></pre> 
<p>查看卷组，可以看到刚才创建的miniovg 卷组有19.99G的空间</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># vgs</span>
  VG      <span class="token comment">#PV #LV #SN Attr   VSize   VFree </span>
  centos    <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">0</span> wz--n- <span class="token operator">&lt;</span><span class="token number">19</span>.00g     <span class="token number">0</span> 
  miniovg   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">0</span> wz--n-  <span class="token number">19</span>.99g <span class="token number">19</span>.99g
</code></pre> 
<h4><a id="6LV_237"></a>6、基于卷组创建逻辑卷（LV）</h4> 
<p>以miniovg 卷组，创建一个名为miniolv的逻辑卷，分配19G（不能超过卷组最大）的空间</p> 
<pre><code class="prism language-bash"> lvcreate -n miniolv -L 19G miniovg
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment">#  lvcreate -n miniolv -L 19G miniovg</span>
  Logical volume <span class="token string">"miniolv"</span> created.
</code></pre> 
<p>查看逻辑卷</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># lvs</span>
  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  root    centos  -wi-ao---- <span class="token operator">&lt;</span><span class="token number">17</span>.00g                                                    
  swap    centos  -wi-ao----   <span class="token number">2</span>.00g                                                    
  miniolv miniovg -wi-a-----  <span class="token number">19</span>.00g                                                    
</code></pre> 
<h4><a id="7_256"></a>7、格式化逻辑卷</h4> 
<pre><code class="prism language-bash">mkfs.ext4 /dev/miniovg/miniolv
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># mkfs.ext4 /dev/miniovg/miniolv</span>
<span class="token function">mke2fs</span> <span class="token number">1.42</span>.9 <span class="token punctuation">(</span><span class="token number">28</span>-Dec-2013<span class="token punctuation">)</span>
Filesystem <span class="token assign-left variable">label</span><span class="token operator">=</span>
OS type: Linux
Block <span class="token assign-left variable">size</span><span class="token operator">=</span><span class="token number">4096</span> <span class="token punctuation">(</span>log<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
Fragment <span class="token assign-left variable">size</span><span class="token operator">=</span><span class="token number">4096</span> <span class="token punctuation">(</span>log<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token assign-left variable">Stride</span><span class="token operator">=</span><span class="token number">0</span> blocks, Stripe <span class="token assign-left variable">width</span><span class="token operator">=</span><span class="token number">0</span> blocks
<span class="token number">1245184</span> inodes, <span class="token number">4980736</span> blocks
<span class="token number">249036</span> blocks <span class="token punctuation">(</span><span class="token number">5.00</span>%<span class="token punctuation">)</span> reserved <span class="token keyword">for</span> the super user
First data <span class="token assign-left variable">block</span><span class="token operator">=</span><span class="token number">0</span>
Maximum filesystem <span class="token assign-left variable">blocks</span><span class="token operator">=</span><span class="token number">2153775104</span>
<span class="token number">152</span> block <span class="token function">groups</span>
<span class="token number">32768</span> blocks per group, <span class="token number">32768</span> fragments per group
<span class="token number">8192</span> inodes per group
Superblock backups stored on blocks: 
	<span class="token number">32768</span>, <span class="token number">98304</span>, <span class="token number">163840</span>, <span class="token number">229376</span>, <span class="token number">294912</span>, <span class="token number">819200</span>, <span class="token number">884736</span>, <span class="token number">1605632</span>, <span class="token number">2654208</span>, 
	<span class="token number">4096000</span>

Allocating group tables: <span class="token keyword">done</span>                            
Writing inode tables: <span class="token keyword">done</span>                            
Creating journal <span class="token punctuation">(</span><span class="token number">32768</span> blocks<span class="token punctuation">)</span>: <span class="token keyword">done</span>
Writing superblocks and filesystem accounting information: <span class="token keyword">done</span>   

</code></pre> 
<h4><a id="8_286"></a>8、挂载使用</h4> 
<p>我们新建一个挂载目录</p> 
<pre><code class="prism language-bash"><span class="token function">mkdir</span> /miniodata
</code></pre> 
<p>挂载</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> /dev/miniovg/miniolv  /miniodata/
</code></pre> 
<p>查看挂载。可以看到挂载目录 <strong>/miniodata</strong></p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># df -h</span>
Filesystem                   Size  Used Avail Use% Mounted on
devtmpfs                     <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev/shm
tmpfs                        <span class="token number">1</span>.9G   12M  <span class="token number">1</span>.9G   <span class="token number">1</span>% /run
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /sys/fs/cgroup
/dev/mapper/centos-root       17G  <span class="token number">4</span>.3G   13G  <span class="token number">25</span>% /
/dev/sda1                   1014M  157M  858M  <span class="token number">16</span>% /boot
tmpfs                        378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/0
/dev/mapper/miniovg-miniolv   19G   45M   18G   <span class="token number">1</span>% /miniodata
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<h4><a id="9_310"></a>9、设置永久挂载</h4> 
<p>查看磁盘uuid，可以看到我们的物理卷<strong>miniovg-miniolv</strong>的<strong>uuid</strong>为<strong>fd23bbbf-a673-4c80-a5f2-0f3fd083a719</strong></p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># blkid</span>
/dev/sda1: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"2d803c33-0704-43ec-b3be-aed6e9ce8c04"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"xfs"</span> 
/dev/sda2: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"S3N1ts-UI0b-rWtZ-etha-NBcb-ISTC-heTXrF"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"LVM2_member"</span> 
/dev/sdb1: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"zlGCxN-rY4W-llz8-ajZO-KuEV-tkGr-ZiZ0sg"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"LVM2_member"</span> 
/dev/sdc1: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"wBfzdb-3Mco-FIAl-smrz-l8rq-B3xT-OJnTU6"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"LVM2_member"</span> 
/dev/mapper/centos-root: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"5f9f5388-0f0c-4b8e-8252-66d60989f572"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"xfs"</span> 
/dev/mapper/centos-swap: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"cf9f709f-e5b7-48b9-844d-41798efb676e"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"swap"</span> 
/dev/mapper/miniovg-miniolv: <span class="token assign-left variable">UUID</span><span class="token operator">=</span><span class="token string">"fd23bbbf-a673-4c80-a5f2-0f3fd083a719"</span> <span class="token assign-left variable">TYPE</span><span class="token operator">=</span><span class="token string">"ext4"</span> 
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre> 
<p>编辑 /etc/fstab文件，写入挂载信息</p> 
<pre><code class="prism language-bash"><span class="token comment">#</span>
<span class="token comment"># /etc/fstab</span>
<span class="token comment"># Created by anaconda on Mon Oct 25 14:36:42 2021</span>
<span class="token comment">#</span>
<span class="token comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span>
<span class="token comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span>
<span class="token comment">#</span>
/dev/mapper/centos-root /                       xfs     defaults        <span class="token number">0</span> <span class="token number">0</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span>2d803c33-0704-43ec-b3be-aed6e9ce8c04 /boot                   xfs     defaults        <span class="token number">0</span> <span class="token number">0</span>
/dev/mapper/centos-swap swap                    swap    defaults        <span class="token number">0</span> <span class="token number">0</span>
<span class="token assign-left variable">UUID</span><span class="token operator">=</span>fd23bbbf-a673-4c80-a5f2-0f3fd083a719  /miniodata      ext4    defaults        <span class="token number">1</span> <span class="token number">1</span>
</code></pre> 
<p>检查是否设置成功，我们可以先卸载刚才挂载的目录</p> 
<pre><code class="prism language-bash"><span class="token function">umount</span> /miniodata
</code></pre> 
<p>在使用命令，重新读取挂载信息</p> 
<pre><code class="prism language-bash"><span class="token function">mount</span> -a
</code></pre> 
<p>这样重启后就可以自动挂载了</p> 
<h4><a id="10_349"></a>10、磁盘扩容</h4> 
<p>现在我还剩下 /dev/sdd 这块磁盘没有使用，也相当于我们新分配的一块盘，我们把他加入到 /miniolv逻辑卷中。</p> 
<h5><a id="101__351"></a>10.1 扩容卷组</h5> 
<p>先看看我们现在的磁盘大小，可以看到我们现在挂载了一块19G的miniodata盘</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># df -h</span>
Filesystem                   Size  Used Avail Use% Mounted on
devtmpfs                     <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev/shm
tmpfs                        <span class="token number">1</span>.9G   12M  <span class="token number">1</span>.9G   <span class="token number">1</span>% /run
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /sys/fs/cgroup
/dev/mapper/centos-root       17G  <span class="token number">4</span>.3G   13G  <span class="token number">25</span>% /
/dev/sda1                   1014M  157M  858M  <span class="token number">16</span>% /boot
tmpfs                        378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/0
/dev/mapper/miniovg-miniolv   19G   45M   18G   <span class="token number">1</span>% /miniodata
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre> 
<p>当前lvm信息</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># lvs</span>
  LV      VG      Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  root    centos  -wi-ao---- <span class="token operator">&lt;</span><span class="token number">17</span>.00g                                                    
  swap    centos  -wi-ao----   <span class="token number">2</span>.00g                                                    
  miniolv miniovg -wi-ao----  <span class="token number">19</span>.00g                                                    
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># vgs</span>
  VG      <span class="token comment">#PV #LV #SN Attr   VSize   VFree   </span>
  centos    <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">0</span> wz--n- <span class="token operator">&lt;</span><span class="token number">19</span>.00g       <span class="token number">0</span> 
  miniovg   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span> wz--n-  <span class="token number">19</span>.99g <span class="token number">1016</span>.00m
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># pvs</span>
  PV         VG      Fmt  Attr PSize   PFree   
  /dev/sda2  centos  lvm2 a--  <span class="token operator">&lt;</span><span class="token number">19</span>.00g       <span class="token number">0</span> 
  /dev/sdb1  miniovg lvm2 a--  <span class="token operator">&lt;</span><span class="token number">10</span>.00g       <span class="token number">0</span> 
  /dev/sdc1  miniovg lvm2 a--  <span class="token operator">&lt;</span><span class="token number">10</span>.00g <span class="token number">1016</span>.00m
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre> 
<p>我们先把剩下的sdd盘分区 /sdd1</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># fdisk -l /dev/sdd</span>

Disk /dev/sdd: <span class="token number">10.7</span> GB, <span class="token number">10737418240</span> bytes, <span class="token number">20971520</span> sectors
Units <span class="token operator">=</span> sectors of <span class="token number">1</span> * <span class="token number">512</span> <span class="token operator">=</span> <span class="token number">512</span> bytes
Sector size <span class="token punctuation">(</span>logical/physical<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
I/O size <span class="token punctuation">(</span>minimum/optimal<span class="token punctuation">)</span>: <span class="token number">512</span> bytes / <span class="token number">512</span> bytes
Disk label type: dos
Disk identifier: 0xda833282

   Device Boot      Start         End      Blocks   Id  System
/dev/sdd1            <span class="token number">2048</span>    <span class="token number">20971519</span>    <span class="token number">10484736</span>   <span class="token number">83</span>  Linux
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre> 
<p>将 /dev/sdd1 分区加入到卷组（miniovg）中，可看到vg中多出来了10G的剩余空间</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># vgextend  miniovg  /dev/sdd1</span>
  Physical volume <span class="token string">"/dev/sdd1"</span> successfully created.
  Volume group <span class="token string">"miniovg"</span> successfully extended
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># vgs</span>
  VG      <span class="token comment">#PV #LV #SN Attr   VSize   VFree  </span>
  centos    <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">0</span> wz--n- <span class="token operator">&lt;</span><span class="token number">19</span>.00g      <span class="token number">0</span> 
  miniovg   <span class="token number">3</span>   <span class="token number">1</span>   <span class="token number">0</span> wz--n- <span class="token operator">&lt;</span><span class="token number">29</span>.99g <span class="token operator">&lt;</span><span class="token number">10</span>.99g

</code></pre> 
<h5><a id="102_lv_416"></a>10.2 lv扩容</h5> 
<p>第一种方法：直接增大5G，写“+5G”<br> 1.lv扩容5G</p> 
<pre><code class="prism language-bash">lvresize -L +5G /dev/mapper/miniovg-miniolv
</code></pre> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># lvresize -L +10G /dev/mapper/miniovg-miniolv</span>
  Size of logical volume miniovg/miniolv changed from <span class="token number">19.00</span> GiB <span class="token punctuation">(</span><span class="token number">4864</span> extents<span class="token punctuation">)</span> to <span class="token number">29.00</span> GiB <span class="token punctuation">(</span><span class="token number">7424</span> extents<span class="token punctuation">)</span>.
  Logical volume miniovg/miniolv successfully resized.
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> 
<p>2.文件系统大小变更</p> 
<pre><code class="prism language-bash">resize2fs /dev/mapper/miniovg-miniolv
</code></pre> 
<p>[root@localhost /]# resize2fs /dev/mapper/miniovg-miniolv<br> resize2fs 1.42.9 (28-Dec-2013)<br> Filesystem at /dev/mapper/miniovg-miniolv is mounted on /miniodata; on-line resizing required<br> old_desc_blocks = 3, new_desc_blocks = 4<br> The filesystem on /dev/mapper/miniovg-miniolv is now 7602176 blocks long.</p> 
<p>[root@localhost /]#</p> 
<p>第二种方法：原来是10G，增大5G就是“15G”<br> 1.lv扩容到15G</p> 
<pre><code class="prism language-bash">lvresize -L 15G /dev/mapper/miniovg-miniolv
</code></pre> 
<p>2.文件系统大小变更</p> 
<pre><code class="prism language-bash">resize2fs  /dev/mapper/miniovg-miniolv
</code></pre> 
<p>至此，我们在此查看挂载信息，可以看到已经从原来的19G扩容到29G了</p> 
<pre><code class="prism language-bash"><span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># df -h</span>
Filesystem                   Size  Used Avail Use% Mounted on
devtmpfs                     <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /dev/shm
tmpfs                        <span class="token number">1</span>.9G   12M  <span class="token number">1</span>.9G   <span class="token number">1</span>% /run
tmpfs                        <span class="token number">1</span>.9G     <span class="token number">0</span>  <span class="token number">1</span>.9G   <span class="token number">0</span>% /sys/fs/cgroup
/dev/mapper/centos-root       17G  <span class="token number">4</span>.3G   13G  <span class="token number">25</span>% /
/dev/sda1                   1014M  157M  858M  <span class="token number">16</span>% /boot
tmpfs                        378M     <span class="token number">0</span>  378M   <span class="token number">0</span>% /run/user/0
/dev/mapper/miniovg-miniolv   29G   44M   28G   <span class="token number">1</span>% /miniodata
<span class="token punctuation">[</span>root@localhost /<span class="token punctuation">]</span><span class="token comment"># </span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ba200fa32df2fee0686883b3ace0d404/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Godot】添加菜单按钮</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba336ad3787bf5ea3900fc65c066993d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">LeetCode——977. 有序数组的平方</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>