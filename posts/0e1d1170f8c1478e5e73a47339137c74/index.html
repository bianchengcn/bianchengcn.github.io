<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Mybatis坑之collection单属性list - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Mybatis坑之collection单属性list" />
<meta property="og:description" content="今天写了一个一对多的查询用到了collection，首先是这样的
&lt;resultMap id=&#34;userParamMap&#34; type=&#34;com.veoer.mind.entity.UserParam&#34;&gt; &lt;id column=&#34;u_id&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;id&#34; /&gt; &lt;result column=&#34;company_id&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;companyId&#34; /&gt; &lt;result column=&#34;name&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;name&#34; /&gt; &lt;result column=&#34;sex&#34; jdbcType=&#34;INTEGER&#34; property=&#34;sex&#34; /&gt; &lt;result column=&#34;mobile&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;mobile&#34; /&gt; &lt;result column=&#34;email&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;email&#34; /&gt; &lt;result column=&#34;id_card&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;idCard&#34; /&gt; &lt;result column=&#34;work_code&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;workCode&#34; /&gt; &lt;result column=&#34;position&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;position&#34; /&gt; &lt;result column=&#34;if_delete&#34; jdbcType=&#34;INTEGER&#34; property=&#34;ifDelete&#34; /&gt; &lt;result column=&#34;update_time&#34; jdbcType=&#34;TIMESTAMP&#34; property=&#34;updateTime&#34; /&gt; &lt;result column=&#34;supplier_user_id&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;supplierUserId&#34; /&gt; &lt;result column=&#34;supplier_id&#34; jdbcType=&#34;VARCHAR&#34; property=&#34;supplierId&#34; /&gt; &lt;collection property=&#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0e1d1170f8c1478e5e73a47339137c74/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-04-30T10:18:20+08:00" />
<meta property="article:modified_time" content="2020-04-30T10:18:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Mybatis坑之collection单属性list</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>今天写了一个一对多的查询用到了collection，首先是这样的</p> 
<pre><code>  &lt;resultMap id="userParamMap" type="com.veoer.mind.entity.UserParam"&gt;
    &lt;id column="u_id" jdbcType="VARCHAR" property="id" /&gt;
    &lt;result column="company_id" jdbcType="VARCHAR" property="companyId" /&gt;
    &lt;result column="name" jdbcType="VARCHAR" property="name" /&gt;
    &lt;result column="sex" jdbcType="INTEGER" property="sex" /&gt;
    &lt;result column="mobile" jdbcType="VARCHAR" property="mobile" /&gt;
    &lt;result column="email" jdbcType="VARCHAR" property="email" /&gt;
    &lt;result column="id_card" jdbcType="VARCHAR" property="idCard" /&gt;
    &lt;result column="work_code" jdbcType="VARCHAR" property="workCode" /&gt;
    &lt;result column="position" jdbcType="VARCHAR" property="position" /&gt;
    &lt;result column="if_delete" jdbcType="INTEGER" property="ifDelete" /&gt;
    &lt;result column="update_time" jdbcType="TIMESTAMP" property="updateTime" /&gt;
    &lt;result column="supplier_user_id" jdbcType="VARCHAR" property="supplierUserId" /&gt;
    &lt;result column="supplier_id" jdbcType="VARCHAR" property="supplierId" /&gt;
    &lt;collection property="supplierOrganizationIdList" column="orgrm_" javaType="java.util.ArrayList" ofType="java.lang.String"&gt;&lt;/collection&gt;
  &lt;/resultMap&gt;</code></pre> 
<p>这样的</p> 
<pre><code> &lt;select id="findByPageForSupplier" resultMap="userParamMap"&gt;
    select
    u.id as u_id, u.company_id as companyId, u.name,u.sex, u.mobile, u.email, u.id_card as id_card, u.work_code as work_code, u.position, u.if_delete as if_delete, u.update_time as update_time,
    ur.supplier_user_id as supplier_user_id,ur.supplier_id as supplier_id,orgr.supplier_organization_id as orgrm_supplier_organization_id
    from user u
    left join user_relation ur on u.id = ur.user_id
    left join user_organization_relation uor on u.id = uor.user_id
    left join organization_relation orgr on uor.organization_id = orgr.organization_id
      where  orgr.supplier_id = #{supplierId}
    and u.company_id = #{companyId} and orgr.company_id=#{companyId}  and uor.company_id = #{companyId}
      &lt;if test="name != '' and name != null"&gt;
        and u.name like '%#{name}%'
      &lt;/if&gt;
      &lt;if test="time != null"&gt;
        and u.update_time &gt; #{time}
      &lt;/if&gt;
    &lt;/select&gt;</code></pre> 
<p>查询结果是这样的</p> 
<p><img alt="" height="294" src="https://images2.imgbox.com/ed/bc/xJQJ6QOh_o.png" width="496"></p> 
<p>仔细看会发现，我的id和supplierOrganzationIdList里面的值一样，WTFK，我各种修改我的collection，各种查资料，感觉我的collection写的没毛病啊，但是结果始终是这样，最后机缘巧合将我的sql改了一下，把我的list查询条件调到了第一位，也就是这样</p> 
<pre><code>    &lt;select id="findByPageForSupplier" resultMap="userParamMap"&gt;
    select
    orgr.supplier_organization_id as orgrm_supplier_organization_id,
    u.id as u_id, u.company_id as companyId, u.name,u.sex, u.mobile, u.email, u.id_card as id_card, u.work_code as work_code, u.position, u.if_delete as if_delete, u.update_time as update_time,
    ur.supplier_user_id as supplier_user_id,ur.supplier_id as supplier_id
    from user u
    left join user_relation ur on u.id = ur.user_id
    left join user_organization_relation uor on u.id = uor.user_id
    left join organization_relation orgr on uor.organization_id = orgr.organization_id
      where  orgr.supplier_id = #{supplierId}
    and u.company_id = #{companyId} and orgr.company_id=#{companyId}  and uor.company_id = #{companyId}
      &lt;if test="name != '' and name != null"&gt;
        and u.name like '%#{name}%'
      &lt;/if&gt;
      &lt;if test="time != null"&gt;
        and u.update_time &gt; #{time}
      &lt;/if&gt;
    &lt;/select&gt;</code></pre> 
<p>惊喜的发现查询的结果对了，坑爹啊！</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c1ed656743169f107f6c30565790fe10/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">智能信息处理专业是干嘛的？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/333645f31b077d5881f419a095ff24af/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">这可能是用 Markdown 写微信公众号的终极解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>