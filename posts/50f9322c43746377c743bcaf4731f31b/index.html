<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>YOLOv5下载编译运行-口罩检测 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="YOLOv5下载编译运行-口罩检测" />
<meta property="og:description" content="目录
一、YOLOv5程序下载
1. yolov5程序下载
2.口罩数据集下载 二、编译运行代码 1.使用pycharm打开上面的文件夹 2.pycharm训练参数配置 3.编译运行
三、使用训练好的模型进行预测
1. 预测环境配置 四、训练和预测过程遇到的错误及解决办法
1. 训练遇到的报错 2. 预测编译遇到的错误及解决办法 3. 一些其它错误的解决办法 4. YOLOv5训练不显示GFLOPs问题
一、YOLOv5程序下载 1. yolov5程序下载 GitHub - ultralytics/yolov5: YOLOv5 🚀 in PyTorch &gt; ONNX &gt; CoreML &gt; TFLite
依赖包安装 在命令行下进入yolov5目录，执行下面的命令，会把依赖包安装
pip install -r requirements.txt # install 而我的环境有的依赖包已经安装过，不执行，编译遇到缺少什么，就安装什么 2.口罩数据集下载 链接：https://pan.baidu.com/s/1RP3wXuQnGsO87JqgK_bK3g 提取码：j236 --来自百度网盘超级会员V1的分享 解压后文件夹如下，标出来的就是数据集，解压下来的yolov5代码是旧版的，不用，只要数据集。 将上面两步得到的代码和数据集放到同一个目录 二、编译运行代码 1.使用pycharm打开上面的文件夹 2.pycharm训练参数配置 上图第2步的参数设置如下
--data D:/deep_learn/yolov5_20230418/MaskDataSet/data.yaml --weights &#39;&#39; --cfg D:/deep_learn/yolov5_20230418/yolov5-master/models/yolov5s.yaml --data 数据集指定， --weights 预训练权重，用单引号‘ ’代码不使用迁移学习，从0开始训练 -- cfg 模型配置文件，其它参数不设置就使用默认的。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/50f9322c43746377c743bcaf4731f31b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-09T21:21:13+08:00" />
<meta property="article:modified_time" content="2023-05-09T21:21:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">YOLOv5下载编译运行-口罩检测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E4%B8%80%E3%80%81YOLOv5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD-toc" style="margin-left:40px;"><a href="#%E4%B8%80%E3%80%81YOLOv5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD" rel="nofollow">一、YOLOv5程序下载</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20yolov5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20yolov5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD" rel="nofollow">        1. yolov5程序下载</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%E5%8F%A3%E7%BD%A9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8B%E8%BD%BD%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%E5%8F%A3%E7%BD%A9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8B%E8%BD%BD%C2%A0" rel="nofollow">        2.口罩数据集下载 </a></p> 
<p id="%E4%BA%8C%E3%80%81%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%C2%A0-toc" style="margin-left:40px;"><a href="#%E4%BA%8C%E3%80%81%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%C2%A0" rel="nofollow">二、编译运行代码 </a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%E4%BD%BF%E7%94%A8pycharm%E6%89%93%E5%BC%80%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%E4%BD%BF%E7%94%A8pycharm%E6%89%93%E5%BC%80%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%C2%A0" rel="nofollow">        1.使用pycharm打开上面的文件夹 </a></p> 
<p id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A02.pycharm%E8%AE%AD%E7%BB%83%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A02.pycharm%E8%AE%AD%E7%BB%83%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%C2%A0" rel="nofollow">        2.pycharm训练参数配置 </a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C" rel="nofollow">        3.编译运行</a></p> 
<p id="%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8%E8%AE%AD%E7%BB%83%E5%A5%BD%E7%9A%84%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B-toc" style="margin-left:40px;"><a href="#%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8%E8%AE%AD%E7%BB%83%E5%A5%BD%E7%9A%84%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B" rel="nofollow">三、使用训练好的模型进行预测</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E9%A2%84%E6%B5%8B%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E9%A2%84%E6%B5%8B%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%C2%A0" rel="nofollow">        1. 预测环境配置 </a></p> 
<p id="%E5%9B%9B%E3%80%81%E8%AE%AD%E7%BB%83%E5%92%8C%E9%A2%84%E6%B5%8B%E8%BF%87%E7%A8%8B%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E5%9B%9B%E3%80%81%E8%AE%AD%E7%BB%83%E5%92%8C%E9%A2%84%E6%B5%8B%E8%BF%87%E7%A8%8B%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95" rel="nofollow">四、训练和预测过程遇到的错误及解决办法</a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E8%AE%AD%E7%BB%83%E9%81%87%E5%88%B0%E7%9A%84%E6%8A%A5%E9%94%99%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E8%AE%AD%E7%BB%83%E9%81%87%E5%88%B0%E7%9A%84%E6%8A%A5%E9%94%99%C2%A0" rel="nofollow">        1. 训练遇到的报错 </a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%20%E9%A2%84%E6%B5%8B%E7%BC%96%E8%AF%91%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%20%E9%A2%84%E6%B5%8B%E7%BC%96%E8%AF%91%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0" rel="nofollow">        2. 预测编译遇到的错误及解决办法 </a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%20%E4%B8%80%E4%BA%9B%E5%85%B6%E5%AE%83%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%20%E4%B8%80%E4%BA%9B%E5%85%B6%E5%AE%83%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0" rel="nofollow">        3. 一些其它错误的解决办法 </a></p> 
<p id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%204.%20YOLOv5%E8%AE%AD%E7%BB%83%E4%B8%8D%E6%98%BE%E7%A4%BAGFLOPs%E9%97%AE%E9%A2%98-toc" style="margin-left:80px;"><a href="#%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%204.%20YOLOv5%E8%AE%AD%E7%BB%83%E4%B8%8D%E6%98%BE%E7%A4%BAGFLOPs%E9%97%AE%E9%A2%98" rel="nofollow">        4. YOLOv5训练不显示GFLOPs问题</a></p> 
<hr id="hr-toc"> 
<p></p> 
<hr> 
<p></p> 
<h3 id="%E4%B8%80%E3%80%81YOLOv5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD">一、YOLOv5程序下载</h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20yolov5%E7%A8%8B%E5%BA%8F%E4%B8%8B%E8%BD%BD">        1. yolov5程序下载</h4> 
<p><a href="https://github.com/ultralytics/yolov5" title="GitHub - ultralytics/yolov5: YOLOv5 🚀 in PyTorch &gt; ONNX &gt; CoreML &gt; TFLite">GitHub - ultralytics/yolov5: YOLOv5 🚀 in PyTorch &gt; ONNX &gt; CoreML &gt; TFLite</a></p> 
<p><img alt="" height="541" src="https://images2.imgbox.com/bf/dc/BGCdZpJk_o.png" width="1200"></p> 
<p>      依赖包安装 </p> 
<p>     在命令行下进入yolov5目录，执行下面的命令，会把依赖包安装</p> 
<pre><code>pip install -r requirements.txt  # install</code></pre> 
<p>而我的环境有的依赖包已经安装过，不执行，编译遇到缺少什么，就安装什么 </p> 
<p></p> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%E5%8F%A3%E7%BD%A9%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8B%E8%BD%BD%C2%A0">        2.口罩数据集下载 </h4> 
<p> 链接：https://pan.baidu.com/s/1RP3wXuQnGsO87JqgK_bK3g <br> 提取码：j236 <br> --来自百度网盘超级会员V1的分享 </p> 
<p>解压后文件夹如下，标出来的就是数据集，解压下来的yolov5代码是旧版的，不用，只要数据集。 </p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/7e/8a/BwQi4mgA_o.png" width="417"></p> 
<p>将上面两步得到的代码和数据集放到同一个目录 </p> 
<p><img alt="" height="297" src="https://images2.imgbox.com/b8/c4/CJIoXxXA_o.png" width="425"></p> 
<h3 id="%E4%BA%8C%E3%80%81%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%C2%A0">二、编译运行代码 </h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%E4%BD%BF%E7%94%A8pycharm%E6%89%93%E5%BC%80%E4%B8%8A%E9%9D%A2%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9%C2%A0">        1.使用pycharm打开上面的文件夹 </h4> 
<p><img alt="" height="283" src="https://images2.imgbox.com/a7/d8/8LGgKjDz_o.png" width="346"></p> 
<h4 id="%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A02.pycharm%E8%AE%AD%E7%BB%83%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%C2%A0">        2.pycharm训练参数配置 </h4> 
<p> <img alt="" height="742" src="https://images2.imgbox.com/f8/56/wMzoQbLm_o.png" width="1048"></p> 
<p>上图第2步的参数设置如下</p> 
<pre><code>--data
D:/deep_learn/yolov5_20230418/MaskDataSet/data.yaml
--weights
''
--cfg
D:/deep_learn/yolov5_20230418/yolov5-master/models/yolov5s.yaml</code></pre> 
<p> --data   数据集指定， --weights 预训练权重，用单引号‘ ’代码不使用迁移学习，从0开始训练 </p> 
<p>-- cfg    模型配置文件，其它参数不设置就使用默认的。</p> 
<p>  下图是官方的训练参数配置</p> 
<p><img alt="" height="274" src="https://images2.imgbox.com/a5/a6/DNVqZDeR_o.png" width="921"></p> 
<p> 注意--workers 的default值需要修改为0，否则编译报错。</p> 
<p> <img alt="" height="215" src="https://images2.imgbox.com/f8/98/vMwfmus7_o.png" width="759"></p> 
<p>关于编译遇到的报错，在最后有说明 </p> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C">        3.编译运行</h4> 
<p>         编译结束后log信息如下，训练好的模型保存在Results saved to runs\train\exp2</p> 
<pre><code>   100 epochs completed in 0.167 hours.
Optimizer stripped from runs\train\exp2\weights\last.pt, 14.5MB
Optimizer stripped from runs\train\exp2\weights\best.pt, 14.5MB

Validating runs\train\exp2\weights\best.pt...
Fusing layers... 
YOLOv5s summary: 157 layers, 7015519 parameters, 0 gradients
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 1/1 [00:00&lt;00:00,  1.79it/s]
                   all         29        162      0.878      0.349      0.439      0.211
                  mask         29        142      0.755      0.697       0.72      0.342
               no-mask         29         20          1          0      0.159     0.0807
Results saved to runs\train\exp2</code></pre> 
<h3 id="%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8%E8%AE%AD%E7%BB%83%E5%A5%BD%E7%9A%84%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E9%A2%84%E6%B5%8B">三、使用训练好的模型进行预测</h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E9%A2%84%E6%B5%8B%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%C2%A0">        1. 预测环境配置 </h4> 
<p> <img alt="" height="398" src="https://images2.imgbox.com/da/bd/CdhgYGXL_o.png" width="557"></p> 
<p>参数详细设置</p> 
<pre><code>--weights
D:/deep_learn/yolov5_20230418/yolov5-master/runs/train/exp2/weights/best.pt
--source
D:/deep_learn/yolov5_20230418/yolov5-master/data/images</code></pre> 
<p> 预测时指定使用训练好的模型路径和待预测的图像数据</p> 
<p>   待预测的图像如下 </p> 
<p><img alt="" height="563" src="https://images2.imgbox.com/8e/49/XEvGrmgz_o.png" width="959"></p> 
<p>预测结果如下</p> 
<p><img alt="" height="562" src="https://images2.imgbox.com/13/da/uso87lFb_o.png" width="916"></p> 
<h3 id="%E5%9B%9B%E3%80%81%E8%AE%AD%E7%BB%83%E5%92%8C%E9%A2%84%E6%B5%8B%E8%BF%87%E7%A8%8B%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95">四、训练和预测过程遇到的错误及解决办法</h3> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%201.%20%E8%AE%AD%E7%BB%83%E9%81%87%E5%88%B0%E7%9A%84%E6%8A%A5%E9%94%99%C2%A0">        1. 训练遇到的报错 </h4> 
<pre><code>使用train.py报错使用
1.
requirements: YOLOv5 requirement "gitpython" not found, attempting AutoUpdate...
requirements:  AutoUpdate skipped (offline)
Traceback (most recent call last):
  File "D:\deep_learn\yolov5_20230418\yolov5-master\train.py", line 67, in &lt;module&gt;
    GIT_INFO = check_git_info()
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\contextlib.py", line 75, in inner
    return func(*args, **kwds)
  File "D:\deep_learn\yolov5_20230418\yolov5-master\utils\general.py", line 359, in check_git_info
    import git
ModuleNotFoundError: No module named 'git'
解决办法：pip install gitpython

2. 
  Traceback (most recent call last):
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\git\__init__.py", line 89, in &lt;module&gt;
    refresh()
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\git\__init__.py", line 76, in refresh
    if not Git.refresh(path=path):
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\git\cmd.py", line 392, in refresh
    raise ImportError(err)
ImportError: Bad git executable.
解决办法：按照报错所在文件，在执行git代码前面添加下方代码
  os.environ['GIT_PYTHON_REFRESH'] = 'quiet'
例子：
如：os.environ['GIT_PYTHON_REFRESH'] = 'quiet'  #添加代码
    if not Git.refresh(path=path):
        return
		
3.
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\torch\__init__.py", line 129, in &lt;module&gt;
    raise err
OSError: [WinError 1455] 页面文件太小，无法完成操作。 Error loading "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\torch\lib\cufft64_10.dll" or one of its dependencies.
解决办法
   修改train.py中配置项workers的默认值，从初始值8修改为0（也可以试试1或2等较小的数）。</code></pre> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%202.%20%E9%A2%84%E6%B5%8B%E7%BC%96%E8%AF%91%E9%81%87%E5%88%B0%E7%9A%84%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0">        2. 预测编译遇到的错误及解决办法 </h4> 
<p></p> 
<pre><code>使用detect.py报错
1.
  File "D:\deep_learn\yolov5_20230418\yolov5-master\utils\dataloaders.py", line 22, in &lt;module&gt;
    import psutil
ModuleNotFoundError: No module named 'psutil'
解决办法：
pip install psutil

2.
  File "D:\deep_learn\yolov5_20230418\yolov5-master\utils\plots.py", line 18, in &lt;module&gt;
    import seaborn as sn
ModuleNotFoundError: No module named 'seaborn'
解决办法：
pip install seaborn</code></pre> 
<p> 这就是缺少什么就安装什么</p> 
<p></p> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%203.%20%E4%B8%80%E4%BA%9B%E5%85%B6%E5%AE%83%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%C2%A0">        3. 一些其它错误的解决办法 </h4> 
<pre><code>编译报错
File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\torch\nn\modules\activation.py", line 472, in forward
    return F.hardswish(input, self.inplace)
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\torch\nn\modules\module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Hardswish' object has no attribute 'inplace'

修改代码
    def forward(self, input: Tensor) -&gt; Tensor:
#        return F.hardswish(input, self.inplace)   #原来的代码
         return F.hardswish(input)                 #修改后的代码


训练报错

File "D:\BaiduNetdiskDownload\YOLO5\yolov5-master\models\yolo.py", line 150, in _initialize_biases
    b[:, 4] += math.log(8 / (640 / s) ** 2)  # obj (8 objects per 640 image)
RuntimeError: a view of a leaf Variable that requires grad is being used in an in-place operation.

修改
  for mi, s in zip(m.m, m.stride):  # from
            b = mi.bias.view(m.na, -1)  # conv.bias(255) to (3,85)
            with torch.no_grad():  #报错，增加这个代码
                 b[:, 4] += math.log(8 / (640 / s) ** 2)  # obj (8 objects per 640 image) #缩进
                 b[:, 5:] += math.log(0.6 / (m.nc - 0.99)) if cf is None else torch.log(cf / cf.sum()) #缩进  # cls
            mi.bias = torch.nn.Parameter(b.view(-1), requires_grad=True)

报错
 File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\numpy\__init__.py", line 305, in __getattr__
    raise AttributeError(__former_attrs__[attr])
AttributeError: module 'numpy' has no attribute 'int'.

原因：numpy.int在NumPy 1.20中已弃用，在NumPy 1.24中已删除。

解决方式：将numpy.int更改为numpy.int_，int。

方法：点击出现错误代码链接会自动跳转到相应numpy.int的位置

File "D:\BaiduNetdiskDownload\YOLO5\yolov5-master\utils\datasets.py", line 406, in __init__
    self.batch_shapes = np.ceil(np.array(shapes) * img_size / stride + pad).astype(np.int) * stride
  File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\numpy\__init__.py", line 305, in __getattr__
    raise AttributeError(__former_attrs__[attr])
AttributeError: module 'numpy' has no attribute 'int'.
修改
#            self.batch_shapes = np.ceil(np.array(shapes) * img_size / stride + pad).astype(np.int) * stride
             self.batch_shapes = np.ceil(np.array(shapes) * img_size / stride + pad).astype(np.int_) * stride
 所有的np.int 改为  np.int_
 
报错 
TypeError: No loop matching the specified signature and casting was found for ufunc greater
    报错那一行，把dtype=np.float64,去掉。

报错
File "D:\SoftInstall\Anaconda\envs\openmmlab\lib\site-packages\torch\_tensor.py", line 757, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.

意思是:如果想把CUDA tensor格式的数据改成numpy时
，需要先将其转换成cpu float-tensor随后再转到numpy格式。 numpy不能读取CUDA tensor 需要将它转化为 CPU tensor

   #            return self.numpy()   #原来的代码
            return self.cpu().numpy()   #修改后代码</code></pre> 
<h4 id="%C2%A0%20%C2%A0%20%C2%A0%20%C2%A0%204.%20YOLOv5%E8%AE%AD%E7%BB%83%E4%B8%8D%E6%98%BE%E7%A4%BAGFLOPs%E9%97%AE%E9%A2%98">        4. YOLOv5训练不显示GFLOPs问题</h4> 
<p><img alt="" height="44" src="https://images2.imgbox.com/e4/da/rxqZYdDO_o.png" width="605"></p> 
<p> 安装pip install thop ，训练时就会看到GFLOPs</p> 
<p><br><img alt="" height="75" src="https://images2.imgbox.com/e2/7e/0ZWPMYEG_o.png" width="1067"></p> 
<p> </p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/afd8dceb05b77bb58236bd39c5ad8be3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VSCode使用Remote SSH连接远程服务器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c2eeb5b4c5182cd902eb62ee35a4c031/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python学习笔记-20(面向对象案例)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>