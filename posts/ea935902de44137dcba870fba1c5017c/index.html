<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>selenium知识点大全 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="selenium知识点大全" />
<meta property="og:description" content="selenium知识点大全 在使用selenium之前必须先配置浏览器对应版本的webdriver。
1. 初始化浏览器对象 from selenium.webdriver import Chrome # 创建浏览器对象，并且打开一个空的页面 browser = Chrome() # 关闭浏览器 browser.close() 2. 访问指定网页 from selenium import webdriver # 初始化浏览器为chrome浏览器 browser = webdriver.Chrome() # 访问百度首页 browser.get(r&#39;https://www.baidu.com/&#39;) # 浏览器截图 browser.get_screenshot_as_file(&#39;截图.png&#39;) # 关闭浏览器 browser.close() 3. 设置浏览器大小 from selenium import webdriver import time browser = webdriver.Chrome() # 设置浏览器大小：全屏 browser.maximize_window() browser.get(r&#39;https://www.baidu.com&#39;) time.sleep(2) # 设置分辨率 500*500 browser.set_window_size(500, 500) time.sleep(2) # 设置分辨率 1000*800 browser.set_window_size(1000, 800) time.sleep(2) # 关闭浏览器 browser.close() 4. 刷新页面 from selenium import webdriver import time browser = webdriver." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ea935902de44137dcba870fba1c5017c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-24T11:35:07+08:00" />
<meta property="article:modified_time" content="2023-07-24T11:35:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">selenium知识点大全</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="selenium_0"></a>selenium知识点大全</h2> 
<p>在使用selenium之前必须先配置浏览器对应版本的webdriver。</p> 
<h4><a id="1__4"></a>1. 初始化浏览器对象</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> Chrome

<span class="token comment"># 创建浏览器对象，并且打开一个空的页面</span>
browser <span class="token operator">=</span> Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="2__18"></a>2. 访问指定网页</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
 
<span class="token comment"># 初始化浏览器为chrome浏览器</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 访问百度首页</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com/'</span><span class="token punctuation">)</span>

<span class="token comment"># 浏览器截图</span>
browser<span class="token punctuation">.</span>get_screenshot_as_file<span class="token punctuation">(</span><span class="token string">'截图.png'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="3__38"></a>3. 设置浏览器大小</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 设置浏览器大小：全屏</span>
browser<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 设置分辨率 500*500</span>
browser<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 设置分辨率 1000*800</span>
browser<span class="token punctuation">.</span>set_window_size<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="4__65"></a>4. 刷新页面</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time  
 
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 设置浏览器全屏</span>
browser<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>   
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>  
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># 刷新页面</span>
    browser<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'刷新页面'</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'刷新失败'</span><span class="token punctuation">)</span>
   
<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="5__91"></a>5. 前进和后退</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time  
 
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment"># 设置浏览器全屏</span>
browser<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>   
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>  
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token comment"># 打开淘宝页面</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.taobao.com'</span><span class="token punctuation">)</span>  
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token comment"># 后退到百度页面</span>
browser<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>  
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token comment"># 前进到淘宝页面</span>
browser<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span> 
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
 
<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="6__122"></a>6. 获取页面基本属性</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>

<span class="token comment"># 网页标题</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>title<span class="token punctuation">)</span>
<span class="token comment"># 当前网址</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>current_url<span class="token punctuation">)</span>
<span class="token comment"># 浏览器名称</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token comment"># 网页源码</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="7__142"></a>7. 定位标签</h4> 
<pre><code class="prism language-python">browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span><span class="token string">'kw'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span><span class="token string">'wd'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'s_ipt'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>TAG_NAME<span class="token punctuation">,</span><span class="token string">'input'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span><span class="token string">'新闻'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>PARTIAL_LINK_TEXT<span class="token punctuation">,</span><span class="token string">'闻'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span><span class="token string">'//*[@id="kw"]'</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">'#kw'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="8_get_attribute_157"></a>8. get_attribute获取标签属性</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过class属性值获取标签</span>
logo <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span><span class="token string">'index-logo-src'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">)</span>

<span class="token comment"># 获取标签的src属性</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="9__180"></a>9. 获取标签内容</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过css选择器选中标签</span>
logo <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">'#hotsearch-content-wrapper &gt; li:nth-child(1) &gt; a'</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标签的标签内容</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token comment"># 获取标签的href属性</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="10__203"></a>10. 获取其他属性</h4> 
<p>除了属性和文本值外，还有id、位置、标签名和大小等属性。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>

logo <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">'index-logo-src'</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标签的id</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
<span class="token comment"># 获取标签的位置</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>location<span class="token punctuation">)</span>
<span class="token comment"># 获取标签的标签名</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>tag_name<span class="token punctuation">)</span>
<span class="token comment"># 获取标签的大小</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>logo<span class="token punctuation">.</span>size<span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="11__231"></a>11. 页面交互操作</h4> 
<ol><li> <p>输入文本：<code>标签.send_keys(输入内容)</code></p> </li><li> <p>点击：<code>标签.click()</code></p> </li><li> <p>清空输入框：<code>标签.clear()</code></p> </li><li> <p>回车确认：<code>标签.submit()</code></p> </li><li> <p>单选：单选比较好操作，<strong>先定位</strong>需要单选的某个元素，然后<strong>点击</strong>一下即可。</p> </li><li> <p>多选：多选好像也比较容易，<strong>依次定位</strong>需要选择的元素，<strong>点击</strong>即可。</p> </li><li> <p>下拉框：下拉框的操作相对复杂一些，需要用到<code>Select</code>模块。</p> <p>我们来进行演示一波，由于暂时没找到合适的网页，我这边写了一个简单的网页本地测试（文件存为 demo.html)</p> <pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>帅哥<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>才哥<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>才哥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>小明<span class="token punctuation">"</span></span> <span class="token attr-name">selected</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小明<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>小华<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小华<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>草儿<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>小草<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <p>然后，再演示<strong>下拉框的不同选择的方式</strong></p> <pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>select <span class="token keyword">import</span> Select
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

url <span class="token operator">=</span> <span class="token string">'file:///Users/yuting/Work/%E6%8E%88%E8%AF%BE/Python2206/01%E8%87%AA%E5%8A%A8%E5%8A%9E%E5%85%AC/day11-turtle%E7%9A%84%E4%BD%BF%E7%94%A8/demo.html'</span>

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 获取下来列表对应的标签</span>
select_tag <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> <span class="token string">"帅哥"</span><span class="token punctuation">)</span>

<span class="token comment"># 根据索引选择</span>
Select<span class="token punctuation">(</span>select_tag<span class="token punctuation">)</span><span class="token punctuation">.</span>select_by_index<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 根据value值选择</span>
Select<span class="token punctuation">(</span>select_tag<span class="token punctuation">)</span><span class="token punctuation">.</span>select_by_value<span class="token punctuation">(</span><span class="token string">"草儿"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 根据文本值选择</span>
Select<span class="token punctuation">(</span>select_tag<span class="token punctuation">)</span><span class="token punctuation">.</span>select_by_visible_text<span class="token punctuation">(</span><span class="token string">"才哥"</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h4><a id="12__301"></a>12. 选项卡切换</h4> 
<p>我们在访问网页的时候会打开很多个页面，在<code>Selenium</code>中提供了一些方法方便我们对这些页面进行操作。</p> 
<blockquote> 
 <p><code>current_window_handle</code>：获取当前窗口的句柄。</p> 
 <p><code>window_handles</code>：返回当前浏览器的所有窗口的句柄。</p> 
 <p><code>switch_to_window()</code>：用于切换到对应的窗口。</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打开百度</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.baidu.com'</span><span class="token punctuation">)</span>
<span class="token comment"># 新建一个选项卡</span>
browser<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.open()'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>browser<span class="token punctuation">.</span>window_handles<span class="token punctuation">)</span>
<span class="token comment"># 跳转到第二个选项卡并打开知乎</span>
browser<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>browser<span class="token punctuation">.</span>window_handles<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.zhihu.com'</span><span class="token punctuation">)</span>
<span class="token comment"># 回到第一个选项卡并打开淘宝（原来的百度页面改为了淘宝）</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>browser<span class="token punctuation">.</span>window_handles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.taobao.com'</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="13__331"></a>13. 模拟鼠标操作</h4> 
<p>既然是模拟浏览器操作，自然也就需要能模拟鼠标的一些操作了，这里需要导入<code>ActionChains</code> 类。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
</code></pre> 
<h5><a id="131__339"></a>13.1 左键</h5> 
<p>这个其实就是页面交互操作中的点击<code>click()</code>操作。</p> 
<h5><a id="132__343"></a>13.2 右键：</h5> 
<p>context_click()</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 定位到要右击的元素，这里选的新闻链接</span>
right_click <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> <span class="token string">'新闻'</span><span class="token punctuation">)</span>

<span class="token comment"># 执行鼠标右键操作</span>
ActionChains<span class="token punctuation">(</span>browser<span class="token punctuation">)</span><span class="token punctuation">.</span>context_click<span class="token punctuation">(</span>right_click<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上述操作中：</p> 
<blockquote> 
 <p><strong>ActionChains(browser)</strong>：调用ActionChains()类，并将浏览器驱动browser作为参数传入</p> 
 <p><strong>context_click(right_click)</strong>：模拟鼠标双击，需要传入指定元素定位作为参数</p> 
 <p><strong>perform()</strong>：执行ActionChains()中储存的所有操作，可以看做是执行之前一系列的操作</p> 
</blockquote> 
<h5><a id="133_double_click_376"></a>13.3 双击：double_click()</h5> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">r'https://www.baidu.com'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 定位到要双击的元素</span>
double_click <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">'.accessibility-icon'</span><span class="token punctuation">)</span>

<span class="token comment"># 双击</span>
ActionChains<span class="token punctuation">(</span>browser<span class="token punctuation">)</span><span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>double_click<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="134__399"></a>13.4 拖拽</h5> 
<p><code>drag_and_drop(source,target)</code>拖拽操作，开始位置和结束位置需要被指定，这个常用于滑块类验证码的操作之类。</p> 
<p>我们以菜鸟教程的一个案例来进行演示：</p> 
<blockquote> 
 <p>https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
url <span class="token operator">=</span> <span class="token string">'https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

browser<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token string">'iframeResult'</span><span class="token punctuation">)</span>

<span class="token comment"># 开始位置</span>
source <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">"#draggable"</span><span class="token punctuation">)</span>

<span class="token comment"># 结束位置</span>
target <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">"#droppable"</span><span class="token punctuation">)</span>

<span class="token comment"># 执行元素的拖放操作</span>
actions <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>browser<span class="token punctuation">)</span>
actions<span class="token punctuation">.</span>drag_and_drop<span class="token punctuation">(</span>source<span class="token punctuation">,</span> target<span class="token punctuation">)</span>
actions<span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 拖拽</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h5><a id="135__439"></a>13.5 悬停：</h5> 
<p>move_to_element()</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">import</span> time

browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com'</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 定位悬停的位置</span>
move <span class="token operator">=</span> browser<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"s-usersetting-top"</span><span class="token punctuation">)</span>

<span class="token comment"># 悬停操作</span>
ActionChains<span class="token punctuation">(</span>browser<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>move<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
browser<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="14__467"></a>14. 模拟键盘操作</h4> 
<p><code>selenium</code>中的<code>Keys()</code>类提供了大部分的键盘操作方法，通过<code>send_keys()</code>方法来模拟键盘上的按键。</p> 
<p>引入<code>Keys</code>类</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys
</code></pre> 
<blockquote> 
 <p>send_keys(Keys.BACK_SPACE)：删除键(BackSpace)</p> 
 <p>send_keys(Keys.SPACE)：空格键(Space)</p> 
 <p>send_keys(Keys.TAB)：制表键(TAB)</p> 
 <p>send_keys(Keys.ESCAPE)：回退键(ESCAPE)</p> 
 <p>send_keys(Keys.ENTER)：回车键(ENTER)</p> 
 <p>send_keys(Keys.CONTRL,‘a’)：全选(Ctrl+A)</p> 
 <p>send_keys(Keys.CONTRL,‘c’)：复制(Ctrl+C)</p> 
 <p>send_keys(Keys.CONTRL,‘x’)：剪切(Ctrl+X)</p> 
 <p>send_keys(Keys.CONTRL,‘v’)：粘贴(Ctrl+V)</p> 
 <p>send_keys(Keys.F1)：键盘F1</p> 
 <p>…</p> 
 <p>send_keys(Keys.F12)：键盘F12</p> 
</blockquote> 
<h4><a id="15_501"></a>15.常见配置</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 创建设置对象</span>
options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 解决DevToolsActivePort文件不存在的报错</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--no-sandbox'</span><span class="token punctuation">)</span>

<span class="token comment"># 谷歌文档提到需要加上这个属性来规避bug</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span>

<span class="token comment"># 隐藏滚动条, 应对一些特殊页面</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--hide-scrollbars'</span><span class="token punctuation">)</span>

<span class="token comment"># 图片不加载选其一</span>
<span class="token comment"># 不加载图片, 提升速度</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'blink-settings=imagesEnabled=false'</span><span class="token punctuation">)</span>
<span class="token comment"># 不加载图片, 提升速度</span>
options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"prefs"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">"profile.managed_default_content_settings.images"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># 设置取消测试环境</span>
options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">'excludeSwitches'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'enable-automation'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 无头模式</span>
<span class="token comment"># 浏览器不提供可视化页面. linux下如果系统不支持可视化不加这条会启动失败(无头浏览器)</span>
<span class="token comment"># 减少了资源消耗的同时，增加了被反爬的风险</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置代理</span>
option<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--proxy-server=http://代理服务器:端口'</span><span class="token punctuation">)</span>

<span class="token comment"># 避免终端下执行代码报错</span>
options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"excludeSwitches"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'enable-automation'</span><span class="token punctuation">,</span> <span class="token string">'enable-logging'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 加载拓展插件</span>
options<span class="token punctuation">.</span>add_extension<span class="token punctuation">(</span>插件路径<span class="token punctuation">)</span>

<span class="token comment"># 设置请求头</span>
UA <span class="token operator">=</span> <span class="token string">"Mozilla…………"</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"--user-agent=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>UA<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 设置配置</span>
browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>

<span class="token comment"># 加载用户缓存</span>
<span class="token comment"># 可以像正常使用浏览器一样，记录使用记录和cookie</span>
<span class="token comment"># 如果不指定缓存路径，不指定的时候会创建临时文件夹。</span>
<span class="token comment"># 如果selenium实例没有正常销毁，那么当前缓存文件夹不会被删除。</span>
user_dir <span class="token operator">=</span> <span class="token string">r'C:\userDir'</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"--user-data-dir=</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>user_dir<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 去除navigator.webdriver属性</span>
browser<span class="token punctuation">.</span>execute_cdp_cmd<span class="token punctuation">(</span>
    <span class="token string">"Page.addScriptToEvaluateOnNewDocument"</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">"source"</span><span class="token punctuation">:</span> <span class="token string">"Object.defineProperty(navigator, 'webdriver', {get: () =&gt; undefined})"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token comment"># 或者</span>
options<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">"disable-blink-features=AutomationControlled"</span><span class="token punctuation">)</span>

URL <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/'</span>
<span class="token comment"># 加载页面</span>
browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>URL<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/12ceb30561c53eeaf454000d974de773/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue3-vite使用amfe-flexible</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/05aff88f9726ed9d0c6e081a73cb0d7b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java记录H2数据库的操作指令日志</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>