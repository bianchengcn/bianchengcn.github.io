<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C/C&#43;&#43;编程：libssh2 API学习 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="C/C&#43;&#43;编程：libssh2 API学习" />
<meta property="og:description" content="文章目录 libssh2_sftp_initlibssh2_sftp_fstat_exlibssh2_sftp_openlibssh2_sftp_open_exlibssh2_sftp_readlibssh2_sftp_closelibssh2_sftp_close_handlelibssh2_sftp_shutdownlibssh2_sftp_last_errorlibssh2_session_block_directionslibssh2_session_handshakelibssh2_session_initlibssh2_session_init_exlibssh2_session_disconnectlibssh2_session_disconnect_exlibssh2_session_freelibssh2_hostkey_hashlibssh2_session_set_blockinglibssh2_userauth_listlibssh2_userauth_passwordlibssh2_userauth_password_exlibssh2_initlibssh2_exitlibssh2_version libssh2_sftp_init #include &lt;libssh2.h&gt; #include &lt;libssh2_sftp.h&gt; LIBSSH2_SFTP * libssh2_sftp_init(LIBSSH2_SESSION *session); 名称
libssh2_sftp_init-为给定的SSH会话打开SFTP通道。 描述：
打开一个通道并初始化SFTP子系统。尽管SFTP子系统在与Channel API导出的通道类型相同的通道上运行，但该协议本身实现了自己独特的二进制数据包协议，必须使用libssh2_sftp _ *（）系列功能进行管理SFTP会话完成后，必须使用libssh2_sftp_shutdown函数销毁它。 返回值
指向新分配的SFTP实例的指针，失败时为NULL。 错误
LIBSSH2_ERROR_ALLOC-内部内存分配调用失败。LIBSSH2_ERROR_SOCKET_SEND-无法在套接字上发送数据。LIBSSH2_ERROR_SOCKET_TIMEOUT -LIBSSH2_ERROR_SFTP_PROTOCOL-套接字上收到无效的SFTP协议响应，或者SFTP操作导致服务器返回错误代码。LIBSSH2_ERROR_EAGAIN-标记为非阻塞I / O，但调用将阻塞。 libssh2_sftp_fstat_ex 名称：
获取或设置SFTP文件句柄上的属性 参数：
handle ：libssh2_sftp_open_ex的返回值attrs ： libssh2_sftp_open 名称：
libssh2_sftp_open_ex调用的便利宏 #include &lt;libssh2.h&gt; LIBSSH2_SFTP_HANDLE * libssh2_sftp_open（LIBSSH2_SFTP * sftp，const char * path，unsigned long flags，long mode）; libssh2_sftp_open_ex #include &lt;libssh2.h&gt; #include &lt;libssh2_sftp.h&gt; LIBSSH2_SFTP_HANDLE * libssh2_sftp_open_ex(LIBSSH2_SFTP *sftp, const char *filename, unsigned int filename_len, unsigned long flags, long mode, int open_type); 名称" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a3a8d9f12b510358633bc24414e1e38a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-01-20T16:48:58+08:00" />
<meta property="article:modified_time" content="2021-01-20T16:48:58+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C/C&#43;&#43;编程：libssh2 API学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#libssh2_sftp_init_1" rel="nofollow">libssh2_sftp_init</a></li><li><a href="#libssh2_sftp_fstat_ex_25" rel="nofollow">libssh2_sftp_fstat_ex</a></li><li><a href="#libssh2_sftp_open_32" rel="nofollow">libssh2_sftp_open</a></li><li><a href="#libssh2_sftp_open_ex_40" rel="nofollow">libssh2_sftp_open_ex</a></li><li><a href="#libssh2_sftp_read_90" rel="nofollow">libssh2_sftp_read</a></li><li><a href="#libssh2_sftp_close_112" rel="nofollow">libssh2_sftp_close</a></li><li><a href="#libssh2_sftp_close_handle_121" rel="nofollow">libssh2_sftp_close_handle</a></li><li><a href="#libssh2_sftp_shutdown_155" rel="nofollow">libssh2_sftp_shutdown</a></li><li><a href="#libssh2_sftp_last_error_174" rel="nofollow">libssh2_sftp_last_error</a></li><li><a href="#libssh2_session_block_directions_184" rel="nofollow">libssh2_session_block_directions</a></li><li><a href="#libssh2_session_handshake_213" rel="nofollow">libssh2_session_handshake</a></li><li><a href="#libssh2_session_init_241" rel="nofollow">libssh2_session_init</a></li><li><a href="#libssh2_session_init_ex_255" rel="nofollow">libssh2_session_init_ex</a></li><li><a href="#libssh2_session_disconnect_287" rel="nofollow">libssh2_session_disconnect</a></li><li><a href="#libssh2_session_disconnect_ex_299" rel="nofollow">libssh2_session_disconnect_ex</a></li><li><a href="#libssh2_session_free_322" rel="nofollow">libssh2_session_free</a></li><li><a href="#libssh2_hostkey_hash_334" rel="nofollow">libssh2_hostkey_hash</a></li><li><a href="#libssh2_session_set_blocking_355" rel="nofollow">libssh2_session_set_blocking</a></li><li><a href="#libssh2_userauth_list_380" rel="nofollow">libssh2_userauth_list</a></li><li><a href="#libssh2_userauth_password_416" rel="nofollow">libssh2_userauth_password</a></li><li><a href="#libssh2_userauth_password_ex_422" rel="nofollow">libssh2_userauth_password_ex</a></li><li><a href="#libssh2_init_459" rel="nofollow">libssh2_init</a></li><li><a href="#libssh2_exit_481" rel="nofollow">libssh2_exit</a></li><li><a href="#libssh2_version_501" rel="nofollow">libssh2_version</a></li></ul> 
</div> 
<p></p> 
<h2><a id="libssh2_sftp_init_1"></a>libssh2_sftp_init</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span> #<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2_sftp.h&gt;</span></span>

LIBSSH2_SFTP <span class="token operator">*</span> <span class="token function">libssh2_sftp_init</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称</p> 
<ul><li>libssh2_sftp_init-为给定的SSH会话打开SFTP通道。</li></ul> 
<p>描述：</p> 
<ul><li>打开一个通道并初始化SFTP子系统。</li><li>尽管SFTP子系统在与Channel API导出的通道类型相同的通道上运行，但该协议本身实现了自己独特的二进制数据包协议，必须使用libssh2_sftp _ *（）系列功能进行管理</li><li>SFTP会话完成后，必须使用libssh2_sftp_shutdown函数销毁它。</li></ul> 
<p>返回值</p> 
<ul><li>指向新分配的SFTP实例的指针，失败时为NULL。</li></ul> 
<p>错误</p> 
<ul><li>LIBSSH2_ERROR_ALLOC-内部内存分配调用失败。</li><li>LIBSSH2_ERROR_SOCKET_SEND-无法在套接字上发送数据。</li><li>LIBSSH2_ERROR_SOCKET_TIMEOUT -</li><li>LIBSSH2_ERROR_SFTP_PROTOCOL-套接字上收到无效的SFTP协议响应，或者SFTP操作导致服务器返回错误代码。</li><li>LIBSSH2_ERROR_EAGAIN-标记为非阻塞I / O，但调用将阻塞。</li></ul> 
<h2><a id="libssh2_sftp_fstat_ex_25"></a>libssh2_sftp_fstat_ex</h2> 
<p>名称：</p> 
<ul><li>获取或设置SFTP文件句柄上的属性</li></ul> 
<p>参数：</p> 
<ul><li><code>handle</code> ：libssh2_sftp_open_ex的返回值</li><li><code>attrs</code> ：</li></ul> 
<h2><a id="libssh2_sftp_open_32"></a>libssh2_sftp_open</h2> 
<p>名称：</p> 
<ul><li>libssh2_sftp_open_ex调用的便利宏</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> libssh2_sftp_open（LIBSSH2_SFTP <span class="token operator">*</span> sftp，<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> path，<span class="token keyword">unsigned</span> <span class="token keyword">long</span> flags，<span class="token keyword">long</span> mode）<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="libssh2_sftp_open_ex_40"></a>libssh2_sftp_open_ex</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2_sftp.h&gt;</span></span>
 
LIBSSH2_SFTP_HANDLE <span class="token operator">*</span>
<span class="token function">libssh2_sftp_open_ex</span><span class="token punctuation">(</span>LIBSSH2_SFTP <span class="token operator">*</span>sftp<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>filename<span class="token punctuation">,</span>
                     <span class="token keyword">unsigned</span> <span class="token keyword">int</span> filename_len<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> flags<span class="token punctuation">,</span>
                     <span class="token keyword">long</span> mode<span class="token punctuation">,</span> <span class="token keyword">int</span> open_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称</p> 
<ul><li>libssh2_sftp_open-在SFTP上打开文件的文件句柄。</li></ul> 
<p>参数：</p> 
<ul><li>sftp ： libssh2_sftp_init返回的SFTP实例</li><li>filename ：要打开的远程文件/目录资源</li><li>filename_len ：文件名长度</li><li>flag ：LIBSSH2_FXF_ *常量的任何合理组合： 
  <ul><li>LIBSSH2_FXF_READ 
    <ul><li>打开文件进行读取</li></ul> </li><li>LIBSSH2_FXF_WRITE 
    <ul><li>打开文件进行写入</li><li>如果同时指定了this和LIBSSH2_FXF_READ，则将同时打开该文件以进行读取和写入。</li></ul> </li><li>LIBSSH2_FXF_APPEND 
    <ul><li>强制所有写入将数据追加到文件末尾</li></ul> </li><li>LIBSSH2_FXF_CREAT 
    <ul><li>如果指定了此标志，则如果一个不存在，则将创建一个新文件</li><li>如果指定了LIBSSH2_FXF_TRUNC，则新文件如果以前存在，则将被截断为零长度</li></ul> </li><li>LIBSSH2_FXF_TRUNC 
    <ul><li>通过指定LIBSSH2_FXF_CREAT，在创建文件时强制将具有相同名称的现有文件截断为零长度。如果使用此标志，还必须指定LIBSSH2_FXF_CREAT</li></ul> </li><li>LIBSSH2_FXF_EXCL 
    <ul><li>如果命名文件已经存在，则导致请求失败。</li><li>如果使用此标志，还必须指定LIBSSH2_FXF_CREAT</li></ul> </li></ul> </li><li>mode 
  <ul><li>POSIX文件权限，用于分配是否是新创建的文件。请参见&lt;libssh2_sftp.h&gt;中的LIBSSH2_SFTP_S_ *便利性定义。</li></ul> </li><li>open_type 
  <ul><li>LIBSSH2_SFTP_OPENFILE（打开文件）</li><li>LIBSSH2_SFTP_OPENDIR（打开目录）</li></ul> </li></ul> 
<p>返回值：</p> 
<ul><li>指向新创建的LIBSSH2_SFTP_HANDLE实例的指针，失败时为NULL</li></ul> 
<p>错误</p> 
<ul><li>LIBSSH2_ERROR_ALLOC-内部内存分配调用失败。</li><li>LIBSSH2_ERROR_SOCKET_SEND-无法在套接字上发送数据。</li><li>LIBSSH2_ERROR_SOCKET_TIMEOUT -</li><li>LIBSSH2_ERROR_SFTP_PROTOCOL-套接字上收到无效的SFTP协议响应，或者SFTP操作导致服务器返回错误代码。</li><li>LIBSSH2_ERROR_EAGAIN-标记为非阻塞I / O，但调用将阻塞。</li></ul> 
<h2><a id="libssh2_sftp_read_90"></a>libssh2_sftp_read</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span> #<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2_sftp.h&gt;</span></span>

ssize_t libssh2_sftp_read（LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> handle，<span class="token keyword">char</span> <span class="token operator">*</span> buffer，size_t buffer_maxlen）<span class="token punctuation">;</span>
</code></pre> 
<p>名称：</p> 
<ul><li>从SFTP句柄读取数据</li></ul> 
<p>参数：</p> 
<ul><li>handle：libssh2_sftp_open_ex返回的SFTP文件句柄</li><li>buffer：buffer是一个指针，它指向一个预先分配的缓冲区</li><li>buffer_maxlen：最多可以读取的字节数</li></ul> 
<p>返回值：</p> 
<ul><li>实际填充到缓冲区中的字节数，否则为负数。否则它将返回LIBSSH2_ERROR_EAGAIN。虽然LIBSSH2_ERROR_EAGAIN是负数，但它本身并不是真正的失败。</li></ul> 
<p>说明：</p> 
<ul><li>从LIBSSH2_SFTP_HANDLE中读取数据块。</li><li>该方法是在POSIX read（2）函数之后建模的， 并使用相同的调用语义。</li><li>libssh2_sftp_read将尝试读取尽可能多的内容，但是如果文件指针到达末尾或进一步读取会导致套接字阻塞，则它可能不会填充所有缓冲区。</li></ul> 
<h2><a id="libssh2_sftp_close_112"></a>libssh2_sftp_close</h2> 
<p>名称：</p> 
<ul><li>libssh2_sftp_close_handle调用的便利宏</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> libssh2_sftp_close（LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> handle）<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="libssh2_sftp_close_handle_121"></a>libssh2_sftp_close_handle</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span> </span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2_sftp.h&gt;</span></span>

<span class="token keyword">int</span> libssh2_sftp_close_handle（LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> handle）<span class="token punctuation">;</span>

<span class="token keyword">int</span> libssh2_sftp_close（LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> handle）<span class="token punctuation">;</span>

<span class="token keyword">int</span> libssh2_sftp_closedir（LIBSSH2_SFTP_HANDLE <span class="token operator">*</span> handle）<span class="token punctuation">;</span>
</code></pre> 
<p>名称：</p> 
<ul><li>关闭文件句柄</li></ul> 
<p>参数：</p> 
<ul><li>handle：libssh2_sftp_open_ex或libssh2_sftp_opendir（这是一个宏）的返回值</li></ul> 
<p>说明：</p> 
<ul><li>关闭活动的LIBSSH2_SFTP_HANDLE。</li><li>因为文件和目录共享相同的基础存储机制，所以这些方法可以互换使用。libssh2_sftp_close和libssh2_sftp_closedir是libssh2_sftp_close_handle的宏</li></ul> 
<p>返回值：</p> 
<ul><li>成功返回0，失败返回负数。否则它将返回LIBSSH2_ERROR_EAGAIN。虽然LIBSSH2_ERROR_EAGAIN是负数，但它本身并不是真正的失败。</li></ul> 
<p>错误：</p> 
<ul><li>LIBSSH2_ERROR_ALLOC：内部内存分配调用失败。</li><li>LIBSSH2_ERROR_SOCKET_SEND：无法在套接字上发送数据。</li><li>LIBSSH2_ERROR_SOCKET_TIMEOUT：</li><li>LIBSSH2_ERROR_SFTP_PROTOCOL：套接字上收到无效的SFTP协议响应，或者SFTP操作导致服务器返回错误代码。</li></ul> 
<h2><a id="libssh2_sftp_shutdown_155"></a>libssh2_sftp_shutdown</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span> </span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2_sftp.h&gt;</span></span>

<span class="token keyword">int</span> libssh2_sftp_shutdown（LIBSSH2_SFTP <span class="token operator">*</span> sftp）<span class="token punctuation">;</span>
</code></pre> 
<p>名称：</p> 
<ul><li>关闭SFTP会话</li></ul> 
<p>参数：</p> 
<ul><li>sftp - libssh2_sftp_init返回的SFTP实例</li></ul> 
<p>说明：</p> 
<ul><li>销毁先前初始化的SFTP会话，并释放与其关联的所有资源。</li></ul> 
<p>返回值：</p> 
<ul><li>成功返回0，失败返回负数。否则它将返回LIBSSH2_ERROR_EAGAIN。虽然LIBSSH2_ERROR_EAGAIN是负数，但它本身并不是真正的失败</li></ul> 
<h2><a id="libssh2_sftp_last_error_174"></a>libssh2_sftp_last_error</h2> 
<p>名称：</p> 
<ul><li>返回最后一个特定于SFTP的错误代码</li></ul> 
<p>说明：</p> 
<ul><li>返回SFTP层产生的最后一个错误码。注意，只有在libssh2在前一次调用中返回LIBSSH2_ERROR_SFTP_PROTOCOL时，才会返回一个合理的错误代码。如果使用libssh2_sftp_last_error而没有前面的SFTP协议错误，它将返回一个未指定的值</li></ul> 
<p>返回值：</p> 
<ul><li>SFTP实例的当前错误代码状态。</li></ul> 
<h2><a id="libssh2_session_block_directions_184"></a>libssh2_session_block_directions</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> libssh2_session_block_directions（LIBSSH2_SESSION <span class="token operator">*</span> session）<span class="token punctuation">;</span>
</code></pre> 
<p>名称：</p> 
<ul><li>获取等待的路线</li></ul> 
<p>说明：</p> 
<ul><li>当任何libssh2函数返回LIBSSH2_ERROR_EAGAIN时，应用程序应等待套接字具有可用于读取或写入的数据</li><li>根据libssh2_session_block_directions的返回值，应用程序应等待读取，写入或同时等待。</li></ul> 
<p>参数：</p> 
<ul><li>session ：libssh2_session_init_ex返回的会话实例</li></ul> 
<p>返回值：</p> 
<ul><li> <p>返回方向集作为二进制掩码。可以是以下各项的组合：</p> 
  <ul><li>LIBSSH2_SESSION_BLOCK_INBOUND：入站方向被阻止。</li><li>LIBSSH2_SESSION_BLOCK_OUTBOUND：出站方向被阻止。</li></ul> </li><li> <p>在再次调用libssh2函数之前，应用程序应等待数据可用于套接字。</p> </li><li> <p>如果设置了LIBSSH2_SESSION_BLOCK_INBOUND，则select应该在readfds集中包含会话套接字。</p> </li><li> <p>相应地，在LIBSSH2_SESSION_BLOCK_OUTBOUND的情况下，writefds设置应包含套接字。</p> </li></ul> 
<h2><a id="libssh2_session_handshake_213"></a>libssh2_session_handshake</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">libssh2_session_handshake</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> libssh2_socket_t socket<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称</p> 
<ul><li>执行SSH握手</li></ul> 
<p>参数：</p> 
<ul><li>session - libssh2_session_init_ex返回的会话实例</li><li>socket-连接的套接字描述符。通常，尽管该协议允许任何可靠的传输，但TCP连接允许该库尝试使用任何berkeley套接字</li></ul> 
<p>返回值</p> 
<ul><li>成功返回0，失败返回负。</li></ul> 
<p>错误</p> 
<ul><li>LIBSSH2_ERROR_SOCKET_NONE-套接字无效。</li><li>LIBSSH2_ERROR_BANNER_SEND-无法将横幅发送到远程主机。</li><li>LIBSSH2_ERROR_KEX_FAILURE- &gt;与远程主机的加密密钥交换失败。</li><li>LIBSSH2_ERROR_SOCKET_SEND-无法在套接字上发送数据。</li><li>LIBSSH2_ERROR_SOCKET_DISCONNECT-套接字已断开连接。</li><li>LIBSSH2_ERROR_PROTO-套接字上收到无效的SSH协议响应。</li><li>LIBSSH2_ERROR_EAGAIN-标记为非阻塞I / O，但调用将阻塞。</li></ul> 
<p>返回值</p> 
<ul><li>成功返回0，失败返回负。</li></ul> 
<h2><a id="libssh2_session_init_241"></a>libssh2_session_init</h2> 
<p>名称</p> 
<ul><li><code>libssh2_session_init</code>： <code>libssh2_session_init_ex</code>调用的便利宏</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

LIBSSH2_SESSION <span class="token operator">*</span> libssh2_session_init（<span class="token keyword">void</span>）<span class="token punctuation">;</span>
</code></pre> 
<p>描述</p> 
<ul><li>这是使用基础函数<code>libssh2_session_init_ex</code>的公共libssh2头文件中定义的宏。</li></ul> 
<h2><a id="libssh2_session_init_ex_255"></a>libssh2_session_init_ex</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

LIBSSH2_SESSION <span class="token operator">*</span> <span class="token function">libssh2_session_init_ex</span><span class="token punctuation">(</span><span class="token function">LIBSSH2_ALLOC_FUNC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>myalloc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LIBSSH2_FREE_FUNC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>myfree<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">LIBSSH2_REALLOC_FUNC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>myrealloc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>abstract<span class="token punctuation">)</span><span class="token punctuation">;</span>

LIBSSH2_SESSION <span class="token operator">*</span> <span class="token function">libssh2_session_init</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称：</p> 
<ul><li>libssh2_session_init_ex-初始化SSH会话对象</li></ul> 
<p>描述：</p> 
<ul><li>初始化SSH会话对象。默认情况下，系统内存分配器（malloc（），free（），realloc（））将用于任何动态分配的内存块。可以使用此API调用的扩展版本指定备用内存分配功能，和/或可以将可选的特定于应用程序的数据附加到会话对象。</li><li><strong>在配置会话选项或启动与远程服务器的SSH会话之前，必须首先调用此方法。</strong></li></ul> 
<p>参数：</p> 
<ul><li> <p>myalloc-自定义分配器函数。有关实现分配器回调的信息，请参阅“回调”部分。传递NULL值以使用默认系统分配器。</p> </li><li> <p>myfree-定制的解除分配器功能。有关实现deallocator回调的信息，请参阅“回调”部分。传递NULL值以使用默认的系统解除分配器。</p> </li><li> <p>myrealloc-自定义重新分配器功能。有关实现重新分配器回调的信息，请参阅“回调”部分。传递NULL值以使用默认的系统重新分配器。</p> </li><li> <p>abstract-指向应用程序特定回调数据的任意指针。该值将传递给与命名会话实例关联的任何回调函数。</p> </li></ul> 
<p>返回值：</p> 
<ul><li>指向新分配的LIBSSH2_SESSION实例的指针，或在错误时为NULL</li></ul> 
<p>其他：</p> 
<ul><li>libssh2_session_free</li><li>libssh2_session_handshake</li></ul> 
<h2><a id="libssh2_session_disconnect_287"></a>libssh2_session_disconnect</h2> 
<p>名称：</p> 
<ul><li>libssh2_session_disconnect_ex调用的便利宏</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> libssh2_session_disconnect（LIBSSH2_SESSION <span class="token operator">*</span> session，<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> description）<span class="token punctuation">;</span>
</code></pre> 
<h2><a id="libssh2_session_disconnect_ex_299"></a>libssh2_session_disconnect_ex</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">libssh2_session_disconnect_ex</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> <span class="token keyword">int</span> reason<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>description<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>lang<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">libssh2_session_disconnect</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称</p> 
<ul><li>libssh2_session_disconnect_ex-终止传输层</li></ul> 
<p>描述：</p> 
<ul><li>向与会话关联的远程主机发送断开连接消息，以及原因符号和详细说明。</li></ul> 
<p>参数：</p> 
<ul><li><code>session</code> ：<code>libssh2_session_init_ex</code>返回的会话实例</li><li><code>reason</code>：断开原因常量之一</li><li><code>description</code>：易于理解的断开原因</li><li><code>lang</code>：描述所提供描述语言/编码的本地化字符串</li></ul> 
<p>其他：</p> 
<ul><li>libssh2_session_init_ex</li></ul> 
<h2><a id="libssh2_session_free_322"></a>libssh2_session_free</h2> 
<p>名称：</p> 
<ul><li>libssh2_session_free-释放与会话实例关联的资源</li></ul> 
<p>描述：</p> 
<ul><li>释放与会话实例关联的所有资源。通常在<code>libssh2_session_disconnect_ex</code>之后调用</li></ul> 
<p>其他：</p> 
<ul><li>libssh2_session_init_ex</li><li>libssh2_session_disconnect_ex</li></ul> 
<h2><a id="libssh2_hostkey_hash_334"></a>libssh2_hostkey_hash</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">libssh2_hostkey_hash</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> <span class="token keyword">int</span> hash_type<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>名称</p> 
<ul><li>libssh2_hostkey_hash-返回远程主机密钥的哈希</li></ul> 
<p>描述：</p> 
<ul><li>返回远程系统的主机键的计算摘要。</li><li>返回的字符串的长度是特定于hash_type的（例如，MD5为16个字节，SHA1为20个字节，SHA256为32个字节）。</li></ul> 
<p>参数：</p> 
<ul><li>session - libssh2_session_init_ex返回的会话实例</li><li>hash_type - LIBSSH2_HOSTKEY_HASH_MD5， LIBSSH2_HOSTKEY_HASH_SHA1或LIBSSH2_HOSTKEY_HASH_SHA256之一。</li></ul> 
<p>返回值：</p> 
<ul><li>计算的主机密钥哈希值，如果信息不可用（会话尚未启动，或者请求的哈希算法不可用），则为NULL</li><li>散列由原始二进制字节组成，而不是十六进制数字，因此不能直接打印</li></ul> 
<h2><a id="libssh2_session_set_blocking_355"></a>libssh2_session_set_blocking</h2> 
<p>名称</p> 
<ul><li>libssh2_session_set_blocking-设置或者清除会话的阻塞模式</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">libssh2_session_set_blocking</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> <span class="token keyword">int</span> blocking<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>描述：</p> 
<ul><li> <p>设置或者清除会话的阻塞模式</p> </li><li> <p>在会话上设置或清除选中的阻塞模式。这将立即影响与此会话相关的任何通道。</p> </li><li> <p>如果在一个没有可用数据的会话上执行读操作：</p> 
  <ul><li>阻塞会话将等待数据到达并返回它接收到的数据</li><li>非阻塞会话将立即返回一个空缓冲区。</li></ul> </li><li> <p>如果在没有空间存放更多数据的会话上执行写操作</p> 
  <ul><li>阻塞的会话将等待空间</li><li>非阻塞会话将立即返回而不写入任何东西</li></ul> </li></ul> 
<p>参数：</p> 
<ul><li><code>session</code>： <code>libssh2_session_init_ex</code>返回的会话实例</li><li><code>blocking</code>：非0阻塞，0不阻塞</li></ul> 
<h2><a id="libssh2_userauth_list_380"></a>libssh2_userauth_list</h2> 
<p>名称：</p> 
<ul><li>libssh2_userauth_list-列出支持的身份验证方法</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>
 
<span class="token keyword">char</span> <span class="token operator">*</span>
<span class="token function">libssh2_userauth_list</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>username<span class="token punctuation">,</span>
                      <span class="token keyword">unsigned</span> <span class="token keyword">int</span> username_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/45/b6/REpf3zzS_o.png" alt="在这里插入图片描述"><br> 参数：</p> 
<ul><li> <p><code>session</code> ： <a href="" rel="nofollow">libssh2_session_init_ex</a>返回的会话实例</p> </li><li> <p><code>username</code>：认证时将使用的用户名。请注意，大多数服务器实现不允许请求之间使用不同的用户名进行身份验证。因此，该用户名必须与以后的userauth调用中使用的用户名相同。</p> </li><li> <p><code>username_len</code>：用户名参数的长度</p> </li></ul> 
<p>返回值：</p> 
<ul><li>成功后，以逗号分隔的受支持身份验证方案列表。该列表由libssh2内部管理。失败时返回NULL。</li></ul> 
<p>错误：</p> 
<ul><li>LIBSSH2_ERROR_ALLOC-内部内存分配调用失败</li><li>LIBSSH2_ERROR_SOCKET_SEND-无法在套接字上发送数据</li><li>LIBSSH2_ERROR_EAGAIN-标记为非阻塞I / O，但调用</li></ul> 
<p>其他API：</p> 
<ul><li>libssh2_session_init_ex</li></ul> 
<p>将<strong>SSH_USERAUTH_NONE</strong>请求发送到远程主机。除非远程主机配置为不接受任何可行的身份验证方案（不太可能），否则它将返回<strong>SSH_USERAUTH_FAILURE</strong>以及其支持的身份验证方案的列表。万一没有身份验证成功，这种方法将返回NULL。通过检查<a href="" rel="nofollow">libssh2_userauth_authenticated</a>可以将这种情况与失败的情况区分开。</p> 
<p><img src="https://images2.imgbox.com/db/df/4OAyXLHU_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="libssh2_userauth_password_416"></a>libssh2_userauth_password</h2> 
<p>libssh2_userauth_password- <code>libssh2_userauth_password_ex</code>调用的便捷宏</p> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">define</span> libssh2_userauth_password(session, username, password)  libssh2_userauth_password_ex((session), (username),                               strlen(username),                               (password), strlen(password), NULL)</span>
</code></pre> 
<h2><a id="libssh2_userauth_password_ex_422"></a>libssh2_userauth_password_ex</h2> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">libssh2_userauth_password_ex</span><span class="token punctuation">(</span>LIBSSH2_SESSION <span class="token operator">*</span>session<span class="token punctuation">,</span>
                    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>username<span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> username_len<span class="token punctuation">,</span>
                    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>password<span class="token punctuation">,</span>
                    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> password_len<span class="token punctuation">,</span>
                    <span class="token function">LIBSSH2_PASSWD_CHANGEREQ_FUNC</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>passwd_change_cb<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token macro property">#<span class="token directive keyword">define</span> libssh2_userauth_password(session, username, password)  libssh2_userauth_password_ex((session), (username),                               strlen(username),                               (password), strlen(password), NULL)</span>
</code></pre> 
<p>名称</p> 
<ul><li>libssh2_userauth_password_ex-使用用户名和密码验证会话</li></ul> 
<p>描述：</p> 
<ul><li>尝试基本密码验证。注意，许多似乎支持普通密码身份验证的SSH服务器实际上已经禁用了它，而是使用键盘交互身份验证(通过PAM或其他支持的身份验证路由)。</li></ul> 
<p>参数：</p> 
<ul><li>session ： libssh2_session_init_ex返回的会话实例</li><li>username ：用户名</li><li>username_len ：用户名参数的长度</li><li>password ：用于验证用户名的密码</li><li>password_len ：密码参数的长度</li><li>passwd_change_cb ：如果主机接受身份验证，但请求更改密码，则将发出此回调。如果没有定义回调，但服务器要求更改密码，身份验证将失败。</li></ul> 
<p>返回值：</p> 
<ul><li>成功时返回0，失败时返回负值。它会在阻塞时返回LIBSSH2_ERROR_EAGAIN。虽然LIBSSH2_ERROR_EAGAIN是一个负数，但它本身并不是真正的失败。</li></ul> 
<p>错误：</p> 
<ul><li>LIBSSH2_ERROR_ALLOC - 内部内存分配调用失败。</li><li>LIBSSH2_ERROR_SOCKET_SEND - 无法在套接字上发送数据。</li><li>LIBSSH2_ERROR_PASSWORD_EXPIRED -</li><li>fLIBSSH2_ERROR_AUTHENTICATION_FAILED - 失败，无效的用户名/密码或公钥/私钥。</li></ul> 
<h2><a id="libssh2_init_459"></a>libssh2_init</h2> 
<p>名称：</p> 
<ul><li>libssh2_init-全局库初始化</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> LIBSSH2_INIT_NO_CRYPTO 0x0001</span>

<span class="token keyword">int</span> <span class="token function">libssh2_init</span><span class="token punctuation">(</span><span class="token keyword">int</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>描述：</p> 
<ul><li>初始化libssh2函数。这通常会初始化加密库。它使用全局状态，并且不是线程安全的-您必须确保不同时调用此函数。</li></ul> 
<p>返回值：</p> 
<ul><li>如果成功，则返回0，否则返回负值。</li></ul> 
<p>可用性：</p> 
<ul><li>在libssh2 1.2.5中添加</li></ul> 
<p>其他API：</p> 
<ul><li><code>libssh2_exit</code></li></ul> 
<h2><a id="libssh2_exit_481"></a>libssh2_exit</h2> 
<p>名称：</p> 
<ul><li>libssh2_exit-全局库取消初始化</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">void</span> libssh2_exit（<span class="token keyword">void</span>）<span class="token punctuation">;</span>
</code></pre> 
<p>描述：</p> 
<ul><li>退出libssh2函数并释放内部使用的所有内存。</li></ul> 
<p>可用性：</p> 
<ul><li>在libssh2 1.2.5中添加</li></ul> 
<p>其他API：</p> 
<ul><li><code>libssh2_init</code></li></ul> 
<h2><a id="libssh2_version_501"></a>libssh2_version</h2> 
<ul><li>libssh2_version–返回libssh2版本号</li></ul> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;libssh2.h&gt;</span></span>

<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> libssh2_version（<span class="token keyword">int</span> required_version）<span class="token punctuation">;</span>
</code></pre> 
<p>描述：</p> 
<ul><li>如果required_version小于或等于使用中的libssh2的版本号，则将libssh2的版本号作为指向零终止字符串的指针返回。</li><li>所述REQUIRED_VERSION应的版本号由LIBSSH2_VERSION_NUM构造在libssh2.h公共头文件，它是在0xMMmmpp格式的24比特数定义。MM为大写字母，mm为小写字母，pp为音色编号。</li></ul> 
<p>返回值：</p> 
<ul><li>如果REQUIRED_VERSION不满足，作为一个指向零终止的字符串或NULL</li><li>否则，libssh2的版本号被返回</li></ul> 
<p>可用性：</p> 
<ul><li>此功能是在libssh2 1.1中添加的</li></ul> 
<p>实例：</p> 
<ul><li>为了确保您使用正确的libssh2版本运行：</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">libssh2_version</span><span class="token punctuation">(</span>LIBSSH2_VERSION_NUM<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  fprintf <span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"Runtime libssh2 version too old!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<ul><li>无条件获取版本号：</li></ul> 
<pre><code class="prism language-cpp"><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"libssh2 version: %s"</span><span class="token punctuation">,</span> <span class="token function">libssh2_version</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c902078de1266fdac1a826763f42efad/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">mysql常用转换函数_MySQL常用类型转换函数有哪些 MySQL常用类型转换函数分享</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/2ab3b02416eaf0ce9c6ab8e9bd0ae770/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">mysql增删改查操作语句_学习笔记-mysql增删改查操作语句</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>