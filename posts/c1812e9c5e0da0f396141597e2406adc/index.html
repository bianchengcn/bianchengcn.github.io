<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>uniapp 转H5 实现微信浏览器自定义分享样式 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="uniapp 转H5 实现微信浏览器自定义分享样式" />
<meta property="og:description" content="uniapp 转H5后 实现微信浏览器自定义分享样式
uniapp 项目转 h5 1.在manifest.json文件中,找到H5配置一下路径,需要注意这个名字需要和布到线上的文件夹名字一致 2.就是运行打包了 选择网站pc就是h5打包了,之后.，网站域名，例如www.xxx.com或者你的服务器的IP地址47.103.XX.XX，（这个地址是你将项目打包之后存放放静态文件的地址） 3.剩下的就需要后端给你的包布到线上就可以了 h5实现微信浏览器自定义分享样式( 就是改变右上角分享时候的样式,) 之前的 改变后 微信官方文档.
一 绑定域名(这里建议看官方文档) 二 引入官方js文件 uniapp引入的话,直接在官方下载引入会报错, 直接npm i weixin-js-sdk
三 代码 新建一个js文件,注入wx.config进行相关的初始化等操作， var wx = require(&#34;weixin-js-sdk/index.js&#34;) //引入刚下载的js文件 import $H from &#39;@/api/request.js&#39; //封装好的接口请求 export default { //初始化 initJssdkShare: function(callback, url) { var url = url console.log(url); //这一步需要调用后台接口,返回需要的签名 签名时间戳 随机串 和公众号appid //注意url:window.location.href.split(&#39;#&#39;)[0] // $H.post(&#34;/users/weixin/getsignature&#34;, { url // url是当前页面的url }).then(res =&gt; { console.log(res); wx.config({ // debug: true,//调试的时候需要 在app上回弹出errmg:config ok 的时候就证明没问题了 这时候就可以改为false appId: res." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/c1812e9c5e0da0f396141597e2406adc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-04T18:44:30+08:00" />
<meta property="article:modified_time" content="2021-08-04T18:44:30+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">uniapp 转H5 实现微信浏览器自定义分享样式</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>uniapp 转H5后 实现微信浏览器自定义分享样式</p> 
<h2><a id="uniapp__h5_2"></a>uniapp 项目转 h5</h2> 
<h5><a id="1manifestjsonH5_3"></a>1.在manifest.json文件中,找到H5配置一下路径,需要注意这个名字需要和布到线上的文件夹名字一致</h5> 
<p><img src="https://images2.imgbox.com/3e/c7/Rq6VQE5g_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="2_pch5wwwxxxcomIP47103XXXX_5"></a>2.就是运行打包了 选择网站pc就是h5打包了,之后.，网站域名，例如www.xxx.com或者你的服务器的IP地址47.103.XX.XX，（这个地址是你将项目打包之后存放放静态文件的地址）</h5> 
<p><img src="https://images2.imgbox.com/f0/63/M7WcKPbE_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/11/f9/cZOyhnLt_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="3_8"></a>3.剩下的就需要后端给你的包布到线上就可以了</h5> 
<h2><a id="h5__9"></a>h5实现微信浏览器自定义分享样式( 就是改变右上角分享时候的样式,)</h2> 
<h6><a id="httpsimgblogcsdnimgcn657dd4494652416584350d493f900aa2pngxossprocessimagewatermarktype_ZmFuZ3poZW5naGVpdGkshadow_10text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MjI2NDgyMQsize_16color_FFFFFFt_70_10"></a><img src="https://images2.imgbox.com/16/41/xmYqip5C_o.png" alt="在这里插入图片描述"></h6> 
<h5><a id="_11"></a>之前的</h5> 
<p><img src="https://images2.imgbox.com/0b/a7/ASIDQUOs_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_13"></a>改变后</h5> 
<p><img src="https://images2.imgbox.com/87/da/R5aNUCHB_o.png" alt="在这里插入图片描述"><br> <a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#12" rel="nofollow">微信官方文档</a>.</p> 
<h5><a id="__16"></a>一 绑定域名(这里建议看官方文档)</h5> 
<p><img src="https://images2.imgbox.com/04/2a/dwYerDLD_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_js_18"></a>二 引入官方js文件</h5> 
<h6><a id="uniapp_19"></a>uniapp引入的话,直接在官方下载引入会报错,</h6> 
<p>直接<strong>npm i weixin-js-sdk</strong><br> <img src="https://images2.imgbox.com/ad/80/wcvsJ3rt_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/52/55/GJK4GhGm_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="__23"></a>三 代码</h5> 
<h6><a id="jswxconfig_24"></a>新建一个js文件,注入wx.config进行相关的初始化等操作，</h6> 
<pre><code class="prism language-js"><span class="token keyword">var</span> wx <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"weixin-js-sdk/index.js"</span><span class="token punctuation">)</span> <span class="token comment">//引入刚下载的js文件</span>
<span class="token keyword">import</span> $<span class="token constant">H</span> <span class="token keyword">from</span> <span class="token string">'@/api/request.js'</span> <span class="token comment">//封装好的接口请求</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">//初始化</span>
	<span class="token function-variable function">initJssdkShare</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> url</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">var</span> url <span class="token operator">=</span> url
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//这一步需要调用后台接口,返回需要的签名 签名时间戳 随机串 和公众号appid</span>
		<span class="token comment">//注意url:window.location.href.split('#')[0] //</span>
		$<span class="token constant">H</span><span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/users/weixin/getsignature"</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
			url <span class="token comment">// url是当前页面的url</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
				wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
					<span class="token comment">// debug: true,//调试的时候需要 在app上回弹出errmg:config ok 的时候就证明没问题了 这时候就可以改为false</span>
					appId<span class="token operator">:</span> res<span class="token punctuation">.</span>appId<span class="token punctuation">,</span><span class="token comment">//appid</span>
					timestamp<span class="token operator">:</span> res<span class="token punctuation">.</span>timestamp<span class="token punctuation">,</span><span class="token comment">//时间戳</span>
					nonceStr<span class="token operator">:</span> res<span class="token punctuation">.</span>nonceStr<span class="token punctuation">,</span><span class="token comment">//随机串 </span>
					signature<span class="token operator">:</span> res<span class="token punctuation">.</span>signature<span class="token punctuation">,</span><span class="token comment">//签名</span>
					jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"updateAppMessageShareData"</span><span class="token punctuation">,</span> <span class="token string">"updateTimelineShareData"</span><span class="token punctuation">,</span><span class="token string">"onMenuShareAppMessage"</span><span class="token punctuation">]</span><span class="token comment">//必填 是下面需要用到的方法集合</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
					<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// data是穿的参数 url是当前页面的链接</span>
	<span class="token function-variable function">share</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>url</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initJssdkShare</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
			wx<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"llllllllllll"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> sharedata<span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
					title<span class="token operator">:</span> data<span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token comment">//标题</span>
					desc<span class="token operator">:</span> data<span class="token punctuation">.</span>desc<span class="token punctuation">,</span> <span class="token comment">//描述</span>
					link<span class="token operator">:</span> data<span class="token punctuation">.</span>link <span class="token punctuation">,</span><span class="token comment">//分享链接</span>
					imgUrl<span class="token operator">:</span>data<span class="token punctuation">.</span>imgUrl<span class="token punctuation">,</span> <span class="token comment">//图片</span>
					success<span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
					<span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">;</span>
				wx<span class="token punctuation">.</span><span class="token function">updateAppMessageShareData</span><span class="token punctuation">(</span>sharedata<span class="token punctuation">)</span><span class="token comment">//自定义微信分享给朋友</span>
				wx<span class="token punctuation">.</span><span class="token function">updateTimelineShareData</span><span class="token punctuation">(</span>sharedata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//自定义微信分享给朋友</span>
				wx<span class="token punctuation">.</span><span class="token function">onMenuShareAppMessage</span><span class="token punctuation">(</span>sharedata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获取“分享给朋友”按钮点击状态及自定义分享内容接口（即将废弃）</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>url<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>注意</strong>:(如果遇到essMsg:config fail 或者报出无效的签名 的话很有可能是url出问题)<br> 1.调用后端接口传的url是当前页面的地址<br> 2.调用wx.config时候的参数大小写要注意<br> 3.自定义的时候 wx.updateAppMessageShareData()传的参数</p> 
<h3><a id="__mainjs_81"></a>四 在main.js中应用</h3> 
<p><img src="https://images2.imgbox.com/85/43/y5YOy7sc_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_83"></a>然后就是在相应的页面调用</h5> 
<p><img src="https://images2.imgbox.com/f1/a1/9j6rphOh_o.png" alt="在这里插入图片描述"><br> 最后的最后 config fail 的问题找了好久 问题出在了传给后端的的页面地址url上<br> 超级感谢百度</p> 
<p><a href="https://www.cnblogs.com/niceyoo/p/12232641.html" rel="nofollow">贴上原文文档</a>.</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/735b8d18742731f3b0e767bc3c9ce1fc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MATLAB（十）方程式求根</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/36695504cef65202c5120accbae54efc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">win8系统怎么开telnet服务器,Win8系统开启Telnet协议功能的方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>