<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python实现Excel切片删除功能（附源码） - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python实现Excel切片删除功能（附源码）" />
<meta property="og:description" content="使用Python实现Excel中的“切片删除”功能（附源码） 先上效果图！！！ 如下是需要处理的Excel文件，可以看到在27行和117行处的E列存在数据不一致情况，需进行“切片删除”
运行结果图如下：
我们可以发现，E列27行至117行处的不一致数据已经被删除，即实现了在Excel文件内部进行进行**“切片化”**的数据删除操作！！！
什么是“切片删除”？ 在Excel中，切片是一种数据筛选工具，它允许您以交互的方式对数据进行过滤和分析。切片删除功能是指删除已创建的切片。
要删除切片，您可以按照以下步骤操作：
在Excel工作表中，单击任意一个包含切片的单元格。在“切片工具”选项卡上，选择“切片操作”组中的“删除”按钮。或者，您可以右键单击切片，然后选择“删除”。 删除切片后，相关的切片将从工作表中移除。注意，这不会影响数据本身，只是移除了用于筛选数据的切片控件。请注意，切片删除功能只适用于Excel 2013及更高版本。在较早的版本中，删除切片的步骤可能略有不同，但大致思路是一样的。
如何使用Python进行批量Excel数据文件的切片删除功能？ delete_slices方法是openpyxl库提供的一个函数，用于删除Excel工作表中的切片。
底层原理涉及以下几个步骤：
openpyxl库加载Excel文件：通过调用load_workbook函数，openpyxl库可以读取Excel文件，并将其加载到内存中以进行后续操作。定位要操作的工作表：使用workbook[&#39;Sheet1&#39;]语句，我们选择要操作的具体工作表。这里假设工作表的名称为&#34;Sheet1&#34;。删除切片：调用delete_slices方法，可以删除工作表中的所有切片。保存修改后的Excel文件：使用save方法将修改后的Excel文件保存到硬盘上。这样可以确保我们对切片的删除操作得以保存。 openpyxl库是一个强大的Python库，它允许我们处理Excel文件的各种操作。在删除切片的底层实现中，openpyxl库会解析Excel文件的结构，并找到切片相关的数据及其位置信息。然后，它会对这些数据进行相应的删除操作，并将修改后的数据重新写入到Excel文件中。
需要注意的是，openpyxl库只能操作XLSX格式的Excel文件，无法处理旧版本（.xls）的Excel文件。
代码如下： import pandas as pd import openpyxl # 读取Excel文件 df = pd.read_excel(&#39;筛选后文件.xlsx&#39;) # 获取要遍历的列号，假设列号为4（第5列） column_num = 4 start_row = None end_row = None # 标记变量 flag_A = False flag_B = False # 保存要删除的行索引 rows_to_delete = [] # 遍历指定列的数据 for index, value in df.iloc[:, column_num].items(): if value == &#39;执行机构类型&#39;: # 获取坐标 cell = df." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/62dc38fc82db3bcb589fbafef4d0fbd2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-16T11:25:33+08:00" />
<meta property="article:modified_time" content="2024-01-16T11:25:33+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python实现Excel切片删除功能（附源码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="PythonExcel_0"></a>使用Python实现Excel中的“切片删除”功能（附源码）</h2> 
<h4><a id="_2"></a>先上效果图！！！</h4> 
<blockquote> 
 <p>如下是需要处理的Excel文件，可以看到在2<strong>7行和117行处的E列</strong>存在数据不一致情况，需进行“<strong>切片删除</strong>”<br> <img src="https://images2.imgbox.com/11/d1/5qgIRvbb_o.png" alt="在这里插入图片描述"><br> 运行结果图如下：<br> <img src="https://images2.imgbox.com/82/95/k5G4KIA9_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/8f/0d/gUgAfEcB_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<blockquote> 
 <p>我们可以发现，<strong>E列27行至117行</strong>处的不一致数据已经被删除，即实现了在Excel文件内部进行进行**“切片化”**的数据删除操作！！！</p> 
</blockquote> 
<h5><a id="_12"></a>什么是“切片删除”？</h5> 
<p>在<strong>Excel</strong>中，切片是一种<strong>数据筛选</strong>工具，它允许您以<strong>交互</strong>的方式对数据进行<strong>过滤和分析</strong>。切片删除功能是指删除已创建的切片。</p> 
<p>要删除切片，您可以按照以下步骤操作：</p> 
<ol><li>在Excel工作表中，单击任意一个包含切片的单元格。</li><li>在“切片工具”选项卡上，选择“切片操作”组中的“删除”按钮。或者，您可以右键单击切片，然后选择“删除”。</li></ol> 
<p>删除切片后，相关的切片将从工作表中移除。注意，这不会影响数据本身，只是移除了用于筛选数据的切片控件。请注意，切片删除功能只适用于Excel 2013及更高版本。在较早的版本中，删除切片的步骤可能略有不同，但大致思路是一样的。</p> 
<h4><a id="PythonExcel_23"></a>如何使用Python进行批量Excel数据文件的切片删除功能？</h4> 
<p><code>delete_slices</code>方法是openpyxl库提供的一个函数，用于删除Excel工作表中的切片。</p> 
<p><strong>底层原理</strong>涉及以下几个步骤：</p> 
<ol><li>openpyxl库加载Excel文件：通过调用<code>load_workbook</code>函数，openpyxl库可以读取Excel文件，并将其加载到内存中以进行后续操作。</li><li>定位要操作的工作表：使用<code>workbook['Sheet1']</code>语句，我们选择要操作的具体工作表。这里假设工作表的名称为"Sheet1"。</li><li>删除切片：调用<code>delete_slices</code>方法，可以删除工作表中的所有切片。</li><li>保存修改后的Excel文件：使用<code>save</code>方法将修改后的Excel文件保存到硬盘上。这样可以确保我们对切片的删除操作得以保存。</li></ol> 
<p>openpyxl库是一个强大的Python库，它允许我们处理Excel文件的各种操作。在删除切片的底层实现中，openpyxl库会解析Excel文件的结构，并找到切片相关的数据及其位置信息。然后，它会对这些数据进行相应的删除操作，并将修改后的数据重新写入到Excel文件中。</p> 
<blockquote> 
 <p>需要注意的是，openpyxl库<strong>只能操作XLSX格式</strong>的Excel文件，无法处理旧版本（.xls）的Excel文件。</p> 
</blockquote> 
<h4><a id="_38"></a>代码如下：</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> openpyxl

<span class="token comment"># 读取Excel文件</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'筛选后文件.xlsx'</span><span class="token punctuation">)</span>

<span class="token comment"># 获取要遍历的列号，假设列号为4（第5列）</span>
column_num <span class="token operator">=</span> <span class="token number">4</span>

start_row <span class="token operator">=</span> <span class="token boolean">None</span>
end_row <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment"># 标记变量</span>
flag_A <span class="token operator">=</span> <span class="token boolean">False</span>
flag_B <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token comment"># 保存要删除的行索引</span>
rows_to_delete <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment"># 遍历指定列的数据</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token keyword">in</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column_num<span class="token punctuation">]</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> value <span class="token operator">==</span> <span class="token string">'执行机构类型'</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取坐标</span>
        cell <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column_num<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
        start_row <span class="token operator">=</span> cell <span class="token operator">+</span> <span class="token number">2</span>  <span class="token comment"># 行索引从0开始，所以需要加1</span>
        flag_A <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">elif</span> value <span class="token operator">==</span> <span class="token string">'IO接口类型'</span><span class="token punctuation">:</span>
        <span class="token comment"># 获取坐标</span>
        cell <span class="token operator">=</span> df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> column_num<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
        end_row <span class="token operator">=</span> cell <span class="token operator">+</span> <span class="token number">2</span>  <span class="token comment"># 行索引从0开始，所以需要加1</span>
        flag_B <span class="token operator">=</span> <span class="token boolean">True</span>

    <span class="token keyword">if</span> flag_A <span class="token keyword">and</span> <span class="token keyword">not</span> flag_B<span class="token punctuation">:</span>
        <span class="token comment"># 添加要删除的行索引</span>
        rows_to_delete<span class="token punctuation">.</span>append<span class="token punctuation">(</span>index<span class="token punctuation">)</span>

    <span class="token keyword">if</span> flag_A <span class="token keyword">and</span> flag_B<span class="token punctuation">:</span>
        <span class="token keyword">break</span>  <span class="token comment"># 找到目标字段后跳出循环</span>

<span class="token comment"># 删除行数据</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>rows_to_delete<span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 输出行号信息</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"执行机构类型行号: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>start_row<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"IO接口类型行号: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>end_row<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># 加载Excel文件</span>
wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">'筛选后文件.xlsx'</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span>active

<span class="token comment"># 删除E30到E950之间的数据</span>
column_num <span class="token operator">=</span> <span class="token number">4</span>  <span class="token comment"># E列的列号为5</span>

<span class="token comment"># 将右侧数据整体左移一列</span>
<span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start_row<span class="token punctuation">,</span> end_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>column_num<span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_column<span class="token punctuation">)</span><span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>r<span class="token punctuation">,</span> column<span class="token operator">=</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>r<span class="token punctuation">,</span> column<span class="token operator">=</span>c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>r<span class="token punctuation">,</span> column<span class="token operator">=</span>c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment"># 删除第5列（E列）</span>
sheet<span class="token punctuation">.</span>delete_cols<span class="token punctuation">(</span>column_num<span class="token punctuation">)</span>
wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'output.xlsx'</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/847a7d9104f1eae7e9cb7e3af1e8e7a5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【论文阅读】（2023）Lower and Upper Bounding Procedures for the Bin Packing Problem with Concave Loading...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c0f3be3816782ebc75e629e4c9bf4f54/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">VitePress搭建技术文档</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>