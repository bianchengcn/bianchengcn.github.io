<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Java网络编程入门 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Java网络编程入门" />
<meta property="og:description" content="网络编程是对信息的发送和接收处理。
目录 一、基础点二、TCP三、UDP 一、基础点 * * 网络编程概述 * Java中提供网络类库，可以实现网络连接，底层由JVM控制，且Java实现跨平台的网络库 * 程序员所面对的是一个统一的网络编程环境 * 计算机网络：把分布在不同地理区域的计算机和专门的外部设备用通信线路互连成一个规模大、 * 功能强的网络系统，从而使得众多的计算机和外部设备能互相传递信息、共享硬件、软件和数据资源等 * 网络编程目的：直接或间接的通过网络协议与其他计算机实现数据交换，进行通信 * 主要两个问题：1 如何准确的定位网络的一台和多台主机，且定位主机上特定的应用 * 2 找到主机后如何可靠高效的进行数据传输 * 网络通信 * 通信双方地址：1 IP 2 端口号 * 一定的规则（网络通信协议） * 3 OSI参考模型 * 4 TCP/IP参考模型（TCP/IP协议）：国际标准 * 通信要素1 ：IP地址 * -- 唯一的标识Internet上的计算机（通信实体） * -- 本地回环地址（hostAddress）:127.0.0.1 主机名（hostName）：localhost * -- 分类方式1：IPV4和IPV6 * IPV4：4个字节组成，4个0-255.大概42亿个地址，30亿都在北美？亚洲4亿。2011年初已经用完。 * 以点分十进制表示，如192.168.0.1 * IPV6: 128位（16个字节）。写成8个无符号整数，每个整数用四个十六进制表示，数之间用 ：隔开 * 如 3ffe:3201:1401:1280:c8ff:fe4d:db39:1984 * -- 分类方式2: 公网地址（万维网使用）和私有地址（局域网） * 192.168.开头的是私有地址，范围192.168.0.0 - 192." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/7a1414e1292f6182295284ee4b8bf489/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-05T22:08:18+08:00" />
<meta property="article:modified_time" content="2021-06-05T22:08:18+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Java网络编程入门</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><font color="#999AAA">网络编程是对信息的发送和接收处理。</font></p> 
<hr color="#000000" size='1"'> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">一、基础点</a></li><li><a href="#TCP_171" rel="nofollow">二、TCP</a></li><li><a href="#UDP_343" rel="nofollow">三、UDP</a></li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_6"></a>一、基础点</h2> 
<hr> 
<pre><code class="prism language-java"><span class="token operator">*</span>
<span class="token operator">*</span> 网络编程概述
<span class="token operator">*</span>   <span class="token class-name">Java</span>中提供网络类库，可以实现网络连接，底层由JVM控制，且<span class="token class-name">Java</span>实现跨平台的网络库
<span class="token operator">*</span>   程序员所面对的是一个统一的网络编程环境
<span class="token operator">*</span> 计算机网络：把分布在不同地理区域的计算机和专门的外部设备用通信线路互连成一个规模大、
<span class="token operator">*</span>   功能强的网络系统，从而使得众多的计算机和外部设备能互相传递信息、共享硬件、软件和数据资源等
<span class="token operator">*</span> 网络编程目的：直接或间接的通过网络协议与其他计算机实现数据交换，进行通信
<span class="token operator">*</span>   主要两个问题：<span class="token number">1</span> 如何准确的定位网络的一台和多台主机，且定位主机上特定的应用
<span class="token operator">*</span>              <span class="token number">2</span> 找到主机后如何可靠高效的进行数据传输
<span class="token operator">*</span> 网络通信
<span class="token operator">*</span>   通信双方地址：<span class="token number">1</span> IP <span class="token number">2</span> 端口号
<span class="token operator">*</span>   一定的规则（网络通信协议）
<span class="token operator">*</span>       <span class="token number">3</span> OSI参考模型
<span class="token operator">*</span>       <span class="token number">4</span> TCP<span class="token operator">/</span>IP参考模型（TCP<span class="token operator">/</span>IP协议）：国际标准
<span class="token operator">*</span>   通信要素<span class="token number">1</span> ：IP地址
<span class="token operator">*</span>       <span class="token operator">--</span> 唯一的标识<span class="token class-name">Internet</span>上的计算机（通信实体）
<span class="token operator">*</span>       <span class="token operator">--</span> 本地回环地址（hostAddress）<span class="token operator">:</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> 主机名（hostName）：localhost
<span class="token operator">*</span>       <span class="token operator">--</span> 分类方式<span class="token number">1</span>：IPV4和IPV6
<span class="token operator">*</span>           IPV4：<span class="token number">4</span>个字节组成，<span class="token number">4</span>个<span class="token number">0</span><span class="token operator">-</span><span class="token number">255.</span>大概<span class="token number">42</span>亿个地址，<span class="token number">30</span>亿都在北美？亚洲<span class="token number">4</span>亿。<span class="token number">2011</span>年初已经用完。
<span class="token operator">*</span>               以点分十进制表示，如<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token operator">*</span>           IPV6<span class="token operator">:</span> <span class="token number">128</span>位（<span class="token number">16</span>个字节）。写成<span class="token number">8</span>个无符号整数，每个整数用四个十六进制表示，数之间用 ：隔开
<span class="token operator">*</span>               如 <span class="token number">3f</span>fe<span class="token operator">:</span><span class="token number">3201</span><span class="token operator">:</span><span class="token number">1401</span><span class="token operator">:</span><span class="token number">1280</span><span class="token operator">:</span>c8ff<span class="token operator">:</span>fe4d<span class="token operator">:</span>db39<span class="token operator">:</span><span class="token number">1984</span>
<span class="token operator">*</span>       <span class="token operator">--</span> 分类方式<span class="token number">2</span><span class="token operator">:</span> 公网地址（万维网使用）和私有地址（局域网）
<span class="token operator">*</span>           <span class="token number">192.168</span><span class="token punctuation">.</span>开头的是私有地址，范围<span class="token number">192.168</span><span class="token number">.0</span><span class="token number">.0</span> <span class="token operator">-</span> <span class="token number">192.168</span><span class="token number">.255</span><span class="token number">.255</span>，为组织机构内部使用
<span class="token operator">*</span>   通信要素<span class="token number">2</span> ：端口号
<span class="token operator">*</span>     端口号标识正在计算机上运行的进程（程序）
<span class="token operator">*</span>       <span class="token operator">--</span> 不同的进程有不同的端口号
<span class="token operator">*</span>       <span class="token operator">--</span> 规定为<span class="token number">16</span>位的整数 <span class="token number">0</span><span class="token operator">~</span><span class="token number">65535</span>
<span class="token operator">*</span>       <span class="token operator">--</span> 端口分类
<span class="token operator">*</span>           公认端口：<span class="token number">0</span><span class="token operator">~</span><span class="token number">1023</span>。被预先定义的服务通信占用（如HTTP占用端口<span class="token number">80</span>，FTP占用<span class="token number">21</span>，<span class="token class-name">Telnet</span>占用<span class="token number">23</span>）
<span class="token operator">*</span>           注册端口：<span class="token number">1024</span><span class="token operator">~</span><span class="token number">49151</span>。分配给用户进程或应用进程
<span class="token operator">*</span>               如（<span class="token class-name">Tomcat</span>占用端口<span class="token number">8080</span>，<span class="token class-name">MySQL</span>占用<span class="token number">3306</span>，<span class="token class-name">Oracle</span>占用<span class="token number">1521</span>等）
<span class="token operator">*</span>           动态<span class="token operator">/</span>私有端口：<span class="token number">49152</span><span class="token operator">~</span><span class="token number">65535</span>
<span class="token operator">*</span>     端口号和IP地址组合得出一个网络接口：<span class="token class-name">Socket</span>
<span class="token operator">*</span>
<span class="token operator">*</span> 网络协议
<span class="token operator">*</span>   TCP<span class="token operator">/</span>IP协议 传输控制协议TCP、网络互联协议IP，是一组协议包括多个具有不同功能且互关联的协议
<span class="token operator">*</span>       IP协议是网络层的主要协议，支持网络件互连的数据通信
<span class="token operator">*</span>       TCP<span class="token operator">/</span>IP协议模型从实用角度出发，形成高效的四层体系结构，即数据链路层、IP层、传输层和应用层
<span class="token operator">*</span>       TCP三次握手：为了对每次发送的数据进行跟踪和协商，确保数据段的发送和接收同步，根据
<span class="token operator">*</span> 			所接收到的数据量确认数据发送、接收完毕后何时撤销联系，并建立虚连接，
<span class="token operator">*</span>           防止历史连接初始化了连接。TCP建立连接是三次握手，连接终止是四次握手
<span class="token operator">*</span>        第一次：建议连接时，客户端发送SYN包（seq<span class="token operator">=</span>x）到服务器，并进入SYN_SENT状态，
<span class="token operator">*</span> 				等待服务器确认。SYN（同步序列编号）
<span class="token operator">*</span>        第二次：服务器收到SYN包，必须确认客户端的SYN（ACK<span class="token operator">=</span>x<span class="token operator">+</span><span class="token number">1</span>），同时自己发送一个SYN包（seq<span class="token operator">=</span>k）
<span class="token operator">*</span>           即SYN<span class="token operator">+</span>ACK包，此时服务器进入SYN_RECV状态
<span class="token operator">*</span>        第三次：客户端收到服务器的SYN<span class="token operator">+</span>ACK包，向服务器发送确认包（ACK<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span>），此包发送完毕，
<span class="token operator">*</span> 				客户端和服务器进入ESTABLISHED
<span class="token operator">*</span>           （TCP）连接成功，完成三次握手
<span class="token operator">*</span>       TCP终止连接时四次挥手
<span class="token operator">*</span>          <span class="token number">1</span> 客户端在发送最后一条数据时，给予数据标记FIN，告诉服务器，我将要断开连接了
<span class="token operator">*</span>          <span class="token number">2</span> 服务器收到FIN请求后，并不立即用FIN报文段回复客户端，而是先向客户端发送确
<span class="token operator">*</span> 				认序号ACK，同时通知自己相应的应用程序
<span class="token operator">*</span>            ：对方请求关闭连接（先发生ACK是为了防止这段时间客服端重传FIN报文段）。相当于
<span class="token operator">*</span> 				回复客服端：请暂时别断开连接，待我告知服务器端应用程序，并处理
<span class="token operator">*</span>          <span class="token number">3</span> 服务器的应用程序接收到消息，进行相应的处理，回复可以关闭。此时服务器向客户端
<span class="token operator">*</span> 				发送FIN报文段
<span class="token operator">*</span>          <span class="token number">4</span> 客户端收到FIN报文段，向服务器发送ACK表示彻底断开连接
<span class="token operator">*</span>   <span class="token class-name">Socket</span>
<span class="token operator">*</span>       网络上具有唯一标识的IP地址和端口号组合在一起才能构成唯一能识别的 标识符 套接字（<span class="token class-name">Socket</span>）
<span class="token operator">*</span>       通信两端都需要有<span class="token class-name">Socket</span>，是两台机器通信的端点
<span class="token operator">*</span>       网络通信其实就是<span class="token class-name">Socket</span>之间的通信
<span class="token operator">*</span>       <span class="token class-name">Socket</span>允许程序把网络当成一个流，数据在两个<span class="token class-name">Socket</span>之间通过IO传输
<span class="token operator">*</span>       一般主动发起通信的应用程序属于客户端，等待通信请求的位服务端
<span class="token operator">*</span>       分类：stream socket：使用TCP提供可依赖的字节流服务数据报套接字
<span class="token operator">*</span>           datagram socket：使用UDP提供“尽力而为”的数据报服务
<span class="token operator">*</span>   常用方法：
<span class="token operator">*</span>       <span class="token class-name">Socket</span>类的常用构造器
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token class-name">InetAddress</span> address<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span><span class="token punctuation">,</span>创建一个流套接字将其连接到指定
<span class="token operator">*</span> 				IP地址的端口号
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token class-name">String</span> host<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span>，创建一个流套接字将其连接到指定主机上的端口号
<span class="token operator">*</span>       <span class="token class-name">Socket</span>类的常用方法
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回套接字的输入流，用于接收网络消息
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">OutputStream</span> <span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回套接字的输出流，用于发送网络消息
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 套接字连接的远程IP地址。如果未连接，返回<span class="token keyword">null</span>
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getLocalAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取套接字绑定的本地地址。即本地IP地址
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取此套接字连接到的远程端口号，如果尚未连接，返回<span class="token number">0</span>
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getLocalPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取此套接字连接到的本地端口号，如果尚未绑定，返回<span class="token operator">-</span><span class="token number">1</span>
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 关闭套接字。关闭后，需要重新绑定才能使用。关闭套接字也会
<span class="token operator">*</span> 				关闭该套接字的<span class="token class-name">InputStream</span>和<span class="token class-name">OutputStream</span>
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">shutdownInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 关闭该套接字的输入流。即不能在从该套接字的输入流
<span class="token operator">*</span> 				中接受任何数据
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">shutdownOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 禁止关闭套接字的输出流。对于TCP套接字，任何以
<span class="token operator">*</span> 				前写入的数据都将被发送，并且后跟TCP的正常连接终止序列。如果关闭输出流后写
<span class="token operator">*</span> 				入数据，则该流将抛出<span class="token class-name">IOException</span>。既不能通过此套接字的输出流发送数据
<span class="token operator">*</span>   客户端
<span class="token operator">*</span>       客户端<span class="token class-name">Socket</span>的工作过程包括以下四个步骤
<span class="token operator">*</span>       <span class="token number">1</span> 创建<span class="token class-name">Socket</span>：根据指定服务端的IP地址或端口号构造<span class="token class-name">Socket</span>类对象。若服务端响应，则建立
<span class="token operator">*</span> 			客户端到服务端的通信线路若连接失败，会出现异常
<span class="token operator">*</span>       <span class="token number">2</span> 打开连接到<span class="token class-name">Socket</span>的输入<span class="token operator">/</span>输出流进行数据传输：<span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">*</span>       <span class="token number">3</span> 按照一定的协议对<span class="token class-name">Socket</span>进行读写操作：通过输入流度服务器放入线路的信息（但不能读自
<span class="token operator">*</span> 			己放入线路的信息）通过输出流将信息写入线程
<span class="token operator">*</span>       <span class="token number">4</span> 关闭<span class="token class-name">Socket</span>：断开客户端到服务器的连接，释放线路
<span class="token operator">*</span>       客户端程序可以使用<span class="token class-name">Socket</span>类创建对象，创建的同时会自动向服务器方发起连接
<span class="token operator">*</span>       <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token class-name">String</span> host<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> ：
<span class="token operator">*</span>           向服务器（域名是host，端口是port）发起TCP连接，连接成功则创建对象
<span class="token operator">*</span>       <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token class-name">InetAddress</span> address<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> ：
<span class="token operator">*</span>           根据<span class="token class-name">InetAddress</span>对象所表示的IP地址以及端口号port发起连接
<span class="token operator">*</span>       	客户端建立socketAtClient对象的过程就是向服务器发出套接字连接请求
<span class="token operator">*</span>   服务端
<span class="token operator">*</span>       服务端程序<span class="token class-name">Socket</span>的工作过程包括以下四个步骤
<span class="token operator">*</span>       <span class="token number">1</span> 调用<span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span><span class="token operator">:</span> 创建一个服务端套接字，并绑定到指定端口上，用于监听
<span class="token operator">*</span> 			客户端请求
<span class="token operator">*</span>       <span class="token number">2</span> 调用<span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 监听连接请求，如果客户端请求连接，则接收此连接，返回通信套接字对象
<span class="token operator">*</span>       <span class="token number">3</span> 调用 该<span class="token class-name">Socket</span>类对象的 <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，开始网络数据的发送和接收
<span class="token operator">*</span>       <span class="token number">4</span> 关闭<span class="token class-name">ServerSocket</span>，客户端访问结束，关闭通信套接字
<span class="token operator">*</span>       <span class="token class-name">ServerSocket</span>对象负责等待客户端请求建立套接字连接
<span class="token operator">*</span>
<span class="token operator">*</span>   UDP：称为用户数据报协议（UDP，<span class="token class-name">User</span> <span class="token class-name">Datagram</span> <span class="token class-name">Protocol</span>）
<span class="token operator">*</span>       UDP 为应用程序提供了一种无需建立连接就可以发送封装的 IP 数据包的方法
<span class="token operator">*</span>       UDP提供了无连接通信，且不对传送数据包进行可靠性保证，适合于一次传输少量数据，UDP传输
<span class="token operator">*</span> 			的可靠性由应用层负责
<span class="token operator">*</span>       <span class="token class-name">Java</span>中类<span class="token class-name">DatagramSocket</span>和<span class="token class-name">DatagramPacket</span>实现了基于UDP协议网络程序
<span class="token operator">*</span>       UDP数据报通过数据报套接字<span class="token class-name">DatagramSocket</span>发送和接收，系统不保证UDP数据报一定能安全送
<span class="token operator">*</span> 			到目的地，也不确定何时送达
<span class="token operator">*</span>       <span class="token class-name">DatagramPacket</span>对象封装了UDP数据报，在数据报中包含了发送端的IP地址和端口号以及接收
<span class="token operator">*</span> 			端的IP地址和端口号
<span class="token operator">*</span>       UDP协议中每个数据报都给出了完整的地址信息，无需建立发送方和接收方的连接。如同发快递包裹
<span class="token operator">*</span>       <span class="token class-name">DatagramSocket</span> 类中常用方法
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">)</span><span class="token operator">:</span> 创建数据报套接字，并绑定本地主机上的指定端口
<span class="token operator">*</span>               套接字被绑定到通配符地址，IP地址由内核决定
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token keyword">int</span> port<span class="token punctuation">,</span><span class="token class-name">InetAddress</span> addre<span class="token punctuation">)</span><span class="token operator">:</span> 创建数据报套接字，并绑定
<span class="token operator">*</span> 				本地地址。本地端口必须在<span class="token number">0</span><span class="token operator">~</span><span class="token number">65535</span>之间（包括关系）。如果IP地址为<span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.0</span>，套接
<span class="token operator">*</span> 				字将被绑定到。通配符地址，IP地址由内核决定
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 关闭此数据报套接字
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">DatagramPacket</span> p<span class="token punctuation">)</span><span class="token operator">:</span> 从此套接字发送数据包。<span class="token class-name">DatagramPacket</span>包
<span class="token operator">*</span> 				含的信息指示：将要发送的数据、其长度、远程主机的IP地址和端口号
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">DatagramPacket</span> p<span class="token punctuation">)</span><span class="token operator">:</span> 从此套接字接收数据包。
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getLocalAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取套接字绑定的本地主机地址。
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getLocalPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取此套接字绑定的本地主机端口号
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 套接字连接的地址。如果未连接，返回<span class="token keyword">null</span>
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 获取此套接字连接到的远程端口号，如果尚未连接，返回<span class="token operator">-</span><span class="token number">1</span>
<span class="token operator">*</span>      <span class="token class-name">DatagramPacket</span> 类中常用方法
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span><span class="token class-name">Byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span><span class="token operator">:</span> 构造<span class="token class-name">DatagramPacket</span>，用来接
<span class="token operator">*</span>               收长度为length的数据包，length参数必须小于等于buf<span class="token punctuation">.</span>length
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span><span class="token class-name">Byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">,</span> <span class="token class-name">InetAddress</span> address<span class="token punctuation">,</span> <span class="token keyword">int</span> port<span class="token punctuation">)</span><span class="token operator">:</span>
 <span class="token operator">*</span>              构造数据包，将长度为length的包发送到指定主机上的指定端口号。
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token class-name">InetAddress</span> <span class="token function">getInetAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回某台远程主机的IP地址
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回某台远程主机的端口号，此数据报是将要发往该主机的或
<span class="token operator">*</span> 				从该主机接接收的
 <span class="token operator">*</span>          <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回数据缓冲区
<span class="token operator">*</span>           <span class="token keyword">public</span> <span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> 返回将要发送或接收到的数据的长度
<span class="token operator">*</span>
<span class="token operator">*</span> OSI七层
<span class="token operator">*</span>     应用层：是网络向用户提供服务的窗口，主要用来支持用户的需求，人的需求 不同，应用层奇数也就不同
<span class="token operator">*</span>         提供了多种应用服务：电子邮件<span class="token punctuation">(</span>MHS<span class="token punctuation">)</span>、文件传输<span class="token punctuation">(</span>FTAM<span class="token punctuation">)</span>、虚拟终端<span class="token punctuation">(</span>VT<span class="token punctuation">)</span>、电子数据交换<span class="token punctuation">(</span>EDI<span class="token punctuation">)</span>等
<span class="token operator">*</span>         主要协议：<span class="token function">FTP</span><span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token function">SMTP</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span> DNS<span class="token punctuation">.</span><span class="token function">HTTP</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span>
<span class="token operator">*</span>     表示层：为通信提供一种公共的语言，方便交互，不同计算机系统结构使用的数据表示不同
<span class="token operator">*</span>         如：IBM主机使用的是EBCDIC编码，而大部分PC使用ASCII编码
<span class="token operator">*</span>         其他功能如：数据加密、数据压缩等
<span class="token operator">*</span>     会话层：提供的服务可以使应用建立和维持会话，且能使会话同步
<span class="token operator">*</span>     传输层：两个计算机通过网络进行数据传输时，是端到端的，具有缓冲作用
<span class="token operator">*</span>         协议：TCP<span class="token operator">/</span>UDP
<span class="token operator">*</span>     数据链路层：可以理解为数据通道
<span class="token operator">*</span>         MAC地址表示唯一性
<span class="token operator">*</span>     物理层：为数据端设备提供传输数据的通路， 数据通路可以是一个物理媒体，可以是多个物理媒
<span class="token operator">*</span> 			体链接而成。（比特流传输）
<span class="token operator">*</span>     网络层：IP，以IP报文形式进行数据传入
<span class="token operator">*</span> <span class="token operator">*</span><span class="token operator">/</span>
</code></pre> 
<hr> 
<h2><a id="TCP_171"></a>二、TCP</h2> 
<hr> 
<pre><code class="prism language-java"><span class="token operator">*</span>
<span class="token operator">*</span> rt<span class="token punctuation">.</span>jar 下的java<span class="token operator">/</span>net下 的类，是网络编程
<span class="token operator">*</span> 网络架构：<span class="token class-name">B</span><span class="token operator">/</span><span class="token class-name">S</span>和<span class="token class-name">C</span><span class="token operator">/</span><span class="token class-name">S</span>
<span class="token operator">*</span>   <span class="token class-name">B</span><span class="token operator">/</span><span class="token class-name">S</span>：<span class="token class-name">Browser</span><span class="token operator">/</span><span class="token class-name">Server</span>，基于浏览器的，比如网页版淘宝
<span class="token operator">*</span>   <span class="token class-name">C</span><span class="token operator">/</span><span class="token class-name">S</span>：<span class="token class-name">Client</span><span class="token operator">/</span><span class="token class-name">Server</span>，基于客户端，如果手机APP或者PC端应用程序淘宝
<span class="token operator">*</span> TCP<span class="token operator">:</span>
<span class="token operator">*</span>   能重传，不丢包，如果丢失会记录，重新发送
<span class="token operator">*</span>   可靠
<span class="token operator">*</span>   有序，顺序不会错，不如向服务端发送<span class="token number">123</span><span class="token punctuation">,</span><span class="token number">2</span>丢失了，那你接受的可能是<span class="token number">132</span>。但收到的一定是<span class="token number">123</span>
<span class="token operator">*</span>   面向连接，如果无连接，数据不会发送
<span class="token operator">*</span>   三次握手，可保证数据安全性，能够保证数据交互
<span class="token operator">*</span>   相当于打电话，只有电话接通了才能传输信息
<span class="token operator">*</span> UDP：
<span class="token operator">*</span>   速度快
<span class="token operator">*</span>   不保证可靠
<span class="token operator">*</span>   可能丢包
<span class="token operator">*</span>   无连接
<span class="token operator">*</span>   相当于发短信，不管是否收到，发过去就行
<span class="token operator">*</span> <span class="token operator">*</span><span class="token operator">/</span>
</code></pre> 
<hr> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> _02_TcpClient <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 单次连接
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建对象，指定IP和端口</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取输入流，用于获取服务端传递的数据</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换为字符流，并指定编码</span>
        <span class="token class-name">InputStreamReader</span> isr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 字符缓冲流</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>isr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> tmp<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tmp<span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 阻塞式接收和发送
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建对象，指定IP和端口</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过输出流向客户端返回数据</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换为字符输出，指定编码utf-8</span>
        <span class="token class-name">OutputStreamWriter</span> osw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>os<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 封装打印流(写出用打印流)</span>
        <span class="token class-name">PrintWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>osw<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 获取输入流，用于获取服务端传递的数据</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换为字符流，并指定编码</span>
        <span class="token class-name">InputStreamReader</span> isr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 字符缓冲流</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>isr<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 控制台输入</span>
        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 发送服务端</span>
            bw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 接收服务端数据</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 控制台输入</span>
            msg <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> _01_TcpServer <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 单次连接
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建对象并开启端口</span>
        <span class="token class-name">ServerSocket</span> serverSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器启动，等待客户端连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 等待客户端连接执行到这里线程会停下来，直到客户端连接成功</span>
        <span class="token comment">// 客户端连接之后，会得到该Socket对象</span>
        <span class="token comment">// 这个Socket可理解为 客户端，包含客户端锁传递的信息</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端已连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过输出流向客户端返回数据</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"你好吗？最近咋样！"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        os<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 先开启的后关闭</span>
        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        serverSocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"连接已关闭"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 阻塞式接收和发送
     * @throws IOException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建对象并开启端口</span>
        <span class="token class-name">ServerSocket</span> serverSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"服务器启动，等待客户端连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 等待客户端连接执行到这里线程会停下来，直到客户端连接成功</span>
        <span class="token comment">// 客户端连接之后，会得到该Socket对象</span>
        <span class="token comment">// 这个Socket可理解为 客户端，包含客户端锁传递的信息</span>
        <span class="token class-name">Socket</span> socket <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端已连接"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过输出流向客户端返回数据</span>
        <span class="token class-name">OutputStream</span> os <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 转换为字符输出，指定编码utf-8</span>
        <span class="token class-name">OutputStreamWriter</span> osw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>os<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 封装缓冲流</span>
        <span class="token class-name">PrintWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span>osw<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 接收数据，用输入流</span>
        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStreamReader</span> isr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>isr<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 读数据</span>
        <span class="token class-name">String</span> tmp<span class="token punctuation">;</span>
        <span class="token comment">// 阻塞式接收和发送</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tmp<span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"客户端发来信息："</span><span class="token operator">+</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"您给服务端发送的数据为："</span><span class="token operator">+</span>tmp<span class="token operator">+</span><span class="token string">"。服务端以收到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 先开启的后关闭</span>
        bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        serverSocket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"连接已关闭"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h2><a id="UDP_343"></a>三、UDP</h2> 
<hr> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> _02_UdpClient <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 一次发送
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 发送数据</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">"你好！"</span><span class="token punctuation">;</span>
        <span class="token comment">// 字节数字输出流, 这一块相当于数据包装</span>
        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataOutputStream</span> dos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataOutputStream</span><span class="token punctuation">(</span>baos<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 写数据到baos</span>
        dos<span class="token punctuation">.</span><span class="token function">writeUTF</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 把baos转换为字节数组</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// System.out.println(new String(buf));</span>

        <span class="token comment">// 发送的数据包，大小限制为64k，绑定地址</span>
        <span class="token class-name">DatagramPacket</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span>
                buf<span class="token punctuation">,</span> buf<span class="token punctuation">.</span>length<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">InetSocketAddress</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 发送，需要通过电脑中一个端口发出去</span>
        <span class="token class-name">DatagramSocket</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通信</span>
        <span class="token comment">// 发送dp数据包</span>
        ds<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ds<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 持续发送
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 发送数据</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入需要传递的信息："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        str <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>str<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 字节数字输出流, 这一块相当于数据包装</span>
            <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">DataOutputStream</span> dos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataOutputStream</span><span class="token punctuation">(</span>baos<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 写数据到baos</span>
            dos<span class="token punctuation">.</span><span class="token function">writeUTF</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 把baos转换为字节数组</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// System.out.println(new String(buf));</span>

            <span class="token comment">// 发送的数据包，大小限制为64k，绑定地址</span>
            <span class="token class-name">DatagramPacket</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span>
                    buf<span class="token punctuation">,</span> buf<span class="token punctuation">.</span>length<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">InetSocketAddress</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 发送，需要通过电脑中一个端口发出去</span>
            <span class="token class-name">DatagramSocket</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通信</span>

            <span class="token comment">// 发送dp数据包</span>
            ds<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ds<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 如果输入exit，退出客户端</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// 循环输入</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"请输入需要传递的信息："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            str <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> _01_UdpServer <span class="token punctuation">{<!-- --></span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 打开UDP对象</span>
        <span class="token class-name">DatagramSocket</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramSocket</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 声明一个字节数字，用来存放收到的数据</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// 包接收器，把接收到的数据存放在byte数组中</span>
        <span class="token class-name">DatagramPacket</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DatagramPacket</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span>buf<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 阻塞式接收</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 监听接收</span>
            ds<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 字节数组输入流</span>
            <span class="token class-name">ByteArrayInputStream</span> bais <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 转换为数据流</span>
            <span class="token class-name">DataInputStream</span> dis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataInputStream</span><span class="token punctuation">(</span>bais<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 数据读取</span>
            <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            msg <span class="token operator">=</span> dis<span class="token punctuation">.</span><span class="token function">readUTF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 如果收到exit 则退出服务端</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">equalsIgnoreCase</span><span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/281fa9fb9f549faa51610c7692146089/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">kubernetes-2-搭建k8s集群</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6f5d73af4c787c17d7e9f572317feab8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【每日选择题】11~20天做选择题汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>