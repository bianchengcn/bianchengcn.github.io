<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>MyBatis入门详解 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MyBatis入门详解" />
<meta property="og:description" content="本期简绍MyBatis相关内容~
目录
1.mybatis相关介绍
1.1什么是mybatis
1.2为什么要学mybatis
2.mybatis实战操作
2.1项目创建
2.1.1准备数据表
2.1.2创建一个mybatis项目
2.2使用mybatis进行增删查改操作
2.2.1查询操作
2.2.2使用springboot进行单元测试介绍
2.2.3修改操作
2.2.4删除操作
2.2.5增添操作
1.mybatis相关介绍 1.1什么是mybatis MyBatis消除了几乎所有的JDBC代码和参数的手工设置以及对结果集的检索封装。MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录。
1.2为什么要学mybatis 因为对于后端开发来说，程序主要是由后端程序和数据库两部分来组成的。而这两个部分要进行通讯，就需要有连接数据库的工具，前面我们已经学过了JDBC，但正是因为JDBC相对于MyBatis太过繁琐，所以我们就要开始学习MyBatis。
2.mybatis实战操作 2.1项目创建 2.1.1准备数据表 ①创建一个如下的数据库和数据表：
-- 创建数据库 drop database if exists mycnblog; create database mycnblog DEFAULT CHARACTER SET utf8mb4; -- 使用数据数据 use mycnblog; -- 创建表[用户表] drop table if exists userinfo; create table userinfo( id int primary key auto_increment, username varchar(100) not null, password varchar(32) not null, photo varchar(500) default &#39;default." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/fbf56a094b77ebe2a2da91f5e2b26848/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-01T20:06:13+08:00" />
<meta property="article:modified_time" content="2022-11-01T20:06:13+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MyBatis入门详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="317" src="https://images2.imgbox.com/44/25/fwtWjNGz_o.png" width="315"></p> 
<p><span style="color:#fe2c24;"> 本</span><span style="color:#ff9900;">期</span><span style="color:#ffd900;">简</span><span style="color:#a2e043;">绍</span><span style="color:#38d8f0;">M</span><span style="color:#4da8ee;">y</span><span style="color:#956fe7;">B</span><span style="color:#7b7f82;">a</span><span style="color:#494949;">ti</span><span style="color:#ed7976;">s</span><span style="color:#faa572;">相</span><span style="color:#e6b223;">关</span><span style="color:#98c091;">内</span><span style="color:#79c6cd;">容</span><span style="color:#6eaad7;">~</span></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="1.mybatis%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#1.mybatis%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D" rel="nofollow">1.mybatis相关介绍</a></p> 
<p id="1.1%E4%BB%80%E4%B9%88%E6%98%AFmybatis-toc" style="margin-left:40px;"><a href="#1.1%E4%BB%80%E4%B9%88%E6%98%AFmybatis" rel="nofollow">1.1什么是mybatis</a></p> 
<p id="1.2%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6mybatis-toc" style="margin-left:40px;"><a href="#1.2%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6mybatis" rel="nofollow">1.2为什么要学mybatis</a></p> 
<p id="2.mybatis%E5%AE%9E%E6%88%98%E6%93%8D%E4%BD%9C-toc" style="margin-left:0px;"><a href="#2.mybatis%E5%AE%9E%E6%88%98%E6%93%8D%E4%BD%9C" rel="nofollow">2.mybatis实战操作</a></p> 
<p id="2.1%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA-toc" style="margin-left:40px;"><a href="#2.1%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA" rel="nofollow">2.1项目创建</a></p> 
<p id="2.1.1%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A1%A8-toc" style="margin-left:80px;"><a href="#2.1.1%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE%E8%A1%A8" rel="nofollow">2.1.1准备数据表</a></p> 
<p id="2.1.2%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAmybatis%E9%A1%B9%E7%9B%AE-toc" style="margin-left:80px;"><a href="#2.1.2%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAmybatis%E9%A1%B9%E7%9B%AE" rel="nofollow">2.1.2创建一个mybatis项目</a></p> 
<p id="2.2%E4%BD%BF%E7%94%A8mybatis%E8%BF%9B%E8%A1%8C%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E6%93%8D%E4%BD%9C-toc" style="margin-left:40px;"><a href="#2.2%E4%BD%BF%E7%94%A8mybatis%E8%BF%9B%E8%A1%8C%E5%A2%9E%E5%88%A0%E6%9F%A5%E6%94%B9%E6%93%8D%E4%BD%9C" rel="nofollow">2.2使用mybatis进行增删查改操作</a></p> 
<p id="2.2.1%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#2.2.1%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C" rel="nofollow">2.2.1查询操作</a></p> 
<p id="2.2.2%E4%BD%BF%E7%94%A8springboot%E8%BF%9B%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%8B%E7%BB%8D-toc" style="margin-left:80px;"><a href="#2.2.2%E4%BD%BF%E7%94%A8springboot%E8%BF%9B%E8%A1%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%8B%E7%BB%8D" rel="nofollow">2.2.2使用springboot进行单元测试介绍</a></p> 
<p id="2.2.3%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#2.2.3%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C" rel="nofollow">2.2.3修改操作</a></p> 
<p id="2.2.4%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#2.2.4%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C" rel="nofollow">2.2.4删除操作</a></p> 
<p id="2.2.5%E5%A2%9E%E6%B7%BB%E6%93%8D%E4%BD%9C-toc" style="margin-left:80px;"><a href="#2.2.5%E5%A2%9E%E6%B7%BB%E6%93%8D%E4%BD%9C" rel="nofollow">2.2.5增添操作</a></p> 
<hr id="hr-toc"> 
<h2><span style="color:#98c091;">1.mybatis相关介绍</span></h2> 
<h3><span style="color:#98c091;">1.1什么是mybatis</span></h3> 
<blockquote> 
 <p>MyBatis消除了几乎所有的JDBC代码和参数的手工设置以及对结果集的检索封装。MyBatis可以使用简单的XML或注解用于配置和原始映射，将接口和Java的POJO（Plain Old Java Objects，普通的Java对象）映射成数据库中的记录。</p> 
</blockquote> 
<h3><span style="color:#98c091;">1.2为什么要学mybatis</span></h3> 
<blockquote> 
 <p>因为对于后端开发来说，程序主要是由后端程序和数据库两部分来组成的。而这两个部分要进行通讯，就需要有连接数据库的工具，前面我们已经学过了JDBC，但正是因为JDBC相对于MyBatis太过繁琐，所以我们就要开始学习MyBatis。</p> 
</blockquote> 
<h2><span style="color:#98c091;">2.mybatis实战操作</span></h2> 
<h3><span style="color:#98c091;">2.1项目创建</span></h3> 
<h4><span style="color:#98c091;">2.1.1准备数据表</span></h4> 
<blockquote> 
 <p><span style="background-color:#ffd900;">①创建一个如下的数据库和数据表：</span></p> 
 <pre><code class="language-sql">-- 创建数据库
drop database if exists mycnblog;
create database mycnblog DEFAULT CHARACTER SET utf8mb4;

-- 使用数据数据
use mycnblog;

-- 创建表[用户表]
drop table if exists  userinfo;
create table userinfo(
    id int primary key auto_increment,
    username varchar(100) not null,
    password varchar(32) not null,
    photo varchar(500) default 'default.png',
    createtime datetime default now(),
    updatetime datetime default now(),
    `state` int default 1
) default charset 'utf8mb4';

-- 创建文章表
drop table if exists  articleinfo;
create table articleinfo(
    id int primary key auto_increment,
    title varchar(100) not null,
    content text not null,
    createtime datetime default now(),
    updatetime datetime default now(),
    uid int not null,
    rcount int not null default 1,
    `state` int default 1
)default charset 'utf8mb4';

-- 创建视频表
drop table if exists videoinfo;
create table videoinfo(
  	vid int primary key,
  	`title` varchar(250),
  	`url` varchar(1000),
		createtime datetime default now(),
		updatetime datetime default now(),
  	uid int
)default charset 'utf8mb4';

-- 添加一个用户信息
INSERT INTO `mycnblog`.`userinfo` (`id`, `username`, `password`, `photo`, `createtime`, `updatetime`, `state`) VALUES 
(1, 'admin', 'admin', '', '2021-12-06 17:10:48', '2021-12-06 17:10:48', 1);

-- 文章添加测试数据
insert into articleinfo(title,content,uid)
    values('Java','Java正文',1);
    
-- 添加视频
insert into videoinfo(vid,title,url,uid) values(1,'java title','http://www.baidu.com',1);
</code></pre> 
 <p>②将其放在mysql中：</p> 
 <p><img alt="" height="284" src="https://images2.imgbox.com/6d/88/oeCDi2mw_o.png" width="478"></p> 
</blockquote> 
<h4><span style="color:#98c091;">2.1.2创建一个mybatis项目</span></h4> 
<blockquote> 
 <p><span style="color:#494949;"><span style="background-color:#ffd900;">①添加MyBatis相关依赖</span></span></p> 
 <p><span style="color:#494949;"><span style="background-color:#a2e043;">（1）新项目添加MyBatis依赖</span></span></p> 
 <p>1.基于spring项目进行创建：</p> 
 <p>（a）</p> 
 <p><img alt="" height="774" src="https://images2.imgbox.com/a6/38/CVY0H98b_o.png" width="1189"></p> 
 <p>(b) <img alt="" height="984" src="https://images2.imgbox.com/87/24/0DxvaQRl_o.png" width="1163"></p> 
 <p>(c)</p> 
 <p><img alt="" height="999" src="https://images2.imgbox.com/b3/b8/icp5Sdkk_o.png" width="1193"> (d)</p> 
 <p><img alt="" height="1005" src="https://images2.imgbox.com/f1/4b/FGTf4g5A_o.png" width="1196"></p> 
 <p><span style="background-color:#a2e043;"> (2)老项目添加MyBatis：</span></p> 
 <p>我们在pom.xml中点击鼠标右键，然后如下图所示操作</p> 
 <p><img alt="" height="1200" src="https://images2.imgbox.com/d6/09/1pmnJZhc_o.png" width="1200"></p> 
 <p><span style="background-color:#ffd900;"> ②配置数据库连接字符串和MyBatis（保存的xml目录）</span></p> 
 <p><span style="background-color:#a2e043;">（1）配置数据库的连接信息</span></p> 
 <p>1.主配置文件（application.yml）</p> 
 <pre><code class="language-XML">#生产环境的配置文件
spring:
  profiles:
    active: dev</code></pre> 
 <p>2.开发环境配置文件（application-dev.yml）</p> 
 <pre><code class="language-XML">#开发环境的配置文件
#无论是生产环境和开发环境都要配置以下四项
# 配置数据库的连接
spring:
  datasource:
    url: jdbc:mysql://127.0.0.1:3306/mycnblog?characterEncoding=utf8
    username: root   # 用户名（默认是root）
    password: 123456 # 自己的密码
    driver-class-name: com.mysql.cj.jdbc.Driver # mysql的驱动名称
</code></pre> 
 <p>3.当前运行环境配置文件（application-prod.yml）</p> 
 <p>这里先不做配置</p> 
 <p><span style="background-color:#a2e043;">（2）配置MyBatis的xml保存路径</span></p> 
 <p>xml属于资源文件，放于resource目录下。因此我们在resource目录下新建一个mybatis目录文件。</p> 
 <p><img alt="" height="440" src="https://images2.imgbox.com/85/46/ZnTT8bb3_o.png" width="1200"></p> 
 <p> 代码：</p> 
 <pre><code class="language-XML"># 配置当前运行的环境（配置文件）
spring:
  profiles:
    active: dev # 使用开发环境的配置文件
# 配置 MyBatis 的 XML 的保存路径
# 在resource底下新建一个文件夹，用来放 XML
mybatis:
  mapper-locations: classpath:mybatis/**Mapper.xml
</code></pre> 
 <p><span style="background-color:#ffd900;">③使用Mybatis的操作模式操作数据库：</span></p> 
 <p><img alt="" height="460" src="https://images2.imgbox.com/c7/38/qMFgilcD_o.png" width="862"></p> 
 <p>创建controller，service，model，mapper的package在com.example.demo的目录下，方便在其中创建对应的类</p> 
 <p><span style="background-color:#a2e043;">（1）在model里创建实体类UserInfo（这里最好和数据中的同名，这样便于看）代码如下：</span></p> 
 <pre><code class="language-java">//这是一个实体类，对象的名字最好和数据库表名保持一致，看起来清楚
package com.example.demo.model;
import lombok.Data;
import org.springframework.stereotype.Controller;
@Data
@Controller
public class UserInfo {
    private int id;
    private String username;
    private String password;
    private String photo;
    private String createtime;
    private String updatetime;
    private String state;
}
</code></pre> 
 <p><span style="background-color:#a2e043;">（2）在mapper中创建UserMapper（这样写比较规范，因为会引入@Mapper，当然也可以不这么写）</span></p> 
 <p>代码如下：（即定义普通的接口）</p> 
 <pre><code class="language-java">package com.example.demo.mapper;
import com.example.demo.model.UserInfo;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
//实现xml和interface之间的交互
@Mapper//从普通的接口变成了mybatis的interface;可以通过xml实现，而普通的xml是要通过java才能实现的
public interface UserMapper {
    //根据用户id来查询用户
    //@param是参数在xml中叫id,相当于重命名，但是使用中，只能用修改后的名字
    public UserInfo getUserById(@Param("id") Integer id);
}
</code></pre> 
 <p><span style="background-color:#a2e043;">（3）创建xml实现上面的接口</span></p> 
 <p>注意：我们在前面配置的时候，就写了xml的存放路径需要在mybatis的目录下，并且命名为**Mapper.xml(而在这里为了方便我们更好的知道这里的xml对应的是哪个接口，所以我们将其前面命名一致为UserMapper)</p> 
 <p>1.mybatis的固定xml格式：（每新建一个项目都会用到的,但是namepace需要根据自己的情况来填写）</p> 
 <pre><code class="language-XML">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;
&lt;!--namespace 设置是实现的 接口的包名和类名 ！包名从java源代码底下的目录开始--&gt;
&lt;mapper namespace="com.example.demo.mapper.UserMapper"&gt;
    &lt;select id="getUserById" resultType="com.example.demo.model.UserInfo"&gt;
        select * from userInfo where id=${id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre> 
 <p>注意：（在查询操作的时候，这两个参数都是需要的，查询语句，有结果集的时候，都要映射到Java的对象，映射方式有很多种，但是必须指定一种，这里我们指定的就是resultType）</p> 
 <p><img alt="" height="293" src="https://images2.imgbox.com/4f/40/8HI1o8FA_o.png" width="1200"></p> 
 <p> 我们写的时候，就是interface中写方法申明，在xml中写具体实现就OK了。</p> 
 <p><span style="background-color:#ffd900;">④对以上查询操作进行测试：</span></p> 
 <p>（我们利用service中的类调用mapper，而controller里的类去调用service）</p> 
 <p><span style="background-color:#a2e043;">（1）service相关代码：</span></p> 
 <pre><code class="language-java">package com.example.demo.service;
import com.example.demo.mapper.UserMapper;
import com.example.demo.model.UserInfo;
import org.springframework.stereotype.Service;
import javax.annotation.Resource;
@Service
public class UserService {
    @Resource
    private UserMapper userMapper;//因为是mybatis接口，所以可以用
    public UserInfo getUserById(Integer id){
        return userMapper.getUserById(id);
    }
}
</code></pre> 
 <p><span style="background-color:#a2e043;">（2）Controller相关代码：</span></p> 
 <pre><code class="language-java">package com.example.demo.controller;
import com.example.demo.model.UserInfo;
import com.example.demo.service.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
@RestController
public class UserController {
    @Autowired
    private UserService userService;
    @RequestMapping("/getUserById")
    public UserInfo getUserById(Integer id){
        if (id==null)return null;
        return userService.getUserById(id);
    }
}</code></pre> 
 <p>输出结果：</p> 
 <p><img alt="" height="125" src="https://images2.imgbox.com/7b/0e/bj21mK3k_o.png" width="1200"></p> 
 <p>对应数据库中内容进行查看：</p> 
 <p><img alt="" height="193" src="https://images2.imgbox.com/73/66/SA7AL0AN_o.png" width="1139"> 一致的，查询成功</p> 
 <p><span style="background-color:#ffd900;">⑤MyBatis的执行过程：</span></p> 
 <p><img alt="" height="606" src="https://images2.imgbox.com/37/3b/1rYJGMNo_o.png" width="1002"> 这也就是为什么我们在④中需要引入controller下的类，以及service下的类，已经他们返回的代码的意义所在。</p> 
 <p>注意：为了更容易的排查sql中的问题，我们在开发环境中application-dev.yml设置日志进行打印（这个也是固定的写法）</p> 
 <pre><code class="language-java"># 开启 MyBatis SQL 打印
logging:
  level:
    com:
      example:
        demo: debug
mybatis:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl</code></pre> 
 <p>写后我们运行程序成功，就可以在控制台上看到：</p> 
 <p><img alt="" height="176" src="https://images2.imgbox.com/10/78/7Vm6lY1P_o.png" width="1200"></p> 
</blockquote> 
<h3><span style="color:#98c091;">2.2使用mybatis进行增删查改操作</span></h3> 
<h4><span style="color:#98c091;">2.2.1查询操作</span></h4> 
<blockquote> 
 <p><span style="color:#494949;"><span style="background-color:#ffd900;">①在Mapper接口中声明一个方法：</span>（注意！！！Mapper接口中，必须得有@Mapper注解，否则是不能够与xml产生映射的）</span></p> 
 <p><img alt="" height="94" src="https://images2.imgbox.com/d1/ce/kvq7v92X_o.png" width="822"></p> 
 <p><span style="background-color:#ffd900;">② 在xml中执行查询操作：</span>使用预处理符<code>#{}</code>或者替换符<code>${}</code>来将程序传入的参数替换到sql语句中：</p> 
 <p><img alt="" height="130" src="https://images2.imgbox.com/3e/0d/WBYLdJ2G_o.png" width="1065"></p> 
 <p><span style="background-color:#ffd900;"> ③查询结果：</span></p> 
 <p><img alt="" height="137" src="https://images2.imgbox.com/15/9a/hG1Je4w8_o.png" width="1200"></p> 
</blockquote> 
<h4><span style="color:#98c091;">2.2.2使用springboot进行单元测试介绍</span></h4> 
<blockquote> 
 <p><span style="background-color:#ffd900;">①什么是单元测试？</span></p> 
 <p>1、可以非常简单、直观、快速的测试某个功能是否正确。<br> 2、使用单元测试可以帮我们在打包的时候，发现一些问题，因为在打包之前，所以的单元测试必须通过，否则不能打包成功。<br> 3、使用单元测试，在测试功能的时候，可以不污染连接的数据库，也就是可以不对数据库进行任何改变的情况下，测试功能的正确性。<br><span style="background-color:#ffd900;">②为什么使用单元测试？</span></p> 
 <p>因为其可以不污染数据库，因此我们可以在添加进去前进行测试</p> 
 <p><span style="background-color:#ffd900;">③如何创建单元测试？</span></p> 
 <p>（1）框架支持（在我们创建spring boot项目时会自动进行添加，所以这个地方不做过多说明）</p> 
 <p>（2）我们在需要测试方法的所在类中，右键点击Generate，Test，然后对测试的内容进行勾选。（下面我们以测试UserMapper类中的getUserById为例）</p> 
 <p>a.<img alt="" height="550" src="https://images2.imgbox.com/d4/3d/PychLk3b_o.png" width="1200"></p> 
 <p>b.</p> 
 <p><img alt="" height="127" src="https://images2.imgbox.com/82/96/8NztVqcn_o.png" width="164"></p> 
 <p>c.</p> 
 <p><img alt="" height="550" src="https://images2.imgbox.com/7a/3e/q8fqhFzT_o.png" width="874"><span style="color:#494949;">(3)进入测试页面后，我们先选择添加配置单元测试类的注解：@SpringBootTest注解</span></p> 
 <p><span style="color:#494949;">(4)在测试方法上添加@Test注解</span></p> 
 <p><span style="color:#494949;">(5)注入Mapper对象，调用里面操作数据库的方法，进行单元测试。</span></p> 
 <p>a.直接输出结果方式进行测试： </p> 
 <p> (注意：在一个测试中是可以有多个测试方法，且每个测试方法都可以独立地进行启动)</p> 
 <p><img alt="" height="203" src="https://images2.imgbox.com/1d/c4/O1RiETom_o.png" width="828"></p> 
 <p> 输出结果如下：</p> 
 <p><img alt="" height="210" src="https://images2.imgbox.com/29/99/vXyBGwcL_o.png" width="1200"></p> 
 <p>b.通过断言来进行测试：（断言常用方法如下）</p> 
 <p><img alt="" height="714" src="https://images2.imgbox.com/74/9e/p60tn20v_o.png" width="1200"></p> 
 <p>示例：（我们以assert不为null来进行判断，如果不为null，就会返回√，否则则表示测试用例不通过） </p> 
 <p><img alt="" height="333" src="https://images2.imgbox.com/08/70/NqTUyoWr_o.png" width="1200"></p> 
 <p>这就表示测试例成功。</p> 
 <p>失败显示如下：（很显然id=1的是不为null 的）</p> 
 <p><img alt="" height="303" src="https://images2.imgbox.com/87/1b/oInbHQ0s_o.png" width="1200"> （6）使用@Transactional注解可以防止污染数据库</p> 
 <p>使用这个注解后，是不会修改数据库里的内容的，因此当我们进行增删查改的时候，可以先这样进行测试看到底有没有问题，再进行后续操作。这个在下面的操作中也会进行演示。</p> 
</blockquote> 
<h4><span style="color:#98c091;">2.2.3修改操作</span></h4> 
<blockquote> 
 <p><span style="color:#494949;"><span style="background-color:#ffd900;">①在Mapper接口中声明一个方法：</span>（注意！！！Mapper接口中，必须得有@Mapper注解，否则是不能够与xml产生映射的）</span></p> 
 <pre><code class="language-java">  //根据id来修改用户名称，且返回值为影响的行数
    public Integer updateName(@Param("id")Integer id,@Param("username")String name);</code></pre> 
 <p></p> 
 <p><span style="background-color:#ffd900;">② 在xml中执行查询操作：</span>使用预处理符<code>#{}</code>或者替换符<code>${}</code>来将程序传入的参数替换到sql语句中：</p> 
 <pre><code class="language-XML">    &lt;update id="updataName"&gt;
       update userinfo set username=#{username} where id=#{id}
    &lt;/update&gt;</code></pre> 
 <p></p> 
 <p><span style="background-color:#ffd900;"> ③测试代码：</span></p> 
 <pre><code class="language-java">  @Test
    @Transactional
    void updateName() {
        int result = userMapper.updateName(1, "李四");
        Assertions.assertSame(1,result);
    }</code></pre> 
 <p>测试结果：</p> 
 <p><img alt="" height="79" src="https://images2.imgbox.com/c2/18/1Vyy0jHp_o.png" width="875"></p> 
 <p>我们可以发现测试是通过了的，但是由于我们加了@Transactional这个注解的话，数据库是不会进行实际的修改的，我们可以查一下：</p> 
 <p><img alt="" height="174" src="https://images2.imgbox.com/b2/01/eslOsWXy_o.png" width="1139"><span style="background-color:#ffd900;">④我们去掉测试代码中的 @Transactional，来看一下是否会更改数据库的值</span></p> 
 <p><img alt="" height="331" src="https://images2.imgbox.com/57/a7/NSEJfpgE_o.png" width="1200"></p> 
 <p>仍然是通过了测试，这个时候，我们来查询一下数据库：</p> 
 <p><img alt="" height="188" src="https://images2.imgbox.com/9c/e3/6nFeA6vC_o.png" width="1198"></p> 
 <p><span style="background-color:#ffd900;"> ⑤我们也可以通过类似于上述查询的方式，在url中对数据库的内容进行修改：</span></p> 
 <p>在UserService，UserController中分别添加如下内容：</p> 
 <p>（我们返回的仍然是受影响的行数） </p> 
 <p><img alt="" height="119" src="https://images2.imgbox.com/4e/06/2YZdCV8D_o.png" width="906"></p> 
 <p><img alt="" height="177" src="https://images2.imgbox.com/28/cd/aTb34Hio_o.png" width="856"> 输出结果：</p> 
 <p><img alt="" height="134" src="https://images2.imgbox.com/90/b6/f7SOkUVk_o.png" width="1034"></p> 
 <p>此时，我们查看数据库，看username是否已经被改成了lisi。 </p> 
 <p> <img alt="" height="179" src="https://images2.imgbox.com/01/a9/Yd6y8tPy_o.png" width="1118"></p> 
</blockquote> 
<h4><span style="color:#98c091;">2.2.4删除操作</span></h4> 
<blockquote> 
 <p><span style="background-color:#ffd900;">①声明方法：</span></p> 
 <pre><code class="language-java">  //根据id删除某一个用户的信息,返回受影响行数
    public Integer deleteUser(@Param("id")Integer id);</code></pre> 
 <p><span style="background-color:#ffd900;">②在xml中编写sql:</span></p> 
 <pre><code class="language-XML">    &lt;delete id="deleteUser"&gt;
        delete from userInfo where id=#{id};
    &lt;/delete&gt;</code></pre> 
 <p><span style="background-color:#ffd900;">③测试代码：</span></p> 
 <pre><code class="language-java">    @Test
    @Transactional
    void deleteUser(){
        int result=userMapper.deleteUser(1);
        Assertions.assertSame(1,result);
    }</code></pre> 
 <p><span style="background-color:#ffd900;">④输出结果：</span></p> 
 <p><img alt="" height="106" src="https://images2.imgbox.com/c6/82/6uc10Jh1_o.png" width="1011"></p> 
 <p>测试成功，因为本身这个数据表就只有一行数据，这里就不真正删除啦 </p> 
</blockquote> 
<h4><span style="color:#98c091;">2.2.5增添操作</span></h4> 
<blockquote> 
 <p></p> 
 <p>增加的操作会相对复杂一点。我们声明方法中的形参传入一个UserInfo对象</p> 
 <p><span style="background-color:#ffd900;">①返回一个参数</span></p> 
 <p>(1)声明方法：</p> 
 <pre><code class="language-java">    //插入一行数据，返回受影响的行数
    public Integer add(UserInfo userInfo);</code></pre> 
 <p>(2)在xml中编写sql:</p> 
 <pre><code class="language-XML"> &lt;insert id="add"&gt;
        insert into userinfo(username, password, photo) values (#{username}, #{password},#{photo});
    &lt;/insert&gt;</code></pre> 
 <p>(3)测试代码：</p> 
 <pre><code class="language-java">    @Test
    void add(){
        UserInfo userInfo=new UserInfo();
        userInfo.setId(2);
        userInfo.setUsername("张三");
        userInfo.setPhoto("abc.png");
        userInfo.setPassword("123456");
        int result=userMapper.add(userInfo);
        Assertions.assertSame(1,result);
    }</code></pre> 
 <p>(4)输出结果：</p> 
 <p><img alt="" height="99" src="https://images2.imgbox.com/b0/5a/Sni8DToe_o.png" width="1000"></p> 
 <p>测试成功，此时只返回了一个参数</p> 
 <p><img alt="" height="122" src="https://images2.imgbox.com/13/d0/xUgyFNcJ_o.png" width="1200"> 我们来查看该表现在的内容：</p> 
 <p><img alt="" height="197" src="https://images2.imgbox.com/53/6a/CCqahFwC_o.png" width="1106"></p> 
 <p><span style="background-color:#ffd900;"> ②返回多个参数：</span></p> 
 <p>比如返回受影响的行数和自增id的值，这个时候我们就需要对xml的<code>insert</code>标签进行配置。</p> 
 <p>（1）声明：</p> 
 <pre><code class="language-java"> public Integer addId(UserInfo userInfo);</code></pre> 
 <p>（2）xml中：（注意！！！insert标签中还需要设置useGeneratedKeys="true"表示为自增主键，keyProperty="id"表示哪一个是自增主键）</p> 
 <pre><code class="language-XML"> &lt;insert id="addId" useGeneratedKeys="true" keyProperty="id" keyColumn="id"&gt;
        insert into userinfo(username, password, photo) values (#{username}, #{password},#{photo});
    &lt;/insert&gt;</code></pre> 
 <p>（3）测试代码：</p> 
 <pre><code class="language-java">    @Test
    void addId() {
        UserInfo userInfo = new UserInfo();
        userInfo.setUsername("王五");
        userInfo.setPassword("123456");
        userInfo.setPhoto("default.png");
        System.out.println("插入之前的id=" + userInfo.getId());
        int result = userMapper.addId(userInfo);
        System.out.println("插入之后的id=" + userInfo.getId());
        Assertions.assertSame(1,result);
    }</code></pre> 
 <p>（4）输出结果：</p> 
 <p>测试成功 </p> 
 <p><img alt="" height="373" src="https://images2.imgbox.com/af/f2/RRy5ZD1Z_o.png" width="1200"></p> 
 <p> 查看现在的数据表：</p> 
 <p><img alt="" height="238" src="https://images2.imgbox.com/2b/ea/oo117tYw_o.png" width="1178"></p> 
</blockquote> 
<blockquote> 
 <p>最后尝试通过名字来改id，上面我们看到张三的id为3，我们来试一试能不能改为2：</p> 
 <p><span style="background-color:#ffd900;">①声明方法：</span></p> 
 <pre><code class="language-java"> public Integer updateidByname(Integer id,String username);</code></pre> 
 <p><span style="background-color:#ffd900;">②在xml中修改：</span></p> 
 <pre><code class="language-XML">  &lt;update id="updateidByname"&gt;
        update userInfo set id=#{id} where username=#{username};
    &lt;/update&gt;</code></pre> 
 <p><span style="background-color:#ffd900;">③测试代码：</span></p> 
 <pre><code class="language-java">  @Test
    void updateidByname(){
        int result = userMapper.updateidByname(2, "张三");
        Assertions.assertSame(1,result);
    }
</code></pre> 
 <p><span style="background-color:#ffd900;">④输出结果：</span></p> 
 <p>测试成功</p> 
 <p><img alt="" height="229" src="https://images2.imgbox.com/a4/c7/gD0MUryH_o.png" width="1200"></p> 
</blockquote> 
<p>本期MyBatis到此结束，这一期的内容可以支撑我们做SSM项目了，下期，我们将延伸一下。 </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/65f6e2f38d0d1e6d16b66f91af151ec7/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Android studio 六大基本布局详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9b7b7d7b1931855e4f81855b20d2570d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue2-生命周期</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>