<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>《qt quick核心编程》笔记三 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="《qt quick核心编程》笔记三" />
<meta property="og:description" content="9 C&#43;&#43;和QML混合编程 9.1 在QML中使用C&#43;&#43;类和对象 qt提供两种方式在QML环境中使用C&#43;&#43;对象：
在C&#43;&#43;中实现一个类，注册为QML环境的一个类型，在QML环境中使用该类型创建对象在C&#43;&#43;中构造一个对象，将这个对象设置为QML的上下文属性，在QML环境中直接使用该属性 9.1.1 前提条件：定义可以导出的C&#43;&#43;类 一个C&#43;&#43;类必须满足以下条件才能够导出到QML环境中使用：
从QObject或QObject的派生类继承使用Q_OBJECT宏 QML中使用C&#43;&#43;导出的类，只能使用以下特征的属性和方法：
信号和槽Q_INVOKABLE宏修饰的成员函数Q_ENUM宏修饰的枚举类型Q_PROPERTY宏修饰的成员属性（常用READ、WRITE、NOTIFY标记） &lt;colormaker.h&gt;头文件
#ifndef COLORMAKER_H #define COLORMAKER_H #include &lt;QObject&gt; #include &lt;QColor&gt; class ColorMaker : public QObject { Q_OBJECT Q_PROPERTY(QColor color READ getColor WRITE setColor NOTIFY colorChanged) Q_PROPERTY(QColor timeColor READ timeColor) public: explicit ColorMaker(QObject *parent = nullptr); ~ColorMaker(); enum GenerateAlgorithm{ RandomRGB, RandomRed, RandomGreen, RandomBlue, LinearIncrease}; Q_ENUM(GenerateAlgorithm) Q_INVOKABLE ColorMaker::GenerateAlgorithm algorithm() const; Q_INVOKABLE void setAlgorithm(ColorMaker::GenerateAlgorithm algorithm); QColor getColor() const; void setColor(const QColor &amp;color); QColor timeColor() const; signals: void colorChanged(const QColor &amp;color); void currentTime(const QString &amp;strTime); public slots: void start(); void stop(); protected: void timerEvent(QTimerEvent *e); private: GenerateAlgorithm m_algorithm; QColor m_currentColor; int m_nColorTimer; }; #endif // COLORMAKER_H &lt;colormaker." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/458e66fc40044cd8697d50fa56cbb42e/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-07T22:10:42+08:00" />
<meta property="article:modified_time" content="2023-10-07T22:10:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">《qt quick核心编程》笔记三</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-github-gist">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="9_CQML_0"></a>9 C++和QML混合编程</h3> 
<h4><a id="91_QMLC_1"></a>9.1 在QML中使用C++类和对象</h4> 
<p>qt提供两种方式在QML环境中使用C++对象：</p> 
<ol><li>在C++中实现一个类，注册为QML环境的一个类型，在QML环境中使用该类型创建对象</li><li>在C++中构造一个对象，将这个对象设置为QML的上下文属性，在QML环境中直接使用该属性</li></ol> 
<h5><a id="911_C_6"></a>9.1.1 前提条件：定义可以导出的C++类</h5> 
<p>一个C++类必须满足以下条件才能够导出到QML环境中使用：</p> 
<ul><li>从<code>QObject</code>或<code>QObject</code>的派生类继承</li><li>使用<code>Q_OBJECT</code>宏</li></ul> 
<p>QML中使用C++导出的类，只能使用以下特征的属性和方法：</p> 
<ol><li>信号和槽</li><li>Q_INVOKABLE宏修饰的成员函数</li><li>Q_ENUM宏修饰的枚举类型</li><li>Q_PROPERTY宏修饰的成员属性（常用READ、WRITE、NOTIFY标记）</li></ol> 
<p><strong>&lt;colormaker.h&gt;头文件</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">COLORMAKER_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">COLORMAKER_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QObject&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QColor&gt;</span></span>

<span class="token keyword">class</span> <span class="token class-name">ColorMaker</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QObject</span></span>
<span class="token punctuation">{<!-- --></span>
	Q_OBJECT
	<span class="token function">Q_PROPERTY</span><span class="token punctuation">(</span>QColor color READ getColor WRITE setColor NOTIFY colorChanged<span class="token punctuation">)</span>
	<span class="token function">Q_PROPERTY</span><span class="token punctuation">(</span>QColor timeColor READ timeColor<span class="token punctuation">)</span>

<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">explicit</span> <span class="token function">ColorMaker</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">~</span><span class="token function">ColorMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">enum</span> <span class="token class-name">GenerateAlgorithm</span><span class="token punctuation">{<!-- --></span> RandomRGB<span class="token punctuation">,</span> RandomRed<span class="token punctuation">,</span> RandomGreen<span class="token punctuation">,</span> RandomBlue<span class="token punctuation">,</span> LinearIncrease<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">Q_ENUM</span><span class="token punctuation">(</span>GenerateAlgorithm<span class="token punctuation">)</span>

	Q_INVOKABLE ColorMaker<span class="token double-colon punctuation">::</span>GenerateAlgorithm <span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	Q_INVOKABLE <span class="token keyword">void</span> <span class="token function">setAlgorithm</span><span class="token punctuation">(</span>ColorMaker<span class="token double-colon punctuation">::</span>GenerateAlgorithm algorithm<span class="token punctuation">)</span><span class="token punctuation">;</span>

	QColor <span class="token function">getColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">const</span> QColor <span class="token operator">&amp;</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
	QColor <span class="token function">timeColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

signals<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">colorChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QColor <span class="token operator">&amp;</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">currentTime</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>strTime<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> slots<span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
 <span class="token keyword">void</span> <span class="token function">timerEvent</span><span class="token punctuation">(</span>QTimerEvent <span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">private</span><span class="token operator">:</span>
	GenerateAlgorithm m_algorithm<span class="token punctuation">;</span>
	QColor m_currentColor<span class="token punctuation">;</span>
	<span class="token keyword">int</span> m_nColorTimer<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// COLORMAKER_H</span></span>
</code></pre> 
<p><strong>&lt;colormaker.c&gt;源文件</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"colormaker.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDateTime&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QRandomGenerator&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTimerEvent&gt;</span></span>

<span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">ColorMaker</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>parent<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">QObject</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_algorithm</span><span class="token punctuation">(</span>RandomRGB<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_currentColor</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>black<span class="token punctuation">)</span><span class="token punctuation">,</span>
	  <span class="token function">m_nColorTimer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">ColorMaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
QColor <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">getColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> m_currentColor<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token keyword">const</span> QColor <span class="token operator">&amp;</span>color<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  m_currentColor <span class="token operator">=</span> color<span class="token punctuation">;</span>
  emit <span class="token function">colorChanged</span><span class="token punctuation">(</span>m_currentColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
QColor <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">timeColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
  QTime time <span class="token operator">=</span> <span class="token class-name">QTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> r <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> g <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">minute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> b <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">second</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token class-name">QColor</span><span class="token double-colon punctuation">::</span><span class="token function">fromRgb</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> g<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ColorMaker<span class="token double-colon punctuation">::</span>GenerateAlgorithm <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">return</span> m_algorithm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span>GenerateAlgorithm algorithm<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  m_algorithm <span class="token operator">=</span> algorithm<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>m_nColorTimer <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	m_nColorTimer <span class="token operator">=</span> <span class="token function">startTimer</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>m_nColorTimer <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token function">killTimer</span><span class="token punctuation">(</span>m_nColorTimer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	m_nColorTimer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">ColorMaker</span><span class="token double-colon punctuation">::</span><span class="token function">timerEvent</span><span class="token punctuation">(</span>QTimerEvent <span class="token operator">*</span>e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">-&gt;</span><span class="token function">timerId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> m_nColorTimer<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>m_algorithm<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">case</span> RandomRGB<span class="token operator">:</span>
	  m_currentColor<span class="token punctuation">.</span><span class="token function">setRgb</span><span class="token punctuation">(</span><span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
							<span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
							<span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> RandomRed<span class="token operator">:</span>
	  m_currentColor<span class="token punctuation">.</span><span class="token function">setRed</span><span class="token punctuation">(</span><span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> RandomGreen<span class="token operator">:</span>
	  m_currentColor<span class="token punctuation">.</span><span class="token function">setGreen</span><span class="token punctuation">(</span><span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> RandomBlue<span class="token operator">:</span>
	  m_currentColor<span class="token punctuation">.</span><span class="token function">setBlue</span><span class="token punctuation">(</span><span class="token class-name">QRandomGenerator</span><span class="token double-colon punctuation">::</span><span class="token function">global</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">bounded</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> LinearIncrease<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
	  <span class="token keyword">int</span> r <span class="token operator">=</span> m_currentColor<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
	  <span class="token keyword">int</span> g <span class="token operator">=</span> m_currentColor<span class="token punctuation">.</span><span class="token function">green</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
	  <span class="token keyword">int</span> b <span class="token operator">=</span> m_currentColor<span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">;</span>
	  m_currentColor<span class="token punctuation">.</span><span class="token function">setRgb</span><span class="token punctuation">(</span>r <span class="token operator">%</span> <span class="token number">255</span><span class="token punctuation">,</span> g <span class="token operator">%</span> <span class="token number">255</span><span class="token punctuation">,</span> b <span class="token operator">%</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	emit <span class="token function">colorChanged</span><span class="token punctuation">(</span>m_currentColor<span class="token punctuation">)</span><span class="token punctuation">;</span>
	emit <span class="token function">currentTime</span><span class="token punctuation">(</span>
		<span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">"yyyy-MM-ddhh:mm:ss"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">timerEvent</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="912_1CQML_141"></a>9.1.2 使用方法1：将一个C++类注册为QML类型使用</h5> 
<p>首先定义出一个供QML访问的C++类，接下来需要将这个C++类型注册为QML类型，然后才能在QML中使用</p> 
<p>注册QML类型的函数：<br> <code>qmlRegisterSingletonType()</code>注册表一个单例类型<br> <code>qmlRegisterType()</code>注册一个非单例类型<br> <code>qmlRegisterTypeNotAvailable()</code>注册一个类型用来占位<br> <code>qmlRegisterUncreatableType()</code>注册一个具有附加属性的附加类型</p> 
<p><strong>举例qmlRegisterType如下：</strong></p> 
<pre><code class="prism language-cpp"><span class="token comment">//用来注册一个新类型</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">int</span> <span class="token function">qmlRegisterType</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>uri<span class="token punctuation">,</span> <span class="token keyword">int</span> versionMajor<span class="token punctuation">,</span> <span class="token keyword">int</span> versionMinor<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>qmlName<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//为特定的版本注册类型</span>
<span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">int</span> metaObjectRevision<span class="token operator">&gt;</span>
<span class="token keyword">int</span> <span class="token function">qmlRegisterType</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>uri<span class="token punctuation">,</span> <span class="token keyword">int</span> versionMajor<span class="token punctuation">,</span> <span class="token keyword">int</span> versionMinor<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>qmlName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>uri</code>：指定一个唯一的包名，"import QtQuick.Controls 1.2"中的<code>QtQuick.Controls</code>就是包名，<code>1.2</code>则是版本<br> <code>versionMajor</code>：包的主版本号，"import QtQuick.Controls 1.2"中的<code>1.2</code>中的<code>1</code><br> <code>versionMinor</code>：包的子版本号，"import QtQuick.Controls 1.2"中的<code>1.2</code>中的<code>2</code><br> <code>qmlName</code>：QML中可以使用的类名</p> 
<p><strong>&lt;main.cpp&gt;</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtGui/QGuiApplication&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQuick/QQuickView&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQml&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"colorMaker.h"</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	QGuiApplication <span class="token function">app</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token generic-function"><span class="token function">qmlRegisterType</span><span class="token generic class-name"><span class="token operator">&lt;</span>ColorMaker<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"an.qt.ColorMaker"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"ColorMaker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">//注册ColorMaker类</span>
	QQuickView viewer<span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">setResizeMode</span><span class="token punctuation">(</span>QQuickView<span class="token double-colon punctuation">::</span>SizeRootObjectToView<span class="token punctuation">)</span><span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">setSource</span><span class="token punctuation">(</span><span class="token function">QUrl</span><span class="token punctuation">(</span><span class="token string">"qrc:///main.qml"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>后续即可直接在qml中使用：<br> <strong>&lt;main.qml&gt;</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.2</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>
<span class="token keyword">import</span> an<span class="token punctuation">.</span>qt<span class="token punctuation">.</span>ColorMaker <span class="token number">1.0</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	Text <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> timeLabel
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> parent<span class="token punctuation">.</span>left
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> parent<span class="token punctuation">.</span>top
		anchors<span class="token punctuation">.</span>topMargin<span class="token operator">:</span> <span class="token number">4</span>
		font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">26</span>
	<span class="token punctuation">}</span>
	ColorMaker <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorMaker
		<span class="token literal-property property">color</span><span class="token operator">:</span> Qt<span class="token punctuation">.</span>green
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorRect
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> start
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"start"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> parent<span class="token punctuation">.</span>left
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> parent<span class="token punctuation">.</span>bottom
		anchors<span class="token punctuation">.</span>bottomMargin<span class="token operator">:</span> <span class="token number">4</span>
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			colorMaker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> stop
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"stop"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> start<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			colorMaker<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">function</span> <span class="token function">changeAlgorithm</span><span class="token punctuation">(</span><span class="token parameter">button<span class="token punctuation">,</span> algorithm</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">switch</span> <span class="token punctuation">(</span>algorithm<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomRGB"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomRed"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomGreen"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomBlue"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"LinearIncrease"</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorAlgorithm
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"RandomRGB"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> stop<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">var</span> algorithm <span class="token operator">=</span> <span class="token punctuation">(</span>colorMaker<span class="token punctuation">.</span><span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>
			<span class="token function">changeAlgorithm</span><span class="token punctuation">(</span>colorAlgorithm<span class="token punctuation">,</span> algorithm<span class="token punctuation">)</span>
			colorMaker<span class="token punctuation">.</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> quit
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"quit"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> colorAlgorithm<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			Qt<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Component<span class="token punctuation">.</span>onCompleted<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
		colorMaker<span class="token punctuation">.</span>color <span class="token operator">=</span> Qt<span class="token punctuation">.</span><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
		colorMaker<span class="token punctuation">.</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span>ColorMaker<span class="token punctuation">.</span>LinearIncrease<span class="token punctuation">)</span>
		<span class="token function">changeAlgorithm</span><span class="token punctuation">(</span>colorAlgorithm<span class="token punctuation">,</span> colorMaker<span class="token punctuation">.</span><span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	Connections <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">target</span><span class="token operator">:</span> colorMaker
		<span class="token keyword">function</span> <span class="token function">onCurrentTime</span><span class="token punctuation">(</span><span class="token parameter">strTime</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			timeLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> strTime
			timeLabel<span class="token punctuation">.</span>color <span class="token operator">=</span> colorMaker<span class="token punctuation">.</span>timeColor
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Connections <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">target</span><span class="token operator">:</span> colorMaker
		<span class="token keyword">function</span> <span class="token function">onColorChanged</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			colorRect<span class="token punctuation">.</span>color <span class="token operator">=</span> color
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="913_2CQML_298"></a>9.1.3 使用方法2：将一个C++对象注册为QML属性使用</h5> 
<p>首先要先注册属性<br> <strong>&lt;main.cpp&gt;</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtGui/QGuiApplication&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQuick/QQuickView&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQml&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"colorMaker.h"</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	QGuiApplication <span class="token function">app</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
	QQuickView viewer<span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">setResizeMode</span><span class="token punctuation">(</span>QQuickView<span class="token double-colon punctuation">::</span>SizeRootObjectToView<span class="token punctuation">)</span><span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">rootContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">setContextProperty</span><span class="token punctuation">(</span><span class="token string">"colorMaker"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> ColorMaker<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//注册为属性</span>
	viewer<span class="token punctuation">.</span><span class="token function">setSource</span><span class="token punctuation">(</span><span class="token function">QUrl</span><span class="token punctuation">(</span><span class="token string">"qrc:///main.qml"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	viewer<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后修改qml中的内容，无需import类，直接使用注册的属性名即可<br> <strong>&lt;main.qml&gt;</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.2</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	Text <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> timeLabel
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> parent<span class="token punctuation">.</span>left
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> parent<span class="token punctuation">.</span>top
		anchors<span class="token punctuation">.</span>topMargin<span class="token operator">:</span> <span class="token number">4</span>
		font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">26</span>
	<span class="token punctuation">}</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorRect
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> start
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"start"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> parent<span class="token punctuation">.</span>left
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> parent<span class="token punctuation">.</span>bottom
		anchors<span class="token punctuation">.</span>bottomMargin<span class="token operator">:</span> <span class="token number">4</span>
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			colorMaker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> stop
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"stop"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> start<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			colorMaker<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">function</span> <span class="token function">changeAlgorithm</span><span class="token punctuation">(</span><span class="token parameter">button<span class="token punctuation">,</span> algorithm</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">switch</span> <span class="token punctuation">(</span>algorithm<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomRGB"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomRed"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomGreen"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"RandomBlue"</span>
			<span class="token keyword">break</span>
		<span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
			button<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"LinearIncrease"</span>
			<span class="token keyword">break</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorAlgorithm
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"RandomRGB"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> stop<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">var</span> algorithm <span class="token operator">=</span> <span class="token punctuation">(</span>colorMaker<span class="token punctuation">.</span><span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span>
			<span class="token function">changeAlgorithm</span><span class="token punctuation">(</span>colorAlgorithm<span class="token punctuation">,</span> algorithm<span class="token punctuation">)</span>
			colorMaker<span class="token punctuation">.</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> quit
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"quit"</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> colorAlgorithm<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> start<span class="token punctuation">.</span>bottom
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			Qt<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Component<span class="token punctuation">.</span>onCompleted<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
		colorMaker<span class="token punctuation">.</span>color <span class="token operator">=</span> Qt<span class="token punctuation">.</span><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span>
		colorMaker<span class="token punctuation">.</span><span class="token function">setAlgorithm</span><span class="token punctuation">(</span>colorMaker<span class="token punctuation">.</span>LinearIncrease<span class="token punctuation">)</span>
		<span class="token function">changeAlgorithm</span><span class="token punctuation">(</span>colorAlgorithm<span class="token punctuation">,</span> colorMaker<span class="token punctuation">.</span><span class="token function">algorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	Connections <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">target</span><span class="token operator">:</span> colorMaker
		<span class="token keyword">function</span> <span class="token function">onCurrentTime</span><span class="token punctuation">(</span><span class="token parameter">strTime</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			timeLabel<span class="token punctuation">.</span>text <span class="token operator">=</span> strTime
			timeLabel<span class="token punctuation">.</span>color <span class="token operator">=</span> colorMaker<span class="token punctuation">.</span>timeColor
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Connections <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">target</span><span class="token operator">:</span> colorMaker
		<span class="token keyword">function</span> <span class="token function">onColorChanged</span><span class="token punctuation">(</span><span class="token parameter">color</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
			colorRect<span class="token punctuation">.</span>color <span class="token operator">=</span> color
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="92_CQML_428"></a>9.2 在C++中使用QML对象</h4> 
<h5><a id="921__429"></a>9.2.1 查找一个对象的孩子</h5> 
<p>QObject类的构造函数有一个parent参数，指定一个对象的父亲，QML中的对象借助这个组成了以根Item为根的对象树<br> QObject类中有一个<code>objectName</code>属性，代表这个对象的名字<br> 通过对象名字可以用于<code>findChild()</code>和<code>findChildren()</code>查找孩子</p> 
<pre><code class="prism language-cpp">T <span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">findChild</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span> name <span class="token operator">=</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token double-colon punctuation">::</span>FindChildOptions options <span class="token operator">=</span> Qt<span class="token double-colon punctuation">::</span>FindChildrenRecursively<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
QList<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">findChildren</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span> name <span class="token operator">=</span> <span class="token function">QString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Qt<span class="token double-colon punctuation">::</span>FindChildOptions options <span class="token operator">=</span> Qt<span class="token double-colon punctuation">::</span>FindChildrenRecursively<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
QList<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">findChildren</span><span class="token punctuation">(</span><span class="token keyword">const</span> QRegExp <span class="token operator">&amp;</span> regExp<span class="token punctuation">,</span> Qt<span class="token double-colon punctuation">::</span>FindChildOptions options <span class="token operator">=</span> Qt<span class="token double-colon punctuation">::</span>FindChildrenRecursively<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
QList<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">findChildren</span><span class="token punctuation">(</span><span class="token keyword">const</span> QRegularExpression <span class="token operator">&amp;</span> re<span class="token punctuation">,</span> Qt<span class="token double-colon punctuation">::</span>FindChildOptions options <span class="token operator">=</span> Qt<span class="token double-colon punctuation">::</span>FindChildrenRecursively<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
</code></pre> 
<p>示例：查找parentWidget的名为"button1"，类型为QPushButton的孩子</p> 
<pre><code class="prism language-cpp">QPushButton <span class="token operator">*</span>button <span class="token operator">=</span> parentWidget<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">findChild</span><span class="token generic class-name"><span class="token operator">&lt;</span>QPushButton<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"button1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>示例：查找parentWidget的所有名为"widgetname"的QWidget类型的孩子列表</p> 
<pre><code class="prism language-cpp">QList<span class="token operator">&lt;</span>QWidget <span class="token operator">*</span><span class="token operator">&gt;</span> widgets <span class="token operator">=</span> parentWidget<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">findChildren</span><span class="token generic class-name"><span class="token operator">&lt;</span>QWidget <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"widgetname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h5><a id="922_QML_450"></a>9.2.2 使用元对象调用QML对象的方法</h5> 
<p>QMetaObject的<code>invokeMethod()</code>静态方法用来调用一个对象的信号、槽、可调用方法.</p> 
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token class-name">QMetaObject</span><span class="token double-colon punctuation">::</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span>
	QObject <span class="token operator">*</span> obj<span class="token punctuation">,</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> member<span class="token punctuation">,</span>
	Qt<span class="token double-colon punctuation">::</span>ConnectionType type<span class="token punctuation">,</span>
	QGenericReturnArgument ret<span class="token punctuation">,</span>
	QGenericArgument val0 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val1 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val2 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val3 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val4 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val5 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val6 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val7 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val8 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	QGenericArgument val9 <span class="token operator">=</span> <span class="token function">QGenericArgument</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">)</span>

<span class="token comment">//QGenericReturnArgument 原型为：</span>
QGenericReturnArgument <span class="token function">Q_RETURN_ARG</span><span class="token punctuation">(</span> Type<span class="token punctuation">,</span> Type <span class="token operator">&amp;</span> value<span class="token punctuation">)</span>

<span class="token comment">//QGenericArgument 原型为：</span>
QGenericArgument <span class="token function">Q_ARG</span><span class="token punctuation">(</span> Type<span class="token punctuation">,</span> <span class="token keyword">const</span> Type <span class="token operator">&amp;</span> value<span class="token punctuation">)</span>
</code></pre> 
<p><code>返回值</code>：true调用成功，false调用失败<br> <code>obj</code>：被调用对象的指针<br> <code>member</code>：方法名字<br> <code>type</code>：连接类型</p> 
<ul><li>Qt::DirectConnection</li><li>Qt::AutoConnection</li><li>Qt::QueuedConnection</li></ul> 
<p><code>ret</code>：接收调用方法的返回值<br> <code>val0-val10</code>：用于传递给调用方法的参数</p> 
<p><strong>调用方法：</strong><br> 假设一个对象有一个槽compute(QString, int, double)，返回一个QString对象</p> 
<pre><code class="prism language-cpp">QString retVal<span class="token punctuation">;</span>
<span class="token class-name">QMetaObject</span><span class="token double-colon punctuation">::</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span>
	obj<span class="token punctuation">,</span> 
	<span class="token string">"compute"</span><span class="token punctuation">,</span> 
	Qt<span class="token double-colon punctuation">::</span>DirectConnection<span class="token punctuation">,</span>
	<span class="token function">Q_RETURN_ARG</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span> retVal<span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">Q_ARG</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span> <span class="token string">"sqrt"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">Q_ARG</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token function">Q_ARG</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">,</span> <span class="token number">9.7</span><span class="token punctuation">)</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>示例代码如下：<br> <strong>&lt;changecolor.h&gt;</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CHANGECOLOR_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHANGECOLOR_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QObject&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QTimer&gt;</span></span>
<span class="token keyword">class</span> <span class="token class-name">ChangeQmlColor</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QObject</span></span> <span class="token punctuation">{<!-- --></span>
  Q_OBJECT
<span class="token keyword">public</span><span class="token operator">:</span>
  <span class="token function">ChangeQmlColor</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>target<span class="token punctuation">,</span> QObject <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">~</span><span class="token function">ChangeQmlColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">protected</span> slots<span class="token operator">:</span>
  <span class="token keyword">void</span> <span class="token function">onTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
  QTimer m_timer<span class="token punctuation">;</span>
  QObject <span class="token operator">*</span>m_target<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// CHANGECOLOR_H</span></span>

</code></pre> 
<p><strong>&lt;changecolor.cpp&gt;</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"changeColor.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QColor&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDateTime&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QVariant&gt;</span></span>
<span class="token class-name">ChangeQmlColor</span><span class="token double-colon punctuation">::</span><span class="token function">ChangeQmlColor</span><span class="token punctuation">(</span>QObject <span class="token operator">*</span>target<span class="token punctuation">,</span> QObject <span class="token operator">*</span>parent<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">QObject</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_timer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_target</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">qsrand</span><span class="token punctuation">(</span><span class="token class-name">QDateTime</span><span class="token double-colon punctuation">::</span><span class="token function">currentDateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toTime_t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">connect</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m_timer<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">timeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">onTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  m_timer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">ChangeQmlColor</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">ChangeQmlColor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">ChangeQmlColor</span><span class="token double-colon punctuation">::</span><span class="token function">onTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  QColor color <span class="token operator">=</span> <span class="token class-name">QColor</span><span class="token double-colon punctuation">::</span><span class="token function">fromRgb</span><span class="token punctuation">(</span><span class="token function">qrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token function">qrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token function">qrand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  m_target<span class="token operator">-&gt;</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"color"</span><span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>&lt;main.cpp&gt;</strong></p> 
<pre><code class="prism language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"changecolor.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QApplication&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QColor&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QQmlApplicationEngine&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QtQml&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">QT_VERSION <span class="token operator">&lt;</span> <span class="token function">QT_VERSION_CHECK</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span></span>
  <span class="token class-name">QCoreApplication</span><span class="token double-colon punctuation">::</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AA_EnableHighDpiScaling<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
  QApplication <span class="token function">app</span><span class="token punctuation">(</span>argc<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">;</span>

  QQmlApplicationEngine engine<span class="token punctuation">;</span>
  <span class="token keyword">const</span> QUrl <span class="token function">url</span><span class="token punctuation">(</span><span class="token function">QStringLiteral</span><span class="token punctuation">(</span><span class="token string">"qrc:/main.qml"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  engine<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

  QObject <span class="token operator">*</span>root <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
  QList<span class="token operator">&lt;</span>QObject <span class="token operator">*</span><span class="token operator">&gt;</span> rootObjects <span class="token operator">=</span> engine<span class="token punctuation">.</span><span class="token function">rootObjects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> count <span class="token operator">=</span> rootObjects<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rootObjects<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">objectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"rootObject"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	  root <span class="token operator">=</span> rootObjects<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">new</span> <span class="token function">ChangeQmlColor</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
  QObject <span class="token operator">*</span>quitButton <span class="token operator">=</span> root<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">findChild</span><span class="token generic class-name"><span class="token operator">&lt;</span>QObject <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"quitButton"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>quitButton<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token class-name">QObject</span><span class="token double-colon punctuation">::</span><span class="token function">connect</span><span class="token punctuation">(</span>quitButton<span class="token punctuation">,</span> <span class="token function">SIGNAL</span><span class="token punctuation">(</span><span class="token function">clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>app<span class="token punctuation">,</span> <span class="token function">SLOT</span><span class="token punctuation">(</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  QObject <span class="token operator">*</span>textLabel <span class="token operator">=</span> root<span class="token operator">-&gt;</span><span class="token generic-function"><span class="token function">findChild</span><span class="token generic class-name"><span class="token operator">&lt;</span>QObject <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">"textLabel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>textLabel<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// this will failed</span>
	<span class="token keyword">bool</span> bRet <span class="token operator">=</span> <span class="token class-name">QMetaObject</span><span class="token double-colon punctuation">::</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span>textLabel<span class="token punctuation">,</span> <span class="token string">"setText"</span><span class="token punctuation">,</span><span class="token function">Q_ARG</span><span class="token punctuation">(</span>QString<span class="token punctuation">,</span> <span class="token string">"world hello"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"call setText return - "</span> <span class="token operator">&lt;&lt;</span> bRet<span class="token punctuation">;</span>
	textLabel<span class="token operator">-&gt;</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"color"</span><span class="token punctuation">,</span> <span class="token class-name">QColor</span><span class="token double-colon punctuation">::</span><span class="token function">fromRgb</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	bRet <span class="token operator">=</span> <span class="token class-name">QMetaObject</span><span class="token double-colon punctuation">::</span><span class="token function">invokeMethod</span><span class="token punctuation">(</span>textLabel<span class="token punctuation">,</span> <span class="token string">"doLayout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"call doLayout return - "</span> <span class="token operator">&lt;&lt;</span> bRet<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>&lt;main.qml&gt;</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">objectName</span><span class="token operator">:</span> <span class="token string">"rootObject"</span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	Text <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">objectName</span><span class="token operator">:</span> <span class="token string">"textLabel"</span>
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"Hello World"</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">26</span>
	<span class="token punctuation">}</span>
	Button <span class="token punctuation">{<!-- --></span>
		anchors<span class="token punctuation">.</span>right<span class="token operator">:</span> parent<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>rightMargin<span class="token operator">:</span> <span class="token number">4</span>
		anchors<span class="token punctuation">.</span>bottom<span class="token operator">:</span> parent<span class="token punctuation">.</span>bottom
		anchors<span class="token punctuation">.</span>bottomMargin<span class="token operator">:</span> <span class="token number">4</span>
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"quit"</span>
		<span class="token literal-property property">objectName</span><span class="token operator">:</span> <span class="token string">"quitButton"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="10__618"></a>10 动画</h3> 
<p>基本动画对象<br> <code>PropertyAnimation</code>：可以改变各种property产生动画<br> <code>NumberAnimation</code>：PropertyAnimation的派生类，专门改变数字类型的property产生动画<br> <code>ColorAnimation</code>：PropertyAnimation的派生类，专门改变color类型的property产生动画<br> <code>RotationAnimation</code>：PropertyAnimation的派生类，专门改变rotation的值产生动画<br> <code>Vector3dAnimation</code>：PropertyAnimation的派生类，再一个Vector3d发生变化时使用<br> <code>PathAnimation</code>：让对象沿着一个给定的路径运动<br> <code>SmoothAnimation</code>：允许一个property跟踪一个值，产生平滑动画<br> <code>SpringAnimation</code>：允许一个property跟踪一个值，动画效果类似于弹簧运动</p> 
<p>组合动画对象：<br> <code>SequentialAnimation</code>：顺序执行一系列动画<br> <code>ParallelAnimation</code>：并行执行一系列动画</p> 
<p>动画搭档：<br> <code>Behavior</code>：为Item的property变化绑定一个默认的动画对象<br> <code>ParentAnimation</code>：在改变一个Item的parent时使用，使得该Item从旧parent移动到新parent的过程更平滑，通常和Transition、State、ParentChange联合使用<br> <code>AnchorAnimation</code>：在改变一个Item的anchor时使用，平滑变化过程，通常和Transition、State、ParentChange联合使用<br> <code>PauseAnimation</code>：在动画过程中插入它，可以将动画过程暂停一段时间<br> <code>PropertyAction</code>：在动画执行过程中立即改变某个属性<br> <code>ScriptAction</code>：在动画执行过程中运行一段ECMAScript脚本</p> 
<h4><a id="101__641"></a>10.1 基本动画元素</h4> 
<p><code>Animation</code>是Qt Quick中所有动画类的基类<br> 有以下属性<br> <code>running</code>：布尔值，指示动画是否在运行，默认false，start()方法置为true，stop()方法置为false<br> <code>loops</code>：动画的执行次数，默认值1，赋值Animation.Infinite导致动画永远的循环执行下去<br> <code>paused</code>：布尔值，默认false，指定动画当前是否处于暂停状态，pause()方法置为true<br> <code>alwaysRunToEnd</code>：布尔值，默认false，是否即使stop()或设置running为false，动画也要执行完</p> 
<p>有以下方法：<br> <code>start()</code>：启动一个动画，如果动画已经执行，则什么也不干<br> <code>stop()</code>：终止一个动画，如果动画没执行完，那么动画操作的属性可能就是某个中间值<br> <code>restart()</code>：等同于先调用stop()，在调用start()<br> <code>pause()</code>：暂停一个动画，如果动画已经暂停，则什么也不干<br> <code>resume()</code>：和pause()对应，让一个动画继续执行<br> <code>complete()</code>：完成一个动画，如果动画执行到某个中间步骤，将使动画直接跳到结束状态</p> 
<p>有以下信号：<br> <code>started()</code>：动画开始时触发（只有顶层的动画才会触发信号，动画位于某个动画分组或Behavior、Transition中，则不会触发）<br> <code>stopped()</code>：动画（手动或自动）执行完毕进入停止状态时触发，只有单独的顶层动画才会触发</p> 
<p>启动动画的方法：</p> 
<ul><li>调用start()方法</li><li>设置running为true</li><li>为running绑定表达式，表达式求值结果为true</li></ul> 
<p>停止动画的方法：</p> 
<ul><li>调用stop()方法</li><li>设置running为false</li><li>触发running绑定表达式重新求值，且返回值为false</li><li>调用complete()方法</li></ul> 
<h5><a id="1012_PropertyAnimation_672"></a>10.1.2 PropertyAnimation（属性变化动画基类）</h5> 
<h6><a id="_673"></a>单独使用：</h6> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem
		Rectangle <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> rect
			<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
			<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">150</span>
			anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
			<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
			PropertyAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">id</span><span class="token operator">:</span> animation
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"width"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">150</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token punctuation">}</span>
			MouseArea <span class="token punctuation">{<!-- --></span>
				anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
				<span class="token literal-property property">onClicked</span><span class="token operator">:</span> animation<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//同时改变两个属性</span>
PropertyAnimation <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> animation<span class="token punctuation">;</span>
	<span class="token literal-property property">target</span><span class="token operator">:</span> rect<span class="token punctuation">;</span>
	<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"width,height"</span><span class="token punctuation">;</span>
	<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">220</span><span class="token punctuation">;</span>
	<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//同时改变两个对象</span>
PropertyAnimation <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> animation<span class="token punctuation">;</span>
	<span class="token literal-property property">targets</span><span class="token operator">:</span> <span class="token punctuation">[</span>rectA <span class="token punctuation">,</span> rectB<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"width"</span><span class="token punctuation">;</span>
	<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">150</span><span class="token punctuation">;</span>
	<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>target</code>：要操作的对象<br> <code>property</code>：要改变目标的哪个属性<br> <code>from</code>：要改变目标的初始值（默认，目标的当前值）<br> <code>to</code>：指定目标的目标值<br> <code>duration</code>：动画时间<br> <code>easing</code>：动画的松弛曲线</p> 
<h6><a id="_735"></a>在信号处理器中使用</h6> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">150</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> PropertyAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"width"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">150</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h6><a id="Animation_on_property_765"></a>使用Animation on &lt;property&gt;</h6> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">150</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
		<span class="token punctuation">}</span>
		PropertyAnimation on width <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">150</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token literal-property property">running</span><span class="token operator">:</span> mouseArea<span class="token punctuation">.</span>pressed
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p>如果不设置running属性，则动画对象将立即执行</p> 
</blockquote> 
<h6><a id="startstop_796"></a>使用start()和stop()信号</h6> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">150</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		property <span class="token keyword">var</span> animation
		PropertyAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> toSquare
			<span class="token literal-property property">target</span><span class="token operator">:</span> rect
			<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"width"</span>
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">150</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token literal-property property">onStarted</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				rect<span class="token punctuation">.</span>animation <span class="token operator">=</span> toSquare
				rect<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span>
			<span class="token punctuation">}</span>
			<span class="token literal-property property">onStopped</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				rect<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"blue"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		PropertyAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> toRect
			<span class="token literal-property property">target</span><span class="token operator">:</span> rect
			<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"width"</span>
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">50</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token literal-property property">onStarted</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				rect<span class="token punctuation">.</span>animation <span class="token operator">=</span> toRect
				rect<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span>
			<span class="token punctuation">}</span>
			<span class="token literal-property property">onStopped</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				rect<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"blue"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>rect<span class="token punctuation">.</span>animation <span class="token operator">===</span> toRect <span class="token operator">||</span> rect<span class="token punctuation">.</span>animation <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					toSquare<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					toRect<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="1013_NumberAnimation_857"></a>10.1.3 NumberAnimation</h5> 
<p>NumberAnimation是PropertyAnimation的派生类，专门用于处理数字类型的property<br> NumberAnimation重写了from和to两个属性类型为real，因此动画将会更加精细顺滑</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">95</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				animationX<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				animationRotation<span class="token punctuation">.</span>running <span class="token operator">=</span> <span class="token boolean">true</span>
				animationRadius<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		NumberAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> animationX
			<span class="token literal-property property">target</span><span class="token operator">:</span> rect
			<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"x"</span>
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">310</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>OutCubic
		<span class="token punctuation">}</span>
		NumberAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> animationRotation
			<span class="token literal-property property">target</span><span class="token operator">:</span> rect
			<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"rotation"</span>
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">1080</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token literal-property property">running</span><span class="token operator">:</span> <span class="token boolean">false</span>
			easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>OutInQuad
		<span class="token punctuation">}</span>
		NumberAnimation on radius <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> animationRadius
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">25</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token literal-property property">running</span><span class="token operator">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="1014_ColorAnimation_913"></a>10.1.4 ColorAnimation</h5> 
<p>ColorAnimation是PropertyAnimation的派生类，专门用于处理Color类型的property<br> ColorAnimation重写了from和to两个属性类型为color</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">60</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">60</span>
		<span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">30</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> ColorAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"color"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"green"</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="1015_RotationAnimation_946"></a>10.1.5 RotationAnimation</h5> 
<p>RotationAnimation是PropertyAnimation的派生类，专门处理rotation和angle属性<br> RotationAnimation重写了from和to两个属性类型为real</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">60</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> parent<span class="token punctuation">.</span>left
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">20</span>
		anchors<span class="token punctuation">.</span>verticalCenter<span class="token operator">:</span> parent<span class="token punctuation">.</span>verticalCenter
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> RotationAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">90</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1500</span>
				<span class="token literal-property property">direction</span><span class="token operator">:</span> RotationAnimation<span class="token punctuation">.</span>Counterclockwise
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> blueRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">120</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">60</span>
		anchors<span class="token punctuation">.</span>right<span class="token operator">:</span> parent<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>rightMargin<span class="token operator">:</span> <span class="token number">40</span>
		anchors<span class="token punctuation">.</span>verticalCenter<span class="token operator">:</span> parent<span class="token punctuation">.</span>verticalCenter
		<span class="token literal-property property">transformOrigin</span><span class="token operator">:</span> Item<span class="token punctuation">.</span>TopRight
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> anim<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		RotationAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> anim
			<span class="token literal-property property">target</span><span class="token operator">:</span> blueRect
			<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">60</span>
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1500</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>RotationAnimation新增一个<code>direction</code>属性，指定旋转方向</p> 
<ul><li><code>RotationAnimation.Numerical</code>：默认值，在from和to之间进行线性插值旋转</li><li><code>RotationAnimation.Clockwise</code>：在两个角度之间顺时间旋转</li><li><code>RotationAnimation.Counterclockwise</code>：在两个角度之间逆时针旋转</li><li><code>RotationAnimation.Shortest</code>：选取两个角度之间的最短路径旋转</li></ul> 
<p>RotationAnimation旋转一个Item时以Item的transformOrigin属性指定的点为中心旋转</p> 
<blockquote> 
 <p>使用RotationAnimation时不需要指定property属性，因为是固定的</p> 
</blockquote> 
<h5><a id="1016_PathAnimation_1009"></a>10.1.6 PathAnimation</h5> 
<p>PathAnimation是Animation继承而来，它让目标对象沿着一个既定的路径运动</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Canvas <span class="token punctuation">{<!-- --></span>
		anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token literal-property property">onPaint</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			<span class="token keyword">var</span> ctx <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">4</span>
			ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"red"</span>
			ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
			ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		Rectangle <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> rect
			<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">40</span>
			<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">40</span>
			<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
			<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">20</span>
			<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span>
			MouseArea <span class="token punctuation">{<!-- --></span>
				anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
				<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
				<span class="token literal-property property">onClicked</span><span class="token operator">:</span> pathAnim<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
			PathAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">id</span><span class="token operator">:</span> pathAnim
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">6000</span>
				<span class="token literal-property property">anchorPoint</span><span class="token operator">:</span> <span class="token string">"20,20"</span>
				<span class="token literal-property property">orientationEntryDuration</span><span class="token operator">:</span> <span class="token number">200</span>
				<span class="token literal-property property">orientationExitDuration</span><span class="token operator">:</span> <span class="token number">200</span>
				easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>InOutCubic
				<span class="token literal-property property">orientation</span><span class="token operator">:</span> PathAnimation<span class="token punctuation">.</span>TopFirst
				<span class="token literal-property property">path</span><span class="token operator">:</span> Path <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">startX</span><span class="token operator">:</span> <span class="token number">40</span>
					<span class="token literal-property property">startY</span><span class="token operator">:</span> <span class="token number">0</span>
					PathArc <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">360</span>
						<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span>
						<span class="token literal-property property">useLargeArc</span><span class="token operator">:</span> <span class="token boolean">true</span>
						<span class="token literal-property property">radiusX</span><span class="token operator">:</span> <span class="token number">160</span>
						<span class="token literal-property property">radiusY</span><span class="token operator">:</span> <span class="token number">160</span>
						<span class="token literal-property property">direction</span><span class="token operator">:</span> PathArc<span class="token punctuation">.</span>Counterclockwise
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>path</code>：构造的路径<br> <code>easing</code>：指定动画的松弛曲线<br> <code>anchorPoint</code>：指定目标对象的那个点锚定在路径上<br> <code>orienttation</code>：控制目标沿着路径移动的旋转策略</p> 
<ul><li><code>PathAnimation.Fixed</code>，orientation的默认值，在运动过程中保持物体方位不旋转。</li><li><code>PathAnimation.RightFirst</code>，旋转目标对象时努力使目标对象的右侧贴合路径。</li><li><code>PathAnimation.LeftFirst</code>，旋转目标对象时努力使目标对象的左侧贴合路径。</li><li><code>PathAnimation.BottomFirst</code>，旋转目标对象时努力使目标对象的底部贴合路径。</li><li><code>PathAnimation.TopFirst</code>，旋转目标对象时努力使目标对象的顶部贴合路径。</li></ul> 
<h5><a id="1017_SmoothedAnimation_1079"></a>10.1.7 SmoothedAnimation</h5> 
<p>SmoothedAnimation是NumberAnimation的派生类<br> 默认将easing.type设置为Easing.InOutQuad，在from和to之间产生平滑的动画效果</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">80</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">60</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">20</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">20</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
	<span class="token punctuation">}</span>
	SmoothedAnimation <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> smoothX
		<span class="token literal-property property">target</span><span class="token operator">:</span> rect
		<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"x"</span>
		<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
		<span class="token literal-property property">velocity</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span>
	<span class="token punctuation">}</span>
	SmoothedAnimation <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> smoothY
		<span class="token literal-property property">target</span><span class="token operator">:</span> rect
		<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"y"</span>
		<span class="token literal-property property">velocity</span><span class="token operator">:</span> <span class="token number">100</span>
	<span class="token punctuation">}</span>
	MouseArea <span class="token punctuation">{<!-- --></span>
		anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			smoothX<span class="token punctuation">.</span>from <span class="token operator">=</span> rect<span class="token punctuation">.</span>x
			smoothX<span class="token punctuation">.</span>to <span class="token operator">=</span> mouse<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token number">4</span>
			smoothX<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			smoothY<span class="token punctuation">.</span>from <span class="token operator">=</span> rect<span class="token punctuation">.</span>y
			smoothY<span class="token punctuation">.</span>to <span class="token operator">=</span> mouse<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token number">4</span>
			smoothY<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>easing.type</code>：默认设置为Easing.InOutQuad<br> <code>duration</code>：动画周期，单位毫秒，默认为-1<br> <code>velocity</code>：速率，默认速率200units/秒，设置为-1时禁用速率，如果from和to之间很小，则自行调整</p> 
<blockquote> 
 <p>当<code>duration</code>和<code>velocity</code>同时设置时，自动根据from、to之间举例和速率计算动画完成所需时间，用这个时间和<code>duration</code>比较，如果<code>duration</code>段，则用duration，否则使用velocity</p> 
</blockquote> 
<h5><a id="1018_SpringAnimation_1132"></a>10.1.8 SpringAnimation</h5> 
<p>SpringAnimation用于模仿弹簧的震荡效果</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">40</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">40</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">20</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">20</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
	<span class="token punctuation">}</span>
	SpringAnimation <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> springX
		<span class="token literal-property property">target</span><span class="token operator">:</span> rect
		<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"x"</span>
		<span class="token literal-property property">spring</span><span class="token operator">:</span> <span class="token number">3</span>
		<span class="token literal-property property">damping</span><span class="token operator">:</span> <span class="token number">0.06</span>
		<span class="token literal-property property">epsilon</span><span class="token operator">:</span> <span class="token number">0.25</span>
	<span class="token punctuation">}</span>
	SpringAnimation <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> springY
		<span class="token literal-property property">target</span><span class="token operator">:</span> rect
		<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"y"</span>
		<span class="token literal-property property">spring</span><span class="token operator">:</span> <span class="token number">3</span>
		<span class="token literal-property property">damping</span><span class="token operator">:</span> <span class="token number">0.06</span>
		<span class="token literal-property property">epsilon</span><span class="token operator">:</span> <span class="token number">0.25</span>
	<span class="token punctuation">}</span>
	MouseArea <span class="token punctuation">{<!-- --></span>
		anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
			springX<span class="token punctuation">.</span>from <span class="token operator">=</span> rect<span class="token punctuation">.</span>x
			springX<span class="token punctuation">.</span>to <span class="token operator">=</span> mouse<span class="token punctuation">.</span>x <span class="token operator">-</span> <span class="token number">20</span>
			springX<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			springY<span class="token punctuation">.</span>from <span class="token operator">=</span> rect<span class="token punctuation">.</span>y
			springY<span class="token punctuation">.</span>to <span class="token operator">=</span> mouse<span class="token punctuation">.</span>y <span class="token operator">-</span> <span class="token number">20</span>
			springY<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>spring</code>：控制动画的加速度，默认0，0-5.0之间取值<br> <code>damping</code>：衰减系数，值越大震荡越快平复，默认0，0-1.0之间取值<br> <code>epsilon</code>：设定一个最接近0的阈值来代替0，默认0.01，调整可带来性能提升<br> <code>velocity</code>：设定动画的最大速率，默认值为0，没有限制</p> 
<h4><a id="102__1186"></a>10.2 组合动画</h4> 
<p>组合动画包括：ParallelAnimation和SequentialAnimation</p> 
<h5><a id="1021_ParallelAnimation_1189"></a>10.2.1 ParallelAnimation</h5> 
<p>ParallelAnimation允许将多个动画元素组合在一起执行<br> ParallelAnimation中定义的多个动画将并行执行<br> ParallelAnimation从Animation继承而来，没有额外的属性，本身单独使用没有意义</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">95</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>anim<span class="token punctuation">.</span>paused<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					anim<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>anim<span class="token punctuation">.</span>running<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					anim<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					anim<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		ParallelAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> anim
			<span class="token literal-property property">loops</span><span class="token operator">:</span> Animation<span class="token punctuation">.</span>Infinite
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"x"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">310</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token punctuation">}</span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"rotation"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">360</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
				<span class="token literal-property property">loops</span><span class="token operator">:</span> <span class="token number">3</span>
			<span class="token punctuation">}</span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"radius"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">25</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="1022_SequentialAnimation_1250"></a>10.2.2 SequentialAnimation</h5> 
<p>SequentialAnimation中定义的动画将顺序执行</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">95</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>anim<span class="token punctuation">.</span>paused<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					anim<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>anim<span class="token punctuation">.</span>running<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					anim<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					rect<span class="token punctuation">.</span>radius <span class="token operator">=</span> <span class="token number">0</span>
					rect<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0</span>
					rect<span class="token punctuation">.</span>rotation <span class="token operator">=</span> <span class="token number">0</span>
					anim<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		SequentialAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> anim
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"x"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">310</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token punctuation">}</span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"rotation"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">360</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
				<span class="token literal-property property">loops</span><span class="token operator">:</span> <span class="token number">3</span>
			<span class="token punctuation">}</span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"radius"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token number">25</span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">3000</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h4><a id="103_State_1311"></a>10.3 State</h4> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>

	Text <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> centerText
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"A Single Text."</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">24</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onReleased</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				centerText<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"redText"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"redText"</span>
				<span class="token literal-property property">changes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					PropertyChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> centerText
						<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"blueText"</span>
				<span class="token literal-property property">when</span><span class="token operator">:</span> mouseArea<span class="token punctuation">.</span>pressed
				PropertyChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> centerText
					<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
					font<span class="token punctuation">.</span>bold<span class="token operator">:</span> <span class="token boolean">true</span>
					font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">32</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
		<span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"redText"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>Item有一个state属性，字符串，默认是空串<br> Item还有一个states属性，list&lt;State&gt;，保存为这个Item定义的所有的状态</p> 
<p>应用一种State的两种方式：</p> 
<ol><li>显式改变Item的state属性</li><li>将State的when属性绑定到一个表达式上</li></ol> 
<p><strong>State类型：</strong><br> <code>name</code>：字符串，保存状态的名字<br> <code>when</code>：布尔值，描述状态在什么时候应用，一般绑定在ECMAScript表达式上，true时应用<br> <code>extened</code>：字符串，指向当前状态的"基类"的名字<br> <code>changes</code>：list&lt;Change&gt;，保存应用于这种状态的所有变化，当进入一种State后，这个列表中的Change对象会依次顺序执行</p> 
<p>Change对象的类型有以下几种：</p> 
<ul><li><code>PropertyChanges</code>，用来改变一个对象的属性，对应的C++类为QQuickPropertyChanges，是- QQuickStateOperation的派生类。</li><li><code>ParentChange</code>，用来改变一个对象的父，对应的C++类为QQuickParentChange，是QQuickStateOperation的派生类。</li><li><code>AnchorChanges</code>，用来改变一个对象的锚布局参数，对应的C++类为QQuickAnchorChanges，是QQuickStateOperation的派生类。</li><li><code>StateChangeScript</code>，用来执行一个ECMAScript脚本，对应的C++ 类 为 QQuickStateChangeScript ， 是QQuickStateOperation的派生类。</li></ul> 
<h5><a id="1031_PropertyChanges_1380"></a>10.3.1 PropertyChanges</h5> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"resetwidth"</span>
				<span class="token literal-property property">when</span><span class="token operator">:</span> mouseArea<span class="token punctuation">.</span>pressed
				PropertyChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> rect
					<span class="token literal-property property">restoreEntryValues</span><span class="token operator">:</span> <span class="token boolean">false</span>
					<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
					<span class="token literal-property property">width</span><span class="token operator">:</span> parent<span class="token punctuation">.</span>width
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>target</code>：指向要改变的的目标对象<br> <code>restoreEntryValues</code>：布尔值，离开本状态时，是否将本状态改变的那些属性的值重置为进入本状态之前的值，默认true<br> <code>explicit</code>：如果设定目标属性时，使用表达式，是否将表达式视为一次性的赋值行为，还是每次都计算表达式。默认false，每次都计算</p> 
<h5><a id="1032_ParentChange_1421"></a>10.3.2 ParentChange</h5> 
<p>ParentChange用于改变一个对象的parent</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Rectangle <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"rootItem"</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> blueRect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">8</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">8</span>
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> redRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>x <span class="token operator">+</span> blueRect<span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token number">8</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>y
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"reparent"</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"default"</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"reparent"</span>
				ParentChange <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					<span class="token literal-property property">parent</span><span class="token operator">:</span> blueRect
					<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
					<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
					<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">30</span>
					<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">30</span>
					<span class="token literal-property property">rotation</span><span class="token operator">:</span> <span class="token number">45</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"default"</span>
				ParentChange <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					<span class="token literal-property property">parent</span><span class="token operator">:</span> rootItem
					<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span>
					<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
					<span class="token literal-property property">x</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>x <span class="token operator">+</span> blueRect<span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token number">8</span>
					<span class="token literal-property property">y</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>y
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>target</code>，指定要操作的目标对象<br> <code>parent</code>，指定目标对象的新parent<br> <code>x</code>，指定目标对象相对于新parent的x 位置<br> <code>y</code>，指定目标对象相对于新parent的y 位置<br> <code>width</code>，指定目标对象的宽度<br> <code>height</code>，指定目标对象的高度<br> <code>rotation</code>，指定目标对象的旋转角度<br> <code>scale</code>，指定目标对象的放大系数</p> 
<h5><a id="1033_AnchorChanges_1499"></a>10.3.3 AnchorChanges</h5> 
<p>AnchorChanges用于改变一个Item的锚布局属性</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Controls <span class="token number">2.15</span>

Rectangle <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> blueRect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">180</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">8</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">8</span>
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> redRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
		anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>right
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">10</span>
		anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>top
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"reanchor"</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"default"</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"reanchor"</span>
				<span class="token literal-property property">changes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					AnchorChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
						anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>bottom
						anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> rootItem<span class="token punctuation">.</span>left
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					PropertyChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
						<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">40</span>
						anchors<span class="token punctuation">.</span>topMargin<span class="token operator">:</span> <span class="token number">4</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"default"</span>
				AnchorChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>right
					anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>top
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><code>target</code>，指向目标对象。<br> <code>anchors.left</code><br> <code>anchors.right</code><br> <code>anchors.top</code><br> <code>anchors.bottom</code><br> <code>anchors.horizontalCenter</code><br> <code>anchors.verticalCenter</code><br> <code>anchors.baseline</code></p> 
<h5><a id="1034_StateChangeScript_1578"></a>10.3.4 StateChangeScript</h5> 
<p>StateChangeScript用于在状态改变时执行ECMAScript脚本<br> <strong>&lt;colorMaker.js&gt;</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">changeColor</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	obj<span class="token punctuation">.</span>color <span class="token operator">=</span> Qt<span class="token punctuation">.</span><span class="token function">rgba</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>&lt;main.qml&gt;</strong></p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>
<span class="token keyword">import</span> <span class="token string">"colorMaker.js"</span> <span class="token keyword">as</span> ColorMaker

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> colorRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">150</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">130</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"default"</span>
				<span class="token literal-property property">when</span><span class="token operator">:</span> mouseArea<span class="token punctuation">.</span>pressed
				StateChangeScript <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"changeColor"</span>
					<span class="token literal-property property">script</span><span class="token operator">:</span> ColorMaker<span class="token punctuation">.</span><span class="token function">changeColor</span><span class="token punctuation">(</span>colorRect<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>name</code>：脚本名称，可以被ScriptAction对象引用，以便服复用代码<br> <code>script</code>：实际的脚本代码</p> 
<h4><a id="104_Transition_1626"></a>10.4 Transition</h4> 
<p>Item的Transition属性是一个列表，保存为这个Item定义的所有Transition<br> 当一个Item从一个State切换到另一个State时，Transition定义的动画会自动在两个State之间运行，从而使得State状态切换的更加平滑</p> 
<pre><code class="prism language-javascript"><span class="token comment">//举例如下：</span>
Item <span class="token punctuation">{<!-- --></span>
<span class="token operator">...</span>
<span class="token literal-property property">transitions</span><span class="token operator">:</span> <span class="token punctuation">[</span>
	Transition <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">"stateA"</span><span class="token punctuation">;</span>
		<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"stateB"</span><span class="token punctuation">;</span>
		NumberAnimation <span class="token punctuation">{<!-- --></span> 
			<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"x,y"</span><span class="token punctuation">;</span> 
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">;</span> 
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	Transition <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">"stateB"</span><span class="token punctuation">;</span>
		<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"stateA"</span><span class="token punctuation">;</span>
		NumberAnimation <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"x,y"</span><span class="token punctuation">;</span> 
			<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">;</span> 
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"gray"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> State <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"pressed"</span>
			<span class="token literal-property property">when</span><span class="token operator">:</span> mouseArea<span class="token punctuation">.</span>pressed
			PropertyChanges <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">target</span><span class="token operator">:</span> rect
				<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"green"</span>
				<span class="token literal-property property">scale</span><span class="token operator">:</span> <span class="token number">2.0</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//begin, 增加过渡动画</span>
		<span class="token literal-property property">transitions</span><span class="token operator">:</span> Transition <span class="token punctuation">{<!-- --></span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"scale"</span>
				easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>InOutQuad
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token punctuation">}</span>
			ColorAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">600</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token comment">//end, 增加过渡动画</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>Transition的属性及成员函数如下：<br> <code>from</code>：用来指定触发过度状态名称，默认值为"<em>“，匹配所有状态<br> <code>to</code>：用来指定过滤的目标状态名称，默认值为”</em>"，匹配所有状态<br> <code>running</code>：这个Transition是否正在运行<br> <code>animations</code>：列表，保存为一个Transition定义的所有Animations<br> <code>reversible</code>：指定触发Transition的条件反转时Transition是否自动反转，默认false</p> 
<h5><a id="1041_Transition_1708"></a>10.4.1 Transition综合示例</h5> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem

	Text <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> linkText
		<span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">"I\'m web link."</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		font<span class="token punctuation">.</span>pixelSize<span class="token operator">:</span> <span class="token number">24</span>
		property <span class="token keyword">var</span> <span class="token literal-property property">hadClicked</span><span class="token operator">:</span> <span class="token boolean">false</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">hoverEnabled</span><span class="token operator">:</span> <span class="token boolean">true</span>
			<span class="token literal-property property">onEntered</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				linkText<span class="token punctuation">.</span>state <span class="token operator">=</span> linkText<span class="token punctuation">.</span>hadClicked <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token string">"clickedHover"</span> <span class="token operator">:</span> <span class="token string">"hover"</span>
			<span class="token punctuation">}</span>
			<span class="token literal-property property">onExited</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				linkText<span class="token punctuation">.</span>state <span class="token operator">=</span> linkText<span class="token punctuation">.</span>hadClicked <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token string">"clicked"</span> <span class="token operator">:</span> <span class="token string">"initial"</span>
			<span class="token punctuation">}</span>
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>linkText<span class="token punctuation">.</span>hadClicked <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					linkText<span class="token punctuation">.</span>hadClicked <span class="token operator">=</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>
				linkText<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"clicked"</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"initial"</span>
				<span class="token literal-property property">changes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					PropertyChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> linkText
						<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"hover"</span>
				PropertyChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> linkText
					<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#87CEFA"</span>
					font <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">italic</span><span class="token operator">:</span> <span class="token boolean">true</span>
						<span class="token literal-property property">pixelSize</span><span class="token operator">:</span> <span class="token number">36</span>
						<span class="token literal-property property">underline</span><span class="token operator">:</span> <span class="token boolean">true</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"clicked"</span>
				PropertyChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> linkText
					<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#8B4513"</span>
					font <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">pixelSize</span><span class="token operator">:</span> <span class="token number">24</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"clickedHover"</span>
				PropertyChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> linkText
					<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#D2691E"</span>
					font <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">italic</span><span class="token operator">:</span> <span class="token boolean">true</span>
						<span class="token literal-property property">pixelSize</span><span class="token operator">:</span> <span class="token number">36</span>
						<span class="token literal-property property">underline</span><span class="token operator">:</span> <span class="token boolean">true</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
		<span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"initial"</span>
		<span class="token literal-property property">transitions</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			Transition <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">"initial"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"hover"</span>
				<span class="token literal-property property">reversible</span><span class="token operator">:</span> <span class="token boolean">true</span>
				NumberAnimation <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"font.pixelSize"</span>
					<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
				<span class="token punctuation">}</span>
				ColorAnimation <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			Transition <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">"hover"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"clicked"</span>
				NumberAnimation <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"font.pixelSize"</span>
					<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
				<span class="token punctuation">}</span>
				ColorAnimation <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			Transition <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">"clicked"</span>
				<span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">"clickedHover"</span>
				<span class="token literal-property property">reversible</span><span class="token operator">:</span> <span class="token boolean">true</span>
				SequentialAnimation <span class="token punctuation">{<!-- --></span>
					NumberAnimation <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">"font.pixelSize"</span>
						<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
					<span class="token punctuation">}</span>
					ColorAnimation <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">800</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h4><a id="105__1833"></a>10.5 协同动画元素</h4> 
<p>Behavior对象用于给Item的某个属性绑定默认动画<br> ParentAnimation 、 AnchorAnimation通 常 需要和 Transition 、State联合使用<br> PauseAnimation可以插入在多个动画之间产生暂停效果<br> PropertyAction可以插入在多个动画之间来立即改变某个属性<br> ScriptAction用于在动画执行过程中运行一段ECMAScript脚本</p> 
<h5><a id="1051_Behavior_1840"></a>10.5.1 Behavior</h5> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.15</span>
<span class="token keyword">import</span> QtQuick<span class="token punctuation">.</span>Window <span class="token number">2.15</span>

Window <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">visible</span><span class="token operator">:</span> <span class="token boolean">true</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem

	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> rect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">160</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		anchors<span class="token punctuation">.</span>centerIn<span class="token operator">:</span> parent
		Behavior on width <span class="token punctuation">{<!-- --></span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		Behavior on height <span class="token punctuation">{<!-- --></span>
			NumberAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
				easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>InCubic
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				rect<span class="token punctuation">.</span>width <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> rootItem<span class="token punctuation">.</span>width
				rect<span class="token punctuation">.</span>height <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> rootItem<span class="token punctuation">.</span>height<span class="token punctuation">,</span> rect<span class="token punctuation">.</span>height <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h5><a id="1052_ParentAnimation_1881"></a>10.5.2 ParentAnimation</h5> 
<p>ParentAnimation是Animation的派生类<br> ParentAnimation在改变一个Item的parent时使用，使得旧parent移动到新parent的过程更平滑</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.2</span>

Rectangle <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> blueRect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">8</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">8</span>
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> redRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"default"</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"reparent"</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"default"</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"reparent"</span>
				ParentChange <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					<span class="token literal-property property">parent</span><span class="token operator">:</span> blueRect
					<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">50</span>
					<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">50</span>
					<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">30</span>
					<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">30</span>
					<span class="token literal-property property">rotation</span><span class="token operator">:</span> <span class="token number">45</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"default"</span>
				ParentChange <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					<span class="token literal-property property">parent</span><span class="token operator">:</span> rootItem
					<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span>
					<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
					<span class="token literal-property property">x</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>x <span class="token operator">+</span> blueRect<span class="token punctuation">.</span>width <span class="token operator">+</span> <span class="token number">8</span>
					<span class="token literal-property property">y</span><span class="token operator">:</span> blueRect<span class="token punctuation">.</span>y
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
		<span class="token literal-property property">transitions</span><span class="token operator">:</span> Transition <span class="token punctuation">{<!-- --></span>
			ParentAnimation <span class="token punctuation">{<!-- --></span>
				NumberAnimation <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">properties</span><span class="token operator">:</span> <span class="token string">"x,y"</span>
					<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><code>newParent</code>：指定目标对象的新parent<br> <code>target</code>：指定目标对象<br> <code>via</code>：动画过程中参考的其他对象</p> 
<h5><a id="1053_AnchorAnimation_1956"></a>10.5.3 AnchorAnimation</h5> 
<p>AnchorAnimation只能和Transition、AnchorChanges联合使用，不能在Behavior或其他动画元素中用</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> QtQuick <span class="token number">2.2</span>

Rectangle <span class="token punctuation">{<!-- --></span>
	<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">360</span>
	<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">240</span>
	<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"#EEEEEE"</span>
	<span class="token literal-property property">id</span><span class="token operator">:</span> rootItem
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> blueRect
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">200</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">180</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"blue"</span>
		<span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">8</span>
		<span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">8</span>
	<span class="token punctuation">}</span>
	Rectangle <span class="token punctuation">{<!-- --></span>
		<span class="token literal-property property">id</span><span class="token operator">:</span> redRect
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">"red"</span>
		<span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">100</span>
		<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">100</span>
		anchors<span class="token punctuation">.</span>leftMargin<span class="token operator">:</span> <span class="token number">10</span>
		MouseArea <span class="token punctuation">{<!-- --></span>
			<span class="token literal-property property">id</span><span class="token operator">:</span> mouseArea
			anchors<span class="token punctuation">.</span>fill<span class="token operator">:</span> parent
			<span class="token literal-property property">onClicked</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">||</span> redRect<span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"reanchor"</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
					redRect<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"default"</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token literal-property property">states</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"reanchor"</span>
				<span class="token literal-property property">changes</span><span class="token operator">:</span> <span class="token punctuation">[</span>
					AnchorChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
						anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>bottom
						anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> rootItem<span class="token punctuation">.</span>left
					<span class="token punctuation">}</span><span class="token punctuation">,</span>
					PropertyChanges <span class="token punctuation">{<!-- --></span>
						<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
						<span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">40</span>
						anchors<span class="token punctuation">.</span>topMargin<span class="token operator">:</span> <span class="token number">4</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			State <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"default"</span>
				AnchorChanges <span class="token punctuation">{<!-- --></span>
					<span class="token literal-property property">target</span><span class="token operator">:</span> redRect
					anchors<span class="token punctuation">.</span>left<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>right
					anchors<span class="token punctuation">.</span>top<span class="token operator">:</span> blueRect<span class="token punctuation">.</span>top
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
		<span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">"default"</span>
		<span class="token literal-property property">transitions</span><span class="token operator">:</span> Transition <span class="token punctuation">{<!-- --></span>
			AnchorAnimation <span class="token punctuation">{<!-- --></span>
				<span class="token literal-property property">duration</span><span class="token operator">:</span> <span class="token number">1000</span>
				easing<span class="token punctuation">.</span>type<span class="token operator">:</span> Easing<span class="token punctuation">.</span>OutInCubic
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>使用AnchorAnimation可以设定duration、easing、targets属性，和Transition结合使用时，无需target属性</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4e89fd7ea5732714b07504377fbc10ca/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">《qt quick核心编程》笔记四</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38dca7bbf943ed460ee3412c92c07726/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">按键状态机（实现单击，长按，双击）的模块分享</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>