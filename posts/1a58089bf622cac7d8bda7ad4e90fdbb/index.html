<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>tomact启动报错：org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="tomact启动报错：org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java" />
<meta property="og:description" content="问题描述： tomcat7.0.33版本启动项目报错，提示内存溢出，调整JVM内存，还是会偶尔启动报错。
java.util.concurrent.ExecutionException: java.lang.StackOverflowError at java.util.concurrent.FutureTask.report(FutureTask.java:122) at java.util.concurrent.FutureTask.get(FutureTask.java:188) at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123) at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549) at java.util.concurrent.FutureTask.run(FutureTask.java:262) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) at java.lang.Thread.run(Thread.java:744) Caused by: java.lang.StackOverflowError at java.util.HashSet.&lt;init&gt;(HashSet.java:102) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2243) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) 原因分析： tomcat7.0.3X版本支持servlet3.0的特性，比如说支持@WebServlet、@WebListener，要支持这些特性，tomcat就得去扫描所有的jar包里面的每个类。这个异常表明在扫描jar包的时候，递归调用太深，导致栈溢出了，tomcat给了一个馊主意，让你增大xss，这个还是不好，xss加大了，可用线程数就少了。
分析tomcat源代码，发现它扫描的流程如下：
1.扫描所有jar包
2.通过查找jar包中META-INF/services/javax.servlet.ServletContainerInitializer文件内的定义，初始化ServletContainerInitializer实现
3.如果web.xml中配置了metadata-complete=&#34;true&#34; 或者没有找到ServletContainerInitializer实现，都不会继续扫描jar包
网上大多数的答案的都是说在web.xml中加入了metadata-complete=&#34;true&#34;就能避免这个异常。确实在很多场景下，这个异常是能够避免。但是使用spring-web-3.1.0.RELEASE的同学就杯具了，这个jar包中定义了一个ServletContainerInitializer，还是导致了扫描jar包。
我们可以用另外的办法来解决这个问题，我们让tomcat不扫描指定的jar包，tomcat就要轻松得多了，org.apache.tomcat.util.scan.StandardJarScanner中定义了defaultJarsToSkip，有了这个东东，我们就可以跳过某些jar包。
如果你不想使用servlet3.0 annotation支持，在tomcat的catalina.properties配置文件中tomcat.util.scan.DefaultJarScanner.jarsToSkip的值后面加一个&#34;,*&#34;，这样就不会扫描所有的jar包了。启动更快，也不会出异常。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/1a58089bf622cac7d8bda7ad4e90fdbb/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-27T16:11:48+08:00" />
<meta property="article:modified_time" content="2022-07-27T16:11:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">tomact启动报错：org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>问题描述：</h2> 
<p>tomcat7.0.33版本启动项目报错，提示内存溢出，调整JVM内存，还是会偶尔启动报错。</p> 
<pre><code class="language-java">java.util.concurrent.ExecutionException: java.lang.StackOverflowError
    at java.util.concurrent.FutureTask.report(FutureTask.java:122)
    at java.util.concurrent.FutureTask.get(FutureTask.java:188)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask.run(FutureTask.java:262)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:744)
Caused by: java.lang.StackOverflowError
    at java.util.HashSet.&lt;init&gt;(HashSet.java:102)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2243)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)
    at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)</code></pre> 
<h2> 原因分析：</h2> 
<p>tomcat7.0.3X版本支持servlet3.0的特性，比如说支持@WebServlet、@WebListener，要支持这些特性，tomcat就得去扫描所有的jar包里面的每个类。这个异常表明在扫描jar包的时候，递归调用太深，导致栈溢出了，tomcat给了一个馊主意，让你增大xss，这个还是不好，xss加大了，可用线程数就少了。</p> 
<p>分析tomcat源代码，发现它扫描的流程如下：<br><br> 1.扫描所有jar包<br><br> 2.通过查找jar包中META-INF/services/javax.servlet.ServletContainerInitializer文件内的定义，初始化ServletContainerInitializer实现<br><br> 3.如果web.xml中配置了metadata-complete="true" 或者没有找到ServletContainerInitializer实现，都不会继续扫描jar包<br><br> 网上大多数的答案的都是说在web.xml中加入了metadata-complete="true"就能避免这个异常。确实在很多场景下，这个异常是能够避免。但是使用spring-web-3.1.0.RELEASE的同学就杯具了，这个jar包中定义了一个ServletContainerInitializer，还是导致了扫描jar包。<br><br> 我们可以用另外的办法来解决这个问题，我们让tomcat不扫描指定的jar包，tomcat就要轻松得多了，org.apache.tomcat.util.scan.StandardJarScanner中定义了defaultJarsToSkip，有了这个东东，我们就可以跳过某些jar包。<br><br> 如果你不想使用servlet3.0 annotation支持，在tomcat的catalina.properties配置文件中tomcat.util.scan.DefaultJarScanner.jarsToSkip的值后面加一个",*"，这样就不会扫描所有的jar包了。启动更快，也不会出异常。</p> 
<p class="img-center"><img alt="" height="347" src="https://images2.imgbox.com/ab/b2/IP8KsZMT_o.png" width="800"></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/930ef93e41d936f22f82a45d39cc6c0b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Windows中卷(Volume)操作，获取卷GUID、磁盘类型、磁盘大小等API</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/6df5d96dbb36f0c5c21e419308d9f277/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于JavaScript的Object所有方法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>