<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LearnOpenGL学习笔记—入门07：Coordinate Systems - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LearnOpenGL学习笔记—入门07：Coordinate Systems" />
<meta property="og:description" content="LearnOpenGL学习笔记—入门07：Coordinate Systems 0 前言1 坐标系统概述1.1 局部空间1.2 世界空间/模型矩阵1.3 观察空间/观察矩阵1.4 裁剪空间/投影矩阵1.4.1 正射投影1.4.2 透视投影 1.5 总结 2 代码实现2.1 更多的3d2.2 更多的立方体！2.2.1 关于DrawCall2.2.2 main代码 0 前言 本节笔记对应的内容 坐标系统
在入门01中我们配置好了环境
在入门02中我们可以检测输入并出现一个有颜色的窗口
在入门03中我们初步学习了图形渲染管线，尝试用不同方法画出了三角形和四边形
在入门04（上）中我们学习了shader和GLSL的相关知识，并给图形加上了变换的颜色以及彩色。
在入门04（下）中我们建立自己的shader类，并能够从外部读取shader的内容。
在入门05中我们了解了有关材质的内容
在入门06中，我们尝试用旋转矩阵以及四元数的方法组成变换矩阵，让它动起来，并对四元数的理解进行了一定阐述。
这一节我们会讲讲坐标系统，讲讲从3D空间得到2D平面的过程
1 坐标系统概述 在上一个教程中，我们学习了如何有效地利用矩阵的变换来对所有顶点进行变换，但是OpenGL希望在每次顶点着色器运行后，所有可见的所有顶点都为标准化设备坐标(Normalized Device Coordinate, NDC)。
标准化设备坐标，即每个顶点的x，y，z坐标都应该在-1.0到1.0之间，超出这个坐标范围的顶点都将不可见。将坐标变换为标准化设备坐标，接着再转化为屏幕坐标，这个过程通常是分步进行的，也就是类似于流水线那样子。在流水线中，物体的顶点在最终转化为屏幕坐标之前还会被变换到多个坐标系统(Coordinate System)。
将物体的坐标变换到几个过渡坐标系(Intermediate Coordinate System)的优点在于，在特定的坐标系统中，一些操作或运算更加方便和容易。对我们来说比较重要的总共有5个不同的坐标系统：
局部空间(Local Space，或者称为物体空间(Object Space))
世界空间(World Space)
观察空间(View Space，或者称为视觉空间(Eye Space))
裁剪空间(Clip Space)
屏幕空间(Screen Space)
这就是一个顶点在最终被转化为片段之前需要经历的所有不同状态。 为了将坐标从一个坐标系变换到另一个坐标系，我们需要用到几个变换矩阵，最重要的几个分别是
模型(Model)矩阵、观察(View)矩阵、投影(Projection)矩阵。联合起来就是我们常说的MVP矩阵我们的顶点坐标起始于局部空间(Local Space)，在这里它称为局部坐标(Local Coordinate)，它在之后会变为世界坐标(World Coordinate)，观察坐标(View Coordinate)，裁剪坐标(Clip Coordinate)，并最后以屏幕坐标(Screen Coordinate)的形式结束。 下面的这张图展示了整个流程以及各个变换过程做了什么：
局部坐标是对象相对于局部原点的坐标，也是物体起始的坐标。世界空间坐标是处于一个更大的空间范围的。这些坐标相对于世界的全局原点，它们会和其它物体一起相对于世界的原点进行摆放。将世界坐标变换为观察空间坐标，使得每个坐标都是从摄像机或者说观察者的角度进行观察的。坐标到达观察空间之后，我们需要将其投影到裁剪坐标。裁剪坐标会被处理至-1.0到1.0的范围内，并判断哪些顶点将会出现在屏幕上。最后，将裁剪坐标变换为屏幕坐标，我们将使用一个叫做视口变换(Viewport Transform)的过程。视口变换将位于-1.0到1.0范围的坐标变换到由glViewport函数所定义的坐标范围内。最后变换出来的坐标将会送到光栅器，将其转化为片段。 我们之所以将顶点变换到各个不同的空间的原因是有些操作在特定的坐标系统中才有意义且更方便。例如，当需要对物体进行修改的时候，在局部空间中来操作会更说得通；如果要对一个物体做出一个相对于其它物体位置的操作时，在世界坐标系中来做这个才更说得通，等等。
1.1 局部空间 拿拍照来举例，给一群人拍照，里面每个人都会调整各自的仪容仪表，各自调整就是在局部空间。 局部空间是指物体所在的坐标空间，即对象最开始所在的地方。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/49fcaa14f09593018f71a8fe9b46813a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-26T14:20:05+08:00" />
<meta property="article:modified_time" content="2020-07-26T14:20:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LearnOpenGL学习笔记—入门07：Coordinate Systems</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>LearnOpenGL学习笔记—入门07：Coordinate Systems</h4> 
 <ul><li><a href="#0__1" rel="nofollow">0 前言</a></li><li><a href="#1__11" rel="nofollow">1 坐标系统概述</a></li><li><ul><li><a href="#11__41" rel="nofollow">1.1 局部空间</a></li><li><a href="#12__48" rel="nofollow">1.2 世界空间/模型矩阵</a></li><li><a href="#13__59" rel="nofollow">1.3 观察空间/观察矩阵</a></li><li><a href="#14__71" rel="nofollow">1.4 裁剪空间/投影矩阵</a></li><li><ul><li><a href="#141__90" rel="nofollow">1.4.1 正射投影</a></li><li><a href="#142__111" rel="nofollow">1.4.2 透视投影</a></li></ul> 
   </li><li><a href="#15__141" rel="nofollow">1.5 总结</a></li></ul> 
  </li><li><a href="#2__143" rel="nofollow">2 代码实现</a></li><li><ul><li><a href="#21_3d_231" rel="nofollow">2.1 更多的3d</a></li><li><a href="#22__270" rel="nofollow">2.2 更多的立方体！</a></li><li><a href="#221_DrawCall_317" rel="nofollow">2.2.1 关于DrawCall</a></li><li><a href="#222_main_320" rel="nofollow">2.2.2 main代码</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="0__1"></a>0 前言</h2> 
<p>本节笔记对应的内容 <a href="https://learnopengl-cn.github.io/01%20Getting%20started/08%20Coordinate%20Systems/" rel="nofollow">坐标系统</a><br> 在<a href="https://editor.csdn.net/md/?articleId=106961379" rel="nofollow">入门01</a>中我们配置好了环境<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/106970090">入门02</a>中我们可以检测输入并出现一个有颜色的窗口<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/106982301">入门03</a>中我们初步学习了图形渲染管线，尝试用不同方法画出了三角形和四边形<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/106997376">入门04（上）</a>中我们学习了shader和GLSL的相关知识，并给图形加上了变换的颜色以及彩色。<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/107003753">入门04（下）</a>中我们建立自己的shader类，并能够从外部读取shader的内容。<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/107255602">入门05</a>中我们了解了有关材质的内容<br> 在<a href="https://blog.csdn.net/weixin_43803133/article/details/107449570">入门06</a>中，我们尝试用旋转矩阵以及四元数的方法组成变换矩阵，让它动起来，并对<a href="https://blog.csdn.net/weixin_43803133/article/details/107520595">四元数的理解</a>进行了一定阐述。<br> 这一节我们会讲讲坐标系统，讲讲从3D空间得到2D平面的过程</p> 
<h2><a id="1__11"></a>1 坐标系统概述</h2> 
<p>在上一个教程中，我们学习了如何有效地利用矩阵的变换来对所有顶点进行变换，但是OpenGL希望在每次顶点着色器运行后，所有可见的所有顶点都为标准化设备坐标(Normalized Device Coordinate, NDC)。</p> 
<ul><li>标准化设备坐标，即每个顶点的x，y，z坐标都应该在-1.0到1.0之间，超出这个坐标范围的顶点都将不可见。</li><li>将坐标变换为标准化设备坐标，接着再转化为屏幕坐标，这个过程通常是分步进行的，也就是类似于流水线那样子。</li><li>在流水线中，物体的顶点在最终转化为屏幕坐标之前还会被变换到多个坐标系统(Coordinate System)。<br> 将物体的坐标变换到几个过渡坐标系(Intermediate Coordinate System)的优点在于，在特定的坐标系统中，一些操作或运算更加方便和容易。</li><li>对我们来说比较重要的总共有5个不同的坐标系统：<br> 局部空间(Local Space，或者称为物体空间(Object Space))<br> 世界空间(World Space)<br> 观察空间(View Space，或者称为视觉空间(Eye Space))<br> 裁剪空间(Clip Space)<br> 屏幕空间(Screen Space)<br> 这就是一个顶点在最终被转化为片段之前需要经历的所有不同状态。</li></ul> 
<p>为了将坐标从一个坐标系变换到另一个坐标系，我们需要用到几个变换矩阵，最重要的几个分别是</p> 
<ul><li>模型(Model)矩阵、观察(View)矩阵、投影(Projection)矩阵。联合起来就是我们常说的MVP矩阵</li><li>我们的顶点坐标起始于局部空间(Local Space)，在这里它称为局部坐标(Local Coordinate)，它在之后会变为世界坐标(World Coordinate)，观察坐标(View Coordinate)，裁剪坐标(Clip Coordinate)，并最后以屏幕坐标(Screen Coordinate)的形式结束。</li></ul> 
<p>下面的这张图展示了整个流程以及各个变换过程做了什么：<br> <img src="https://images2.imgbox.com/8e/95/F5iiSnZI_o.png" alt="在这里插入图片描述"></p> 
<ul><li>局部坐标是对象相对于局部原点的坐标，也是物体起始的坐标。</li><li>世界空间坐标是处于一个更大的空间范围的。这些坐标相对于世界的全局原点，它们会和其它物体一起相对于世界的原点进行摆放。</li><li>将世界坐标变换为观察空间坐标，使得每个坐标都是从摄像机或者说观察者的角度进行观察的。</li><li>坐标到达观察空间之后，我们需要将其投影到裁剪坐标。裁剪坐标会被处理至-1.0到1.0的范围内，并判断哪些顶点将会出现在屏幕上。</li><li>最后，将裁剪坐标变换为屏幕坐标，我们将使用一个叫做视口变换(Viewport Transform)的过程。</li><li>视口变换将位于-1.0到1.0范围的坐标变换到由glViewport函数所定义的坐标范围内。</li><li>最后变换出来的坐标将会送到光栅器，将其转化为片段。</li></ul> 
<p>我们之所以将顶点变换到各个不同的空间的原因是有些操作在特定的坐标系统中才有意义且更方便。例如，当需要对物体进行修改的时候，在局部空间中来操作会更说得通；如果要对一个物体做出一个相对于其它物体位置的操作时，在世界坐标系中来做这个才更说得通，等等。</p> 
<h3><a id="11__41"></a>1.1 局部空间</h3> 
<ul><li>拿拍照来举例，给一群人拍照，里面每个人都会调整各自的仪容仪表，各自调整就是在局部空间。</li></ul> 
<p>局部空间是指物体所在的坐标空间，即对象最开始所在的地方。<br> 在一个建模软件中创建了一个立方体，创建的立方体的原点有可能位于(0, 0, 0)，即便它有可能最后在程序中处于完全不同的位置。<br> 有可能创建的所有模型都以(0, 0, 0)为初始位置（译注：然而它们会最终出现在世界的不同位置）。<br> 所以，模型的所有顶点都是在局部空间中，它们相对于物体来说都是局部的。</p> 
<h3><a id="12__48"></a>1.2 世界空间/模型矩阵</h3> 
<ul><li>给一群人拍个照片，我们要把他们各自整理好后，我们要把他们先集中起来，然后调整站位，角度。</li><li>集中起来调整，这一过程就是模型矩阵，所在的空间就是世界空间。</li></ul> 
<p>如果我们将我们所有的物体导入到程序当中，它们有可能会全挤在世界的原点(0, 0, 0)上，这并不是我们想要的结果。<br> 我们想为每一个物体定义一个位置，从而能在更大的世界当中放置它们。<br> 世界空间中的坐标正如其名：是指顶点相对于（游戏）世界的坐标。<br> 如果想将物体分散在世界上摆放，这个空间就是我们希望物体变换到的空间。<br> 物体的坐标将会从局部变换到世界空间；该变换是由模型矩阵(Model Matrix)实现的。<br> 模型矩阵是一种变换矩阵，它能通过对物体进行位移、缩放、旋转来将它置于它本应该在的位置或朝向。</p> 
<h3><a id="13__59"></a>1.3 观察空间/观察矩阵</h3> 
<ul><li>找一群人拍个照片，一切顺利后，摄像机对好方位。</li><li>摄像机也就是观察空间，而调整摄影机的过程，就是观察矩阵。</li></ul> 
<p>观察空间经常被人们称之OpenGL的摄像机(Camera)（所以有时也称为摄像机空间(Camera Space)或视觉空间(Eye Space)）。<br> 观察空间是将世界空间坐标转化为用户视野前方的坐标而产生的结果。<br> 因此观察空间就是从摄像机的视角所观察到的空间。<br> 这通常是由一系列的位移和旋转的组合来完成，平移/旋转场景从而使得特定的对象被变换到摄像机的前方。<br> 这些组合在一起的变换通常存储在一个观察矩阵(View Matrix)里，它被用来将世界坐标变换到观察空间。</p> 
<p>关于相机，我们将在下一节中进行讨论如何创建一个这样的观察矩阵来模拟一个摄像机。</p> 
<h3><a id="14__71"></a>1.4 裁剪空间/投影矩阵</h3> 
<ul><li>我们对着这群人拍照，按下快门，将三维的场景变成了平面照片，同时摄影机屏幕外的部分不要。</li><li>这一投影过程用到的就是投影矩阵，摄影机屏幕也就是裁剪空间。</li></ul> 
<p>在一个顶点着色器运行的最后，OpenGL期望所有的坐标都能落在一个特定的范围内，且任何在这个范围之外的点都应该被裁剪掉(Clipped)。<br> 被裁剪掉的坐标就会被忽略，所以剩下的坐标就将变为屏幕上可见的片段。这也就是裁剪空间(Clip Space)名字的由来。</p> 
<p>因为将所有可见的坐标都指定在-1.0到1.0的范围内不是很直观，所以我们会指定自己的坐标集(Coordinate Set)并将它变换回标准化设备坐标系。</p> 
<p>为了将顶点坐标从观察变换到裁剪空间，我们需要定义一个投影矩阵(Projection Matrix)，它指定了一个范围的坐标，比如在每个维度上的-1000到1000。<br> 投影矩阵接着会将在这个指定的范围内的坐标变换为标准化设备坐标的范围(-1.0, 1.0)。<br> 所有在范围外的坐标不会被映射到在-1.0到1.0的范围之间，所以会被裁剪掉。</p> 
<p>将特定范围内的坐标转化到标准化设备坐标系的过程被称之为投影(Projection)。</p> 
<p>将观察坐标变换为裁剪坐标的投影矩阵可以为两种不同的形式，每种形式都定义了不同的平截头体（(Frustum，即为由投影矩阵创建的观察箱(Viewing Box))。</p> 
<p>我们可以选择创建一个正射投影矩阵(Orthographic Projection Matrix)或一个透视投影矩阵(Perspective Projection Matrix)。<br> <img src="https://images2.imgbox.com/a8/02/iTooUfhn_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="141__90"></a>1.4.1 正射投影</h4> 
<p><img src="https://images2.imgbox.com/ad/cb/mvGMIQxG_o.png" alt="在这里插入图片描述"><br> 正射投影矩阵定义了一个类似立方体的平截头箱，它定义了一个裁剪空间，在这空间之外的顶点都会被裁剪掉，投影完没有透视效果。<br> 创建一个正射投影矩阵需要指定可见平截头体的宽、高和长度。<br> 它的平截头体看起来像一个容器：<br> <img src="https://images2.imgbox.com/4d/21/kyDEN7h1_o.png" alt="在这里插入图片描述"><br> 由这个平截头体映射到标准化设备坐标，我们会这么做，利用位移和缩放矩阵，先将它移动到场景中心，然后缩放到标准大小。<br> <img src="https://images2.imgbox.com/1b/85/6jmzbBTI_o.png" alt="在这里插入图片描述"></p> 
<p>要创建一个正射投影矩阵，我们可以使用GLM的内置函数glm::ortho</p> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span><span class="token function">ortho</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">800.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">600.0f</span><span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">100.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>前两个参数指定了平截头体的左右坐标，第三和第四参数指定了平截头体的底部和顶部。通过这四个参数我们定义了近平面和远平面的大小。<br> 第五和第六个参数则定义了近平面和远平面的距离。<br> 这个投影矩阵会将处于这些x，y，z值范围内的坐标变换为标准化设备坐标。</li></ul> 
<p>因为正射投影没有使用透视，远处的物体不会显得更小，所以产生奇怪的视觉效果。由于这个原因，正射投影主要用于二维渲染以及一些建筑或工程的程序，在那些我们希望顶点不会被透视所干扰的场景里。</p> 
<h4><a id="142__111"></a>1.4.2 透视投影</h4> 
<ul><li> <p>对透视投影进行概述<br> <img src="https://images2.imgbox.com/09/ec/zStRjZWc_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/93/c6/YXSt7pxj_o.png" alt="在这里插入图片描述"></p> </li><li> <p><img src="https://images2.imgbox.com/cb/23/lLc2uGWH_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/88/65/LjPVgS6T_o.png" alt="在这里插入图片描述"></p> </li><li> <p>经过上述说明，我们明白我们要做的是把透视投影变成正射投影，再用之前正射投影的办法得到标准化设备坐标。<br> <img src="https://images2.imgbox.com/f7/4e/2AUhgZ0C_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/19/86/KAyJhPgN_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/f5/02/cwbM1KhB_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/b1/a5/PaVF4fhe_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/b4/ab/GF0keGFk_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/5d/5e/gvLDsLO2_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/9a/db/4nxFBUdk_o.png" alt="在这里插入图片描述"></p> </li></ul> 
<p>带入之前正射投影的结果，得到透视投影矩阵最终结果（这个结果中是以“挤压矩阵”是以-z方向算的，所以正负号有一些差异）<br> <img src="https://images2.imgbox.com/86/cf/3ufMzCyT_o.png" alt="在这里插入图片描述"><br> 关于z值的变化我们其实可以带入算出来<br> <img src="https://images2.imgbox.com/fa/5d/dRExqWcv_o.png" alt="在这里插入图片描述"><br> 以下是一些查到的方法<br> <img src="https://images2.imgbox.com/13/dc/BT48DSTl_o.png" alt="在这里插入图片描述"><br> 在GLM中可以这样创建一个透视投影矩阵：</p> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span>mat4 proj <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">perspective</span><span class="token punctuation">(</span>glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token number">45.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>width<span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>height<span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">100.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>它的第一个参数定义了fov的值，它表示的是视野(Field of View)，并且设置了观察空间的大小，也就是张角大小。<br> 如果想要一个真实的观察效果，通常设置为45.0f，但想要一个末日风格的结果可以将其设置一个更大的值。</li><li>第二个参数设置了宽高比，由视口的宽除以高所得。</li><li>第三和第四个参数设置了平截头体的近和远平面。我们通常设置近距离为0.1f，而远距离设为100.0f。</li><li>所有在近平面和远平面内且处于平截头体内的顶点都会被渲染。</li></ul> 
<h3><a id="15__141"></a>1.5 总结</h3> 
<p><img src="https://images2.imgbox.com/95/ed/zIU6xHmM_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2__143"></a>2 代码实现</h2> 
<p>我们为上述的每一个步骤都创建了一个变换矩阵：模型矩阵、观察矩阵和投影矩阵。<br> 一个顶点坐标将会根据以下过程被变换到裁剪坐标：<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          V 
         
         
         
           c 
          
         
           l 
          
         
           i 
          
         
           p 
          
         
        
       
         = 
        
        
        
          M 
         
         
         
           p 
          
         
           r 
          
         
           o 
          
         
           j 
          
         
           e 
          
         
           c 
          
         
           t 
          
         
           i 
          
         
           o 
          
         
           n 
          
         
        
       
         ⋅ 
        
        
        
          M 
         
         
         
           v 
          
         
           i 
          
         
           e 
          
         
           w 
          
         
        
       
         ⋅ 
        
        
        
          M 
         
         
         
           m 
          
         
           o 
          
         
           d 
          
         
           e 
          
         
           l 
          
         
        
       
         ⋅ 
        
        
        
          V 
         
         
         
           l 
          
         
           o 
          
         
           c 
          
         
           a 
          
         
           l 
          
         
        
       
      
        V_{clip}=M_{projection}⋅M_{view}⋅M_{model}⋅V_{local} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right: 0.05724em;">j</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">t</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">d</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.22222em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br> 矩阵运算的顺序是相反的（我们需要从右往左阅读矩阵的乘法）。<br> 最后的顶点应该被赋值到顶点着色器中的gl_Position，OpenGL将会自动进行透视除法和裁剪。</p> 
<ul><li> <p>我们刚才使用变换矩阵,让顶点着色器的输出要求所有的顶点，都在裁剪空间内。<br> OpenGL然后对裁剪坐标执行透视除法从而将它们变换到标准化设备坐标。<br> OpenGL会使用glViewPort内部的参数来将标准化设备坐标映射到屏幕坐标，每个坐标都关联了一个屏幕上的点（在我们的例子中是一个800x600的屏幕）。<br> 这个过程称为视口变换。</p> </li><li> <p>我们首先创建一个模型矩阵。<br> 这个模型矩阵包含了位移、缩放与旋转操作，它们会被应用到所有物体的顶点上，以变换它们到全局的世界空间。<br> 让我们变换一下我们的平面，将其绕着x轴旋转，使它看起来像放在地上一样。<br> 这个模型矩阵看起来是这样的：</p> </li></ul> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span>mat4 modelMat<span class="token punctuation">;</span>
modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">55.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>接下来我们需要创建一个观察矩阵。<br> 我们想要在场景里面稍微往后移动，以使得物体变成可见（当在世界空间时，我们位于原点(0,0,0)）。<br> 将摄像机向后移动，和将整个场景向前移动是一样的。<br> 这正是观察矩阵所做的，我们以相反于摄像机移动的方向移动整个场景。<br> 因为我们想要往后移动，并且OpenGL是一个右手坐标系(Right-handed System)，所以我们需要沿着z轴的正方向移动。<br> 我们会通过将场景沿着z轴负方向平移来实现，它会给我们一种我们在往后移动的感觉。</li></ul> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span>mat4 viewMat<span class="token punctuation">;</span>
<span class="token comment">// 注意，我们将矩阵向我们要进行移动场景的反方向移动。</span>
viewMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">translate</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>最后我们需要做的是定义一个投影矩阵。我们希望在场景中使用透视投影，所以像这样声明一个投影矩阵：</li></ul> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span>mat4 projection<span class="token punctuation">;</span>
projection <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">perspective</span><span class="token punctuation">(</span>glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token number">45.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> screenWidth <span class="token operator">/</span> screenHeight<span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">100.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>合并起来即</p> 
<pre><code class="prism language-cpp"><span class="token comment">//M</span>
glm<span class="token operator">::</span>mat4 modelMat<span class="token punctuation">;</span>
modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">55.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//V</span>
glm<span class="token operator">::</span>mat4 viewMat<span class="token punctuation">;</span>
<span class="token comment">// 注意，我们将矩阵向我们要进行移动场景的反方向移动。</span>
viewMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">translate</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//P</span>
glm<span class="token operator">::</span>mat4 projMat<span class="token punctuation">;</span>
projMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">perspective</span><span class="token punctuation">(</span>glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token number">45.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">800.0f</span> <span class="token operator">/</span> <span class="token number">600.0f</span><span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">100.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在顶点着色器中改一下</p> 
<pre><code class="prism language-cpp"><span class="token macro property">#version 330 core									  </span>
<span class="token function">layout</span><span class="token punctuation">(</span>location <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> in vec3 aPos<span class="token punctuation">;</span>   <span class="token comment">// 位置变量的属性位置值为 0</span>
<span class="token function">layout</span><span class="token punctuation">(</span>location <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> in vec3 aColor<span class="token punctuation">;</span> <span class="token comment">// 颜色变量的属性位置值为 1</span>
<span class="token function">layout</span><span class="token punctuation">(</span>location <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> in vec2 aTexCoord<span class="token punctuation">;</span> <span class="token comment">// uv变量的属性位置值为 2</span>

out vec4 vertexColor<span class="token punctuation">;</span>
out vec2 TexCoord<span class="token punctuation">;</span>

<span class="token comment">//uniform mat4 transform;</span>
uniform mat4 modelMat<span class="token punctuation">;</span>
uniform mat4 viewMat<span class="token punctuation">;</span>
uniform mat4 projMat<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>										   
   gl_Position <span class="token operator">=</span>  projMat <span class="token operator">*</span> viewMat <span class="token operator">*</span> modelMat <span class="token operator">*</span> <span class="token function">vec4</span><span class="token punctuation">(</span>aPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> aPos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> aPos<span class="token punctuation">.</span>z<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
   vertexColor <span class="token operator">=</span> <span class="token function">vec4</span><span class="token punctuation">(</span>aColor<span class="token punctuation">,</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
   TexCoord <span class="token operator">=</span> aTexCoord<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>然后在渲染循环里加上</p> 
<pre><code class="prism language-cpp"><span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"modelMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"viewMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"projMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>projMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>最终的物体应该会：</p> 
<ul><li>稍微向后倾斜至地板方向。</li><li>离我们有一些距离。</li><li>有透视效果（顶点越远，变得越小）。<br> <img src="https://images2.imgbox.com/c9/8e/kLOJcThc_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="21_3d_231"></a>2.1 更多的3d</h3> 
<p>到目前为止，我们一直都在使用一个2D平面，而且在3D空间里！<br> 所以，让我们大胆地拓展我们的2D平面为一个3D立方体。<br> 要想渲染一个立方体，我们一共需要36个顶点（6个面 x 每个面有2个三角形组成 x 每个三角形有3个顶点），可以从<a href="https://learnopengl.com/code_viewer.php?code=getting-started/cube_vertices" rel="nofollow">这里</a>获取顶点位置，代替原本的vertices数组<br> 并且修改顶点属性</p> 
<pre><code class="prism language-cpp"><span class="token comment">// 位置属性</span>
<span class="token function">glVertexAttribPointer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">glEnableVertexAttribArray</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 颜色属性</span>
<span class="token comment">//glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(float), (void*)(3 * sizeof(float)));</span>
<span class="token comment">//glEnableVertexAttribArray(1);</span>
<span class="token comment">// uv属性</span>
<span class="token function">glVertexAttribPointer</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">glEnableVertexAttribArray</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>把和EBO有关的全部注释掉，用直接画数组的方式画出图形</p> 
<pre><code class="prism language-cpp"><span class="token function">glDrawArrays</span><span class="token punctuation">(</span>GL_TRIANGLES<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>并且在开启窗口（glViewport(0, 0, 800, 600);）的后面启动深度缓存</p> 
<pre><code class="prism language-cpp"><span class="token function">glEnable</span><span class="token punctuation">(</span>GL_DEPTH_TEST<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>在渲染循环中，每次渲染迭代之前清除深度缓冲（否则前一帧的深度信息仍然保存在缓冲中）</p> 
<pre><code class="prism language-cpp"><span class="token function">glClear</span><span class="token punctuation">(</span>GL_COLOR_BUFFER_BIT <span class="token operator">|</span> GL_DEPTH_BUFFER_BIT<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<ul><li>Z缓冲<br> OpenGL存储它的所有深度信息于一个Z缓冲(Z-buffer)中，也被称为深度缓冲(Depth Buffer)。<br> GLFW会自动为你生成这样一个缓冲（就像它也有一个颜色缓冲来存储输出图像的颜色）。<br> 深度值存储在每个片段里面（作为片段的z值），当片段想要输出它的颜色时，OpenGL会将它的深度值和z缓冲进行比较，如果当前的片段在其它片段之后，它将会被丢弃，否则将会覆盖。<br> 这个过程称为深度测试(Depth Testing)，它是由OpenGL自动完成的。</li></ul> 
<p><img src="https://images2.imgbox.com/c8/62/YSpgpwCm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22__270"></a>2.2 更多的立方体！</h3> 
<p>现在我们想在屏幕上显示10个立方体。<br> 每个立方体看起来都是一样的，区别在于它们在世界的位置及旋转角度不同。<br> 立方体的图形布局已经定义好了，所以当渲染更多物体的时候我们不需要改变我们的缓冲数组和属性数组，我们唯一需要做的只是改变每个对象的模型矩阵来将立方体变换到世界坐标系中。</p> 
<p>首先，让我们为每个立方体定义一个位移向量来指定它在世界空间的位置。我们将在一个glm::vec3数组中定义10个立方体位置</p> 
<pre><code class="prism language-cpp">glm<span class="token operator">::</span>vec3 cubePositions<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">2.0f</span><span class="token punctuation">,</span>  <span class="token number">5.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">15.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.8f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">12.3f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">2.4f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.7f</span><span class="token punctuation">,</span>  <span class="token number">3.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">1.3f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">1.5f</span><span class="token punctuation">,</span>  <span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span> <span class="token number">1.5f</span><span class="token punctuation">,</span>  <span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.3f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>现在，在渲染循环中，我们调用glDrawArrays 10次，但这次在我们渲染之前每次传入一个不同的模型矩阵到顶点着色器中。<br> 我们将会在游戏循环中创建一个小的循环用不同的模型矩阵渲染我们的物体10次。<br> 我们也对每个箱子也稍微加了一点旋转：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
		glm<span class="token operator">::</span>mat4 modelMat<span class="token punctuation">;</span>
		modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">translate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> cubePositions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">float</span> angle <span class="token operator">=</span> <span class="token number">20.0f</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
		modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		myShader<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glUniform1i</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"ourTexture"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glUniform1i</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"ourFace"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//glUniformMatrix4fv(glGetUniformLocation(myShader-&gt;ID, "transform"), 1, GL_FALSE, glm::value_ptr(trans));</span>
		<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"modelMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"viewMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"projMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>projMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span>
		<span class="token function">glDrawArrays</span><span class="token punctuation">(</span>GL_TRIANGLES<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/a1/2d/bLzmR1y5_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="221_DrawCall_317"></a>2.2.1 关于DrawCall</h3> 
<p>我们调用glDrawArrays 10次，对应Unity中有个叫DrawCall的东西<br> 我们调用glDrawArrays 10次也就是会发出10个DrawCall，每画一次物体就是呼叫一个DrawCall</p> 
<h3><a id="222_main_320"></a>2.2.2 main代码</h3> 
<p>mian.cpp的代码如下</p> 
<pre><code class="prism language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> GLEW_STATIC</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;GL/glew.h&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;GLFW/glfw3.h&gt;</span></span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Shader.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> STB_IMAGE_IMPLEMENTATION</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"stb_image.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;glm/glm.hpp&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;glm/gtc/matrix_transform.hpp&gt;</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;glm/gtc/type_ptr.hpp&gt;</span></span>


<span class="token comment">//float vertices[] = {<!-- --></span>
<span class="token comment">//	//     ---- 位置 ----       ---- 颜色 ----     - 纹理坐标 -</span>
<span class="token comment">//		 0.5f,  0.5f, 0.0f,   1.0f, 0.0f, 0.0f,   1.0f, 1.0f,   // 右上</span>
<span class="token comment">//		 0.5f, -0.5f, 0.0f,   0.0f, 1.0f, 0.0f,   1.0f, 0.0f,   // 右下</span>
<span class="token comment">//		-0.5f, -0.5f, 0.0f,   0.0f, 0.0f, 1.0f,   0.0f, 0.0f,   // 左下</span>
<span class="token comment">//		-0.5f,  0.5f, 0.0f,   1.0f, 1.0f, 0.0f,   0.0f, 1.0f    // 左上</span>
<span class="token comment">//};</span>
<span class="token comment">//0 1 2   2 3 0</span>
<span class="token comment">//unsigned int indices[] = {<!-- --></span>
<span class="token comment">//	0,1,2,</span>
<span class="token comment">//	2,3,0</span>
<span class="token comment">//};</span>

<span class="token keyword">float</span> vertices<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>

	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>

	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>

	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>

	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>

	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	 <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span>
	<span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

glm<span class="token operator">::</span>vec3 cubePositions<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">,</span>  <span class="token number">0.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">2.0f</span><span class="token punctuation">,</span>  <span class="token number">5.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">15.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3.8f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">12.3f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">2.4f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.4f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.7f</span><span class="token punctuation">,</span>  <span class="token number">3.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.3f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.5f</span><span class="token punctuation">,</span>  <span class="token number">2.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.5f</span><span class="token punctuation">,</span>  <span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.3f</span><span class="token punctuation">,</span>  <span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.5f</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">processInput</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> window<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">glfwGetKey</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> GLFW_KEY_ESCAPE <span class="token punctuation">)</span><span class="token operator">==</span> GLFW_PRESS<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">glfwSetWindowShouldClose</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	

	<span class="token function">glfwInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MAJOR<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MINOR<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_OPENGL_PROFILE<span class="token punctuation">,</span> GLFW_OPENGL_CORE_PROFILE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">//Open GLFW Window</span>
	GLFWwindow<span class="token operator">*</span> window <span class="token operator">=</span> <span class="token function">glfwCreateWindow</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token string">"My OpenGL Game"</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">,</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>window <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Open window failed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwTerminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">glfwMakeContextCurrent</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//Init GLEW</span>
	glewExperimental <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">glewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> GLEW_OK<span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Init GLEW failed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwTerminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token function">glViewport</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glEnable</span><span class="token punctuation">(</span>GL_DEPTH_TEST<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//glEnable(GL_CULL_FACE);</span>
	<span class="token comment">//glCullFace(GL_BACK);</span>
	<span class="token comment">//glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);</span>

	Shader<span class="token operator">*</span> myShader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Shader</span><span class="token punctuation">(</span><span class="token string">"vertexSource.txt"</span><span class="token punctuation">,</span> <span class="token string">"fragmentSource.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> VAO<span class="token punctuation">;</span>
	<span class="token function">glGenVertexArrays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>VAO<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glBindVertexArray</span><span class="token punctuation">(</span>VAO<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> VBO<span class="token punctuation">;</span>
	<span class="token function">glGenBuffers</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>VBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glBindBuffer</span><span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span>VBO<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glBufferData</span><span class="token punctuation">(</span>GL_ARRAY_BUFFER<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>vertices<span class="token punctuation">)</span><span class="token punctuation">,</span> vertices<span class="token punctuation">,</span> GL_STATIC_DRAW<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//unsigned int EBO;</span>
	<span class="token comment">//glGenBuffers(1, &amp;EBO);</span>
	<span class="token comment">//glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span>
	<span class="token comment">//glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);</span>

	<span class="token comment">// 位置属性</span>
	<span class="token function">glVertexAttribPointer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glEnableVertexAttribArray</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 颜色属性</span>
	<span class="token comment">//glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(float), (void*)(3 * sizeof(float)));</span>
	<span class="token comment">//glEnableVertexAttribArray(1);</span>
	<span class="token comment">// uv属性</span>
	<span class="token function">glVertexAttribPointer</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> GL_FLOAT<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glEnableVertexAttribArray</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">stbi_set_flip_vertically_on_load</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> TexBufferA<span class="token punctuation">;</span>
	<span class="token function">glGenTextures</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>TexBufferA<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glActiveTexture</span><span class="token punctuation">(</span>GL_TEXTURE0<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glBindTexture</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> TexBufferA<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 为当前绑定的纹理对象设置环绕、过滤方式</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_S<span class="token punctuation">,</span> GL_REPEAT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_T<span class="token punctuation">,</span> GL_REPEAT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MIN_FILTER<span class="token punctuation">,</span> GL_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MAG_FILTER<span class="token punctuation">,</span> GL_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MIN_FILTER<span class="token punctuation">,</span> GL_LINEAR_MIPMAP_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 加载并生成纹理</span>
	<span class="token keyword">int</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> nrChannel<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>data <span class="token operator">=</span> <span class="token function">stbi_load</span><span class="token punctuation">(</span><span class="token string">"container.jpg"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>width<span class="token punctuation">,</span> <span class="token operator">&amp;</span>height<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nrChannel<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">glTexImage2D</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGB<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGB<span class="token punctuation">,</span> GL_UNSIGNED_BYTE<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glGenerateMipmap</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed to load texture"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token function">stbi_image_free</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> TexBufferB<span class="token punctuation">;</span>
	<span class="token function">glGenTextures</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>TexBufferB<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glActiveTexture</span><span class="token punctuation">(</span>GL_TEXTURE1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glBindTexture</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> TexBufferB<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">// 为当前绑定的纹理对象设置环绕、过滤方式</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_S<span class="token punctuation">,</span> GL_REPEAT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_WRAP_T<span class="token punctuation">,</span> GL_REPEAT<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MIN_FILTER<span class="token punctuation">,</span> GL_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MAG_FILTER<span class="token punctuation">,</span> GL_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glTexParameteri</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> GL_TEXTURE_MIN_FILTER<span class="token punctuation">,</span> GL_LINEAR_MIPMAP_LINEAR<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 加载并生成纹理</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>data2 <span class="token operator">=</span> <span class="token function">stbi_load</span><span class="token punctuation">(</span><span class="token string">"awesomeface.png"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>width<span class="token punctuation">,</span> <span class="token operator">&amp;</span>height<span class="token punctuation">,</span> <span class="token operator">&amp;</span>nrChannel<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>data2<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
		<span class="token function">glTexImage2D</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGBA<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> GL_RGBA<span class="token punctuation">,</span> GL_UNSIGNED_BYTE<span class="token punctuation">,</span> data2<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glGenerateMipmap</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Failed to load texture"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">stbi_image_free</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">计算变换矩阵</span>
	glm<span class="token operator">::</span>mat4 trans<span class="token punctuation">;</span>
 <span class="token comment">//   trans = glm::translate(trans, glm::vec3(1.0f, 0.0f, 0.0f));</span>
	<span class="token comment">trans = glm::rotate(trans, glm::radians(45.0f), glm::vec3(0.0, 0.0, 1.0));</span>
	<span class="token comment">glm::quat MyQuaternion = angleAxis(glm::radians(45.0f), glm::vec3(0.0, 0.0, 1.0));</span>
	<span class="token comment">//glm::quat MyQuaternion = glm::quat(cos(glm::radians(22.5f)),0,0,sin(glm::radians(22.5f)));</span>
	<span class="token comment">//glm::mat4 RotationMatrix = glm::mat4_cast(MyQuaternion);</span>
	<span class="token comment">//trans *= RotationMatrix;</span>
	<span class="token comment">//trans = glm::scale(trans, glm::vec3(0.5, 0.5, 0.5));</span>
	
	<span class="token comment">//M</span>
	<span class="token comment">//glm::mat4 modelMat;</span>
	<span class="token comment">//modelMat = glm::rotate(modelMat, glm::radians(-55.0f), glm::vec3(1.0f, 0.0f, 0.0f));</span>
	<span class="token comment">//V</span>
	glm<span class="token operator">::</span>mat4 viewMat<span class="token punctuation">;</span>
	<span class="token comment">// 注意，我们将矩阵向我们要进行移动场景的反方向移动。</span>
	viewMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">translate</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3.0f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//P</span>
	glm<span class="token operator">::</span>mat4 projMat<span class="token punctuation">;</span>
	projMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">perspective</span><span class="token punctuation">(</span>glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span><span class="token number">45.0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">800.0f</span> <span class="token operator">/</span> <span class="token number">600.0f</span><span class="token punctuation">,</span> <span class="token number">0.1f</span><span class="token punctuation">,</span> <span class="token number">100.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">glfwWindowShouldClose</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token punctuation">{<!-- --></span>
		<span class="token function">processInput</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">glClearColor</span><span class="token punctuation">(</span><span class="token number">0.2f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">1.0f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glClear</span><span class="token punctuation">(</span>GL_COLOR_BUFFER_BIT <span class="token operator">|</span> GL_DEPTH_BUFFER_BIT<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">glActiveTexture</span><span class="token punctuation">(</span>GL_TEXTURE0<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glBindTexture</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> TexBufferA<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glActiveTexture</span><span class="token punctuation">(</span>GL_TEXTURE1<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glBindTexture</span><span class="token punctuation">(</span>GL_TEXTURE_2D<span class="token punctuation">,</span> TexBufferB<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">glBindVertexArray</span><span class="token punctuation">(</span>VAO<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			glm<span class="token operator">::</span>mat4 modelMat<span class="token punctuation">;</span>
			modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">translate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> cubePositions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">float</span> angle <span class="token operator">=</span> <span class="token number">20.0f</span> <span class="token operator">*</span> i<span class="token punctuation">;</span>
			modelMat <span class="token operator">=</span> glm<span class="token operator">::</span><span class="token function">rotate</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">radians</span><span class="token punctuation">(</span>angle<span class="token punctuation">)</span><span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">vec3</span><span class="token punctuation">(</span><span class="token number">1.0f</span><span class="token punctuation">,</span> <span class="token number">0.3f</span><span class="token punctuation">,</span> <span class="token number">0.5f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


			myShader<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">glUniform1i</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"ourTexture"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">glUniform1i</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"ourFace"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//glUniformMatrix4fv(glGetUniformLocation(myShader-&gt;ID, "transform"), 1, GL_FALSE, glm::value_ptr(trans));</span>
			<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"modelMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>modelMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"viewMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>viewMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">glUniformMatrix4fv</span><span class="token punctuation">(</span><span class="token function">glGetUniformLocation</span><span class="token punctuation">(</span>myShader<span class="token operator">-</span><span class="token operator">&gt;</span>ID<span class="token punctuation">,</span> <span class="token string">"projMat"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">,</span> glm<span class="token operator">::</span><span class="token function">value_ptr</span><span class="token punctuation">(</span>projMat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment">//glDrawElements(GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0);</span>
			<span class="token function">glDrawArrays</span><span class="token punctuation">(</span>GL_TRIANGLES<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>


		

		<span class="token function">glfwSwapBuffers</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwPollEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">glfwTerminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span>


</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d19634c55f618ea6d0873ea8d145bf5f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Centos7通过Docker搭建Replication集群</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/447f38d0875843174fae0300db85134e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【python】裁剪图片为指定大小，按位置截取，cv2（批量制作主图）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>