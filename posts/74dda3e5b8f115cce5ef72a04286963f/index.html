<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Unity截屏分享朋友圈(微信) - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Unity截屏分享朋友圈(微信)" />
<meta property="og:description" content="Unity2017.1 ShareSDK GalleryScreenshot.unitypackage
一、SharSDK注册产品 后台&gt;概括
二、微信开放平台上注册产品
2.1Unity: PlayerSettings&gt;OtherSetting: com.wfj.snailshell
Android平台 应用下载地址：未填写
应用签名：xxxxb98a448d45e37cc7b3fa5c0fxxxx
包名：com.wfj.snailshell
2.2应用签名的获取
2.2.1修改apk后缀名为zip,解压得到其中的META-INF文件夹;
2.2.2把META-INF文件夹放到C盘根目录下;
2.2.3在dos面板中, 敲入命令: keytool -printcert -file C:\META-INF\CERT.RSA 命令,即可获取签名信息
2.2.4去冒号
2.3检查签名
https://open.weixin.qq.com/cgi-bin/readtemplate?t=resource/app_download_android_tmpl&amp;lang=zh_CN 签名生成工具
安装apk后输入com.wfj.snailshell
三、Unity配置
3.1修改AndroidManifest
http://bbs.mob.com/thread-23519-1-1.html
3.2替换DemoCallback.jar
Unity：Assets\Plugins\Android\ShareSDK\libs
代码：
using cn.sharesdk.unity3d; using System.Collections; using System.IO; using UnityEngine; using UnityEngine.UI; public class SharePhoto : MonoBehaviour { public Image ImagePreview; public ShareSDK Ssdk; string photoNamePrefix = &#34;jimmy&#34;; string albumName = &#34;SnailShellShots&#34;; string filePath; void Start() { ScreenshotManager." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/74dda3e5b8f115cce5ef72a04286963f/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-10-26T15:43:00+08:00" />
<meta property="article:modified_time" content="2017-10-26T15:43:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Unity截屏分享朋友圈(微信)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div id="cnblogs_post_body" class="blogpost-body"> 
 <p>Unity2017.1  ShareSDK  GalleryScreenshot.unitypackage</p> 
 <p>一、SharSDK注册产品 </p> 
 <p>后台&gt;概括</p> 
 <p>二、微信开放平台上注册产品</p> 
 <p>2.1Unity: PlayerSettings&gt;OtherSetting:<span style="color:#0000ff;"> com.wfj.snailshell</span></p> 
 <h5>Android平台</h5> 
 <p class="emtpyitem">应用下载地址：未填写</p> 
 <p>应用签名：xxxxb98a448d45e37cc7b3fa5c0fxxxx</p> 
 <p>包名：<span style="color:#0000ff;">com.wfj.snailshell</span></p> 
 <p><span style="color:#000000;">2.2应用签名的获取</span></p> 
 <p><span style="color:#000000;">2.2.1修改apk后缀名为zip,解压得到其中的META-INF文件夹;</span></p> 
 <p><span style="color:#000000;">2.2.2把META-INF文件夹放到C盘根目录下;</span></p> 
 <p><span style="color:#000000;">2.2.3在dos面板中,  敲入命令:  keytool -printcert -file C:\META-INF\CERT.RSA  命令,即可获取签名信息</span></p> 
 <p><span style="color:#000000;">2.2.4去冒号</span></p> 
 <p><span style="color:#000000;">2.3检查签名</span></p> 
 <p><span style="color:#000000;">https://open.weixin.qq.com/cgi-bin/readtemplate?t=resource/app_download_android_tmpl&amp;lang=zh_CN  签名生成工具</span></p> 
 <p><span style="color:#000000;">安装apk后输入<span style="color:#0000ff;">com.wfj.snailshell</span></span></p> 
 <p><span style="color:#000000;">三、Unity配置</span></p> 
 <p>3.1修改AndroidManifest<br>http://bbs.mob.com/thread-23519-1-1.html</p> 
 <p>3.2替换DemoCallback.jar</p> 
 <p>Unity：Assets\Plugins\Android\ShareSDK\libs</p> 
 <p>代码：</p> 
 <div class="cnblogs_code"> 
  <pre><span style="color:#0000ff;">using</span><span style="color:#000000;"> cn.sharesdk.unity3d;
</span><span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Collections;
</span><span style="color:#0000ff;">using</span><span style="color:#000000;"> System.IO;
</span><span style="color:#0000ff;">using</span><span style="color:#000000;"> UnityEngine;
</span><span style="color:#0000ff;">using</span><span style="color:#000000;"> UnityEngine.UI;

</span><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> SharePhoto : MonoBehaviour
{
    </span><span style="color:#0000ff;">public</span><span style="color:#000000;"> Image ImagePreview;
    </span><span style="color:#0000ff;">public</span><span style="color:#000000;"> ShareSDK Ssdk;
    </span><span style="color:#0000ff;">string</span> photoNamePrefix = <span style="color:#800000;">"</span><span style="color:#800000;">jimmy</span><span style="color:#800000;">"</span><span style="color:#000000;">;
    </span><span style="color:#0000ff;">string</span> albumName = <span style="color:#800000;">"</span><span style="color:#800000;">SnailShellShots</span><span style="color:#800000;">"</span><span style="color:#000000;">;
    </span><span style="color:#0000ff;">string</span><span style="color:#000000;"> filePath;

    </span><span style="color:#0000ff;">void</span><span style="color:#000000;"> Start()
    {
        ScreenshotManager.ScreenshotFinishedSaving </span>+=<span style="color:#000000;"> ScreenshotManager_ScreenshotFinishedSaving;
    }

    </span><span style="color:#0000ff;">private</span> <span style="color:#0000ff;">void</span><span style="color:#000000;"> ScreenshotManager_ScreenshotFinishedSaving()
    {
        </span><span style="color:#0000ff;">string</span> date = System.DateTime.Now.ToString(<span style="color:#800000;">"</span><span style="color:#800000;">dd-MM-yy</span><span style="color:#800000;">"</span><span style="color:#000000;">);
        </span><span style="color:#0000ff;">string</span> screenshotFilename = photoNamePrefix + <span style="color:#800000;">"</span><span style="color:#800000;">_</span><span style="color:#800000;">"</span> + ScreenshotManager.ScreenShotNumber + <span style="color:#800000;">"</span><span style="color:#800000;">_</span><span style="color:#800000;">"</span> + date + <span style="color:#800000;">"</span><span style="color:#800000;">.png</span><span style="color:#800000;">"</span><span style="color:#000000;">;

        </span><span style="color:#0000ff;">#if</span> UNITY_IPHONE<span style="color:#000000;">
            filePath </span>= Application.persistentDataPath + <span style="color:#800000;">"</span><span style="color:#800000;">/</span><span style="color:#800000;">"</span> +<span style="color:#000000;"> screenshotFilename;
        </span><span style="color:#0000ff;">#elif</span> UNITY_ANDROID<span style="color:#000000;">
            filePath </span>= Application.persistentDataPath + <span style="color:#800000;">"</span><span style="color:#800000;">/../../../../DCIM/</span><span style="color:#800000;">"</span> + albumName + <span style="color:#800000;">"</span><span style="color:#800000;">/</span><span style="color:#800000;">"</span> +<span style="color:#000000;"> screenshotFilename;
        </span><span style="color:#0000ff;">#endif</span>

        <span style="color:#008000;">//</span><span style="color:#008000;">创建文件读取流</span>
        FileStream fileStream = <span style="color:#0000ff;">new</span><span style="color:#000000;"> FileStream(filePath, FileMode.Open, FileAccess.Read);
        fileStream.Seek(</span><span style="color:#800080;">0</span><span style="color:#000000;">, SeekOrigin.Begin);
        </span><span style="color:#008000;">//</span><span style="color:#008000;">创建文件长度缓冲区</span>
        <span style="color:#0000ff;">byte</span>[] bytes = <span style="color:#0000ff;">new</span> <span style="color:#0000ff;">byte</span><span style="color:#000000;">[fileStream.Length];
        </span><span style="color:#008000;">//</span><span style="color:#008000;">读取文件</span>
        fileStream.Read(bytes, <span style="color:#800080;">0</span>, (<span style="color:#0000ff;">int</span><span style="color:#000000;">)fileStream.Length);
        </span><span style="color:#008000;">//</span><span style="color:#008000;">释放文件读取流</span>
<span style="color:#000000;">        fileStream.Close();
        fileStream.Dispose();
        fileStream </span>= <span style="color:#0000ff;">null</span><span style="color:#000000;">;

        </span><span style="color:#0000ff;">int</span> width = <span style="color:#800080;">960</span><span style="color:#000000;">;
        </span><span style="color:#0000ff;">int</span> height = <span style="color:#800080;">540</span><span style="color:#000000;">;
        Texture2D texture </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> Texture2D(width, height);
        texture.LoadImage(bytes);
        Sprite sprite </span>= Sprite.Create(texture, <span style="color:#0000ff;">new</span> Rect(<span style="color:#800080;">0</span>, <span style="color:#800080;">0</span>, texture.width, texture.height), <span style="color:#0000ff;">new</span> Vector2(<span style="color:#800080;">0.5f</span>, <span style="color:#800080;">0.5f</span><span style="color:#000000;">));
        ImagePreview.sprite </span>=<span style="color:#000000;"> sprite;

        ImagePreview.gameObject.SetActive(</span><span style="color:#0000ff;">true</span>);  <span style="color:#008000;">//</span><span style="color:#008000;">show preview panel</span>
<span style="color:#000000;">    }

    </span><span style="color:#0000ff;">public</span> <span style="color:#0000ff;">void</span><span style="color:#000000;"> TakeShotClick()
    {
        StartCoroutine(Shot());
    }

    IEnumerator Shot()
    {
        </span><span style="color:#0000ff;">yield</span> <span style="color:#0000ff;">return</span><span style="color:#000000;"> StartCoroutine
            (
                ScreenshotManager.Save
                (
                    photoNamePrefix,
                    albumName,
                    </span><span style="color:#0000ff;">true</span><span style="color:#000000;">
                )
            );
    }

    </span><span style="color:#008000;">//</span><span style="color:#008000;">After taking shot </span>
    <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">void</span><span style="color:#000000;"> OnShareClick()
    {
        ShareContent content </span>= <span style="color:#0000ff;">new</span><span style="color:#000000;"> ShareContent();
        content.SetImagePath(filePath);                 </span><span style="color:#008000;">//</span><span style="color:#008000;">本地图片路径</span>
<span style="color:#000000;">        content.SetShareType(ContentType.Image);
        Ssdk.ShareContent(PlatformType.WeChatMoments, content);
    }
}</span></pre> 
 </div> 
 <p> </p> 
</div> 
<p>转载于:https://www.cnblogs.com/JimmyCode/p/7737159.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a888df3d0f95601a9ef0b6d0eb585455/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">toDF需要导入的包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/103c652c732fa704b30f3a6bed470d29/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Image控件的Stretch属性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>