<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RUST笔记：candle使用基础 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RUST笔记：candle使用基础" />
<meta property="og:description" content="candle介绍 candle是huggingface开源的Rust的极简 ML 框架。 candle-矩阵乘法示例 cargo new myapp cd myapp cargo add --git https://github.com/huggingface/candle.git candle-core cargo build # 测试，或执行 cargo ckeck main.rs use candle_core::{Device, Tensor}; fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; { let device = Device::Cpu; let a = Tensor::randn(0f32, 1., (2, 3), &amp;device)?; let b = Tensor::randn(0f32, 1., (3, 4), &amp;device)?; let c = a.matmul(&amp;b)?; println!(&#34;{c}&#34;); Ok(()) } 项目输出 ~/myrust$ cargo new myapp Created binary (application) `myapp` package ~/myrust$ cd myapp ~/myrust/myapp$ cargo add --git https://github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d58beec756754ab436156bb3addc2ef5/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-26T16:53:06+08:00" />
<meta property="article:modified_time" content="2024-01-26T16:53:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RUST笔记：candle使用基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="candle_0"></a>candle介绍</h2> 
<ul><li><a href="https://github.com/huggingface/candle">candle</a>是huggingface开源的Rust的极简 ML 框架。</li></ul> 
<h2><a id="candle_2"></a>candle-矩阵乘法示例</h2> 
<pre><code>cargo new myapp
cd myapp
cargo add --git https://github.com/huggingface/candle.git candle-core
cargo build # 测试，或执行 cargo ckeck
</code></pre> 
<ul><li>main.rs</li></ul> 
<pre><code>use candle_core::{Device, Tensor};

fn main() -&gt; Result&lt;(), Box&lt;dyn std::error::Error&gt;&gt; {
    let device = Device::Cpu;

    let a = Tensor::randn(0f32, 1., (2, 3), &amp;device)?;
    let b = Tensor::randn(0f32, 1., (3, 4), &amp;device)?;

    let c = a.matmul(&amp;b)?;
    println!("{c}");
    Ok(())
}

</code></pre> 
<ul><li>项目输出</li></ul> 
<pre><code>~/myrust$ cargo new myapp
     Created binary (application) `myapp` package
~/myrust$ cd myapp
~/myrust/myapp$ cargo add --git https://github.com/huggingface/candle.git candle-core
    Updating git repository `https://github.com/huggingface/candle.git`
    Updating git submodule `https://github.com/NVIDIA/cutlass.git`
      Adding candle-core (git) to dependencies.
             Features:
             - accelerate
             - cuda
             - cudarc
             - cudnn
             - metal
             - mkl
    Updating git repository `https://github.com/huggingface/candle.git`
    Updating crates.io index
~/myrust/myapp$ cargo build
  Downloaded serde_derive v1.0.195
  Downloaded either v1.9.0
  Downloaded autocfg v1.1.0
  Downloaded zerofrom v0.1.3
  Downloaded zerofrom-derive v0.1.3
  Downloaded synstructure v0.13.0
  Downloaded crossbeam-deque v0.8.5
  Downloaded yoke-derive v0.7.3
  Downloaded half v2.3.1
  Downloaded bytemuck v1.14.1
  Downloaded rand_core v0.6.4
  Downloaded paste v1.0.14
  Downloaded proc-macro2 v1.0.78
  Downloaded itoa v1.0.10
  Downloaded memmap2 v0.9.4
  Downloaded syn v2.0.48
  Downloaded crossbeam-epoch v0.9.18
  Downloaded cfg-if v1.0.0
  Downloaded bitflags v1.3.2
  Downloaded num_cpus v1.16.0
  Downloaded gemm-f32 v0.17.0
  Downloaded reborrow v0.5.5
  Downloaded stable_deref_trait v1.2.0
  Downloaded rayon-core v1.12.1
  Downloaded seq-macro v0.3.5
  Downloaded thiserror-impl v1.0.56
  Downloaded dyn-stack v0.10.0
  Downloaded thiserror v1.0.56
  Downloaded unicode-xid v0.2.4
  Downloaded rand_chacha v0.3.1
  Downloaded ppv-lite86 v0.2.17
  Downloaded bytemuck_derive v1.5.0
  Downloaded getrandom v0.2.12
  Downloaded once_cell v1.19.0
  Downloaded unicode-ident v1.0.12
  Downloaded byteorder v1.5.0
  Downloaded crc32fast v1.3.2
  Downloaded num-complex v0.4.4
  Downloaded gemm-common v0.17.0
  Downloaded crossbeam-utils v0.8.19
  Downloaded quote v1.0.35
  Downloaded ryu v1.0.16
  Downloaded num-traits v0.2.17
  Downloaded zip v0.6.6
  Downloaded rand_distr v0.4.3
  Downloaded serde v1.0.195
  Downloaded rand v0.8.5
  Downloaded raw-cpuid v10.7.0
  Downloaded libm v0.2.8
  Downloaded serde_json v1.0.111
  Downloaded rayon v1.8.1
  Downloaded libc v0.2.152
  Downloaded gemm-c64 v0.17.0
  Downloaded gemm-c32 v0.17.0
  Downloaded safetensors v0.4.2
  Downloaded gemm-f64 v0.17.0
  Downloaded gemm v0.17.0
  Downloaded gemm-f16 v0.17.0
  Downloaded yoke v0.7.3
  Downloaded pulp v0.18.6
  Downloaded 60 crates (3.1 MB) in 14.91s
   Compiling proc-macro2 v1.0.78
   Compiling unicode-ident v1.0.12
   Compiling libc v0.2.152
   Compiling cfg-if v1.0.0
   Compiling libm v0.2.8
   Compiling autocfg v1.1.0
   Compiling crossbeam-utils v0.8.19
   Compiling ppv-lite86 v0.2.17
   Compiling rayon-core v1.12.1
   Compiling reborrow v0.5.5
   Compiling paste v1.0.14
   Compiling either v1.9.0
   Compiling bitflags v1.3.2
   Compiling seq-macro v0.3.5
   Compiling once_cell v1.19.0
   Compiling unicode-xid v0.2.4
   Compiling raw-cpuid v10.7.0
   Compiling serde v1.0.195
   Compiling crc32fast v1.3.2
   Compiling serde_json v1.0.111
   Compiling stable_deref_trait v1.2.0
   Compiling itoa v1.0.10
   Compiling ryu v1.0.16
   Compiling thiserror v1.0.56
   Compiling byteorder v1.5.0
   Compiling num-traits v0.2.17
   Compiling zip v0.6.6
   Compiling crossbeam-epoch v0.9.18
   Compiling quote v1.0.35
   Compiling syn v2.0.48
   Compiling crossbeam-deque v0.8.5
   Compiling getrandom v0.2.12
   Compiling memmap2 v0.9.4
   Compiling num_cpus v1.16.0
   Compiling rand_core v0.6.4
   Compiling rand_chacha v0.3.1
   Compiling rayon v1.8.1
   Compiling rand v0.8.5
   Compiling rand_distr v0.4.3
   Compiling synstructure v0.13.0
   Compiling bytemuck_derive v1.5.0
   Compiling serde_derive v1.0.195
   Compiling zerofrom-derive v0.1.3
   Compiling thiserror-impl v1.0.56
   Compiling yoke-derive v0.7.3
   Compiling bytemuck v1.14.1
   Compiling num-complex v0.4.4
   Compiling dyn-stack v0.10.0
   Compiling half v2.3.1
   Compiling zerofrom v0.1.3
   Compiling yoke v0.7.3
   Compiling pulp v0.18.6
   Compiling gemm-common v0.17.0
   Compiling gemm-f32 v0.17.0
   Compiling gemm-c64 v0.17.0
   Compiling gemm-f64 v0.17.0
   Compiling gemm-c32 v0.17.0
   Compiling gemm-f16 v0.17.0
   Compiling gemm v0.17.0
   Compiling safetensors v0.4.2
   Compiling candle-core v0.3.3 (https://github.com/huggingface/candle.git#fd7c8565)
   Compiling myapp v0.1.0 (/home/pdd/myrust/myapp)
    Finished dev [unoptimized + debuginfo] target(s) in 32.90s
</code></pre> 
<h2><a id="candle_test_177"></a>candle_test的简单测试项目</h2> 
<ul><li> <p><a href="https://github.com/RileySeaburg/candle_test">https://github.com/RileySeaburg/candle_test</a></p> </li><li> <p><code>git clone https://github.com/RileySeaburg/candle_test.git</code></p> </li></ul> 
<h3><a id="Cargotoml__182"></a><code>Cargo.toml</code> 文件</h3> 
<pre><code class="prism language-csharp"><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">package</span></span><span class="token punctuation">]</span>
name <span class="token operator">=</span> <span class="token string">"candle_test"</span>
version <span class="token operator">=</span> <span class="token string">"0.1.0"</span>
edition <span class="token operator">=</span> <span class="token string">"2021"</span> <span class="token preprocessor property">#  Rust 版本</span>

<span class="token preprocessor property"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>

<span class="token punctuation">[</span>dependencies<span class="token punctuation">]</span>
candle<span class="token operator">-</span>core <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> git <span class="token operator">=</span> <span class="token string">"https://github.com/huggingface/candle.git"</span><span class="token punctuation">,</span> version <span class="token operator">=</span> <span class="token string">"0.2.1"</span><span class="token punctuation">,</span> features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"cuda"</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token preprocessor property"># `candle-core`：项目依赖的包的名称。`git` 字段指定了包的源代码仓库地址。`version` 字段指定了使用的包的版本。`features` 字段是一个数组，指定了启用的功能。在这里，启用了 </span><span class="token string">"cuda"</span> 功能。
<span class="token preprocessor property"># 可以通过以下命令添加，取消可注释掉</span><span class="token string">"cuda"</span>，再cargo build
<span class="token preprocessor property"># cargo add --git https://github.com/huggingface/candle.git candle-core</span>
<span class="token preprocessor property"># cargo add candle-core --features cuda</span>
</code></pre> 
<h3><a id="mainrs_199"></a>main.rs</h3> 
<pre><code class="prism language-rust"><span class="token keyword">use</span> <span class="token namespace">candle_core<span class="token punctuation">::</span></span><span class="token punctuation">{<!-- --></span><span class="token class-name">DType</span><span class="token punctuation">,</span> <span class="token class-name">Device</span><span class="token punctuation">,</span> <span class="token class-name">Result</span><span class="token punctuation">,</span> <span class="token class-name">Tensor</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 定义一个模型结构体</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Model</span> <span class="token punctuation">{<!-- --></span>
    first<span class="token punctuation">:</span> <span class="token class-name">Tensor</span><span class="token punctuation">,</span>
    second<span class="token punctuation">:</span> <span class="token class-name">Tensor</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Model</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 定义模型的前向传播方法</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">forward</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Tensor</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Tensor</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token function">matmul</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// 输入乘以第一层权重</span>
        <span class="token keyword">let</span> x <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">relu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// 使用 ReLU 激活函数</span>
        x<span class="token punctuation">.</span><span class="token function">matmul</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token comment">// 结果乘以第二层权重</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 初始化设备，如果 GPU 可用则使用 GPU，否则使用 CPU</span>
    <span class="token keyword">let</span> device <span class="token operator">=</span> <span class="token keyword">match</span> <span class="token class-name">Device</span><span class="token punctuation">::</span><span class="token function">new_cuda</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> device<span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Device</span><span class="token punctuation">::</span><span class="token class-name">Cpu</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建模型的第一层和第二层权重张量</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token class-name">Tensor</span><span class="token punctuation">::</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">DType</span><span class="token punctuation">::</span><span class="token constant">F32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>device<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">contiguous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second <span class="token operator">=</span> <span class="token class-name">Tensor</span><span class="token punctuation">::</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">DType</span><span class="token punctuation">::</span><span class="token constant">F32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>device<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">contiguous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 初始化模型</span>
    <span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token class-name">Model</span> <span class="token punctuation">{<!-- --></span> first<span class="token punctuation">,</span> second <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 创建一个用于测试的虚拟图像张量</span>
    <span class="token keyword">let</span> dummy_image <span class="token operator">=</span> <span class="token class-name">Tensor</span><span class="token punctuation">::</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">DType</span><span class="token punctuation">::</span><span class="token constant">F32</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>device<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">contiguous</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token comment">// 调用模型的前向传播方法获取预测结果</span>
    <span class="token keyword">let</span> digit <span class="token operator">=</span> model<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>dummy_image<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>

    <span class="token comment">// 打印预测结果</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Digit {digit:?} digit"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="_259"></a>知识点总结</h2> 
<h3><a id="candle_core_Result_261"></a>candle_core:: Result</h3> 
<p><img src="https://images2.imgbox.com/6a/1d/SVObx7np_o.png" alt="在这里插入图片描述"></p> 
<pre><code>// Result定义在/home/pdd/.cargo/git/checkouts/candle-0c2b4fa9e5801351/e8e3375/candle-core/src/error.rs
pub type Result&lt;T&gt; = std::result::Result&lt;T, Error&gt;; // 定义了一个 `Result` 类型，这是一个 `Result&lt;T, Error&gt;` 类型的别名。其中 `T` 是成功时的返回类型，而 `Error` 是失败时的错误类型。
</code></pre> 
<pre><code class="prism language-rust"><span class="token comment">// Ok(()) 定义在 /home/pdd/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/result.rs</span>
<span class="token comment">// 这是 Rust 标准库中的 `Result` 公共的枚举类型，它有两个泛型参数 `T` 和 `E`。`T` 代表成功时返回的值的类型，`E` 代表错误时返回的错误类型。</span>
<span class="token comment">// #[]是属性（attribute）,提供额外信息</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">/// Contains the success value</span>
    <span class="token attribute attr-name">#[lang = <span class="token string">"Ok"</span>]</span>
    <span class="token attribute attr-name">#[stable(feature = <span class="token string">"rust1"</span>, since = <span class="token string">"1.0.0"</span>)]</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token attribute attr-name">#[stable(feature = <span class="token string">"rust1"</span>, since = <span class="token string">"1.0.0"</span>)]</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// `Ok(T)`: 这是 `Result` 枚举的一个变体，用于表示成功的情况</span>
                                                        <span class="token comment">// (): 是 Rust 中的单元类型（unit type），类似于其他语言中的 void。</span>

    <span class="token comment">/// Contains the error value</span>
    <span class="token attribute attr-name">#[lang = <span class="token string">"Err"</span>]</span>
    <span class="token attribute attr-name">#[stable(feature = <span class="token string">"rust1"</span>, since = <span class="token string">"1.0.0"</span>)]</span>
    <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token attribute attr-name">#[stable(feature = <span class="token string">"rust1"</span>, since = <span class="token string">"1.0.0"</span>)]</span> <span class="token class-name">E</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// `Err(E)`: 这是 `Result` 枚举的另一个变体，用于表示错误的情况。</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_286"></a>?符号</h3> 
<ul><li>在 Rust 中，<code>?</code> 符号用于处理 <code>Result</code> 或 <code>Option</code> 类型的返回值。这个符号的作用是将可能的错误或 <code>None</code> 值快速传播到调用链的最上层，使得代码更加简洁和易读。</li></ul> 
<pre><code class="prism language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">forward</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Tensor</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">Tensor</span><span class="token operator">&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> image<span class="token punctuation">.</span><span class="token function">matmul</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// 如果matmul返回Err，则整个forward函数返回Err</span>
    <span class="token keyword">let</span> x <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token function">relu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// 如果relu返回Err，则整个forward函数返回Err</span>
    x<span class="token punctuation">.</span><span class="token function">matmul</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span> <span class="token comment">// 如果matmul返回Err，则整个forward函数返回Err；否则返回Ok(Tensor)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_298"></a>语句和表达式:语句以分号结尾，而表达式通常不需要分号。</h3> 
<ul><li> <p><strong>函数体</strong>：函数体是一个块表达式，其值是最后一个表达式的值。</p> <pre><code class="prism language-rust"><span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{<!-- --></span>
    x <span class="token operator">+</span> y <span class="token comment">// 表达式</span>
<span class="token punctuation">}</span>
</code></pre> </li></ul> 
<h2><a id="CG_320"></a>CG</h2> 
<ul><li><a href="https://github.com/tracel-ai/burn/tree/main">Burn is a new comprehensive dynamic Deep Learning Framework built using Rust with extreme flexibility, compute efficiency and portability as its primary goals. </a></li><li>resnet for caddle: https://github.com/iFREEGROUP/candle-models</li><li><a href="https://github.com/gabrielmbmb/candle-holder">Using candle to build a transformers for Rust.</a></li><li>https://github.com/joker3212/candle-clip</li><li>https://github.com/jonysugianto/candle_fastformer</li><li><a href="https://github.com/huggingface/candle-silu/blob/main/src/ffi.rs">Candle Silu inplace</a></li><li>https://github.com/ansleliu/PortableTelemedicineMonitoringSystem</li><li><a href="https://mobile-aloha.github.io/" rel="nofollow">https://mobile-aloha.github.io/</a></li><li><a href="https://github.com/tonyzhaozh/aloha">Learning Fine-Grained Bimanual Manipulation with Low-Cost Hardware</a>https://arxiv.org/pdf/2304.13705.pdf</li><li><a href="https://github.com/facebookresearch/habitat-sim">A flexible, high-performance 3D simulator for Embodied AI research.</a></li><li><a href="https://github.com/huggingface/huggingface.js">https://github.com/huggingface/huggingface.js</a></li><li>https://www.zhihu.com/people/wasmedge</li><li>https://wasmedge.org/docs/start/install/</li></ul>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/95a85bd68d419c48575a6244af525acc/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Proteus仿真】【STM32单片机】自动抽奖器系统设计</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8f5b7af8bdfc6773e3b633c7a1bab703/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">禁用windows update服务</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>