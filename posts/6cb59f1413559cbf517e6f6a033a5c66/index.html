<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows沙盒的安装与配置 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows沙盒的安装与配置" />
<meta property="og:description" content="沙盒安装 1、打开控制面板
2、选择程序与功能
3、勾选Windows 沙盒，然后点击确定，等待安装完成即可。
沙盒配置 Windows 沙盒支持简单的配置文件，这些文件为沙盒提供最少的自定义参数集。 此功能可与 Windows 10 内部版本 18342 或 Windows 11 一起使用。 Windows 沙盒配置文件的格式为 XML，并通过.wsb文件扩展名与沙盒相关联。
配置文件使用户能够控制Windows 沙盒的以下方面：
vGPU (虚拟化 GPU) ：启用或禁用虚拟化 GPU。 如果禁用 vGPU，沙盒将使用 Windows 高级光栅化平台 (WARP) 。网络：启用或禁用沙盒中的网络访问。映射的文件夹：共享具有 读取 或 写入 权限的主机中的文件夹。 公开主机目录可能会允许恶意软件影响系统或窃取数据。登录命令：Windows 沙盒启动时执行的命令。音频输入：将主机的麦克风输入共享到沙盒中。视频输入：将主机的网络摄像头输入共享到沙盒中。受保护的客户端：将 RDP 会话上增加的安全设置置于沙盒中。打印机重定向：将打印机从主机共享到沙盒中。剪贴板重定向：与沙盒共享主机剪贴板，以便可以来回粘贴文本和文件。内存（MB）：要分配给沙盒的内存量（以 MB 为单位）。 备注: 沙盒窗口的大小目前不可配置。
创建配置文件 若要创建配置文件，请执行以下操作：
打开纯文本编辑器或源代码编辑器 (例如记事本、Visual Studio Code等)
插入以下行：
&lt;Configuration&gt; &lt;/Configuration&gt; 在两行之间添加适当的配置文本。 有关详细信息，请参阅正确的语法和以下示例。
使用所需名称保存文件，但请确保其文件扩展名为 .wsb。 在记事本中，应将文件名和扩展名括在双引号内，例如: &#34;My config file.wsb&#34;。
使用配置文件 若要使用配置文件，请双击它以根据其设置启动Windows 沙盒。 还可以通过命令行调用它，如下所示：
C:\Temp&gt; MyConfigFile.wsb 关键字、值和限制 vGPU 启用或禁用 GPU 共享。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/6cb59f1413559cbf517e6f6a033a5c66/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-17T10:51:55+08:00" />
<meta property="article:modified_time" content="2023-07-17T10:51:55+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows沙盒的安装与配置</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>沙盒安装</h2> 
<p>1、打开控制面板</p> 
<p><img src="https://images2.imgbox.com/27/3b/fFrGc07o_o.png" alt="在这里插入图片描述"></p> 
<p>2、选择<code>程序与功能</code></p> 
<p><img src="https://images2.imgbox.com/5e/2d/GkK5iQMU_o.png" alt="在这里插入图片描述"></p> 
<p>3、勾选<code>Windows 沙盒</code>，然后点击确定，等待安装完成即可。</p> 
<p><img src="https://images2.imgbox.com/b3/4f/ErzpsIaX_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_17"></a>沙盒配置</h2> 
<p>Windows 沙盒支持简单的配置文件，这些文件为沙盒提供最少的自定义参数集。 此功能可与 Windows 10 内部版本 18342 或 Windows 11 一起使用。 Windows 沙盒配置文件的格式为 XML，并通过<code>.wsb</code>文件扩展名与沙盒相关联。</p> 
<p>配置文件使用户能够控制Windows 沙盒的以下方面：</p> 
<ul><li><strong>vGPU (虚拟化 GPU)</strong> ：启用或禁用虚拟化 GPU。 如果禁用 vGPU，沙盒将使用 Windows 高级光栅化平台 (WARP) 。</li><li><strong>网络</strong>：启用或禁用沙盒中的网络访问。</li><li><strong>映射的文件夹</strong>：共享具有 <em>读取</em> 或 <em>写入</em> 权限的主机中的文件夹。 公开主机目录可能会允许恶意软件影响系统或窃取数据。</li><li><strong>登录命令</strong>：Windows 沙盒启动时执行的命令。</li><li><strong>音频输入</strong>：将主机的麦克风输入共享到沙盒中。</li><li><strong>视频输入</strong>：将主机的网络摄像头输入共享到沙盒中。</li><li><strong>受保护的客户端</strong>：将 RDP 会话上增加的安全设置置于沙盒中。</li><li><strong>打印机重定向</strong>：将打印机从主机共享到沙盒中。</li><li><strong>剪贴板重定向</strong>：与沙盒共享主机剪贴板，以便可以来回粘贴文本和文件。</li><li><strong>内存（MB</strong>）：要分配给沙盒的内存量（以 MB 为单位）。</li></ul> 
<blockquote> 
 <p>备注: 沙盒窗口的大小目前不可配置。</p> 
</blockquote> 
<h3><a id="_36"></a>创建配置文件</h3> 
<p>若要创建配置文件，请执行以下操作：</p> 
<ol><li> <p>打开纯文本编辑器或源代码编辑器 (例如记事本、Visual Studio Code等)</p> </li><li> <p>插入以下行：</p> </li></ol> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ol start="3"><li> <p>在两行之间添加适当的配置文本。 有关详细信息，请参阅正确的语法和以下示例。</p> </li><li> <p>使用所需名称保存文件，但请确保其文件扩展名为 <code>.wsb</code>。 在记事本中，应将文件名和扩展名括在双引号内，例如: <code>"My config file.wsb"</code>。</p> </li></ol> 
<h3><a id="_53"></a>使用配置文件</h3> 
<p>若要使用配置文件，请双击它以根据其设置启动Windows 沙盒。 还可以通过命令行调用它，如下所示：</p> 
<pre><code class="prism language-batch">C:\Temp&gt; MyConfigFile.wsb
</code></pre> 
<h3><a id="_61"></a>关键字、值和限制</h3> 
<h4><a id="vGPU_63"></a>vGPU</h4> 
<p>启用或禁用 GPU 共享。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vGPU</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>vGPU</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：在沙盒中启用 vGPU 支持。</li><li><em>Disable</em>：在沙盒中禁用 vGPU 支持。 如果设置了此值，沙盒将使用软件呈现，这可能比虚拟化 GPU 慢。</li><li><em>默认</em> 此值是 vGPU 支持的默认值。 目前，此默认值表示 vGPU 已禁用。</li></ul> 
<blockquote> 
 <p>备注: 启用虚拟化 GPU 可能会增加沙盒的攻击面。</p> 
</blockquote> 
<h4><a id="_78"></a>网络</h4> 
<p>启用或禁用沙盒中的网络。 可以禁用网络访问，以减少沙盒公开的攻击面。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Networking</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Networking</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>启用</em>：在沙盒中启用网络。</li><li><em>禁用</em>：禁用沙盒中的网络。</li><li><em>默认值</em>：此值是网络支持的默认值。 此值通过在主机上创建虚拟交换机来启用网络，并通过虚拟 NIC 将沙盒连接到该交换机。</li></ul> 
<blockquote> 
 <p>备注: 启用网络可能会向内部网络公开不受信任的应用程序。</p> 
</blockquote> 
<h4><a id="_94"></a>映射的文件夹</h4> 
<p>一个文件夹数组，每个文件夹表示主机上的一个位置，该位置将共享到指定路径处的沙盒中。 目前，不支持相对路径。 如果未指定路径，文件夹将映射到容器用户的桌面。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HostFolder</span><span class="token punctuation">&gt;</span></span>absolute path to the host folder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HostFolder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>absolute path to the sandbox folder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
    ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li><em>HostFolder</em>：指定要共享到沙盒的主机上的文件夹。 该文件夹必须已存在于主机上，否则容器将无法启动。</li><li><em>SandboxFolder</em>：指定要将文件夹映射到的沙盒中的目标。 如果该文件夹不存在，则会创建该文件夹。 如果未指定沙盒文件夹，该文件夹将映射到容器桌面。</li><li><em>ReadOnly</em>：如果 <em>为 true</em>，则强制从容器内对共享文件夹进行只读访问。 支持的值： <em>true</em>/<em>false</em>。 默认为 <em>false</em>。</li></ul> 
<blockquote> 
 <p>备注: 从主机映射的文件和文件夹可能会被沙盒中的应用入侵，或可能影响主机。</p> 
</blockquote> 
<h4><a id="_117"></a>登录命令</h4> 
<p>指定沙盒登录后自动调用的单个命令。 沙盒中的应用在容器用户帐户下运行。 容器用户帐户应是管理员帐户。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Command</span><span class="token punctuation">&gt;</span></span>command to be invoked<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Command</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<ul><li><em>命令</em>：容器中将在登录后执行的可执行文件或脚本的路径。</li></ul> 
<blockquote> 
 <p>备注: 尽管非常简单的命令 (（例如启动可执行文件或脚本) ）工作，但涉及多个步骤的更复杂的方案应放在脚本文件中。 此脚本文件可以通过共享文件夹映射到容器中，然后通过 <em>LogonCommand</em> 指令执行。</p> 
</blockquote> 
<h4><a id="_131"></a>音频输入</h4> 
<p>启用或禁用沙盒的音频输入。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>AudioInput</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>AudioInput</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：在沙盒中启用音频输入。 如果设置了此值，沙盒将能够接收用户的音频输入。 使用麦克风的应用程序可能需要此功能。</li><li><em>Disable</em>：禁用沙盒中的音频输入。 如果设置了此值，则沙盒无法接收来自用户的音频输入。 使用麦克风的应用程序可能无法正常使用此设置。</li><li><em>默认值</em>：此值是音频输入支持的默认值。 目前，此默认值表示已启用音频输入。</li></ul> 
<blockquote> 
 <p>备注: 向容器公开主机音频输入可能存在安全隐患。</p> 
</blockquote> 
<h4><a id="_146"></a>视频输入</h4> 
<p>启用或禁用沙盒的视频输入。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VideoInput</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VideoInput</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：在沙盒中启用视频输入。</li><li><em>Disable</em>：禁用沙盒中的视频输入。 使用视频输入的应用程序可能无法在沙盒中正常运行。</li><li><em>默认值</em>：此值是视频输入支持的默认值。 目前，此默认值表示视频输入已禁用。 使用视频输入的应用程序可能无法在沙盒中正常运行。</li></ul> 
<blockquote> 
 <p>备注: 向容器公开主机视频输入可能存在安全隐患。</p> 
</blockquote> 
<h4><a id="_161"></a>受保护的客户端</h4> 
<p>启用“受保护的客户端”模式后，沙盒通过在 <a href="https://learn.microsoft.com/zh-cn/windows/win32/secauthz/appcontainer-isolation" rel="nofollow">AppContainer Isolation</a> 执行环境中运行来添加一个新的安全边界层。</p> 
<p>AppContainer 隔离提供凭据、设备、文件、网络、进程和窗口隔离。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ProtectedClient</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ProtectedClient</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：在受保护的客户端模式下运行 Windows 沙盒。 如果设置了此值，沙盒将在 AppContainer Isolation 中运行。</li><li><em>Disable</em>：在标准模式下运行沙盒，无需额外的安全缓解措施。</li><li><em>默认值</em>：此值是受保护的客户端模式的默认值。 目前，此默认值表示沙盒不在受保护的客户端模式下运行。</li></ul> 
<blockquote> 
 <p>备注: 此设置可能会限制用户在沙盒中复制/粘贴文件的能力。</p> 
</blockquote> 
<h4><a id="_178"></a>打印机重定向</h4> 
<p>启用或禁用从主机到沙盒的打印机共享。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PrinterRedirection</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PrinterRedirection</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：允许将主机打印机共享到沙盒中。</li><li><em>Disable</em>：在沙盒中禁用打印机重定向。 如果设置了此值，则沙盒无法从主机查看打印机。</li><li><em>默认值</em>：此值是打印机重定向支持的默认值。 目前，此默认值表示打印机重定向已禁用。</li></ul> 
<h4><a id="_191"></a>剪贴板重定向</h4> 
<p>启用或禁用与沙盒共享主机剪贴板。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ClipboardRedirection</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ClipboardRedirection</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>支持的值：</p> 
<ul><li><em>Enable</em>：允许与沙盒共享主机剪贴板。</li><li><em>Disable</em>：禁用沙盒中的剪贴板重定向。 如果设置了此值，将限制复制/粘贴到沙盒和沙盒外。</li><li><em>默认值</em>：此值是剪贴板重定向的默认值。 目前， <em>“默认</em>”下允许在主机和沙盒之间复制/粘贴。</li></ul> 
<h4><a id="_MB__204"></a>内存（以 MB 为单位）</h4> 
<p>指定沙盒可以使用的内存量（以 MB 为单位）， (MB) 。</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MemoryInMB</span><span class="token punctuation">&gt;</span></span>value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MemoryInMB</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>如果指定的内存值不足以启动沙盒，则会自动将其增加到所需的最小值。</p> 
<h3><a id="_1_213"></a>示例 1</h3> 
<p>以下配置文件可用于在沙盒中轻松测试下载的文件。 为了实现此测试，将禁用网络和 vGPU，并允许沙盒对共享下载文件夹进行只读访问。 为方便起见，登录命令在启动时会在沙盒中打开 downloads 文件夹。</p> 
<h4><a id="Downloadswsb_217"></a>Downloads.wsb</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VGpu</span><span class="token punctuation">&gt;</span></span>Disable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VGpu</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Networking</span><span class="token punctuation">&gt;</span></span>Disable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Networking</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HostFolder</span><span class="token punctuation">&gt;</span></span>C:\Users\Public\Downloads<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HostFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>C:\Users\WDAGUtilityAccount\Downloads<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Command</span><span class="token punctuation">&gt;</span></span>explorer.exe C:\users\WDAGUtilityAccount\Downloads<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="_2_236"></a>示例 2</h3> 
<p>以下配置文件在沙盒中安装 Visual Studio Code，这需要稍微复杂的 LogonCommand 设置。</p> 
<p>两个文件夹映射到沙盒中;第一个 (SandboxScripts) 包含 VSCodeInstall.cmd，它将安装和运行Visual Studio Code。 假定第二个文件夹 (CodingProjects) 包含开发人员希望使用 Visual Studio Code 修改的项目文件。</p> 
<p>由于 Visual Studio Code 安装程序脚本已映射到沙盒，LogonCommand 可以引用它。</p> 
<h4><a id="VSCodeInstallcmd_244"></a>VSCodeInstall.cmd</h4> 
<p>将 vscode 下载到 <code>downloads</code> 文件夹并从文件夹运行 <code>downloads</code> 。</p> 
<pre><code class="prism language-batch">REM Download Visual Studio Code
curl -L "https://update.code.visualstudio.com/latest/win32-x64-user/stable" --output C:\users\WDAGUtilityAccount\Downloads\vscode.exe

REM Install and run Visual Studio Code
C:\users\WDAGUtilityAccount\Downloads\vscode.exe /verysilent /suppressmsgboxes
</code></pre> 
<h4><a id="VSCodewsb_255"></a>VSCode.wsb</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HostFolder</span><span class="token punctuation">&gt;</span></span>C:\SandboxScripts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HostFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>C:\Users\WDAGUtilityAccount\Downloads\sandbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HostFolder</span><span class="token punctuation">&gt;</span></span>C:\CodingProjects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HostFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>C:\Users\WDAGUtilityAccount\Documents\Projects<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Command</span><span class="token punctuation">&gt;</span></span>C:\Users\WDAGUtilityAccount\Downloads\sandbox\VSCodeInstall.cmd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h3><a id="_3_277"></a>示例 3</h3> 
<p>以下配置文件运行 PowerShell 脚本作为登录命令，以交换左手用户的鼠标主按钮。</p> 
<p><code>C:\sandbox</code> 主机上的 文件夹映射到 <code>C:\sandbox</code> 沙盒中的 文件夹，因此 <code>SwapMouse.ps1</code> 可以在沙盒配置文件中引用脚本。</p> 
<h4><a id="SwapMouseps1_283"></a>SwapMouse.ps1</h4> 
<p>使用以下代码创建 powershell 脚本，并将其 <code>C:\sandbox</code> 作为 保存在目录中 <code>SwapMouse.ps1</code>。</p> 
<pre><code class="prism language-PowerShell">[Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms") | Out-Null

$SwapButtons = Add-Type -MemberDefinition @'
[DllImport("user32.dll")]
public static extern bool SwapMouseButton(bool swap);
'@ -Name "NativeMethods" -Namespace "PInvoke" -PassThru

$SwapButtons::SwapMouseButton(!([System.Windows.Forms.SystemInformation]::MouseButtonsSwapped))
</code></pre> 
<h4><a id="SwapMousewsb_297"></a>SwapMouse.wsb</h4> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Configuration</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HostFolder</span><span class="token punctuation">&gt;</span></span>C:\sandbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>HostFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>C:\sandbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SandboxFolder</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>True<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ReadOnly</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolder</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>MappedFolders</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Command</span><span class="token punctuation">&gt;</span></span>powershell.exe -ExecutionPolicy Bypass -File C:\sandbox\SwapMouse.ps1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LogonCommand</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/a694c5bc90fd73adf3267bd7a9c27dae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">本人浪费24小时研究成功：xmanager7&#43;centos7&#43;window10 远程调用图形界面比如clock，以及异常踩坑分享。</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3fe457a4f443c9ae729e2dd62edc59b8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[RC-04] 0 1 背包</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>