<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>kkFileView LibreOffice文件预览 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="kkFileView LibreOffice文件预览" />
<meta property="og:description" content="官方文档地址: https://gitee.com/kekingcn/file-online-preview/blob/master/README.md
Windows环境下：
点击此处拉取代码
直接导入idea启动
直接启动可能会报找不到office组件，这个时候就需要去下载安装LibreOffice,官方下载地址
双击下载下来的 Libreoffice 程序，全部使用默认安装的方式进行安装，直接点击“下一步”安装完成。
默认Windows的安装路径:C:\Program Files\LibreOffice
将Libreoffice 加入到 Windows系统环境 Path 变量。
加入到系统环境变量中的 Path 变量值：C:\Program Files\LibreOffice\program
cmd到/LibreOffice/program位置下输入启动命令：
soffice -headless -accept=&#34;socket,host=127.0.0.1,port=8100;urp;&#34; -nofirststartwizard 最后回到kkFileView代码中，重启，成功，访问127.0.0.1:8012出现演示首页
到这，windows部署kkFileView LibreOffice全部成功，不用改其中的代码，只需要在前端添加上面的两行代码（注意:根据演示页面可以看出“url”后面不是接的访问路径，而是将访问路径转为了base64,进行访问，根据下面的预览测试也能看出）
Linux环境
将拉取的项目进行打包，会出现3个文件
kkFileView-4.1.0-SNAPSHOT.jar（Spring Boot打包后得到jar包）
kkFileView-4.1.0-SNAPSHOT.jar.original（是Maven在Spring Boot重新打包之前创建的原始jar文件）
kkFileView-4.1.0-SNAPSHOT.tar.gz（Linux版本：项目中通过assembly配置，生成的发行项目包，带配置好的启动脚本startup.sh等）
kkFileView-4.1.0-SNAPSHOT.zip（Window版本：项目中通过assembly配置，生成的发行项目包，带配置好的启动脚本startup.bat等）
注意：在配置文件中startup.sh或startup.bat的文件名，可能与IDEA打包生成的文件名不一致，需要自己修改。
打包完成后进行部署
将kkFileView-4.1.0-SNAPSHOT.tar.gz压缩包放到服务器位置进行解压
终端解压后进入bin目录，直接执行：./startup.sh 脚本就运行了
执行：./startup.sh可以查询项目运行的日志，./shutdown.sh结束运行（这些需要注意：执行启动脚本后，会生成kkFileView.pid文件，如果是执行./shutdown.sh结束运行，该文件会自动删除，如果是kill 杀掉该进程，该文件会还存在，需手动删除该文件，不然再次运行启动脚本，它判断到该文件还存在，会报进程在运行）
到这linux部署kkFileView完成，接下来一样部署LibreOffice
官网下载：https://www.libreoffice.org/download/download/
选择linux版本
命令解压：tar -zxvf LibreOffice_6.2.4_Linux_x86-64_rpm.tar.gz
进行安装
进入解压路径;cd LibreOffice_6.2.4_Linux_x86-64_rpm/RPMS
执行安装命令为：su -c’yum install * .rpm’
安装过程中会让你输入，y/N ，输入y 即可
安装成功：安装成功后会在 /opt/ 下生产一个 libreoffice7.2 的文件夹
最后更改环境变量 ：vim /etc/profile
加入（7.2是看自己的版本对应）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a45f5359024b6e002a192efb5a41e3f4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-28T09:28:07+08:00" />
<meta property="article:modified_time" content="2022-07-28T09:28:07+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">kkFileView LibreOffice文件预览</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><strong>官方文档地址:</strong> https://gitee.com/kekingcn/file-online-preview/blob/master/README.md</p> 
<p><strong>Windows环境下：</strong><br> <a href="https://gitee.com/kekingcn/file-online-preview/tree/master" rel="nofollow">点击此处拉取代码</a><br> <strong>直接导入idea启动</strong></p> 
<p>直接启动可能会报<strong>找不到office组件</strong>，这个时候就需要去下载安装LibreOffice,官方<a href="https://www.libreoffice.org/download/download/" rel="nofollow">下载地址</a><br> <strong>双击下载下来的 Libreoffice 程序，全部使用默认安装的方式进行安装，直接点击“下一步”安装完成。</strong><br> <strong>默认Windows的安装路径:C:\Program Files\LibreOffice</strong><br> <strong>将Libreoffice 加入到 Windows系统环境 Path 变量。<br> 加入到系统环境变量中的 Path 变量值：C:\Program Files\LibreOffice\program</strong><br> <strong>cmd到/LibreOffice/program位置下输入启动命令：</strong></p> 
<pre><code>soffice -headless -accept="socket,host=127.0.0.1,port=8100;urp;" -nofirststartwizard
</code></pre> 
<p><img src="https://images2.imgbox.com/eb/be/7VWpahJz_o.png" alt="在这里插入图片描述"><br> <strong>最后回到kkFileView代码中，重启，成功，访问127.0.0.1:8012出现演示首页</strong><br> <img src="https://images2.imgbox.com/a3/c2/NZWJUhu3_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/b5/f9/y60kWn6D_o.png" alt="在这里插入图片描述"></p> 
<p><strong>到这，windows部署kkFileView LibreOffice全部成功，不用改其中的代码，只需要在前端添加上面的两行代码（注意:根据演示页面可以看出“url”后面不是接的访问路径，而是将访问路径转为了base64,进行访问，根据下面的预览测试也能看出）</strong><br> <img src="https://images2.imgbox.com/5b/1b/4iO6mwbp_o.png" alt="在这里插入图片描述"><br> <strong>Linux环境</strong><br> <strong>将拉取的项目进行打包，会出现3个文件</strong><br> kkFileView-4.1.0-SNAPSHOT.jar（Spring Boot打包后得到jar包）<br> kkFileView-4.1.0-SNAPSHOT.jar.original（是Maven在Spring Boot重新打包之前创建的原始jar文件）<br> kkFileView-4.1.0-SNAPSHOT.tar.gz（Linux版本：项目中通过assembly配置，生成的发行项目包，带配置好的启动脚本startup.sh等）<br> kkFileView-4.1.0-SNAPSHOT.zip（Window版本：项目中通过assembly配置，生成的发行项目包，带配置好的启动脚本startup.bat等）<br> <img src="https://images2.imgbox.com/04/02/fbeq8cru_o.png" alt="在这里插入图片描述"><br> <strong>注意：在配置文件中startup.sh或startup.bat的文件名，可能与IDEA打包生成的文件名不一致，需要自己修改。</strong><br> <img src="https://images2.imgbox.com/81/f6/4c9qkv0t_o.png" alt="在这里插入图片描述"><br> <strong>打包完成后进行部署</strong><br> <strong>将kkFileView-4.1.0-SNAPSHOT.tar.gz压缩包放到服务器位置进行解压</strong><br> <strong>终端解压后进入bin目录，直接执行：./startup.sh 脚本就运行了</strong><br> <strong>执行：./startup.sh可以查询项目运行的日志，./shutdown.sh结束运行（这些需要注意：执行启动脚本后，会生成kkFileView.pid文件，如果是执行./shutdown.sh结束运行，该文件会自动删除，如果是kill 杀掉该进程，该文件会还存在，需手动删除该文件，不然再次运行启动脚本，它判断到该文件还存在，会报进程在运行）</strong></p> 
<p><strong>到这linux部署kkFileView完成，接下来一样部署LibreOffice</strong><br> 官网下载：<a href="https://www.libreoffice.org/download/download/" rel="nofollow">https://www.libreoffice.org/download/download/</a><br> <strong>选择linux版本</strong><br> 命令解压：tar -zxvf LibreOffice_6.2.4_Linux_x86-64_rpm.tar.gz<br> <strong>进行安装</strong><br> 进入解压路径;cd LibreOffice_6.2.4_Linux_x86-64_rpm/RPMS<br> 执行安装命令为：su -c’yum install * .rpm’<br> <img src="https://images2.imgbox.com/e9/8b/Ly9JfsuN_o.png" alt="在这里插入图片描述"></p> 
<p>安装过程中会让你输入，y/N ，输入y 即可<br> <img src="https://images2.imgbox.com/b3/34/VZKLsB0O_o.png" alt="在这里插入图片描述"><br> <strong>安装成功：安装成功后会在 /opt/ 下生产一个 libreoffice7.2 的文件夹</strong><br> <img src="https://images2.imgbox.com/2b/cf/Y90ojnPB_o.png" alt="在这里插入图片描述"><br> <strong>最后更改环境变量 ：vim /etc/profile</strong><br> <strong>加入（7.2是看自己的版本对应）</strong></p> 
<pre><code>export LibreOffice_PATH=/opt/libreoffice7.2/program
 
export PATH=$LibreOffice_PATH:$PATH
</code></pre> 
<p><strong>然后保存,执行生效命令<br> 刷新配置：source /etc/profile</strong></p> 
<p><strong>执行启动命令</strong></p> 
<pre><code class="prism language-handlebars"><span class="token block keyword">/usr/bin/libreoffice7.</span><span class="token number">2</span> <span class="token variable">--headless</span> <span class="token variable">--accept</span><span class="token punctuation">=</span><span class="token string">"socket,host=0.0.0.0,port=8100;urp;"</span> <span class="token variable">--nofirststartwizard</span> <span class="token punctuation">&amp;</span>
</code></pre> 
<p><strong>报错：/opt/libreoffice7.2/program/soffice.bin:加载共享库时出错：libcairo.so.2:无法打开共享对象文件：没有此类文件或目录</strong><br> <strong>执行下命令安装一下依赖包即可：</strong></p> 
<pre><code class="prism language-handlebars"><span class="token variable">yum</span> <span class="token variable">install</span> <span class="token variable">ibus</span>
</code></pre> 
<p>再次启动（这里启动可能有点慢），成功，启动kkFileView 访问127.0.0.1:8012访问，出现演示项目页面</p> 
<p><strong>linux-kkFileView参考</strong><a href="https://qkongtao.cn/?p=1250" rel="nofollow">来源</a><br> <strong>linux-libreoffice</strong>参考<a href="https://blog.csdn.net/LookingTomorrow/article/details/93632378/">来源</a></p> 
<p><strong>如果文件在MinIO服务器下，需设置minio存储桶的访问策略为公共可读，不然无法访问</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e4dbb39508c3fc9cc1ca6e78b02bc51e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">sqlmap使用教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/38db60a89aab2fe9a873120424b51f3c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Source Insight 4.0使用介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>