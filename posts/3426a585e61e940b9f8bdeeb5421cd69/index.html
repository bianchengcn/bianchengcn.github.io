<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>2020.08最新必看 pytorch&#43;cuda10.2（或10.1）&#43;python3.7版 30min完成安装（五小时血泪经验）亲测可用！！防坑！！ - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="2020.08最新必看 pytorch&#43;cuda10.2（或10.1）&#43;python3.7版 30min完成安装（五小时血泪经验）亲测可用！！防坑！！" />
<meta property="og:description" content="博主之前电脑显卡为A卡一直在用cpu版本的，由于新换了一台1660ti卡的笔记本于是研究了一下怎么装gpu版本的pytorch下面进入正文，只有显卡为N卡才能装pytorch的cuda的版本，其他卡只能用CPU的版本。
Anaconda是一个开源的包、环境管理器，可以用于在同一个电脑上安装不同版本的软件包，并能够在不同的环境之间切换，Anaconda不是语言，它只是python的一个集成管理工具或系统，我们只需要安装Anaconda就可以了，甚至不用单独去安装python。
我们在使用过程中会出现conda，实际上这是一个可执行的命令，它的重要的功能就是包管理与环境管理，包管理也就是下载众多packages和科学计算工具等，环境管理就是用户可以安装不同版本的python来进行快速切换。安装anaconda让我们省去了大量下载模块包的时间，更加方便。
一、Anaconda的安装 1：下载地址：官网（国内速度较慢100M网速自测200kb/s）：https://www.anaconda.com/products/individual.
建议使用：清华大学开源软件镜像站（速度较快100M网速自测10mb/s）：
链接: 清华大学开源软件镜像站.
官网界面如下：
清华大学开源软件镜像站界面如下：
请下载Windows Python3.8版本的，64位还是32位根据自己电脑情况，一般为64位，右击我的电脑属性可以查看。
2.anaconda安装过程一路next,这里建议just me
3.这里建议不安装在C盘，占用空间过大。但是不要安装在包含空格和中文的路径下
4.不建议勾选第一项，勾选的话能直接在cmd中使用conda、jupyter、ipython等命令，不勾选的话，也可以在之后使用Anaconda提供的命令行工具进行操作，这个其实勾不勾选问题都不大，建议不勾选，未勾选的话后续进行环境变量的配置不会出现问题。
5.最后完成安装，选中learn会弹出页面可以取消。
二、检查显卡设备 首先我们要确定电脑是否有独立显卡，可以在计算机-管理-设备管理器-显示适配器中，查看是否有独立显卡，可以看到我的电脑有两个显卡，一块集成显卡一块独立显卡N卡。
其次要知道的是高版本的cuda是可以兼容低版本的cuda的，比如我的电脑支持cuda11.0，我就可以安装cuda10.0/cuda10.1/cuda10.2等，但是如果我的电脑只支持cuda10.0那就不可以反过来安装cuda10.1。
打开NVIDIA控制面板，点击 帮助——系统信息——组件，查看自己电脑支持的cuda版本，我的笔记本显卡为GTX1660ti可以看到CUDA为11.0，那么我们可以安装cuda为10.1或10.2版本的pytorch，cudnn的版本只需要与需要用到的cuda版本对应即可后续说明。
三、安装并配置CUDA 1。到链接: 英伟达官网.官网下载对应的CUDA版本。我下载的版本是CUDA10.2
我选择的是exe[network]也就是在线安装，最后下载，下载完成后双击exe文件。
2。安装CUDA：双击执行下载的exe文件，会先解压文件到临时目录（不是安装目录），保持默认即可
3。这里需要选择自定义安装
4。这里要把图示圈起来的对勾去掉
5。这三个地址十分重要，后续我们将进行环境变量的配置，不要改变路径。
6。之后等待安装完成即可。
7。配置CUDA环境变量
首先右键我的电脑-属性-高级系统设置-环境变量
在Path中手动添加如下路径：
C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\lib\x64
C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\include
C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\extras\CUPTI\lib64
C:\ProgramData\NVIDIA Corporation\CUDA Samples\v10.2\bin\win64
C:\ProgramData\NVIDIA Corporation\CUDA Samples\v10.2\common\lib\x64
8。我们可以验证一下cuda是否成功，按win&#43;R 输入cmd
输入命令`
nvcc -V 安装成功10.2版本
四、安装cuDNN 到链接: 英伟达.下载与CUDA对应的cuDNN，这里需要我们注册一个账号，然后登录下载，下载时一定注意与CUDA的版本对应，如果你下载的CUDA为10.2则下载第二个。
下载之后，解压缩，将CUDNN文件夹中的各自的bin、clude、lib文件夹中的内容，直接复制添加到CUDA的刚刚安装目录的对应相同名字的文件夹下。
五、pytorch安装 1。打开链接: pytorch官网.找到匹配的版本，我选择的是win10下的CUDA为10.2的版本，很多教程使用conda下载，我强烈建议使用pip下载，在经历五个小时找bug后使用pip下载，各种错误直接消失很快装好
可以看到给出了命令，但是在国内不翻墙的情况下，下载速度极慢并且容易卡顿，我修改了一下命令，可以使用国内的清华源进行下载，速度较快。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/3426a585e61e940b9f8bdeeb5421cd69/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-18T20:50:46+08:00" />
<meta property="article:modified_time" content="2020-08-18T20:50:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">2020.08最新必看 pytorch&#43;cuda10.2（或10.1）&#43;python3.7版 30min完成安装（五小时血泪经验）亲测可用！！防坑！！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>博主之前电脑显卡为A卡一直在用cpu版本的，由于新换了一台1660ti卡的笔记本于是研究了一下怎么装gpu版本的pytorch下面进入正文，<mark>只有显卡为N卡才能装pytorch的cuda的版本，其他卡只能用CPU的版本</mark>。<br> Anaconda是一个开源的包、环境管理器，可以用于在同一个电脑上安装不同版本的软件包，并能够在不同的环境之间切换，Anaconda不是语言，它只是python的一个集成管理工具或系统，我们只需要安装Anaconda就可以了，甚至不用单独去安装python。<br> 我们在使用过程中会出现conda，实际上这是一个可执行的命令，它的重要的功能就是包管理与环境管理，包管理也就是下载众多packages和科学计算工具等，环境管理就是用户可以安装不同版本的python来进行快速切换。安装anaconda让我们省去了大量下载模块包的时间，更加方便。</p> 
<h3><a id="Anaconda_4"></a>一、Anaconda的安装</h3> 
<p><strong>1</strong>：下载地址：官网（国内速度较慢100M网速自测200kb/s）：<a href="https://www.anaconda.com/products/individual/" rel="nofollow">https://www.anaconda.com/products/individual</a>.<br> 建议使用：清华大学开源软件镜像站（速度较快100M网速自测10mb/s）：<br> 链接: <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" rel="nofollow">清华大学开源软件镜像站</a>.<br> 官网界面如下：<br> <img src="https://images2.imgbox.com/7d/3e/04mNr20h_o.png" alt="在这里插入图片描述"><br> 清华大学开源软件镜像站界面如下：<br> <img src="https://images2.imgbox.com/e7/73/r2oe0O1z_o.png" alt="在这里插入图片描述"></p> 
<p>请下载Windows Python3.8版本的，64位还是32位根据自己电脑情况，一般为64位，右击我的电脑属性可以查看。</p> 
<p><strong>2</strong>.anaconda安装过程一路next,这里建议just me<br> <img src="https://images2.imgbox.com/e8/7c/SB05spfM_o.png" alt="在这里插入图片描述"><br> <strong>3</strong>.这里建议不安装在C盘，占用空间过大。<mark>但是不要安装在包含空格和中文的路径下</mark><br> <img src="https://images2.imgbox.com/3f/bf/16pwavnW_o.png" alt="在这里插入图片描述"></p> 
<p><strong>4</strong>.不建议勾选第一项，勾选的话能直接在cmd中使用conda、jupyter、ipython等命令，不勾选的话，也可以在之后使用Anaconda提供的命令行工具进行操作，这个其实勾不勾选问题都不大，<strong><mark>建议不勾选，未勾选的话后续进行环境变量的配置不会出现问题。</mark></strong><br> <img src="https://images2.imgbox.com/ae/56/IkVB4OQF_o.png" alt="在这里插入图片描述"></p> 
<p><strong>5</strong>.最后完成安装，选中learn会弹出页面可以取消。<br> <img src="https://images2.imgbox.com/18/d0/WG7wtrN4_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_25"></a>二、检查显卡设备</h2> 
<p>首先我们要确定电脑是否有独立显卡，可以在计算机-管理-设备管理器-显示适配器中，查看是否有独立显卡，可以看到我的电脑有两个显卡，一块集成显卡一块独立显卡N卡。<br> <img src="https://images2.imgbox.com/0a/e1/Qx5rM91r_o.png" alt="在这里插入图片描述"></p> 
<p>其次要知道的是高版本的cuda是可以兼容低版本的cuda的，比如我的电脑支持cuda11.0，我就可以安装cuda10.0/cuda10.1/cuda10.2等，但是如果我的电脑只支持cuda10.0那就不可以反过来安装cuda10.1。<br> 打开NVIDIA控制面板，点击 帮助——系统信息——组件，查看自己电脑支持的cuda版本，我的笔记本显卡为GTX1660ti可以看到CUDA为11.0，那么我们可以安装cuda为10.1或10.2版本的pytorch，cudnn的版本只需要与需要用到的cuda版本对应即可后续说明。<br> <img src="https://images2.imgbox.com/ff/77/A1qxBsxn_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="CUDA_32"></a>三、安装并配置CUDA</h2> 
<p><strong>1</strong>。到链接: <a href="https://developer.nvidia.com/cuda-toolkit-archive" rel="nofollow">英伟达官网</a>.官网下载对应的CUDA版本。我下载的版本是CUDA10.2<br> <img src="https://images2.imgbox.com/98/17/FdDr5Qhf_o.png" alt="在这里插入图片描述"><br> 我选择的是exe[network]也就是在线安装，最后下载，下载完成后双击exe文件。<br> <img src="https://images2.imgbox.com/33/60/e3N3eTp8_o.png" alt="在这里插入图片描述"><br> <strong>2</strong>。安装CUDA：双击执行下载的exe文件，会先解压文件到临时目录（不是安装目录），保持默认即可<br> <img src="https://images2.imgbox.com/3e/67/uhgVD1eL_o.png" alt="在这里插入图片描述"><br> <strong>3</strong>。<mark>这里需要选择自定义安装</mark><br> <img src="https://images2.imgbox.com/d0/be/tNtK6tuX_o.png" alt="在这里插入图片描述"><br> <strong>4</strong>。<mark>这里要把图示圈起来的对勾去掉</mark><br> <img src="https://images2.imgbox.com/0a/56/2fhlOdqL_o.png" alt="在这里插入图片描述"><br> <strong>5</strong>。<mark>这三个地址十分重要，后续我们将进行环境变量的配置，不要改变路径。</mark><br> <img src="https://images2.imgbox.com/54/1d/jP4IT300_o.png" alt="在这里插入图片描述"><br> <strong>6</strong>。之后等待安装完成即可。<br> <img src="https://images2.imgbox.com/2d/5e/E30I9drl_o.png" alt="在这里插入图片描述"><br> <strong>7</strong>。配置CUDA环境变量<br> 首先右键我的电脑-属性-高级系统设置-环境变量<br> <img src="https://images2.imgbox.com/2c/0f/hGBNy1ER_o.png" alt="在这里插入图片描述"></p> 
<p>在Path中手动添加如下路径：</p> 
<p>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\lib\x64<br> C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\include<br> C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.2\extras\CUPTI\lib64<br> C:\ProgramData\NVIDIA Corporation\CUDA Samples\v10.2\bin\win64<br> C:\ProgramData\NVIDIA Corporation\CUDA Samples\v10.2\common\lib\x64<br> <img src="https://images2.imgbox.com/f3/7b/TrMAlpNI_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/86/b5/e4VvOLwt_o.png" alt="在这里插入图片描述"><br> <strong>8</strong>。我们可以验证一下cuda是否成功，按win+R 输入cmd<br> 输入命令`</p> 
<pre><code class="prism language-python">nvcc <span class="token operator">-</span>V
</code></pre> 
<p><img src="https://images2.imgbox.com/e8/7e/yhTnHv4H_o.png" alt="在这里插入图片描述"><br> 安装成功10.2版本</p> 
<h2><a id="cuDNN_72"></a>四、安装cuDNN</h2> 
<p>到链接: <a href="https://developer.nvidia.com/cudnn" rel="nofollow">英伟达</a>.下载与CUDA对应的cuDNN，这里需要我们注册一个账号，然后登录下载，下载时一定注意与CUDA的版本对应，如果你下载的CUDA为10.2则下载第二个。<br> <img src="https://images2.imgbox.com/67/1b/e65Gk6xO_o.png" alt="在这里插入图片描述"><br> 下载之后，解压缩，将CUDNN文件夹中的各自的bin、clude、lib文件夹中的内容，直接复制添加到CUDA的刚刚安装目录的对应相同名字的文件夹下。</p> 
<h2><a id="pytorch_78"></a>五、pytorch安装</h2> 
<p><strong>1</strong>。打开链接: <a href="https://pytorch.org/" rel="nofollow">pytorch官网</a>.找到匹配的版本，我选择的是win10下的CUDA为10.2的版本，很多教程使用conda下载，<mark><strong>我强烈建议使用pip下载，在经历五个小时找bug后使用pip下载，各种错误直接消失很快装好</strong></mark><br> <img src="https://images2.imgbox.com/77/0e/hJ575V3Q_o.png" alt="在这里插入图片描述"><br> 可以看到给出了命令，但是在国内不翻墙的情况下，下载速度极慢并且容易卡顿，我修改了一下命令，可以使用国内的清华源进行下载，速度较快。<br> 如果你选择的是CUDA10.2版本的那么使用下面命令下载</p> 
<pre><code class="prism language-python">pip3 install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple torch<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1.6</span><span class="token number">.0</span> torchvision<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.7</span><span class="token number">.0</span> <span class="token operator">-</span>f https<span class="token punctuation">:</span><span class="token operator">//</span>download<span class="token punctuation">.</span>pytorch<span class="token punctuation">.</span>org<span class="token operator">/</span>whl<span class="token operator">/</span>torch_stable<span class="token punctuation">.</span>html
</code></pre> 
<p>如果你选择的是CUDA10.1版本的那么使用下面命令下载</p> 
<pre><code class="prism language-python">pip3 install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple torch<span class="token operator">==</span><span class="token number">1.6</span><span class="token number">.0</span> torchvision<span class="token operator">==</span><span class="token number">0.7</span><span class="token number">.0</span> <span class="token operator">-</span>f https<span class="token punctuation">:</span><span class="token operator">//</span>download<span class="token punctuation">.</span>pytorch<span class="token punctuation">.</span>org<span class="token operator">/</span>whl<span class="token operator">/</span>torch_stable<span class="token punctuation">.</span>html
</code></pre> 
<p><strong>2</strong>。命令使用方法<br> 打开anaconda prompt<br> 首先创建一个pytorch的虚拟环境<br> 可以键入命令<code>conda create -n pytorch_gpu python=3.7</code><br> pytorch_gpu为环境的名称，可以自定义改变<br> <img src="https://images2.imgbox.com/34/08/i3KMxKG5_o.png" alt="在这里插入图片描述"><br> 输入y等待环境创建完成。<br> 键入 <code>conda activate pytorch_gpu</code>进入pytorch的环境，如果前面括号的内容发生改变代表进入成功。<br> <img src="https://images2.imgbox.com/4b/05/oqgkZ5DL_o.png" alt="在这里插入图片描述"><br> 之后输入下载对象pytorch版本的命令即可，由于我选择的是CUDA10.2那我我需要键入</p> 
<pre><code class="prism language-python">pip3 install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple torch<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1.6</span><span class="token number">.0</span> torchvision<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.7</span><span class="token number">.0</span> <span class="token operator">-</span>f https<span class="token punctuation">:</span><span class="token operator">//</span>download<span class="token punctuation">.</span>pytorch<span class="token punctuation">.</span>org<span class="token operator">/</span>whl<span class="token operator">/</span>torch_stable<span class="token punctuation">.</span>html
</code></pre> 
<p><img src="https://images2.imgbox.com/45/b6/MCabO0ht_o.png" alt="在这里插入图片描述"></p> 
<p><mark>等待下载完成即安装完成!!!</mark></p> 
<h2><a id="pytorch_CUDA_108"></a>六、测试pytorch CUDA是否可用</h2> 
<p><strong>1</strong>。首先进入我们刚才建立的虚拟环境，由于我的虚拟环境命名为pytorch，你们的命名为pytorch_gpu或其他，根据命名输入命令，之后输入python，进入python。<br> <img src="https://images2.imgbox.com/02/e4/4R4qdA3I_o.png" alt="在这里插入图片描述"><br> <strong>2</strong>输入以下命令进行测试</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> torch
<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#cuda是否可用</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>device_count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#返回GPU的数量</span>
torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>get_device_name<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#返回gpu名字，设备索引默认从0开始</span>
</code></pre> 
<p>结果如下证明安装成功<br> <img src="https://images2.imgbox.com/f8/d8/U35uWLvm_o.png" alt="在这里插入图片描述"></p> 
<p>在安装过程中遇到的问题：<br> 在使用conda清华源进行安装CUDA10.2版本的pytorch，在最后测试CUDA是否可用的过程中一直是False，至今没找到具体原因，在测试CUDA和cuDNN时显卡都是正常的，但是使用pip下载，下载过后错误就消失了，初步分析使用conda下载可能有文件的缺失。</p> 
<h2><a id="CUDA_124"></a>七、记录在电脑测试显卡CUDA是否正常的方法</h2> 
<p><strong>1</strong>。在cmd中输入nvcc -V查看版号<br> <strong>2</strong>。打开cmd<br> 输入</p> 
<pre><code class="prism language-python">cd C<span class="token punctuation">:</span>\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10<span class="token punctuation">.</span><span class="token number">2</span>\extras\demo_suite
</code></pre> 
<p>分别运行<strong>bandwidthTest.exe</strong> 和 <strong>deviceQuery.exe</strong>如果显示<strong>PASS</strong>则正常<br> <strong>bandwidthTest.exe</strong> ：<br> <img src="https://images2.imgbox.com/7e/96/3G5gKpPc_o.png" alt="在这里插入图片描述"><br> <strong>deviceQuery.exe</strong>：<br> <img src="https://images2.imgbox.com/d4/2f/btZ49fJK_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f809af6e12058c063a8a01ed32cd94b9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Asp.net WebApi 项目示例（增删改查）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/13d0bdc7a62001b27e125bcd8649b3d3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">idea编辑器关闭重复代码检查</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>