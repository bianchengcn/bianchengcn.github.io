<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【ASP】ASP对Access数据库的连接、增删改查及ASP的基本语法 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【ASP】ASP对Access数据库的连接、增删改查及ASP的基本语法" />
<meta property="og:description" content="本文讨论的是ASP，而不是Visual Studio写出来的.ASPX也就是ASP.NET。
ASP不需要任何插件的支持，关键你是配置好WINDOWS的IIS服务器，把页面扔在上面执行就可以了。
不同WINDOWS系统的IIS服务器配置，除了某些被阉割的WINXP装机版系统之外，都支持IIS服务器配置，都在WINDOWS的组件中，不需要下载任何东西。如何配置IIS服务器不是本文讨论的重点。
一、基本目标
假设Access2007数据库database.mdb中存在表test如下：
id为自增列，username,password皆为文本
现在要求把这张表在ASP页面中查询出来。并且再下面继续增加一项username=3,password=a的内容。
运行asp网页的时候记得把access关掉，不可以边打开access边运行asp网页。
二、制作过程
asp代码必须写在&lt;%%&gt;之中，
asp声明变量可以用dim a;声明，a不分类型，系统自动识别。dim可以不写，也就是完全可以写出a=什么，
改变a的值必须用set a=..不能直接a=...，此乃对a的初始化。
数据库声明部分conn与rs的值必须用set conn的形式赋予，因为系统已经自动对其初始化。
&lt;head&gt;部分不需要引用任何文件。
整个网页的代码如下，下面一段一段进行说明：
&lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&#34;Content-Type&#34; content=&#34;text/html; charset=utf-8&#34; /&gt; &lt;title&gt;数据库的连接、增删改查&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;% db=&#34;Database.mdb&#34; Set conn = Server.CreateObject(&#34;ADODB.Connection&#34;) conn.Open &#34;driver={Microsoft Access Driver (*.mdb)};pwd=admin;dbq=&#34; &amp; Server.MapPath(db) response.write &#34;数据库连接成功！&#34; Set rs = Server.CreateObject( &#34;ADODB.Recordset&#34; ) sql = &#34;select * from test;&#34; rs.open sql,conn,1,3 %&gt; &lt;br/&gt; 表test的内容: &lt;table border=&#34;1&#34;&gt; &lt;tr&gt; &lt;td&gt;id&lt;/td&gt; &lt;td&gt;username&lt;/td&gt; &lt;td&gt;password&lt;/td&gt; &lt;/tr&gt; &lt;% if (rs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0f06cd4e7eb3f17f19b1a825c03aa83a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2014-11-09T20:09:57+08:00" />
<meta property="article:modified_time" content="2014-11-09T20:09:57+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【ASP】ASP对Access数据库的连接、增删改查及ASP的基本语法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>本文讨论的是ASP，而不是Visual Studio写出来的.ASPX也就是ASP.NET。</p> 
<p>ASP不需要任何插件的支持，关键你是配置好WINDOWS的IIS服务器，把页面扔在上面执行就可以了。</p> 
<p>不同WINDOWS系统的IIS服务器配置，除了某些被阉割的WINXP装机版系统之外，都支持IIS服务器配置，都在WINDOWS的组件中，不需要下载任何东西。如何配置IIS服务器不是本文讨论的重点。</p> 
<p><br> </p> 
<p><strong>一、基本目标</strong></p> 
<p>假设Access2007数据库database.mdb中存在表test如下：</p> 
<p><img src="https://images2.imgbox.com/5c/2b/n3hVskMz_o.png" alt=""></p> 
<p>id为自增列，username,password皆为文本</p> 
<p>现在要求把这张表在ASP页面中查询出来。并且再下面继续增加一项username=3,password=a的内容。</p> 
<p>运行asp网页的时候记得把access关掉，不可以边打开access边运行asp网页。</p> 
<p><img src="https://images2.imgbox.com/d9/67/XsAloqAz_o.png" alt=""><br> </p> 
<p><br> </p> 
<p><strong>二、制作过程</strong></p> 
<p>asp代码必须写在&lt;%%&gt;之中，</p> 
<p>asp声明变量可以用dim a;声明，a不分类型，系统自动识别。dim可以不写，也就是完全可以写出a=什么，</p> 
<p>改变a的值必须用set a=..不能直接a=...，此乃对a的初始化。</p> 
<p>数据库声明部分conn与rs的值必须用set conn的形式赋予，因为系统已经自动对其初始化。</p> 
<p>&lt;head&gt;部分不需要引用任何文件。</p> 
<p>整个网页的代码如下，下面一段一段进行说明：</p> 
<p></p> 
<pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;数据库的连接、增删改查&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;%
db="Database.mdb"
Set conn = Server.CreateObject("ADODB.Connection")
conn.Open "driver={Microsoft Access Driver (*.mdb)};pwd=admin;dbq=" &amp; Server.MapPath(db) 
response.write "数据库连接成功！"
Set rs = Server.CreateObject( "ADODB.Recordset" )
sql = "select * from test;"
rs.open sql,conn,1,3
%&gt;
&lt;br/&gt;
表test的内容:
&lt;table border="1"&gt;
  &lt;tr&gt;
    &lt;td&gt;id&lt;/td&gt;
    &lt;td&gt;username&lt;/td&gt;
    &lt;td&gt;password&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%
if (rs.bof and rs.eof) then
response.write "nodata!"
else
do while not rs.eof
%&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%=rs("id")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("username")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("password")%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%
rs.movenext
loop
end if
%&gt;
&lt;/table&gt;
&lt;%
'conn.execute "update test set username='2' where username='a';"
conn.execute "insert into test(username,password) values ('3','a');"
%&gt;
---------插入数据之后--------&lt;br/&gt;
表test的内容:&lt;br/&gt;
&lt;%
Set rs = Server.CreateObject( "ADODB.Recordset" )
sql = "select * from test;"
rs.open sql,conn,1,3
%&gt;
&lt;table border="1"&gt;
  &lt;tr&gt;
    &lt;td&gt;id&lt;/td&gt;
    &lt;td&gt;username&lt;/td&gt;
    &lt;td&gt;password&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%
if (rs.bof and rs.eof) then
response.write "nodata!"
else
do while not rs.eof
%&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%=rs("id")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("username")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("password")%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%
rs.movenext
loop
end if
%&gt;
&lt;/table&gt;
&lt;%
rs.close
set rs=nothing
conn.close
set conn=nothing
%&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<br> 这段代码是用记事本敲出来的，没有用任何开发工具，所有缺乏缩进等基本代码格式见谅，ASP实在缺乏代码开发工具。 
<p></p> 
<p>ASPEDIT都是一些1997年就出版的东西了。</p> 
<p><strong>1、&lt;head&gt;部分</strong></p> 
<p></p> 
<pre><code class="language-html">&lt;head&gt;
&lt;!--必须声明使用utf-8编码，否则在IE8中页面显示会乱码--&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;数据库的连接、增删改查&lt;/title&gt;
&lt;/head&gt;</code></pre> 
<p></p> 
<p>以下就是&lt;body&gt;部分了</p> 
<p><strong>2、连接数据库部分</strong></p> 
<p></p> 
<pre><code class="language-html">&lt;%
'asp同使用'去注释，不允许使用;来结束语句，每一个enter键就是代表一条语句结束
'Access数据库文件是database.mdb
db="Database.mdb"
Set conn = Server.CreateObject("ADODB.Connection")
'指定动作，pwd后的值代表此数据库的密码
conn.Open "driver={Microsoft Access Driver (*.mdb)};pwd=admin;dbq=" &amp; Server.MapPath(db)
'在网页上输出东西，可以用response对象 
response.write "数据库连接成功！"
%&gt;</code></pre> 
<strong>3、查询部分</strong> 
<p></p> 
<p></p> 
<pre><code class="language-html">&lt;%
'指定动作
Set rs = Server.CreateObject( "ADODB.Recordset" )
'查询语句
sql = "select * from test;"
'使用sql对conn进行查询，后面的参数代表我要完全操作这个数据库
rs.open sql,conn,1,3
%&gt;
&lt;!--此乃表头，asp代码可以与html代码混合，table默认是没有边框的，所以要设置一个border参数--&gt;
&lt;br/&gt;
表test的内容:
&lt;table border="1"&gt;
  &lt;tr&gt;
    &lt;td&gt;id&lt;/td&gt;
    &lt;td&gt;username&lt;/td&gt;
    &lt;td&gt;password&lt;/td&gt;
  &lt;/tr&gt;
&lt;%
'如果没有查到任何东西这样写，ASP没有括号，条件体必须用end if结束，then相当于左括号，end if相当于右括号
if (rs.bof and rs.eof) then
response.write "nodata!"
else
'否则就循环，直到读完这条游标，循环条件是not rs.eof，ASP没有括号，do while循环体必须用loop结束，do while后自带左括号，loop相当于右括号
'下面的html循环一次就向网页写入一次
do while not rs.eof
%&gt;
  &lt;tr&gt;
    &lt;td&gt;&lt;%=rs("id")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("username")%&gt;&lt;/td&gt;
    &lt;td&gt;&lt;%=rs("password")%&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;%
  '读完一项，游标向下拉
rs.movenext
loop
end if
%&gt;
&lt;/table&gt;</code></pre> 
<strong>4、增加、删除、修改操作部分</strong> 
<p></p> 
<p>这里没有写出删除操作，修改操作则被注释掉了，但他们的用法与增加操作完全一样，</p> 
<p></p> 
<pre><code class="language-html">&lt;%
'与查询操作不同的是，插入操作很简短。
'修改操作可以用下面的语句，把test表的username字段（列）中为a的项都改为2
'conn.execute "update test set username='2' where username='a';"
conn.execute "insert into test(username,password) values ('3','a');"
%&gt;</code></pre>插入之后再次查询的道理与上面的未插入之前是一样道理的，就不再进行说明了。 
<br> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/19ccf0b2f95c42ec6b38caad10ed0d55/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">php接收textarea内容后如何显示换行和空格</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d2925e76af188341e6187056fb1254fb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【ASP】连接Access数据库的登陆系统</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>