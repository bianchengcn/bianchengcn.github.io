<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jquery一个ajax方法结束后，再执行下一个ajax方法。 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jquery一个ajax方法结束后，再执行下一个ajax方法。" />
<meta property="og:description" content="今天遇到一个问题，就是下拉框回显的时候，有时可以正确回显，有时却取不到数据，代码如下：
$.ajax({ type:&#34;get&#34;, url:&#34;EED.jsp?type=selMajor&#34;, dataType:&#39;json&#39; , async:true, success : function(result) { $(&#34;#EEDmajorId&#34;).val(result.majorId); $(&#34;#EEDmajorName&#34;).val(result.majorName); var count = $(&#34;#industryselect option&#34;).length; for (var i = 0; i &lt; count; i&#43;&#43;) { if ($(&#34;#industryselect&#34;).get(0).options[i].text == result.industryName) { $(&#34;#industryselect&#34;).get(0).options[i].selected = true; break; } }; }, error : function(){ alert(&#34;网络连接异常...&#34;); } }); 这里有时会取不到数据，前端报错，Cannot read property &#39;options&#39; of null,于是我锁定了一行代码，
这里count有时取值为0，我意识到行业下拉框可能加载的慢，导致这里取不到值，行业下拉框的代码：
function Industry(){ var select = &#39;&#39;; //alert(m); $.ajax({ type: &#34;get&#34;, //url:&#39;department.json&#39;, url:&#39;EED.jsp?type=getIndustryInfoByEdit&#39;, dataType : &#34;json&#34;, async: false,	success: function (data) {	$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/be110e98551ce6d6289032d0bef0b62d/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-03-08T10:54:48+08:00" />
<meta property="article:modified_time" content="2019-03-08T10:54:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jquery一个ajax方法结束后，再执行下一个ajax方法。</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>今天遇到一个问题，就是下拉框回显的时候，有时可以正确回显，有时却取不到数据，代码如下：</p> 
<pre class="has"><code class="language-javascript">$.ajax({
				type:"get",
				url:"EED.jsp?type=selMajor",
				dataType:'json' ,
				async:true,
				success : function(result) {
				
				$("#EEDmajorId").val(result.majorId);
				$("#EEDmajorName").val(result.majorName);
				
				var count = $("#industryselect option").length;
				for (var i = 0; i &lt; count; i++) {
					if ($("#industryselect").get(0).options[i].text == result.industryName) {
						$("#industryselect").get(0).options[i].selected = true;
						break;
					}
				};  
				                                            
				},                                              			
				error : function(){
					alert("网络连接异常...");
				}
			});</code></pre> 
<p><img alt="" class="has" height="377" src="https://images2.imgbox.com/1c/e2/xGK2G6jQ_o.png" width="758"></p> 
<p>这里有时会取不到数据，前端报错，<span style="color:#f33b45;">Cannot read property 'options' of null,</span>于是我锁定了一行代码，</p> 
<p><img alt="" class="has" height="156" src="https://images2.imgbox.com/5d/3d/qrT5rlRZ_o.png" width="674"></p> 
<p> 这里count有时取值为0，我意识到行业下拉框可能加载的慢，导致这里取不到值，行业下拉框的代码：</p> 
<pre class="has"><code class="language-javascript">function Industry(){
			
			var select = '';
			//alert(m);
			$.ajax({
				type: "get",
				//url:'department.json',
				url:'EED.jsp?type=getIndustryInfoByEdit',
				dataType : "json",
				async: false,			
				success: function (data) {	
					
					$.each(data,function(i,f){
						
						select += '&lt;option value="'+data[i].industryid+'" id="'+i+'" checked=""&gt;'+data[i].industryname+'&lt;/option&gt;';
					});
					 
					$("#industry").html('&lt;select name="comboxname" id="industryselect" style="width:340px"&gt;&lt;option value="" checked=""&gt;所有行业&lt;/option&gt;'+select+'&lt;/select&gt;');
					
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
					//showErrorInfo("error");
					//alert("error");
				}	
			});
			
		}</code></pre> 
<p>页面初始化的时候先加载行业下拉框，在回显数据，所以这里就有先后顺序，在网上翻了一下，果然有办法，写法1</p> 
<pre class="has"><code class="language-javascript"> //ajax操作
    myajax = $.ajax(
         {
         url: "",
         type: "post",
         success: function (data) {
         }
          });


    //myajax请求完毕时执行
        $.when(myajax).done(function () {
          //要执行的操作
        });
    }</code></pre> 
<p>写法2 </p> 
<pre class="has"><code class="language-javascript">$.when($.ajax({
        url: "/home/GetProduct",
        dataType: "JSON",
        type: "GET",
        success: function (data) {
            alert(JSON.stringify(data));
        }
    })).done(function (data) {
        alert(data[0].Name);
    }).done(function (data) {
        alert(data[1].Name);
    }).fail(function () {
        alert("程序出现错误！");
    }).then(function (data) {
        alert("程序执行完成");
    });</code></pre> 
<p>自己修改的代码：</p> 
<pre class="has"><code class="language-javascript">$(document).ready(function(){
			
			
			
			$.when(Industry(),Major()).done(function () {
		          //要执行的操作
				
		     });
				
		});</code></pre> 
<p>写完之后发现，还是有点问题，有把ajax改为同步，才最终解决了问题。</p> 
<p><img alt="" class="has" height="43" src="https://images2.imgbox.com/fa/77/rcb8TeP3_o.png" width="196"></p> 
<p> 写的不好，还望指正。。</p> 
<p><br>  </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e4002ee4880fe0a90f66922faab464b1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">vue-cli3.0结合lib-flexible、px2rem实现移动端适配，完美解决第三方ui库样式变小问题（转）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5be892391e95611ac34c5a3d8fbe6279/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">java基础-抽象类（Abstract）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>