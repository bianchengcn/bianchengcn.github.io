<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【操作系统】页式储存方式，页，页表，页表项 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【操作系统】页式储存方式，页，页表，页表项" />
<meta property="og:description" content="// //操作系统和计算机组成原理里都讲到内存管理的页式管理，但是本人以及很多初次学习分页的时候，都会迷茫页表大小和页表项大小之间的关系，本人仔细分析了后写了这篇blog，仅当学习交流，个人理解之用，如果有错或者分析不够严谨，欢迎指正。 //按字、图结合起来分析，相信还是比较容易看懂。
//一、首先明确几个概念 逻辑地址：是程序编译后，生成的目标模块进行编址时都是从0号单元开始编址，称之为目标模块的相对地址，即为逻辑地址。
页：将进程划分的块，对应的大小就叫页面大小。
页框：将内存划分的块。
页和页框二者一一对应，一个页放入一个页框，（理论上）页的大小和页框的大小相等。
页表：就是一个页和页框一一对应的关系表。【存放在内存中】 关系表只是起到一个索引的作用，说白了就是能根据关系表能查到某一个页面和哪一个页框所对应。
//
//
//二、用例子说话【例子出现在：《王道考研操作系统》的内存管理部分】 已知条件：逻辑地址32位、页面大小4KB、页表项大小4B，按字节编址。
分析： 1. ​ ​ 首先
32
位的虚拟地址可表示的进程大小应该是2^32B = 4GB（暂时别去想页号P占多少位，W占多少位）
​ 2.（根据页的定义和页面大小的定义）将进程进行分页： 3.我们已经知道了页面的数目为：2^20页。现在的迷茫点就在于页表项的问题上。 上图在页表上已经给出了几个数据：20位，12位，32位，2^20项。一一解释如下【请结合上图一个一个数据分析】： ​ 2^20项：因为页表的作用是要将页面的页框一一对应起来，所以，每一个页面在页表中都应该有一个页表项：用来表示一个页号对应一页页框号（内存中的块号），故应 ​ 该有2^20项。【不应该有问题吧，就好像一个班有50个同学，每个人都应该有一个地址一样】
20位：已经很显然了，需要表示出2^20个页表项，就至少需要20位的地址。为什么只取20位而不是21位，22位呢，本人现在还没想这个问题，就暂时定为恰好取20位即可。
32位：已知条件里告诉了页表项大小为4B，那么自然就应该是32位了。
12位：32位-20位 = 12位。为什么页框号地址为12位，只能表示2^12个页框，要小于2^20个页面呢，因为并不是进程的每一个页面都要调入内存。其实32位、12位、20位这三个数据还是有一定依据的，在二级分页的时候就会发现“哦，原来刚刚好”。此处暂不讨论二级分页。
4.通过上面的分析我们得出了哪些数据： 逻辑地址32位，进程大小：4GB。
页面：大小4KB，数量：2^20页。
页表项：4B，数量：2^20项。所以页表就需要4B*2^20 = 4MB的空间存储（这就是书中说：页表项大小为4MB的由来）进一步，主存的页框大小和页面大小是相等的，也为4KB，所以将页表存在主存就需要占用4MB/4KB = 1024页（因为页表也是存在主存中的，而主存也是按页框划分的。这的确是一种资源浪费，所以就需要建立二级页面，将其大小控制在1页之内，将二级页面存入主存即可）" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/15f266735ddd8e93c5316baacde7c1e3/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-12-10T21:41:17+08:00" />
<meta property="article:modified_time" content="2017-12-10T21:41:17+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【操作系统】页式储存方式，页，页表，页表项</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>// <br> //操作系统和计算机组成原理里都讲到内存管理的页式管理，但是本人以及很多初次学习分页的时候，都会迷茫页表大小和页表项大小之间的关系，本人仔细分析了后写了这篇blog，仅当学习交流，个人理解之用，如果有错或者分析不够严谨，欢迎指正。 <br> //按字、图结合起来分析，相信还是比较容易看懂。</p> 
<h4 id="一首先明确几个概念">//一、首先明确几个概念</h4> 
<p>逻辑地址：是程序编译后，生成的目标模块进行编址时都是从0号单元开始编址，称之为目标模块的相对地址，即为逻辑地址。</p> 
<p>页：将进程划分的块，对应的大小就叫页面大小。</p> 
<p>页框：将内存划分的块。</p> 
<p>页和页框二者一一对应，一个页放入一个页框，（理论上）页的大小和页框的大小相等。</p> 
<p>页表：就是一个页和页框一一对应的关系表。【存放在内存中】 关系表只是起到一个索引的作用，说白了就是能根据关系表能查到某一个页面和哪一个页框所对应。</p> 
<p>//</p> 
<p>//</p> 
<h4 id="二用例子说话例子出现在王道考研操作系统的内存管理部分">//二、用例子说话【例子出现在：《王道考研操作系统》的内存管理部分】</h4> 
<p>已知条件：逻辑地址32位、页面大小4KB、页表项大小4B，按字节编址。</p> 
<p>分析： </p> 
<h5 id="1">1.</h5> 
<p>​ <img src="https://images2.imgbox.com/da/b5/wfr71EFy_o.png" alt="img" title=""> </p> 
<p>​ 首先</p> 
<p>32</p> 
<p>位的虚拟地址可表示的进程大小应该是2^32B = 4GB（暂时别去想页号P占多少位，W占多少位）</p> 
<p>​ </p> 
<h5 id="2根据页的定义和页面大小的定义将进程进行分页">2.（根据页的定义和页面大小的定义）将进程进行分页：</h5> 
<h5 id="3我们已经知道了页面的数目为220页现在的迷茫点就在于页表项的问题上">3.我们已经知道了页面的数目为：2^20页。现在的迷茫点就在于页表项的问题上。</h5> 
<h5 id="上图在页表上已经给出了几个数据20位12位32位220项一一解释如下请结合上图一个一个数据分析">上图在页表上已经给出了几个数据：20位，12位，32位，2^20项。一一解释如下【请结合上图一个一个数据分析】：</h5> 
<p>​ 2^20项：因为页表的作用是要将页面的页框一一对应起来，所以，每一个页面在页表中都应该有一个页表项：用来表示一个页号对应一页页框号（内存中的块号），故应 </p> 
<p>​ 该有2^20项。【不应该有问题吧，就好像一个班有50个同学，每个人都应该有一个地址一样】</p> 
<p>20位：已经很显然了，需要表示出2^20个页表项，就至少需要20位的地址。为什么只取20位而不是21位，22位呢，本人现在还没想这个问题，就暂时定为恰好取20位即可。</p> 
<p>32位：已知条件里告诉了页表项大小为4B，那么自然就应该是32位了。</p> 
<p>12位：32位-20位 = 12位。为什么页框号地址为12位，只能表示2^12个页框，要小于2^20个页面呢，因为并不是进程的每一个页面都要调入内存。其实32位、12位、20位这三个数据还是有一定依据的，在二级分页的时候就会发现“哦，原来刚刚好”。此处暂不讨论二级分页。</p> 
<h5 id="4通过上面的分析我们得出了哪些数据">4.通过上面的分析我们得出了哪些数据：</h5> 
<p>逻辑地址32位，进程大小：4GB。</p> 
<p>页面：大小4KB，数量：2^20页。</p> 
<p>页表项：4B，数量：2^20项。所以页表就需要4B*2^20 = 4MB的空间存储（这就是书中说：页表项大小为4MB的由来）进一步，主存的页框大小和页面大小是相等的，也为4KB，所以将页表存在主存就需要占用4MB/4KB = 1024页（因为页表也是存在主存中的，而主存也是按页框划分的。这的确是一种资源浪费，所以就需要建立二级页面，将其大小控制在1页之内，将二级页面存入主存即可）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5ec487ccb237b0faff0a65f6f15da88b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">堆排序实现优先队列（Priority queue）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/98b5b8ff9b727ba851c3e4f5e29e01ca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">单链表（结构体与类实现）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>