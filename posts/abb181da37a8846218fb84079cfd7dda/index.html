<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django学习 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Django学习" />
<meta property="og:description" content="Django学习 文章共计26个章节 文章目录 Django学习文章共计26个章节 第一章 Django介绍和相关术语一、Django介绍1.简介2.安装3.文档 二、Django相关知识学习1.Django结构2.相关术语和规范 第二章 项目搭建一、Django构建项目1、cmd命令行构建项目2、pycharm构建项目 第三章 Django配置一、django配置1、整体介绍2、应用settings文件3、常用配置项4、程序中获取settings中的配置项 第四章 URLConf调度器一、URL调度器1、工作原理2、简单示例3、路径转换器4、自定义路径转换器5、使用正则表达式6、使用默认值7、错误处理8、引用其他URL调度器9、额外的参数10、URL反向解析11、命名空间 第一章 Django介绍和相关术语 一、Django介绍 1.简介 Django是Python语言中的一个web框架，Python语言中主流的web框架有Django、Tornado、Flask等多种。Django相较与其他web框架，其优势为：大而全，框架本身集成了ORM、模型绑定、模板引擎、缓存、Session等功能，是一个全能型框架，拥有自己的Admin数据管理后台，第三方工具齐全，性能折中。缺点：功能太多，数据分表复杂，高性能扩展复杂。
2.安装 1.pip安装：在cmd命令窗口中，输入：
pip install django 2.pycharm安装：在file&gt;&gt;settings&gt;&gt;project&gt;&gt;project interpreter 中搜索django，进行安装。
3.下载安装包安装：在官网https://www.djangoproject.com/download/ ， 下载 django-master.tar，解压后，在解压目录中 运行 cmd（或者在cmd中切换到解压目录），然后通过输入命令：
python setup.py install 3.文档 官方文档的链接在：https://docs.djangoproject.com/en/2.2/，
点击页面右下角的language按钮，可以选择zh-hans，显示中文，只有部分页面有中文翻译，点击页面右下角的Documentation version，可以选择版本。
二、Django相关知识学习 1.Django结构 2.相关术语和规范 1.B/S 和C/S
Django是用于开发B/S架构的软件的，软件主要分为B/S架构和C/S架构：
B/S：全称Browser/Server（浏览器/服务器）
C/S：全称Client/Server（客户端/服务器）
2.MVC
MVC全名是Model View Controller，是模型（Model）—视图（View)—控制器（controller)的缩写，一种软件设计典范，用一种业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，不需要重新编写业务逻辑。
M：管理应用程序的状态（通常存储到数据库中），并约束改变状态的行为，（或者叫做“业务规则”）V：负责把数据格式化后呈现给用户C：接受外部用户的操作，根据操作访问模型获取数据，并调用视图显示这些数据，控制器是将模型和视图隔离，并成为二者之间的联系纽带。 3.MTV
Django也是一个MVC框架。但是在Django中，控制器接受用户输入的部分由框架自行处理，所以 Django 里更关注的是模型（Model）、模板(Template)和视图（Views），称为 MTV模式：
M： 代表模型（Model），即数据存取层。 该层处理与数据相关的所有事务： 如何存取、如何验证有效性、包含哪些行为以及数据之间的关系等。
T： 代表模板(Template)，即表现层。 该层处理与表现相关的决定： 如何在页面或其他类型文档中进行显示。
V： 代表视图（View），即业务逻辑层。 该层包含存取模型及调取恰当模板的相关逻辑。 你可以把它看作模型与模板之间的桥梁。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/abb181da37a8846218fb84079cfd7dda/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-22T23:33:53+08:00" />
<meta property="article:modified_time" content="2022-06-22T23:33:53+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django学习</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="Django_0"></a>Django学习</h2> 
<h3><a id="26_1"></a>文章共计26个章节</h3> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#Django_0" rel="nofollow">Django学习</a></li><li><ul><li><a href="#26_1" rel="nofollow">文章共计26个章节</a></li></ul> 
  </li><li><a href="#_Django_8" rel="nofollow">第一章 Django介绍和相关术语</a></li><li><a href="#Django_10" rel="nofollow">一、Django介绍</a></li><li><ul><li><a href="#1_12" rel="nofollow">1.简介</a></li><li><a href="#2_14" rel="nofollow">2.安装</a></li><li><a href="#3_25" rel="nofollow">3.文档</a></li></ul> 
  </li><li><a href="#Django_28" rel="nofollow">二、Django相关知识学习</a></li><li><ul><li><a href="#1Django_29" rel="nofollow">1.Django结构</a></li><li><a href="#2_31" rel="nofollow">2.相关术语和规范</a></li></ul> 
  </li><li><a href="#__67" rel="nofollow">第二章 项目搭建</a></li><li><a href="#Django_68" rel="nofollow">一、Django构建项目</a></li><li><ul><li><a href="#1cmd_70" rel="nofollow">1、cmd命令行构建项目</a></li><li><a href="#2pycharm_167" rel="nofollow">2、pycharm构建项目</a></li></ul> 
  </li><li><a href="#_Django_285" rel="nofollow">第三章 Django配置</a></li><li><a href="#django_287" rel="nofollow">一、django配置</a></li><li><ul><li><a href="#1_289" rel="nofollow">1、整体介绍</a></li><li><a href="#2settings_301" rel="nofollow">2、应用settings文件</a></li><li><a href="#3_335" rel="nofollow">3、常用配置项</a></li><li><a href="#4settings_499" rel="nofollow">4、程序中获取settings中的配置项</a></li></ul> 
  </li><li><a href="#_512" rel="nofollow"></a></li><li><a href="#_URLConf_514" rel="nofollow">第四章 URLConf调度器</a></li><li><a href="#URL_515" rel="nofollow">一、URL调度器</a></li><li><ul><li><a href="#1_517" rel="nofollow">1、工作原理</a></li><li><a href="#2_532" rel="nofollow">2、简单示例</a></li><li><a href="#3_562" rel="nofollow">3、路径转换器</a></li><li><a href="#4_572" rel="nofollow">4、自定义路径转换器</a></li><li><a href="#5_616" rel="nofollow">5、使用正则表达式</a></li><li><a href="#6_664" rel="nofollow">6、使用默认值</a></li><li><a href="#7_694" rel="nofollow">7、错误处理</a></li><li><a href="#8URL_731" rel="nofollow">8、引用其他URL调度器</a></li><li><a href="#9_818" rel="nofollow">9、额外的参数</a></li><li><a href="#10URL_833" rel="nofollow">10、URL反向解析</a></li><li><a href="#11_910" rel="nofollow">11、命名空间</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<hr> 
<h2><a id="_Django_8"></a>第一章 Django介绍和相关术语</h2> 
<h2><a id="Django_10"></a>一、Django介绍</h2> 
<h3><a id="1_12"></a>1.简介</h3> 
<p>Django是Python语言中的一个web框架，Python语言中主流的web框架有Django、Tornado、Flask等多种。Django相较与其他web框架，其优势为：大而全，框架本身集成了ORM、模型绑定、模板引擎、缓存、Session等功能，是一个全能型框架，拥有自己的Admin数据管理后台，第三方工具齐全，性能折中。缺点：功能太多，数据分表复杂，高性能扩展复杂。</p> 
<h3><a id="2_14"></a>2.安装</h3> 
<p>1.pip安装：在cmd命令窗口中，输入：</p> 
<pre><code class="prism language-c">pip install django
</code></pre> 
<p>2.pycharm安装：在file&gt;&gt;settings&gt;&gt;project&gt;&gt;project interpreter 中搜索django，进行安装。<br> 3.下载安装包安装：在官网<a href="https://www.djangoproject.com/download/" rel="nofollow">https://www.djangoproject.com/download/</a> ， 下载 django-master.tar，解压后，在解压目录中 运行 cmd（或者在cmd中切换到解压目录），然后通过输入命令：</p> 
<pre><code class="prism language-c">python setup<span class="token punctuation">.</span>py install
</code></pre> 
<h3><a id="3_25"></a>3.文档</h3> 
<p>官方文档的链接在：https://docs.djangoproject.com/en/2.2/，<br> 点击页面右下角的language按钮，可以选择zh-hans，显示中文，只有部分页面有中文翻译，点击页面右下角的Documentation version，可以选择版本。</p> 
<h2><a id="Django_28"></a>二、Django相关知识学习</h2> 
<h3><a id="1Django_29"></a>1.Django结构</h3> 
<p><img src="https://images2.imgbox.com/e8/76/IogApPoj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_31"></a>2.相关术语和规范</h3> 
<p>1.B/S 和C/S<br> Django是用于开发B/S架构的软件的，软件主要分为B/S架构和C/S架构：<br> B/S：全称Browser/Server（浏览器/服务器）<br> C/S：全称Client/Server（客户端/服务器）</p> 
<p>2.MVC<br> MVC全名是Model View Controller，是模型（Model）—视图（View)—控制器（controller)的缩写，一种软件设计典范，用一种业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，不需要重新编写业务逻辑。</p> 
<ul><li>M：管理应用程序的状态（通常存储到数据库中），并约束改变状态的行为，（或者叫做“业务规则”）</li><li>V：负责把数据格式化后呈现给用户</li><li>C：接受外部用户的操作，根据操作访问模型获取数据，并调用视图显示这些数据，控制器是将模型和视图隔离，并成为二者之间的联系纽带。</li></ul> 
<p>3.MTV<br> Django也是一个MVC框架。但是在Django中，控制器接受用户输入的部分由框架自行处理，所以 Django 里更关注的是模型（Model）、模板(Template)和视图（Views），称为 MTV模式：</p> 
<ul><li> <p>M： 代表模型（Model），即数据存取层。 该层处理与数据相关的所有事务： 如何存取、如何验证有效性、包含哪些行为以及数据之间的关系等。</p> </li><li> <p>T： 代表模板(Template)，即表现层。 该层处理与表现相关的决定： 如何在页面或其他类型文档中进行显示。</p> </li><li> <p>V： 代表视图（View），即业务逻辑层。 该层包含存取模型及调取恰当模板的相关逻辑。 你可以把它看作模型与模板之间的桥梁。</p> </li></ul> 
<p>4.ORM<br> ​ 对象关系映射（英语：(Object Relational Mapping，简称ORM，或O/RM，或O/R mapping），是一种程序技术，用于实现面向对象编程语言里不同类型系统的数据之间的转换。从效果上说，它其实是创建了一个可在编程语言里使用的–“虚拟对象数据库”。</p> 
<p>​ ORM方法论基于三个核心原则：</p> 
<ul><li> <p>简单：以最基本的形式建模数据。</p> </li><li> <p>传达性：数据库结构被任何人都能理解的语言文档化。</p> </li><li> <p>精确性：基于数据模型创建正确标准化的结构。</p> </li></ul> 
<p>​ ORM是随着面向对象的软件开发方法发展而产生的。用来把对象模型表示的对象映射到基于SQL 的关系模型数据库结构中去。这样，我们在具体的操作实体对象的时候，就不需要再去和复杂的 SQ L 语句打交道，只需简单的操作实体对象的属性和方法。ORM技术是在对象和关系之间提供了一条桥梁，前台的对象型数据和数据库中的关系型的数据通过这个桥梁来相互转化。</p> 
<h2><a id="__67"></a>第二章 项目搭建</h2> 
<h2><a id="Django_68"></a>一、Django构建项目</h2> 
<h3><a id="1cmd_70"></a>1、cmd命令行构建项目</h3> 
<ol><li> <p>cmd窗口中，切换到指定的项目文件夹，执行：</p> <pre><code>django-admin startproject mysite
</code></pre> <p>其中 mysite 是你的项目名称</p> <p>这时会在指定的项目文件夹中，生成一个 mysite 文件夹，目录结构如下：</p> <pre><code>mysite/
    manage.py
    mysite/
        __init__.py
        settings.py
        urls.py
        wsgi.py
</code></pre> <p>这些目录和文件的说明如下：</p> 
  <ul><li>最外层的mysite/ 根目录是项目的名称</li><li>manage.py 是管理 Django 项目的命令行工具</li><li>里面一层的 mysite/ 目录包含你的项目主应用，它是一个 Python 包</li><li>mysite/_<em>init</em>_.py：一个空文件，告诉 Python 这个目录是一个 Python 包</li><li>mysite/settings.py：项目的配置文件</li><li>mysite/urls.py：项目的 url路由配置</li><li>mysite/wsgi.py：用于你的项目的与WSGI兼容的Web服务器入口，用于项目部署</li></ul> </li><li> <p>cmd窗口中，进入最外层的mysite</p> </li><li> <p>在这个目录下，我们可以输入如下命令，创建一个新的子应用：</p> <pre><code>django-admin startapp first_app
</code></pre> </li><li> <p>在该cmd目录下执行如下命令，可以启动项目：</p> <pre><code>python manage.py runserver
</code></pre> <p>该命令后续可以增加参数，如：</p> <pre><code>python manage.py runserver 8081
python manage.py runserver 127.0.0.1:8082
</code></pre> <p>cmd窗口中会出现如下信息：</p> <pre><code>F:\django_study\first_pro&gt;python manage.py runserver
Watching for file changes with StatReloader
Performing system checks...

System check identified no issues (0 silenced).

You have 17 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.
July 03, 2019 - 16:11:57
Django version 2.2.1, using settings 'first_pro.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.
[03/Jul/2019 16:13:06] "GET / HTTP/1.1" 200 16348
[03/Jul/2019 16:13:06] "GET /static/admin/css/fonts.css HTTP/1.1" 200 423
[03/Jul/2019 16:13:06] "GET /static/admin/fonts/Roboto-Regular-webfont.woff HTTP/1.1" 200 85876
[03/Jul/2019 16:13:06] "GET /static/admin/fonts/Roboto-Light-webfont.woff HTTP/1.1" 200 85692
[03/Jul/2019 16:13:06] "GET /static/admin/fonts/Roboto-Bold-webfont.woff HTTP/1.1" 200 86184
Not Found: /favicon.ico
[03/Jul/2019 16:13:06] "GET /favicon.ico HTTP/1.1" 404 1975
</code></pre> </li><li> <p>在浏览器中访问第4步提示的服务器网址：Starting development server at http://127.0.0.1:8000/ 中的 http://127.0.0.1:8000/ ，会出现如下欢迎页面：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/09/c8/QQ5a9DjA_o.png" alt="在这里插入图片描述"></p> 
<ol start="6"><li> <p>第5步能够打开一个 django 的欢迎页面，是因为第 4 步 中的命令，启动了django自带的一个简易web服务器，它是一个用纯 Python 写的轻量级的 Web 服务器。仅仅用于开发环境，不要在生产环境使用。</p> <p>在这个服务器中，在需要的情况下会对每一次的访问请求重新载入一遍 Python 代码。所以你不需要为了让修改的代码生效而频繁的重新启动服务器。然而，一些动作，比如添加新文件，将不会触发自动重新加载，这时你得自己手动重启服务器。</p> </li></ol> 
<h3><a id="2pycharm_167"></a>2、pycharm构建项目</h3> 
<ol><li>pycharm 中 file &gt;&gt; new project &gt;&gt; django</li></ol> 
<p><img src="https://images2.imgbox.com/13/6d/zKJfcbf4_o.png" alt="在这里插入图片描述"></p> 
<p>PS：只有 pycharm professional版本才可以直接创建django项目</p> 
<ol start="2"><li>location 中，前面路径，选择你自己的项目路径， untitled 项目名改为 firstdjangopycharm 变成如下：</li></ol> 
<p>F:\py_study\firstdjangopycharm</p> 
<ol start="3"><li> <p>project interpreter 点击 左边的 三角形 ，选择一个合适的 解释器</p> </li><li> <p>more settings， 点击 左边的 三角形，设置 applications name，点击 create</p> <p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-BJZpX1wt-1655909267141)(.\imgs\pycharm_first_app.png)]</p> </li><li> <p>查看目录结构如下：</p> </li></ol> 
<p><img src="https://images2.imgbox.com/5f/0b/aixLtfZa_o.png" alt="在这里插入图片描述"></p> 
<p>其中polls子应用下各文件的说明如下：</p> 
<ul><li>migrations ： 执行数据库的迁移操作，就是把 models 中的 model 映射到数据库</li><li>admin ：admin管理界面文件</li><li>apps： 本应用的相关配置文件</li><li>models：数据库的model文件</li><li>tests：测试函数文件</li><li>views：视图文件</li></ul> 
<ol start="6"><li> <p>启动项目</p> <p>1.运行根目录下的manage.py， 第一次会运行失败，因为没有添加参数<br> 2.在pycharm的右上角<br> <img src="https://images2.imgbox.com/1f/2a/mhtkOJeW_o.png" alt="在这里插入图片描述"></p> <p>选择 edit configurations</p> <p>3.在 parameters 中写入 runserver 0.0.0.0:8000</p> </li></ol> 
<p><img src="https://images2.imgbox.com/bc/89/5CUEwlS6_o.png" alt="在这里插入图片描述"></p> 
<pre><code>     4.再次运行 manage.py，控制台显示信息如下：
</code></pre> 
<p><img src="https://images2.imgbox.com/db/ba/SuXAfzry_o.png" alt="在这里插入图片描述"></p> 
<pre><code>     5. 在浏览器中访问： http://127.0.0.1:8000 , 可以看到django的欢迎页面
</code></pre> 
<ol start="7"><li> <p>添加第一个页面</p> 
  <ol><li> <p>修改polls/views.py，增加如下代码：</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse

<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"欢迎学习Django!"</span><span class="token punctuation">)</span>

</code></pre> <p>这是 Django 中最简单的视图。</p> <p>定义了一个index()函数，第一个参数必须是 request，与网页发来的请求有关，request 变量里面包含get或post的内容，用户浏览器，系统等信息在里面（后面会详细讲，先了解一下就可以）。</p> </li><li> <p>在polls目录下新建 urls.py</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> </li><li> <p>修改 主应用下的urls.py（firstdjangopycharm/urls.py）</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'polls/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'polls.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> </li><li> <p>重新启动manage.py</p> </li><li> <p>浏览器中访问：http://127.0.0.1:8000/polls/，浏览器会显示我们在 views 中返回的内容：</p> <pre><code>欢迎学习Django!
</code></pre> </li></ol> </li></ol> 
<h2><a id="_Django_285"></a>第三章 Django配置</h2> 
<h2><a id="django_287"></a>一、django配置</h2> 
<h3><a id="1_289"></a>1、整体介绍</h3> 
<p>django项目创建后，在主应用中，会有一个settings.py文件，这个就是该项目的配置文件</p> 
<ul><li>settings文件包含Django安装的所有配置</li><li>settings文件是一个包含模块级变量的python模块，所以该模块本身必须符合python规则，并且可以使用python的语法</li><li>settings中的所有配置项的key必须全部大写</li><li>settings中每一个配置项都有默认值，默认配置内容在django/conf/global_settings.py中可以查看到，项目中不需要导入该模块，django框架会自动获取</li><li>settings中可以添加自定义的配置项</li></ul> 
<h3><a id="2settings_301"></a>2、应用settings文件</h3> 
<ol><li> <p>manage.py启动</p> <p>默认在manage.py中配置：</p> <pre><code class="prism language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">"DJANGO_SETTINGS_MODULE"</span><span class="token punctuation">,</span> <span class="token string">"firstdjangopycharm.settings"</span><span class="token punctuation">)</span>

</code></pre> </li><li> <p>手动指定配置文件位置</p> <p>cmd命令启动如下：</p> <pre><code>python manage.py runserver 0.0.0.0:8000 --settings=firstdjangopycharm.settings
</code></pre> </li><li> <p>服务器部署启动</p> <p>在wsgi.py中配置：</p> <pre><code class="prism language-python">os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">"DJANGO_SETTINGS_MODULE"</span><span class="token punctuation">,</span> <span class="token string">"firstdjangopycharm.settings"</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h3><a id="3_335"></a>3、常用配置项</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> os


<span class="token triple-quoted-string string">"""
    当前文件所在文件夹的上一级目录的绝对路径
    切记2个 os.path.dirname
"""</span>
BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
    用于加密session，一个随机的字符串
    这样生成：
    from django.core.management import utils
    utils.get_random_secret_key()
"""</span>
SECRET_KEY <span class="token operator">=</span> <span class="token string">'=*f&amp;bx760nyar7@8lb8!w$9h(3ea6p3apl$iua!td1q%-u5r4='</span>

<span class="token comment"># 调试模式，可以看到错误的所有相信信息，部署时一定要修改为False</span>
DEBUG <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token triple-quoted-string string">"""
    允许访问的域名设置
    开发环境不用理会
    运行环境，配置 DEBUG = False后，
    如果允许所有域名访问，则设置 ALLOW_HOSTS = ['*']
    如果指定某些域名可以访问，则设置 ALLOW_HOSTS = ['*.baidu.com']
"""</span>
ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>


<span class="token triple-quoted-string string">"""
    应用的配置，
    如：'polls.apps.PollsConfig'
    如果没有 PollsConfig ，那么可以配置为  'polls'
"""</span>
INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span> <span class="token comment"># 只有 DEBUG = Ture 才有效</span>
    
    <span class="token string">'polls'</span>  <span class="token comment"># 子应用必须配置，否则不起作用</span>
<span class="token punctuation">]</span>

<span class="token triple-quoted-string string">"""
    中间层配置
    自己编写的 中间层 需要配置在最后
    譬如：
    mymidlle.md.TestMiddleware
"""</span>
MIDDLEWARE <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'django.middleware.security.SecurityMiddleware'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="token punctuation">,</span>
    <span class="token string">'django.middleware.common.CommonMiddleware'</span><span class="token punctuation">,</span> <span class="token comment"># 自动给网址最后加/</span>
    <span class="token string">'django.middleware.csrf.CsrfViewMiddleware'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="token punctuation">,</span>
    <span class="token string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span>

<span class="token comment"># 配置基础的urls</span>
ROOT_URLCONF <span class="token operator">=</span> <span class="token string">'firstdjangopycharm.urls'</span>

<span class="token comment"># 配置模板</span>
TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">'BACKEND'</span><span class="token punctuation">:</span> <span class="token string">'django.template.backends.django.DjangoTemplates'</span><span class="token punctuation">,</span>
        <span class="token string">'DIRS'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">,</span>
        <span class="token string">'APP_DIRS'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>
        <span class="token string">'OPTIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token string">'context_processors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token string">'django.template.context_processors.debug'</span><span class="token punctuation">,</span>
                <span class="token string">'django.template.context_processors.request'</span><span class="token punctuation">,</span>
                <span class="token string">'django.contrib.auth.context_processors.auth'</span><span class="token punctuation">,</span>
                <span class="token string">'django.contrib.messages.context_processors.messages'</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 服务器部署的WSGI配置</span>
WSGI_APPLICATION <span class="token operator">=</span> <span class="token string">'firstdjangopycharm.wsgi.application'</span>


<span class="token triple-quoted-string string">"""
    数据库配置
    mysql在python3的使用，需要在 __init__.py 中加入以下代码：
    import pymysql

    pymysql.install_as_MySQLdb()
"""</span>
<span class="token comment"># DATABASES = {<!-- --></span>
<span class="token comment">#     'default': {<!-- --></span>
<span class="token comment">#         'ENGINE': 'django.db.backends.sqlite3',</span>
<span class="token comment">#         'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</span>
<span class="token comment">#     }</span>
<span class="token comment"># }</span>
DATABASES <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'ENGINE'</span><span class="token punctuation">:</span> <span class="token string">'django.db.backends.mysql'</span><span class="token punctuation">,</span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django_test1'</span><span class="token punctuation">,</span>
        <span class="token string">'USER'</span><span class="token punctuation">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
        <span class="token string">'PASSWORD'</span><span class="token punctuation">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span>
        <span class="token string">'HOST'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
        <span class="token string">'PORT'</span><span class="token punctuation">:</span> <span class="token string">'3306'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token triple-quoted-string string">"""
    root用户密码验证
"""</span>
AUTH_PASSWORD_VALIDATORS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.UserAttributeSimilarityValidator'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.MinimumLengthValidator'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.CommonPasswordValidator'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.NumericPasswordValidator'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>


<span class="token comment"># 语言选择 ， zh-Hans 为中文</span>
LANGUAGE_CODE <span class="token operator">=</span> <span class="token string">'en-us'</span>

<span class="token comment"># 时区 Asia/Shanghai 是中国时区</span>
TIME_ZONE <span class="token operator">=</span> <span class="token string">'UTC'</span>

<span class="token comment"># 国际化</span>
USE_I18N <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 本地化</span>
USE_L10N <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># 使用时区，配套TIME_ZONE使用，必须设置为 False</span>
USE_TZ <span class="token operator">=</span> <span class="token boolean">False</span>

<span class="token triple-quoted-string string">"""
    静态文件的路径，默认是 static
    如果在各自项目的static目录以外，还有目录存放静态文件，需要添加如下属性：
    STATICFILES_DIRS = (
        os.path.join(BASE_DIR, "common_static1"),
        '/var/www/static/',
    )
"""</span>
STATIC_URL <span class="token operator">=</span> <span class="token string">'/static/'</span>

</code></pre> 
<h3><a id="4settings_499"></a>4、程序中获取settings中的配置项</h3> 
<p>​ 如果在项目代码中需要获取settings中的配置项，这样获取：</p> 
<pre><code class="prism language-python"><span class="token comment"># 切记不要导入具体的settings模块的路径，会形成高耦合</span>
<span class="token comment"># 这样的方式是不可取的：from mysite import settings</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings

d <span class="token operator">=</span> settings<span class="token punctuation">.</span>DEBUG

</code></pre> 
<h2><a id="_512"></a></h2> 
<h2><a id="_URLConf_514"></a>第四章 URLConf调度器</h2> 
<h2><a id="URL_515"></a>一、URL调度器</h2> 
<h3><a id="1_517"></a>1、工作原理</h3> 
<p>​ django通过urlconf来映射视图函数，只区分路径，不区分http方法</p> 
<ul><li>Django确定要使用的根URLconf模块，一般是在settings中的ROOT_URLCONF设置的值，但是如果传入 HttpRequest 对象具有一个urlconf 属性（由中间件设置），则其值将用于代替 ROOT_URLCONF设置。</li><li>Django加载该URLconf模块并查找变量 urlpatterns，它是一个列表django.urls.path() 和 / 或django.urls.re_path()实例。</li><li>Django按顺序遍历每个URL模式，并停在与请求的URL匹配的第一个URL模式，需要特别注意编写的顺序</li><li>一旦某个URL模式匹配，Django就会导入并调用给定的视图，该视图是一个简单的Python函数（或基于类的视图方法）。该视图通过以下参数传递： 
  <ul><li>一个HttpRequest实例。</li><li>如果匹配的URL模式没有返回任何命名组，则来自正则表达式的匹配作为位置参数提供。</li><li>关键字参数由路径表达式匹配的任何命名部分组成，并由可选的kwargs参数传给 django.urls.path()或django.urls.re_path()。</li></ul> </li><li>如果没有URL模式匹配，或者在此过程中的任何点发生异常，Django将调用适当的错误处理视图</li></ul> 
<h3><a id="2_532"></a>2、简单示例</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/2003/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>special_case_2003<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:year&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:year&gt;/&lt;int:month&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>month_archive<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:year&gt;/&lt;int:month&gt;/&lt;slug:slug&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>article_detail<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> 
<p>笔记：</p> 
<ul><li> <p>从URL中捕获值，请使用尖括号</p> </li><li> <p>捕获的值可以选择包含转换器类型。例如，用于 &lt;int:name&gt;捕获，前面的int指整数参数，name是参数的名称</p> </li><li> <p>没有必要添加一个前导斜杠，因为每个URL都有，例如，使用articles而不是/articles。</p> </li><li> <p>示例请求说明：</p> 
  <ul><li><strong>/articles/2005/03/</strong> 匹配列表中的第三个条目。Django会调用这个函数，views.month_archive(request, year=2005, month=3)</li><li><strong>/articles/2003/</strong> 会匹配列表中的第一个模式，而不是第二个模式，因为模式是按顺序测试的，而第一个模式是第一个要传递的测试。看看利用匹配顺序插入像这样的特殊情况。在这里，Django会调用这个函数 views.special_case_2003(request)</li><li><strong>/articles/2003</strong> 不匹配任何这些模式，因为每种模式都要求URL以斜线结尾，不过在浏览器访问时，会自动添加 / 。</li><li>**/articles/2003/03/building-a-django-site/ **将匹配最终模式。Django会调用这个函数 。views.article_detail(request, year=2003, month=3, slug=“building-a-django-site”)</li></ul> </li></ul> 
<h3><a id="3_562"></a>3、路径转换器</h3> 
<ul><li>str：匹配任何非空字符串，不包括路径分隔符’/'。如果转换器不包含在表达式中，这是默认值。</li><li>int：匹配零或任何正整数。返回一个int。</li><li>slug：匹配由ASCII字母或数字组成的字符串，以及横线和下划线字符。例如， building-your-1st-django_site。</li><li>uuid：匹配格式化的UUID。为防止多个URL映射到同一页面，必须包含破折号，并且字母必须是小写。例如，075194d3-6885-417e-a8a8-6c931e272f00。返回一个 UUID实例。</li><li>path：匹配任何非空字符串，包括路径分隔符 ‘/’，可以匹配完整的URL路径，而不仅仅是URL路径的一部分str，使用时要谨慎，因为可能造成后续的所有url匹配都失效。</li></ul> 
<h3><a id="4_572"></a>4、自定义路径转换器</h3> 
<p>转换器是一个包含以下内容的类：</p> 
<ul><li>一个regex类属性，作为一个re匹配字符串。</li><li>to_python(self, value)方法，它处理匹配的字符串转换成要传递到视图函数的类型。</li><li>to_url(self, value)方法，用于处理将Python类型转换为URL中使用的字符串。</li></ul> 
<p>定义方式如下：</p> 
<ol><li> <p>新建一个converters.py文件，在文件中定义一个FourDigitYearConverter类：</p> <pre><code class="prism language-python"><span class="token keyword">class</span> <span class="token class-name">FourDigitYearConverter</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    regex <span class="token operator">=</span> <span class="token string">'[0-9]{4}'</span>

    <span class="token keyword">def</span> <span class="token function">to_python</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'%04d'</span> <span class="token operator">%</span> value
</code></pre> </li><li> <p>使用register_converter()方法在URLconf中注册自定义转换器类 ：</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> register_converter<span class="token punctuation">,</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> converters<span class="token punctuation">,</span> views

register_converter<span class="token punctuation">(</span>converters<span class="token punctuation">.</span>FourDigitYearConverter<span class="token punctuation">,</span> <span class="token string">'yyyy'</span><span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/2003/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>special_case_2003<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;yyyy:year&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> </li></ol> 
<h3><a id="5_616"></a>5、使用正则表达式</h3> 
<p>​ 使用正则表达式匹配路径，请使用 re_path()而不是path()</p> 
<p>​ 在Python正则表达式中，命名正则表达式组的语法是(?P&lt;name&gt;pattern)，其中name是组的名称，并且 pattern是一些要匹配的模式</p> 
<p>​ 示例：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> re_path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

<span class="token comment"># url() 是 re_path 的别名，不推荐使用</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/2003/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>special_case_2003<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:year&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">)</span><span class="token punctuation">,</span>
    re_path<span class="token punctuation">(</span><span class="token string">r'^articles/(?P&lt;year&gt;[0-9]{4})/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">)</span><span class="token punctuation">,</span>
    re_path<span class="token punctuation">(</span><span class="token string">r'^articles/(?P&lt;year&gt;[0-9]{4})/(?P&lt;month&gt;[0-9]{2})/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>month_archive<span class="token punctuation">)</span><span class="token punctuation">,</span>
    re_path<span class="token punctuation">(</span><span class="token string">r'^articles/(?P&lt;year&gt;[0-9]{4})/(?P&lt;month&gt;[0-9]{2})/(?P&lt;slug&gt;[\w-]+)/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>article_detail<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> 
<p>​ 注意事项：</p> 
<ul><li>匹配的URL会受到一些限制。例如，年份10000将不再匹配，因为年份整数限制为四位数字</li><li>无论正则表达式匹配什么类型，每个捕获的参数都以字符串的形式发送到视图</li><li>除了命名的组语法，例如(?P&lt;year&gt;[0-9]{4})，也可以使用较短的未命名组，例如([0-9]{4})，但是不建议这样使用，会引起未知的匹配</li></ul> 
<p>嵌套参数：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> re_path

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 不推荐, 匹配 blog/page-3/</span>
    re_path<span class="token punctuation">(</span><span class="token string">r'^blog/(page-(\d+)/)?$'</span><span class="token punctuation">,</span> blog_articles<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 推荐 ，匹配：comments/page-2/  路径到 comments(request, page_numer)</span>
    re_path<span class="token punctuation">(</span><span class="token string">r'^comments/(?:page-(?P&lt;page_number&gt;\d+)/)?$'</span><span class="token punctuation">,</span> comments<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> 
<h3><a id="6_664"></a>6、使用默认值</h3> 
<p>​ URLConf中：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># http://127.0.0.1:8000/polls/blog/ 等同于 http://127.0.0.1:8000/polls/blog/1/</span>
    path<span class="token punctuation">(</span><span class="token string">'blog/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>page<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># http://127.0.0.1:8000/polls/blog/1/</span>
    <span class="token comment"># http://127.0.0.1:8000/polls/blog/10/</span>
    <span class="token comment"># http://127.0.0.1:8000/polls/blog/99/</span>
    path<span class="token punctuation">(</span><span class="token string">'blog/&lt;int:num&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>page<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>


</code></pre> 
<p>​ views中：</p> 
<pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">page</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> num<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 编写对应的业务逻辑</span>
</code></pre> 
<h3><a id="7_694"></a>7、错误处理</h3> 
<ul><li>handler400- 状态码400</li><li>handler403- 状态码403</li><li>handler404- 状态码404</li><li>handler500- 状态码500</li></ul> 
<ol><li> <p>在 settings中修改配置：</p> <pre><code class="prism language-python">DEBUG <span class="token operator">=</span> <span class="token boolean">False</span>

ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
</code></pre> </li><li> <p>在主应用的urls中配置：</p> <pre><code class="prism language-python"><span class="token comment"># polls是子应用</span>
handler404 <span class="token operator">=</span> <span class="token string">"polls.views.page_not_found"</span>
</code></pre> </li><li> <p>在polls应用的views中添加函数page_not_found：</p> <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">page_not_found</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'自定义的404错误页面'</span><span class="token punctuation">)</span>
</code></pre> </li></ol> 
<h3><a id="8URL_731"></a>8、引用其他URL调度器</h3> 
<ol><li> <p>多个 patterns</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path

extra_patterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'reports/'</span><span class="token punctuation">,</span> credit_views<span class="token punctuation">.</span>report<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'reports/&lt;int:id&gt;/'</span><span class="token punctuation">,</span> credit_views<span class="token punctuation">.</span>report<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'charge/'</span><span class="token punctuation">,</span> credit_views<span class="token punctuation">.</span>charge<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> main_views<span class="token punctuation">.</span>homepage<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'help/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'apps.help.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'credit/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>extra_patterns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> </li><li> <p>使用include消除重复前缀</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;page_slug&gt;-&lt;page_id&gt;/history/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>history<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;page_slug&gt;-&lt;page_id&gt;/edit/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>edit<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;page_slug&gt;-&lt;page_id&gt;/discuss/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>discuss<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;page_slug&gt;-&lt;page_id&gt;/permissions/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>permissions<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 修改为：</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> include<span class="token punctuation">,</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
        path<span class="token punctuation">(</span><span class="token string">'&lt;page_slug&gt;-&lt;page_id&gt;/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">[</span>
        path<span class="token punctuation">(</span><span class="token string">'history/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>history<span class="token punctuation">)</span><span class="token punctuation">,</span>
        path<span class="token punctuation">(</span><span class="token string">'edit/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>edit<span class="token punctuation">)</span><span class="token punctuation">,</span>
        path<span class="token punctuation">(</span><span class="token string">'discuss/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>discuss<span class="token punctuation">)</span><span class="token punctuation">,</span>
        path<span class="token punctuation">(</span><span class="token string">'permissions/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>permissions<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> </li><li> <p>传递捕获的参数</p> <p>在主urls中配置：</p> <pre><code class="prism language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># 这里捕获username参数，类型为字符串</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;username&gt;/polls/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'polls.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <p>对应的 polls 应用下的urls中配置：</p> <pre><code class="prism language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'arg_test/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>arg_test<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <p>对应的 polls 应用下的views中编写函数：</p> <pre><code class="prism language-python"><span class="token keyword">def</span> <span class="token function">arg_test</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 编写对应的业务逻辑</span>
    <span class="token keyword">pass</span>
</code></pre> </li></ol> 
<h3><a id="9_818"></a>9、额外的参数</h3> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment"># 会传递给 views.year_archive(request, year=2005, foo='bar')</span>
    path<span class="token punctuation">(</span><span class="token string">'blog/&lt;int:year&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token string">'foo'</span><span class="token punctuation">:</span> <span class="token string">'bar'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

</code></pre> 
<h3><a id="10URL_833"></a>10、URL反向解析</h3> 
<p>url调度器除了从用户发起请求，到匹配对应的view，还能在python程序中调用进行匹配，通过 path或re_path 中 的name属性进行解析</p> 
<ul><li>在模板中，使用url模板标签</li><li>在Python代码中（主要是views），使用 reverse() 函数</li><li>在模型实例中，使用 get_absolute_url() 方法</li></ul> 
<p>示例：</p> 
<p>urls中配置：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token comment">#...</span>
    path<span class="token punctuation">(</span><span class="token string">'articles/&lt;int:year&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>year_archive<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'news-year-archive'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">#...</span>
<span class="token punctuation">]</span>
</code></pre> 
<ol><li>在模板中</li></ol> 
<pre><code class="prism language-python"><span class="token comment"># 模板中：</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'news-year-archive' 2012 %}"</span><span class="token operator">&gt;</span><span class="token number">2012</span> Archive<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span><span class="token comment"># Or with the year in a template context variable: #}</span>
<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span><span class="token operator">%</span> <span class="token keyword">for</span> yearvar <span class="token keyword">in</span> year_list <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'news-year-archive' yearvar %}"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> yearvar <span class="token punctuation">}</span><span class="token punctuation">}</span> Archive<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token punctuation">{<!-- --></span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>

</code></pre> 
<ol start="2"><li>在python代码中</li></ol> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> reverse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponseRedirect

<span class="token keyword">def</span> <span class="token function">redirect_to_year</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ...</span>
    year <span class="token operator">=</span> <span class="token number">2006</span>
    <span class="token comment"># ...</span>
    <span class="token keyword">return</span> HttpResponseRedirect<span class="token punctuation">(</span>reverse<span class="token punctuation">(</span><span class="token string">'news-year-archive'</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> 
<ol start="3"><li>在模型中：</li></ol> 
<pre><code class="prism language-python"><span class="token triple-quoted-string string">"""
    在模型中实现方法：
    def get_absolute_url(self):
        from django.urls import reverse
        return reverse('news-year-archive', args=[str(self.id)])

    然后在 模板 中如下使用：
"""</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{<!-- -->{ object.get_absolute_url }}"</span><span class="token operator">&gt;</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> <span class="token builtin">object</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>

</code></pre> 
<h3><a id="11_910"></a>11、命名空间</h3> 
<p>​ 主要用于配合第 10 点 url反向解析 使用，多个不同的urls文件中可能配置同名的 name，那么为了进行区分，给不同的urls进行不同的命名，切记同一个项目下命名空间不能重复！</p> 
<p>​ 通过在 url调度器的模块中，定义 app_name = ‘polls’ 来命名</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views
<span class="token comment"># 定义，一般命名空间和子应用名相同，便于记忆</span>
app_name <span class="token operator">=</span> <span class="token string">'polls'</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>IndexView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;int:pk&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>DetailView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>

<span class="token comment"># 调用，一旦有了命名空间，调用时就必须使用 polls： 前缀</span>
reverse<span class="token punctuation">(</span><span class="token string">'polls:index'</span><span class="token punctuation">,</span> current_app<span class="token operator">=</span>self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>resolver_match<span class="token punctuation">.</span>namespace<span class="token punctuation">)</span>

</code></pre> 
<p>​ 命名空间可以进行嵌套：</p> 
<pre><code class="prism language-python"><span class="token comment"># 在 urls 中配置如下：</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views
<span class="token comment"># 定义命名空间，一般命名空间名和子应用名相同，便于记忆</span>
app_name <span class="token operator">=</span> <span class="token string">'polls'</span>

extra_patterns <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token punctuation">[</span>
        path<span class="token punctuation">(</span><span class="token string">'app_name/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>app_name<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'app_name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment"># 此处就是嵌套的命名空间</span>
    <span class="token string">'extra'</span>
<span class="token punctuation">)</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>IndexView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'&lt;int:pk&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>DetailView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'extra/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>extra_patterns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">]</span>


<span class="token comment"># 在模板中使用：</span>
<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'polls:extra:app_name' %}"</span><span class="token operator">&gt;</span>点击链接<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/029460f5dd773189f276a55cd2a4cb5c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Shamir秘密共享机制（加法、乘法共享）Matlab可视化实现</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a7aa0875fdfe7497578b6874fd23fede/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">行内代码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>