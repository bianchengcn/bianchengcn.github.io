<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>RabbitMQ系列之交换机的使用 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="RabbitMQ系列之交换机的使用" />
<meta property="og:description" content="🎉🎉欢迎来到我的CSDN主页！🎉🎉
🏅我是君易--鑨，一个在CSDN分享笔记的博主。📚📚
🌟推荐给大家我的博客专栏《RabbitMQ系列之交换机的使用》。🎯🎯
🎁如果感觉还不错的话请给我关注加三连吧！🎁🎁
目录
前言
一、交换机的简介
1. 什么是交换机
2. 交换机的作用
3. 交换机的应用场景
4. 图解说明
5.交换机属性
二、 交换机类型讲解
1. 直连交换机（Direct exchange）
1.1 基本概述
1.2 特点
1.3 缺点
2. 主题交换机（Topic exchange）
2.1 基本概述
2.2 特点
2.3 应用场景
3. 扇形交换机（Fanout exchange）
3.1 基本概述
3.2 特点
3.3 应用场景
4. 首部交换机（Headers exchange）
4.1 基本概述
4.2 特点
4.3 应用场景
5. 默认交换机 5.1 基本概述
6. 死信交换机 6.1 基本概述
6.2 图解说明 6.3 案例图解
​编辑
三 、实战演示" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/00c5b3ea6e58ca1271c7bebd153f5dbe/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-25T14:10:54+08:00" />
<meta property="article:modified_time" content="2024-01-25T14:10:54+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">RabbitMQ系列之交换机的使用</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" src="https://images2.imgbox.com/20/97/vTIFP0k6_o.png"></p> 
<blockquote> 
 <p style="text-align:center;"> <strong>🎉🎉欢迎来到我的CSDN主页！🎉🎉</strong></p> 
 <p style="text-align:center;"><strong>🏅我是君易--鑨，一个在CSDN分享笔记的博主。📚📚</strong></p> 
 <p style="text-align:center;"><strong>🌟推荐给大家我的博客专栏《RabbitMQ系列之交换机的使用》。🎯🎯</strong></p> 
 <p style="text-align:center;"><strong>🎁如果感觉还不错的话请给我关注加三连吧！🎁🎁</strong></p> 
</blockquote> 
<p class="img-center"><img alt="" src="https://images2.imgbox.com/30/6b/kb9w23Aa_o.gif"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E7%AE%80%E4%BB%8B" rel="nofollow">一、交换机的简介</a></p> 
<p id="1.%20%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:40px;"><a href="#1.%20%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">1. 什么是交换机</a></p> 
<p id="2.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E4%BD%9C%E7%94%A8-toc" style="margin-left:40px;"><a href="#2.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E4%BD%9C%E7%94%A8" rel="nofollow">2. 交换机的作用</a></p> 
<p id="3.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:40px;"><a href="#3.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow">3. 交换机的应用场景</a></p> 
<p id="%C2%A04.%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E-toc" style="margin-left:40px;"><a href="#%C2%A04.%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E" rel="nofollow"> 4. 图解说明</a></p> 
<p id="%C2%A05.%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B1%9E%E6%80%A7-toc" style="margin-left:40px;"><a href="#%C2%A05.%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B1%9E%E6%80%A7" rel="nofollow"> 5.交换机属性</a></p> 
<p id="%E4%BA%8C%E3%80%81%C2%A0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%B1%BB%E5%9E%8B%E8%AE%B2%E8%A7%A3-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%C2%A0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%B1%BB%E5%9E%8B%E8%AE%B2%E8%A7%A3" rel="nofollow">二、 交换机类型讲解</a></p> 
<p id="1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Direct%20exchange%EF%BC%89-toc" style="margin-left:40px;"><a href="#1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Direct%20exchange%EF%BC%89" rel="nofollow">1. 直连交换机（Direct exchange）</a></p> 
<p id="1.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#1.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">1.1 基本概述</a></p> 
<p id="1.2%20%E7%89%B9%E7%82%B9-toc" style="margin-left:80px;"><a href="#1.2%20%E7%89%B9%E7%82%B9" rel="nofollow">1.2 特点</a></p> 
<p id="1.3%C2%A0%E7%BC%BA%E7%82%B9-toc" style="margin-left:80px;"><a href="#1.3%C2%A0%E7%BC%BA%E7%82%B9" rel="nofollow">1.3 缺点</a></p> 
<p id="2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Topic%20exchange%EF%BC%89-toc" style="margin-left:40px;"><a href="#2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Topic%20exchange%EF%BC%89" rel="nofollow">2. 主题交换机（Topic exchange）</a></p> 
<p id="2.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#2.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">2.1 基本概述</a></p> 
<p id="%C2%A02.2%20%E7%89%B9%E7%82%B9-toc" style="margin-left:80px;"><a href="#%C2%A02.2%20%E7%89%B9%E7%82%B9" rel="nofollow"> 2.2 特点</a></p> 
<p id="%C2%A02.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:80px;"><a href="#%C2%A02.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow"> 2.3 应用场景</a></p> 
<p id="3.%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Fanout%20exchange%EF%BC%89-toc" style="margin-left:40px;"><a href="#3.%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Fanout%20exchange%EF%BC%89" rel="nofollow">3. 扇形交换机（Fanout exchange）</a></p> 
<p id="3.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#3.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">3.1 基本概述</a></p> 
<p id="%C2%A03.2%20%E7%89%B9%E7%82%B9-toc" style="margin-left:80px;"><a href="#%C2%A03.2%20%E7%89%B9%E7%82%B9" rel="nofollow"> 3.2 特点</a></p> 
<p id="%C2%A03.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:80px;"><a href="#%C2%A03.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow"> 3.3 应用场景</a></p> 
<p id="4.%C2%A0%C2%A0%E9%A6%96%E9%83%A8%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Headers%20exchange%EF%BC%89-toc" style="margin-left:40px;"><a href="#4.%C2%A0%C2%A0%E9%A6%96%E9%83%A8%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Headers%20exchange%EF%BC%89" rel="nofollow">4.  首部交换机（Headers exchange）</a></p> 
<p id="4.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#4.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">4.1 基本概述</a></p> 
<p id="4.2%20%E7%89%B9%E7%82%B9-toc" style="margin-left:80px;"><a href="#4.2%20%E7%89%B9%E7%82%B9" rel="nofollow">4.2 特点</a></p> 
<p id="4.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-toc" style="margin-left:80px;"><a href="#4.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" rel="nofollow">4.3 应用场景</a></p> 
<p id="5.%20%E9%BB%98%E8%AE%A4%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0-toc" style="margin-left:40px;"><a href="#5.%20%E9%BB%98%E8%AE%A4%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0" rel="nofollow">5. 默认交换机 </a></p> 
<p id="5.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#5.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">5.1 基本概述</a></p> 
<p id="6.%20%E6%AD%BB%E4%BF%A1%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0-toc" style="margin-left:40px;"><a href="#6.%20%E6%AD%BB%E4%BF%A1%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0" rel="nofollow">6. 死信交换机 </a></p> 
<p id="6.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0-toc" style="margin-left:80px;"><a href="#6.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0" rel="nofollow">6.1 基本概述</a></p> 
<p id="6.2%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%C2%A0-toc" style="margin-left:80px;"><a href="#6.2%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%C2%A0" rel="nofollow">6.2 图解说明 </a></p> 
<p id="6.3%20%E6%A1%88%E4%BE%8B%E5%9B%BE%E8%A7%A3-toc" style="margin-left:80px;"><a href="#6.3%20%E6%A1%88%E4%BE%8B%E5%9B%BE%E8%A7%A3" rel="nofollow">6.3 案例图解</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:80px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">​编辑</a></p> 
<p id="%E4%B8%89%20%E3%80%81%E5%AE%9E%E6%88%98%E6%BC%94%E7%A4%BA-toc" style="margin-left:0px;"><a href="#%E4%B8%89%20%E3%80%81%E5%AE%9E%E6%88%98%E6%BC%94%E7%A4%BA" rel="nofollow">三 、实战演示</a></p> 
<p id="1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:40px;"><a href="#1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">1. 直连交换机</a></p> 
<p id="%E7%94%9F%E4%BA%A7%E8%80%85-toc" style="margin-left:80px;"><a href="#%E7%94%9F%E4%BA%A7%E8%80%85" rel="nofollow">生产者</a></p> 
<p id="1.1%20%E5%88%9B%E5%BB%BA%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:120px;"><a href="#1.1%20%E5%88%9B%E5%BB%BA%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">1.1 创建直连交换机</a></p> 
<p id="1.2%20%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB-toc" style="margin-left:120px;"><a href="#1.2%20%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB" rel="nofollow">1.2 绑定队列及交换机的关系</a></p> 
<p id="1.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><a href="#1.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" rel="nofollow">1.3 编写对应的请求方法</a></p> 
<p id="%E6%B6%88%E8%B4%B9%E8%80%85-toc" style="margin-left:80px;"><a href="#%E6%B6%88%E8%B4%B9%E8%80%85" rel="nofollow">消费者</a></p> 
<p id="%C2%A0ReceiverQ1.java-toc" style="margin-left:120px;"><a href="#%C2%A0ReceiverQ1.java" rel="nofollow"> ReceiverQ1.java</a></p> 
<p id="ReceiverQ2.java-toc" style="margin-left:120px;"><a href="#ReceiverQ2.java" rel="nofollow">ReceiverQ2.java</a></p> 
<p id="%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C-toc" style="margin-left:80px;"><a href="#%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C" rel="nofollow">测试效果</a></p> 
<p id="2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:40px;"><a href="#2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">2. 主题交换机</a></p> 
<p id="%E7%94%9F%E4%BA%A7%E8%80%85-toc" style="margin-left:80px;"><a href="#%E7%94%9F%E4%BA%A7%E8%80%85" rel="nofollow">生产者</a></p> 
<p id="2.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:120px;"><a href="#2.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">2.1 创建主题交换机</a></p> 
<p id="2.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB-toc" style="margin-left:120px;"><a href="#2.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB" rel="nofollow">2.2  绑定队列及交换机的关系</a></p> 
<p id="2.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><a href="#2.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" rel="nofollow">2.3 编写对应的请求方法</a></p> 
<p id="%E6%B5%8B%E8%AF%95-toc" style="margin-left:80px;"><a href="#%E6%B5%8B%E8%AF%95" rel="nofollow">测试</a></p> 
<p id="%E8%BF%9B%E5%85%A5Q1%C2%A0-toc" style="margin-left:120px;"><a href="#%E8%BF%9B%E5%85%A5Q1%C2%A0" rel="nofollow">进入Q1 </a></p> 
<p id="%E8%BF%9B%E5%85%A5Q2-toc" style="margin-left:120px;"><a href="#%E8%BF%9B%E5%85%A5Q2" rel="nofollow">进入Q2</a></p> 
<p id="%C2%A0%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:120px;"><a href="#%C2%A0%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow"> ​编辑</a></p> 
<p id="%E8%BF%9B%E5%85%A5Q1%E3%80%81Q2-toc" style="margin-left:120px;"><a href="#%E8%BF%9B%E5%85%A5Q1%E3%80%81Q2" rel="nofollow">进入Q1、Q2</a></p> 
<p id="3.%C2%A0%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:40px;"><a href="#3.%C2%A0%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">3.  扇形交换机</a></p> 
<p id="3.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA-toc" style="margin-left:80px;"><a href="#3.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA" rel="nofollow">3.1 创建主题交换机</a></p> 
<p id="3.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB-toc" style="margin-left:120px;"><a href="#3.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB" rel="nofollow">3.2  绑定队列及交换机的关系</a></p> 
<p id="3.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95-toc" style="margin-left:120px;"><a href="#3.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95" rel="nofollow">3.3 编写对应的请求方法</a></p> 
<p id="%C2%A0%E6%B5%8B%E8%AF%95-toc" style="margin-left:120px;"><a href="#%C2%A0%E6%B5%8B%E8%AF%95" rel="nofollow"> 测试</a></p> 
<p id="%E6%80%BB%E7%BB%93-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93" rel="nofollow">总结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<blockquote> 
 <p>    <strong>    在上一期的RabbitMQ系列的博客分享中我们对其MQ的概念及使用的场景有了一个初步的认识以及了解，并介绍了几种常见的实现的方式，有RabbitMQ、ActiveMQ、 Amazon Simple Queue Service （SQS）等等。本期博客基于上期博客的代码基础进行讲解RabbitMQ中的交换机的使用。</strong></p> 
</blockquote> 
<h2 id="%E4%B8%80%E3%80%81%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E7%AE%80%E4%BB%8B">一、交换机的简介</h2> 
<h3 id="1.%20%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%A4%E6%8D%A2%E6%9C%BA">1. 什么是交换机</h3> 
<blockquote> 
 <p>        在RabbitMQ中，交换机是一个核心概念，它决定了消息在RabbitMQ中的路由策略，也即决定了消息最终到达哪个队列。交换机是用来发送消息的<strong>AMQP实体</strong>，它拿到一个消息之后将它路由给一个或多个队列。交换机根据其类型和绑定的规则来决定使用哪种路由算法。</p> 
</blockquote> 
<h3 id="2.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E4%BD%9C%E7%94%A8">2. 交换机的作用</h3> 
<blockquote> 
 <p>         交换机在RabbitMQ中扮演着重要的角色，它的作用是：生产者发送消息不会像传统方式直接将消息投递到队列中，而是先将消息投递到交换机中，再由交换机转发到具体的队列，队列再将消息以推送或者拉取方式给消费者进行消费。这样可以根据具体的路由策略将消息分发到不同的队列中。<span style="color:#fe2c24;">（交换机的功能可以通俗地理解为“邮局”，负责传递信息，它通过对信息进行重新生成，并经过内部处理后转发至指定端口，具备自动寻址能力和交换作用。）</span></p> 
 <p><span style="color:#fe2c24;">        </span><span style="color:#0d0016;"><strong>交换机具有以下作用：</strong></span></p> 
 <ol><li>连接设备：交换机负责连接网络设备和终端设备，如交换机、路由器、防火墙、无线AP、计算机、服务器、摄像头、网络打印机等，实现所有设备之间的通信。</li><li>构建局域网络：交换机可以构建局域网络，通过与其他网络设备的互联，如无线接入点、路由器、网络防火墙等，实现局域网与局域网的互联以及局域网与Internet的互联。</li><li>扩展网络范围：交换机可以最大限度地扩展网络的范围，提供不同的网络技术来改善传输的距离，特别是对于传输距离非常远的网络来说非常有用。</li><li>实现端口之间的密切联系：以太网交换机可以让端口之间直接产生密切联系，特别是对于网络需求特别大的企业来说，可以同时提供多个端口，满足多数人的网络需要。</li></ol> 
</blockquote> 
<h3 id="3.%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">3. 交换机的应用场景</h3> 
<blockquote> 
 <p>         这里就以RabbitMQ的交换机为例说一说交换机的一些应用场景有哪些，如下所示。</p> 
</blockquote> 
<table border="1" cellpadding="1" cellspacing="1" style="width:600px;"><caption> 
  <span style="color:#fe2c24;"><strong>RabbitMQ的交换机一般的应用场景</strong></span> 
 </caption><tbody><tr><td style="width:83px;"><strong>应用场景</strong></td><td style="width:515px;"><strong>说明</strong></td></tr><tr><td style="width:83px;">异步处理</td><td style="width:515px;">如果改为了MQ方式，就可以进行异步处理，且短信涉及到的网络情况时间还长，与第三方交互也会有些情况，改用MQ异步处理，就可以支持更多的并发，也可以根据业务的量进行随时扩容。</td></tr><tr><td style="width:83px;">发布订阅模式</td><td style="width:515px;">发布订阅是作为生产者产生的一个消息，他的消费者都可以收到此条消息。在这种模式下，交换机可以将收到的消息发给多套副本队列，消费者如果订阅了这个队列的话，就可以收到生产者的消息了。这种模式中，所有消费者拿到的消息是完全相同的。</td></tr></tbody></table> 
<h3 id="%C2%A04.%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E"> 4. 图解说明</h3> 
<blockquote> 
 <p>        在RabbitMQ中，生产者发送消息不会直接价格消息投递给队列中，而是先将消息投递给交换机中，在由交换机转发到具体的队列，队列再将消息以推送或者拉去的方式给消费者进行消费。</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f4/74/8ygGLFAM_o.png"></p> 
<blockquote> 
 <p>        其中包含两个关键组件：</p> 
 <p><span style="color:#fe2c24;"><strong>路由键：生产者将消息发送给交换机的时候，会指定RoutingKey指定路由的规则。</strong></span></p> 
 <p><span style="color:#fe2c24;"><strong>绑定键：通过绑定键将交换机与队列关联起来，这样RabbitMQ就知道如何正确地将消息路由到队列。</strong></span></p> 
</blockquote> 
<h3 id="%C2%A05.%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B1%9E%E6%80%A7"><strong> 5.<span style="color:#0d0016;">交换机属性</span></strong></h3> 
<table border="1" cellpadding="1" cellspacing="1" style="width:600px;"><caption> 
  <span style="color:#fe2c24;"><strong>交换机属性说明</strong></span> 
 </caption><tbody><tr><td><strong>属性</strong></td><td><strong>说明</strong></td></tr><tr><td>Type </td><td>交换机类型（direct、topic、fanout、headers）</td></tr><tr><td>Durability</td><td>是否需要持久化，如果持久化，则RabbitMQ重启后，交换机还存在。</td></tr><tr><td>Auto Delete</td><td>当最后一个绑定到Exchange上的队列删除后，自动删除该Exchange</td></tr><tr><td>Internal</td><td>当前Exchange是否用于RabbitMQ内部使用，默认false</td></tr><tr><td>Argument</td><td>扩展参数，用于扩展AMQP协议定制化使用</td></tr></tbody></table> 
<p></p> 
<h2 id="%E4%BA%8C%E3%80%81%C2%A0%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%B1%BB%E5%9E%8B%E8%AE%B2%E8%A7%A3">二、 交换机类型讲解</h2> 
<h3 id="1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Direct%20exchange%EF%BC%89">1. 直连交换机（Direct exchange）</h3> 
<h4 id="1.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">1.1 基本概述</h4> 
<blockquote> 
 <p>        直连交换机的路由算法非常简单：将消息推送到binding key与该消息的routing key相同的队列。</p> 
</blockquote> 
<p><strong> 图解</strong></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ad/88/VWn7KKz2_o.png"></p> 
<blockquote> 
 <p>        像上图所示，我们直连交换机的绑定了两个队列。第一个队列绑定了orange,第二个队列绑定了两个绑定键：black和green。在这种场景下，一个消息在发布消息时指定了orange将只能被队列Q1接收， 在发布消息时指定了black和green将只能被队列Q2接收， 其他消息将丢失。</p> 
 <p>        同一个绑定键可以绑定到不同的队列上去，可以增加一个交换机X与队列Q2的绑定键，在这种情况下，直连交换机和广播交换机有着相同的行为，将消息推送到所有的匹配队列上。（如下图）</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/32/35/UMWSt3VV_o.png"></p> 
<h4 id="1.2%20%E7%89%B9%E7%82%B9">1.2 特点</h4> 
<blockquote> 
 <p>直连交换机是交换机的一种类型，它的特点主要包括以下几点</p> 
</blockquote> 
<table border="1" cellpadding="1" cellspacing="1" style="width:600px;"><caption> 
  <span style="color:#fe2c24;"><strong>直连交换机的特点</strong></span> 
 </caption><tbody><tr><td><strong>特点</strong></td><td><strong>说明</strong></td></tr><tr><td><strong>公平调度</strong></td><td>当接收端订阅者有多个时，直连交换机能够轮询公平地分发消息给每个订阅者。</td></tr><tr><td><strong>消息的发后既忘特性</strong></td><td>直连交换机中，接收者不知道消息的来源，如果想要指定消息的发送者，需要在发送内容中包含相关信息。</td></tr><tr><td><strong>消息确认</strong></td><td>直连交换机要求接收者在接收到消息后使用特定的方法（如channel.basicAck()）进行手动确认。如果接收者未进行确认，消息的状态将从“Ready”变为“Unacked”，直到确认或断开连接后才会改变状态。</td></tr><tr><td><strong>消息拒绝</strong></td><td>在未确认之前，接收者可以选择拒绝接收消息，例如通过断开与交换机的连接或使用特定的方法拒绝消息。</td></tr><tr><td><strong>内部交换矩阵和高带宽</strong></td><td>直连交换机具有高带宽的内部交换矩阵和背部总线，可以迅速而直接地将数据包传输到目标节点，避免了不必要的网络资源浪费，提高了效率。</td></tr><tr><td><strong>独立网段和固定带宽</strong></td><td>在同一个时间段内，直连交换机可以将数据传输到多个节点之间，每个节点都可以作为独立网段而独自享有固定的部分带宽，避免了与其他设备的竞争。</td></tr><tr><td><strong>工作于数据链路层</strong></td><td>直连交换机主要工作在OSI模型的物理层和数据链路层，不依赖于三层地址和路由信息。</td></tr><tr><td><strong>绑定多个Routing Key</strong></td><td>如果希望一条消息发送到多个队列，直连交换机需要绑定大量的Routing Key。</td></tr></tbody></table> 
<h4 id="1.3%C2%A0%E7%BC%BA%E7%82%B9">1.3 缺点</h4> 
<blockquote> 
 <p>直连交换机的缺点主要包括以下几点：</p> 
 <ol><li>安全性差：使用一个交换机会使不同网段的设备处于同一广播域内，容易受到攻击和干扰。</li><li>扩展性有限：直连交换机的网络规模和节点数量有限，无法满足大规模网络的需求。</li><li>维护和管理困难：由于直连交换机需要手动配置和管理，对于大规模的网络来说，管理和维护成本较高。</li><li>带宽和资源利用率低：直连交换机无法实现动态带宽分配和负载均衡，容易造成资源浪费和带宽瓶颈。</li><li>无法支持大规模并发连接：直连交换机的并发连接数有限，无法满足大规模并发的需求。</li></ol> 
</blockquote> 
<h3 id="2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Topic%20exchange%EF%BC%89">2. 主题交换机（Topic exchange）</h3> 
<h4 id="2.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">2.1 基本概述</h4> 
<blockquote> 
 <p>         主题交换机（Topic Exchange）是一种消息队列的交换机类型，它通过对消息的路由键和队列到交换机的绑定模式之间的匹配，将消息路由给一个或多个队列。主题交换机经常用来实现各种发布/订阅模式及其变种，通常用来实现消息的多播路由。</p> 
</blockquote> 
<p style="text-align:center;"> <img alt="" height="121" src="https://images2.imgbox.com/9a/5e/7Ocb8qw8_o.png" width="684"></p> 
<table border="1" cellpadding="1" cellspacing="1" style="width:600px;"><caption> 
  <span style="color:#fe2c24;"><strong>实例模拟</strong></span> 
 </caption><tbody><tr><td><strong>发送消息绑定的routing key</strong></td><td><strong>接受消息的队列 queue</strong></td></tr><tr><td>quick.orange.rabbit</td><td>Q1,Q2</td></tr><tr><td>lazy.orange.elephant</td><td>Q1,Q2</td></tr><tr><td>quick.orange.fox</td><td>Q1</td></tr><tr><td>lazy.brown.fox</td><td>Q2</td></tr><tr><td>lazy.pink.rabbit</td><td>Q2</td></tr><tr><td>quick.brown.fox</td><td>没有队列接收</td></tr></tbody></table> 
<h4 id="%C2%A02.2%20%E7%89%B9%E7%82%B9"> 2.2 特点</h4> 
<blockquote> 
 <p>主题交换机的特点是：</p> 
</blockquote> 
<table border="1" cellpadding="1" cellspacing="1" style="width:600px;"><caption> 
  <span style="color:#fe2c24;"><strong>主题交换机的特点</strong></span> 
 </caption><tbody><tr><td style="width:66px;"><strong>特点</strong></td><td style="width:531px;"><strong>说明</strong></td></tr><tr><td style="width:66px;">模糊匹配</td><td style="width:531px;">主题交换机支持模糊匹配，可以使用星号（*）和井号（#）作为通配符进行匹配。其中，* 可以代替一个单词，# 可以代替任意个单词。</td></tr><tr><td style="width:66px;">队列绑定</td><td style="width:531px;">主题交换机通过队列绑定来实现消息的路由，可以将一个或多个队列绑定到交换机上，并根据匹配规则将消息路由到相应的队列中。</td></tr><tr><td style="width:66px;">多播路由</td><td style="width:531px;">主题交换机可以实现消息的多播路由，即将一条消息发送给多个队列，满足发布/订阅模式的需求。</td></tr></tbody></table> 
<h4 id="%C2%A02.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"> 2.3 应用场景</h4> 
<blockquote> 
 <p>主题交换机的应用场景包括：</p> 
 <ol><li>发布/订阅模式：主题交换机适用于实现发布/订阅模式及其变种，例如在新闻网站、博客平台等场景中，发布者发布一条消息后，订阅者可以接收到该消息。</li><li>消息分发：主题交换机可以将一条消息同时发送给多个队列，实现消息的分发和多播路由，适用于需要将消息同时发送给多个消费者的场景，例如日志收集、监控系统等。</li><li>异步处理：主题交换机可以将消息异步地发送给消费者处理，提高系统的并发性能和吞吐量，适用于需要进行大量异步处理的场景，例如在线游戏、社交网络等。</li></ol> 
</blockquote> 
<blockquote> 
 <p><span style="color:#fe2c24;"><strong>         需要注意的是，主题交换机在不同的消息队列系统中可能具有不同的实现方式和特点。在实际应用中，需要根据具体的需求和场景选择适合的消息队列系统和主题交换机类型。</strong></span></p> 
</blockquote> 
<h3 id="3.%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Fanout%20exchange%EF%BC%89">3. 扇形交换机（Fanout exchange）</h3> 
<h4 id="3.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">3.1 基本概述</h4> 
<blockquote> 
 <p>        扇形交换机是最基本的交换机类型，它的作用是广播消息。扇形交换机会把能接收到的消息全部发送给绑定在自己身上的队列。因为广播不需要思考，所以扇形交换机处理消息的速度也是所有交换机类型里面最快的。</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ee/09/IHd9itOE_o.png"></p> 
<h4 id="%C2%A03.2%20%E7%89%B9%E7%82%B9"> 3.2 特点</h4> 
<blockquote> 
 <p>扇形交换机具有以下特点：</p> 
 <ol><li><strong>广播消息</strong>：扇形交换机能够将接收到的消息广播给所有绑定在其上的队列。</li><li><strong>速度快</strong>：由于广播不需要“思考”，所以扇形交换机处理消息的速度非常快，是所有交换机类型中速度最快的。</li></ol> 
</blockquote> 
<h4 id="%C2%A03.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"> 3.3 应用场景</h4> 
<blockquote> 
 <p>扇形交换机通常用于以下应用场景：</p> 
 <ol><li>大规模多用户在线（MMO）游戏：这种场景中，可能需要对排行榜更新等全局事件进行大规模广播，使用扇形交换机可以将消息广播给所有消费者，确保所有用户都能收到相同的消息。</li><li>体育新闻网站：体育新闻网站需要近乎实时地将比分更新分发给移动客户端。使用扇形交换机可以将比分更新广播给所有订阅的移动客户端，确保所有用户都能接收到最新的比分信息。</li><li>分发系统：在分发系统，如群聊中，扇形交换机被用来分发消息给参与群聊的用户。</li></ol> 
</blockquote> 
<h3 id="4.%C2%A0%C2%A0%E9%A6%96%E9%83%A8%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88Headers%20exchange%EF%BC%89">4.  首部交换机（Headers exchange）</h3> 
<h4 id="4.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">4.1 基本概述</h4> 
<blockquote> 
 <p>        首部交换机是一种特殊的交换机类型，它不依赖于路由键的匹配规则来路由消息，而是根据发送的消息内容中的headers属性进行匹配。在绑定队列和交换器时，可以制定一组键值对。当发送消息到交换器时，RabbitMQ会获取到该消息的headers（也是一个键值对的形式），并对比其中的键值对是否完全匹配队列和交换器绑定时指定的键值对。如果完全匹配，则消息会路由到该队列，否则不会路由到该队列。</p> 
</blockquote> 
<h4 id="4.2%20%E7%89%B9%E7%82%B9">4.2 特点</h4> 
<blockquote> 
 <p>首部交换机的特点主要包括以下几点：</p> 
 <ol><li>基于headers属性匹配：首部交换机根据发送的消息内容中的headers属性进行匹配，而不是依赖于路由键的匹配规则。</li><li>性能较差：由于需要对比消息的headers属性与队列和交换器绑定时指定的键值对，因此首部交换机的性能会比较差，且不实用。</li><li>无法看到实际应用：在实际应用中，很少看到首部交换机的存在。</li></ol> 
</blockquote> 
<h4 id="4.3%20%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF">4.3 应用场景</h4> 
<blockquote> 
 <p><span style="color:#fe2c24;">         首部交换机的应用场景较少，主要是用于某些特殊场景，例如企业网络、商务大厦网络、酒店宽带网络等。在这些场景中，可能需要实现数据的传输和交换，并且需要支持带宽控制、流量管理、VLAN等功能。但是，由于首部交换机的性能较差，且不实用，因此在实际应用中并不常见。</span></p> 
</blockquote> 
<h3 id="5.%20%E9%BB%98%E8%AE%A4%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0">5. 默认交换机 </h3> 
<h4 id="5.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">5.1 基本概述</h4> 
<blockquote> 
 <p>        默认交换机（default exchange）实际上是一个由消息代理预先声明好的没有名字（名字为空字符串）的直连交换机（direct exchange）。它有一个特殊的属性使得它对于简单应用特别有用处，那就是每个新建队列（queue）都会自动绑定到默认交换机上，绑定的路由键（routing key）名称与队列名称相同。</p> 
 <p>        举个例子，当你声明了一个名为"search-indexing-online"的队列，AMQP代理会自动将其绑定到默认交换机上，绑定（binding）的路由键名称也是为"search-indexing-online"。换句话说，默认交换机看起来貌似能够直接将消息投递给队列，尽管技术上并没有做相关的操作。</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/10/43/5SObEMxG_o.png"></p> 
<h3 id="6.%20%E6%AD%BB%E4%BF%A1%E4%BA%A4%E6%8D%A2%E6%9C%BA%C2%A0">6. 死信交换机 </h3> 
<h4 id="6.1%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0">6.1 基本概述</h4> 
<blockquote> 
 <p>        死信交换机是一种特殊的交换机，用于接收和路由成为死信的消息。当消息成为死信后，会被发送到死信交换机，并通过该交换机的路由规则，将消息路由到指定的死信队列中进行处理。</p> 
</blockquote> 
<blockquote> 
 <p>当队列中的消息满足以下情况之一时，可以成为死信：</p> 
 <ol><li>消费者使用basic.reject或basic.nack声明消费失败，并且消息的requeue参数设置成了false。</li><li>消息是一个过期消息，超时无人消费。</li><li>要投递的队列消息满了，最新进来的消息变成死信。</li></ol> 
 <p>        如果这个包含死信的队列配置了dead-letter-exchange属性，指定了一个交换机，那么队列中的死信就会投递到交换机中，而这个交换机就被称为死信交换机（Dead Letter Exchange）。</p> 
 <p>        死信交换机可以用于收集所有消费者处理失败的消息（死信），交由人工处理，进一步提高消息队列的可靠性</p> 
</blockquote> 
<h4 id="6.2%20%E5%9B%BE%E8%A7%A3%E8%AF%B4%E6%98%8E%C2%A0">6.2 图解说明 </h4> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b3/e9/qpomo5IH_o.png"></p> 
<h4 id="6.3%20%E6%A1%88%E4%BE%8B%E5%9B%BE%E8%A7%A3">6.3 案例图解</h4> 
<h4 id="%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4e/8b/U77MhgJV_o.png"></h4> 
<h2 id="%E4%B8%89%20%E3%80%81%E5%AE%9E%E6%88%98%E6%BC%94%E7%A4%BA">三 、实战演示</h2> 
<blockquote> 
 <p>        我们先创建两个队列用于我们实现对应的效果演示。</p> 
</blockquote> 
<pre><code class="language-java">  @Bean
//                声明第一个队列  。
        public Queue queue01(){
            return new Queue("queue01");
        }
        @Bean
//        声明第二个队列
        public Queue queue02(){
        return new Queue("queue02");
    }
</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/01/e2/mUCoB4sp_o.png"></p> 
<h3 id="1.%20%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA">1. 直连交换机</h3> 
<h4 id="%E7%94%9F%E4%BA%A7%E8%80%85">生产者</h4> 
<h5 id="1.1%20%E5%88%9B%E5%BB%BA%E7%9B%B4%E8%BF%9E%E4%BA%A4%E6%8D%A2%E6%9C%BA">1.1 创建直连交换机</h5> 
<pre><code class="language-java">//    创建直连交换机
    @Bean
//    创建交换机
    public DirectExchange directExchange(){
    return new DirectExchange("exchange01");
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/4e/80/tgcXSq0i_o.png"></p> 
<h5 id="1.2%20%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB">1.2 绑定队列及交换机的关系</h5> 
<pre><code class="language-java">  @Bean
//    绑定队列和交换机
    public Binding binding01(){
    return BindingBuilder
            .bind(queue01())
            .to(directExchange())
            .with("yx");
    }

    @Bean
//    绑定队列和交换机
    public Binding binding02(){
        return BindingBuilder
                .bind(queue02())
                .to(directExchange())
                .with("zxy");
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/93/76/DtpvOLOq_o.png"></p> 
<h5 id="1.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95">1.3 编写对应的请求方法</h5> 
<blockquote> 
 <p>        我们在controller类中编写对应的请求方法</p> 
</blockquote> 
<pre><code class="language-java"> @RequestMapping("/send3")
    public String send3() {
//    向交换机发送消息
        amqpTemplate.convertAndSend("directExchange","yx","木易");
        return "木易";
    }

    @RequestMapping("/send4")
    public String send4() {
//    向交换机发送消息
        amqpTemplate.convertAndSend("directExchange","zxy","馨月");
        return "木易";
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/a4/93/PgK4eulb_o.png"></p> 
<h4 id="%E6%B6%88%E8%B4%B9%E8%80%85">消费者</h4> 
<blockquote> 
 <p>        我们在消费者这边编写独有的代码进行接受生成者发送的请求信息。</p> 
</blockquote> 
<h5 id="%C2%A0ReceiverQ1.java"> ReceiverQ1.java</h5> 
<pre><code class="language-java">package com.yx.consumer;

import lombok.extern.slf4j.Slf4j;
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

@Component
@SuppressWarnings("all")
@Slf4j
@RabbitListener(queues = "queue01") //接收的队列
public class ReceiverQ1 {
@RabbitHandler
public void process(String msg) {
log.warn("queue01接收到:" + msg);
}
}</code></pre> 
<h5 id="ReceiverQ2.java">ReceiverQ2.java</h5> 
<pre><code class="language-java">package com.yx.consumer;

import lombok.extern.slf4j.Slf4j;
import org.springframework.amqp.rabbit.annotation.RabbitHandler;
import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

@Component
@SuppressWarnings("all")
@Slf4j
@RabbitListener(queues = "queue02") //接收的队列
public class ReceiverQ2 {
@RabbitHandler
public void process(String msg) {
log.warn("queue02接收到:" + msg);
}
}</code></pre> 
<h4 id="%E6%B5%8B%E8%AF%95%E6%95%88%E6%9E%9C">测试效果</h4> 
<blockquote> 
 <p>        我们在测试之前要先说名，我们应该先启动我们的生产者并且访问我们的请求方法使其RabbitMQ管理器生成对应的队列或者前往官网管理器手动添加对应的队列，否则我们启动消费者或者启动消费者，消费者的服务端控制台回报错。</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/32/29/hAmEKjLQ_o.png"></p> 
<blockquote> 
 <p>        因此我们先启动生成者访问对应的接口方法生成对应的队列。 </p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/6b/05/bCzfuW7p_o.gif"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/72/72/EdAwShWW_o.png"></p> 
<blockquote> 
 <p>        我们启动消费者服务进行接受信息 </p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/e6/9f/9ELk2Ugm_o.gif"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/43/1b/RgX1U2Ly_o.png"></p> 
<h3 id="2.%20%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA">2. 主题交换机</h3> 
<blockquote> 
 <p>// 规则 :</p> 
 <p>// *.*.yx-&gt;Q1</p> 
 <p>// *.*.zxy-&gt;Q2</p> 
 <p>// mq.# --Q1,Q2</p> 
</blockquote> 
<h4>生产者</h4> 
<h5 id="2.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA">2.1 创建主题交换机</h5> 
<pre><code class="language-java">//  创建主题交换机
    @Bean
    public TopicExchange topicExchange(){
        return new TopicExchange("topicExchange");
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/96/82/GhzKZNc1_o.png"></p> 
<h5 id="2.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB">2.2  绑定队列及交换机的关系</h5> 
<pre><code class="language-java">//    绑定主题交换机  queue01
    @Bean
    public Binding binding03(){
    return BindingBuilder
            .bind(queue01())
            .to(topicExchange())
            .with("*.*.yx");
    }

//    绑定主题交换机  queue02
    @Bean
    public Binding binding04(){
        return BindingBuilder
                .bind(queue01())
                .to(topicExchange())
                .with("*.*.zxy");
    }

//    绑定主题交换机 queue01和queue02
    @Bean
    public Binding binding05(){
        return BindingBuilder
                .bind(queue01())
                .to(topicExchange())
                .with("mq.#");
    }
    @Bean
    public Binding binding06(){
        return BindingBuilder
                .bind(queue02())
                .to(topicExchange())
                .with("mq.#");
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/f6/11/5AIU2MR6_o.png"></p> 
<h5 id="2.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95">2.3 编写对应的请求方法</h5> 
<blockquote> 
 <p>        我们在controller类中编写对应的请求方法,我们使用参数的大大提高我们的测试灵活度</p> 
</blockquote> 
<pre><code class="language-java"> @RequestMapping("/send5")
    public String send5(String rex) {
//    向交换机发送消息
        amqpTemplate.convertAndSend("topicExchange",rex,"木易与馨月");
        return "木易与馨月";
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/08/4a/HlAbmgZf_o.png"></p> 
<blockquote> 
 <p>         我们消费者因为在测试直连交换机是已经配置好了队列，因此不用重复设置直接测试。</p> 
</blockquote> 
<h4 id="%E6%B5%8B%E8%AF%95">测试</h4> 
<blockquote> 
 <p>         我们重新启动我们的生产者不用重新启动消费者，我们测试对应的接口方法。</p> 
</blockquote> 
<h5 id="%E8%BF%9B%E5%85%A5Q1%C2%A0">进入Q1 </h5> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/5d/23/mPfCXrNt_o.gif"></p> 
<p style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/50/6b/swhKcD6j_o.png"></p> 
<h5 id="%E8%BF%9B%E5%85%A5Q2">进入Q2</h5> 
<h5 id="%C2%A0%E2%80%8B%E7%BC%96%E8%BE%91" style="text-align:center;"> <img alt="" src="https://images2.imgbox.com/22/37/cK5tMTKJ_o.png"></h5> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/ce/56/f49GfvGK_o.png"></p> 
<h5 id="%E8%BF%9B%E5%85%A5Q1%E3%80%81Q2">进入Q1、Q2</h5> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/00/02/x6aPTKQ3_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/1b/ca/YSJj4zc7_o.png"></p> 
<h3 id="3.%C2%A0%20%E6%89%87%E5%BD%A2%E4%BA%A4%E6%8D%A2%E6%9C%BA">3.  扇形交换机</h3> 
<h4 id="3.1%20%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98%E4%BA%A4%E6%8D%A2%E6%9C%BA">3.1 创建主题交换机</h4> 
<pre><code class="language-java">//        创建fanout交换机
    @Bean
    public FanoutExchange fanoutExchange(){
    return new FanoutExchange("fanoutExchange");
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/28/32/Twi4MVTH_o.png"></p> 
<h5 id="3.2%C2%A0%C2%A0%E7%BB%91%E5%AE%9A%E9%98%9F%E5%88%97%E5%8F%8A%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%85%B3%E7%B3%BB">3.2  绑定队列及交换机的关系</h5> 
<pre><code class="language-java">//   绑定队列与交换机的关系
    @Bean
    public Binding binding07(){
        return BindingBuilder
                .bind(queue01())
                .to(fanoutExchange());
    }
    @Bean
    public Binding binding08(){
        return BindingBuilder
                .bind(queue02())
                .to(fanoutExchange());
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/cd/0d/ncKHDAaS_o.png"></p> 
<h5 id="3.3%20%E7%BC%96%E5%86%99%E5%AF%B9%E5%BA%94%E7%9A%84%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95">3.3 编写对应的请求方法</h5> 
<p>        我们在controller类中写对应的w请求方法。</p> 
<pre><code class="language-java"> @RequestMapping("/send6")
    public String send6() {
//    向交换机发送消息
        amqpTemplate.convertAndSend("fanoutExchange","","木易Love馨月");
        return "木易Love馨月";
    }</code></pre> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b7/45/11co8wVN_o.png"></p> 
<h5 id="%C2%A0%E6%B5%8B%E8%AF%95"> 测试</h5> 
<blockquote> 
 <p>        我们重新启动我们的生产者，在我们的网页上去访问对应的接口方法。</p> 
</blockquote> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/dd/f8/hfxNJXWM_o.png"></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/1e/d3/pFDx32aw_o.png"></p> 
<h2 id="%E6%80%BB%E7%BB%93">总结</h2> 
<blockquote> 
 <p>         我们今天的这期的博客分享中我们学习到了一些有关交换机的类型及其他们的基础使用，不同的交换机类型各自有着不同的特点及优点对应的应用场景也不同，我们在项目根据自身的需求情况采用对应的类型进行使用从此到达效果。我们下期博客主讲如何使用我们的死信交换机。</p> 
</blockquote> 
<hr> 
<blockquote> 
 <p style="text-align:center;"><strong>🎉🎉本期的博客分享到此结束🎉🎉</strong></p> 
 <p style="text-align:center;"><strong>📚📚各位老铁慢慢消化📚📚</strong></p> 
 <p style="text-align:center;"><strong>🎯🎯下期博客博主会带来新货🎯🎯</strong></p> 
 <p style="text-align:center;"><strong>🎁三连加关注，阅读不迷路 ！🎁</strong></p> 
</blockquote> 
<p><img alt="" src="https://images2.imgbox.com/94/ea/DwJ6tSU6_o.gif"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b2b1f20ae5e56a783a60e76e572db3ae/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">el-form动态检验无法生效问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/545884e9694426a10c42de2fd22d45c8/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL Server 安装程序无法通过 Windows Update 服务搜索更新。</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>