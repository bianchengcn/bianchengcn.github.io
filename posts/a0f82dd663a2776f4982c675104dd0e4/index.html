<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>接口自动化测试之预期结果的处理 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="接口自动化测试之预期结果的处理" />
<meta property="og:description" content="在做接口自动化测试时，我们需将测试用例的预期结果与实际结果进行对比，如果一致就认定测试用例通过，不一致就认定失败。而后端接口返回的数据一般是以json的方式返回到前端，那么用jsonpath来做预期结果的处理就很适合了，尤其是对于复杂的json串，jsonpath的优势更明显。
Jsonpath：看它的名字你就能知道，这家伙和JSON文档有关系，正如XPath之于XML文档一样，JsonPath为Json文档提供了解析能力，通过使用JsonPath，你可以方便的查找节点、获取想要的数据，JsonPath是Json版的XPath。
JsonPath语法要点：
$ 表示文档的根元素
@ 表示文档的当前元素
.node_name 或 [&#39;node_name&#39;] 匹配下级节点
[index] 检索数组中的元素
[start:end:step] 支持数组切片语法
* 作为通配符，匹配所有成员
.. 子递归通配符，匹配成员的所有子元素
(&lt;expr&gt;) 使用表达式
?(&lt;boolean expr&gt;)进行数据筛选
下面分别用Java与Python实现以Jsonpath的方式处理预期结果
# java代码
import com.alibaba.fastjson.JSONPath;
import org.junit.jupiter.api.Test;
import java.util.HashMap;
import java.util.Map;
public class JSONPathUtil {
public static Boolean checkPoint(String response, String checkData) throws Exception {
//分隔检查点
String[] data = checkData.split(&#34;;&#34;);
//设置标记
Boolean flag = false;
Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
for (int i = 0; i &lt; data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a0f82dd663a2776f4982c675104dd0e4/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-01T15:40:40+08:00" />
<meta property="article:modified_time" content="2024-02-01T15:40:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">接口自动化测试之预期结果的处理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在做接口自动化测试时，我们需将测试用例的预期结果与实际结果进行对比，如果一致就认定测试用例通过，不一致就认定失败。而后端接口返回的数据一般是以json的方式返回到前端，那么用jsonpath来做预期结果的处理就很适合了，尤其是对于复杂的json串，jsonpath的优势更明显。</p> 
<p>Jsonpath：看它的名字你就能知道，这家伙和JSON文档有关系，正如XPath之于XML文档一样，JsonPath为Json文档提供了解析能力，通过使用JsonPath，你可以方便的查找节点、获取想要的数据，JsonPath是Json版的XPath。</p> 
<p><a href="https://so.csdn.net/so/search?q=JsonPath%E8%AF%AD%E6%B3%95&amp;spm=1001.2101.3001.7020" title="JsonPath语法">JsonPath语法</a>要点：</p> 
<ul><li> <p>$ 表示文档的根元素</p> </li><li> <p>@ 表示文档的当前元素</p> </li><li> <p>.node_name 或 ['node_name'] 匹配下级节点</p> </li><li> <p>[index] 检索数组中的元素</p> </li><li> <p>[start:end:step] 支持数组切片语法</p> </li><li> <p>* 作为通配符，匹配所有成员</p> </li><li> <p>.. 子递归通配符，匹配成员的所有子元素</p> </li><li> <p>(&lt;expr&gt;) 使用表达式</p> </li><li> <p>?(&lt;boolean expr&gt;)进行数据筛选</p> </li></ul> 
<p>下面分别用Java与Python实现以Jsonpath的方式处理预期结果</p> 
<ol><li><li> <p><code># java代码</code></p> </li><li><li> <p><code>import com.alibaba.fastjson.JSONPath;</code></p> </li><li> <p><code>import org.junit.jupiter.api.Test;</code></p> </li><li> <p><code>import java.util.HashMap;</code></p> </li><li> <p><code>import java.util.Map;</code></p> </li><li><li> <p><code>public class JSONPathUtil {<!-- --></code></p> </li><li><li> <p><code>public static Boolean checkPoint(String response, String checkData) throws Exception {<!-- --></code></p> </li><li> <p><code>//分隔检查点</code></p> </li><li> <p><code>String[] data = checkData.split(";");</code></p> </li><li> <p><code>//设置标记</code></p> </li><li> <p><code>Boolean flag = false;</code></p> </li><li><li> <p><code>Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</code></p> </li><li> <p><code>for (int i = 0; i &lt; data.length; i++) {<!-- --></code></p> </li><li> <p><code>map.put(data[i].split("=")[0], data[i].split("=")[1]);</code></p> </li><li> <p><code>System.out.println("检查点" + (i + 1) + "实际结果：" + JSONPath.read(response, data[i].split("=")[0]));</code></p> </li><li> <p><code>System.out.println("检查点" + (i + 1) + "预期结果：" + map.get(data[i].split("=")[0]));</code></p> </li><li> <p><code>if (JSONPath.read(response, data[i].split("=")[0]) instanceof String) {<!-- --></code></p> </li><li> <p><code>if (JSONPath.read(response, data[i].split("=")[0]).equals(map.get(data[i].split("=")[0]))) {<!-- --></code></p> </li><li> <p><code>flag = true;</code></p> </li><li> <p><code>} else {<!-- --></code></p> </li><li> <p><code>flag = false;</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>} else {<!-- --></code></p> </li><li> <p><code>if ((JSONPath.read(response, data[i].split("=")[0]).toString()).equals(map.get(data[i].split("=")[0]))) {<!-- --></code></p> </li><li> <p><code>flag = true;</code></p> </li><li> <p><code>} else {<!-- --></code></p> </li><li> <p><code>flag = false;</code></p> </li><li> <p><code>break;</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>return flag;</code></p> </li><li> <p><code>}</code></p> </li><li><li> <p><code>@Test</code></p> </li><li> <p><code>public void testCheckPoint() {<!-- --></code></p> </li><li> <p><code>String json = "{\"store\":{\"book\":[{\"title\":\"高效Java\",\"price\":10.0},{\"title\":\"设计模式\",\"price\":12.21},{\"title\":\"重构\",\"isbn\":\"553\",\"price\":8},{\"title\":\"虚拟机\",\"isbn\":\"395\",\"price\":22}],\"bicycle\":{\"color\":\"red\",\"price\":19}}}";</code></p> </li><li> <p><code>String params = "$.store.book[0].price=10.0;$.store.book[1].title=设计模式";</code></p> </li><li> <p><code>Boolean flag = null;</code></p> </li><li> <p><code>try {<!-- --></code></p> </li><li> <p><code>flag = checkPoint(json, params);</code></p> </li><li> <p><code>} catch (Exception e) {<!-- --></code></p> </li><li> <p><code>e.printStackTrace();</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>if (flag) {<!-- --></code></p> </li><li> <p><code>System.out.println("测试执行结果：成功");</code></p> </li><li> <p><code>} else {<!-- --></code></p> </li><li> <p><code>System.out.println("测试执行结果：失败");</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li><li> <p><code>}</code></p> </li></ol> 
<p>下面是python代码</p> 
<pre></pre> 
<ol><li><li> <p><code>import jsonpath</code></p> </li><li><li><li> <p><code>def get_instance(value, check):</code></p> </li><li> <p><code>flag = None</code></p> </li><li> <p><code>if isinstance(value, str):</code></p> </li><li> <p><code>if check == value:</code></p> </li><li> <p><code>flag = True</code></p> </li><li> <p><code>else:</code></p> </li><li> <p><code>flag = False</code></p> </li><li> <p><code>elif isinstance(value, float):</code></p> </li><li> <p><code>if value - float(check) == 0:</code></p> </li><li> <p><code>flag = True</code></p> </li><li> <p><code>else:</code></p> </li><li> <p><code>flag = False</code></p> </li><li> <p><code>elif isinstance(value, int):</code></p> </li><li> <p><code>if value - int(check) == 0:</code></p> </li><li> <p><code>flag = True</code></p> </li><li> <p><code>else:</code></p> </li><li> <p><code>flag = False</code></p> </li><li> <p><code>return flag</code></p> </li><li><li><li> <p><code>def check(response, checkPoint):</code></p> </li><li> <p><code>c = checkPoint.split(";")</code></p> </li><li> <p><code>flag = None</code></p> </li><li> <p><code>for i in range(0, len(c)):</code></p> </li><li> <p><code>checkPoint_dict = {}</code></p> </li><li> <p><code>checkPoint_dict[c[i].split("=")[0]] = c[i].split("=")[1]</code></p> </li><li> <p><code>list = jsonpath.jsonpath(response, c[i].split("=")[0])</code></p> </li><li> <p><code>value = list[0]</code></p> </li><li> <p><code>check = checkPoint_dict[c[i].split("=")[0]]</code></p> </li><li> <p><code>print("检查点{}：实际结果：{}, 预期结果：{}".format(i + 1, value, check))</code></p> </li><li> <p><code>flag = get_instance(value, check)</code></p> </li><li> <p><code>if flag:</code></p> </li><li> <p><code>print("测试执行结果：成功")</code></p> </li><li> <p><code>else:</code></p> </li><li> <p><code>print("测试执行结果：失败")</code></p> </li><li><li><li> <p><code>if __name__ == '__main__':</code></p> </li><li> <p><code>response = {"store": {"book": [{"title": "高效Java", "price": 10.0}, {"title": "设计模式", "price": 12.21},</code></p> </li><li> <p><code>{"title": "重构", "isbn": "553", "price": 8},</code></p> </li><li> <p><code>{"title": "虚拟机", "isbn": "395", "price": 22}],</code></p> </li><li> <p><code>"bicycle": {"color": "red", "price": 19}}}</code></p> </li><li> <p><code>checkPoint = "$.store.book[0].price=10.0;$.store.book[1].title=设计模式1";</code></p> </li><li> <p><code>check(response, checkPoint)</code></p> </li></ol> 
<p>总结：<br> 感谢每一个认真阅读我文章的人！！！</p> 
<p>作为一位过来人也是希望大家少走一些弯路，如果你不想再体验一次学习时找不到资料，没人解答问题，坚持几天便放弃的感受的话，在这里我给大家分享一些自动化测试的学习资源，希望能给你前进的路上带来帮助。</p> 
<p><img alt="" height="822" src="https://images2.imgbox.com/ac/5c/r4xJw6an_o.png" width="1068"></p> 
<p>视频文档获取方式：<br> 这份文档和视频资料，对于想从事【软件测试】的朋友来说应该是最全面最完整的备战仓库，这个仓库也陪伴我走过了最艰难的路程，希望也能帮助到你！以上均可以分享，点下方小卡片即可自行领取。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/cc2c9b750b98f6806e6c70f7acf66d2b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">操作系统（10）----死锁</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/28dd0055b9af0bda05b1e887d6bec105/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">FileZilla 425 无法连接FTP的解决方法(阿里云服务器)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>