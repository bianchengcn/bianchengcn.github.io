<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue2实现自定义主题webpack-theme-color-replacer - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue2实现自定义主题webpack-theme-color-replacer" />
<meta property="og:description" content="需求：根据element的自定义主题色，之后改变element的全局所有颜色，解决页面刷新后主题色失效问题，这个需要把颜色存入到浏览器的存储中，如果换个浏览器就得重新选择了哈，如果需要在不同的浏览器保持一致的主题，需要跟后端沟通
之前还写过一个简单的，有需要的可以去看：vue实现element-ui自定义主题色切换(简单版)_element主题切换_请叫我欧皇i的博客-CSDN博客
效果如下：
1.下载颜色插件 我下的是1.4.6版本,最好下载的版本一致吧，不然报错了我也没办法
npm install webpack-theme-color-replacer@1.4.6 2.建个js文件themeColorClient.js 直接复制粘贴以下代码
import client from &#39;webpack-theme-color-replacer/client&#39; import forElementUI from &#39;webpack-theme-color-replacer/forElementUI&#39; // 注意自己项目里的引入路径 export let curColor = &#39;#409EFF&#39; // 动态切换主题色 export function changeThemeColor(newColor) { var options = { newColors: [...forElementUI.getElementUISeries(newColor), &#39;#ff0000&#39;, &#39;#ffff00&#39;] } return client.changer.changeColor(options, Promise) .then(() =&gt; { curColor = newColor localStorage.setItem(&#39;theme_color&#39;, curColor) }) } // 页面刷新的时候会触发 export function initThemeColor() { const savedColor = localStorage.getItem(&#39;theme_color&#39;) if (savedColor) { curColor = savedColor changeThemeColor(savedColor) } } 3." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/01826f3ea6d8bab50bc841526133bced/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-15T16:43:05+08:00" />
<meta property="article:modified_time" content="2024-01-15T16:43:05+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue2实现自定义主题webpack-theme-color-replacer</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>需求：根据element的自定义主题色，之后改变element的全局所有颜色，解决页面刷新后主题色失效问题，这个需要把颜色存入到浏览器的存储中，如果换个浏览器就得重新选择了哈，如果需要在不同的浏览器保持一致的主题，需要跟后端沟通</p> 
<p>之前还写过一个简单的，有需要的可以去看：<a href="https://blog.csdn.net/qq_44278289/article/details/131835511?ops_request_misc=&amp;request_id=ce68779532f7420b949a31eb0997f5ea&amp;biz_id=&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~koosearch~default-1-131835511-null-null.268%5Ev1%5Econtrol&amp;utm_term=%E4%B8%BB%E9%A2%98&amp;spm=1018.2226.3001.4450" title="vue实现element-ui自定义主题色切换(简单版)_element主题切换_请叫我欧皇i的博客-CSDN博客">vue实现element-ui自定义主题色切换(简单版)_element主题切换_请叫我欧皇i的博客-CSDN博客</a></p> 
<p>效果如下：</p> 
<h3><img alt="" height="503" src="https://images2.imgbox.com/f9/b1/geepaiX9_o.gif" width="1200"></h3> 
<h3>1.下载颜色插件</h3> 
<p>我下的是1.4.6版本,最好下载的版本一致吧，不然报错了我也没办法</p> 
<pre><code class="language-javascript">npm install webpack-theme-color-replacer@1.4.6</code></pre> 
<h3>2.建个js文件themeColorClient.js</h3> 
<p>直接复制粘贴以下代码</p> 
<pre><code class="language-javascript">import client from 'webpack-theme-color-replacer/client'
import forElementUI from 'webpack-theme-color-replacer/forElementUI'
// 注意自己项目里的引入路径

export let curColor = '#409EFF'

// 动态切换主题色
export function changeThemeColor(newColor) {
  var options = {
    newColors: [...forElementUI.getElementUISeries(newColor), '#ff0000', '#ffff00']
  }
  return client.changer.changeColor(options, Promise)
    .then(() =&gt; {
      curColor = newColor
      localStorage.setItem('theme_color', curColor)
    })
}
// 页面刷新的时候会触发
export function initThemeColor() {
  const savedColor = localStorage.getItem('theme_color')
  if (savedColor) {
    curColor = savedColor
    changeThemeColor(savedColor)
  }
}
</code></pre> 
<h3>3.在main.js文件导入</h3> 
<p>保证每次刷新数据还在</p> 
<pre><code class="language-javascript">import { initThemeColor } from './plugins/themeColorClient'
initThemeColor()</code></pre> 
<h3>4.颜色选择器</h3> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;el-color-picker v-model="mainColor" size="small" @change="changeColor" /&gt;
&lt;/template&gt;

&lt;script&gt;
import { changeThemeColor, curColor } from "@/plugins/themeColorClient";
export default {
  name: "d2-header-color",
  data() {
    return {
      mainColor: curColor,
      predefine: [
        "#ff4500",
        "#ff8c00",
        "#ffd700",
        "#90ee90",
        "#00ced1",
        "#1e90ff",
        "#c71585",
      ],
    };
  },
  methods: {
    changeColor(newColor) {
      console.log(newColor, "颜色");
      changeThemeColor(newColor)
        .then((t) =&gt; console.log("123465"))
        .catch((err) =&gt; console.log(err, "567"));
      //.then(t =&gt; this.$x.toast.success('主题色切换成功~'))
    },
  },
};
&lt;/script&gt;
</code></pre> 
<h3>5.在vue.config.js中配置</h3> 
<pre><code class="language-javascript">const ThemeColorReplacer = require('webpack-theme-color-replacer')
const forElementUI = require('webpack-theme-color-replacer/forElementUI')
module.exports = {
  chainWebpack: config =&gt; {
       // 自定义主题色
    config
      .plugin('theme-color-replacer')
      .use(ThemeColorReplacer, [{
        fileName: 'style/theme-colors.[contenthash:8].css',
        matchColors: [
          ...forElementUI.getElementUISeries(process.env.VUE_APP_ELEMENT_COLOR), // Element-ui主色系列
          '#0cdd3a', // 自定义颜色
          '#c655dd'
        ],
        changeSelector: forElementUI.changeSelector,
        // 解决history模式下路由跳转样式不生效问题
        injectCss: true,
        isJsUgly: process.env.NODE_ENV === 'production' ? true : undefined
      }])
}
    
}</code></pre> 
<h3>6.如果非element的组件需要使用全局自定义样式可以如下设置</h3> 
<p>在公共的scss样式文件下添加如下代码</p> 
<pre><code class="language-css">// 全局更改样式,必须是--navWidth，可以看theme文件
//--navWidth为变量,必须以--开头，否则其它页面使用这个变量不会生效
$mainBgc: var(--navWidth, #409eff);</code></pre> 
<p> 之后在需要全局样式下添加$mainBgc即可</p> 
<pre><code class="language-css">.box{
color:$mainBgc;
}</code></pre> 
<p>这样就可以实现了，文章到此结束，希望对你有所帮助~有不懂的可以在评论区联系我</p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dd98d587d26061a46b2483b1234e0dd9/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">windows_exporter 安装</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/40fcebeeabf52e08572ca3243c5337cf/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">23种设计模式都适用于哪些场景？</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>