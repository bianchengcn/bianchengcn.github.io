<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Windows下利用win32clipboard实现Python的剪切板(Clipboard)操作 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Windows下利用win32clipboard实现Python的剪切板(Clipboard)操作" />
<meta property="og:description" content="最近翻译论文的时候发现复制过来的文字经常带有很多的换行符，为了方便的去除这些换行符，写了一个python小方法。
代码如下(适用于Python3)：
import win32clipboard as wc import win32con import sys def stripClipboard(): # 开始剪切板操作 wc.OpenClipboard() # 尝试将剪切板内容读取为Unicode文本 # 如果复制的内容是文件而非文本，读取为Unicode文本会报错，所以需要错误处理。 try: txt = wc.GetClipboardData(win32con.CF_UNICODETEXT) except Exception as e: print(&#34;剪切板内容非文本，无法去除换行符。&#34;) wc.EmptyClipboard() sys.exit(&#34;已清空剪切板并退出。&#34;) txt = wc.GetClipboardData(win32con.CF_UNICODETEXT) txt = str(txt).strip() # 字符串按行分割 txt = txt.splitlines() n = len(txt) # 用空格拼接每行 txt = &#39; &#39;.join(txt) # 将所有长度大于1的空白符转为1个空格 txt = &#39; &#39;.join(txt.split()) # 清空剪切板 wc.EmptyClipboard() # 尝试将处理完的字符放入剪切板，注意这里用的是win32con.CF_UNICODETEXT， # 如果使用win32con.CF_TEXT则需要对txt进行编码，否则会出现乱码。 wc.SetClipboardData(win32con.CF_UNICODETEXT, txt) # 关闭剪切板 wc.CloseClipboard() print(&#39;删除了{}个换行符\n&#39;.format(n-1)) print(txt&#43;&#39;\n&#39;) if __name__ == &#39;__main__&#39;: stripClipboard() 保存并命名为“stripClipboard." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/71b79f0a1785b02d7b8c45cc4edca0b8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-01T05:50:49+08:00" />
<meta property="article:modified_time" content="2017-08-01T05:50:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Windows下利用win32clipboard实现Python的剪切板(Clipboard)操作</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>最近翻译论文的时候发现复制过来的文字经常带有很多的换行符，为了方便的去除这些换行符，写了一个python小方法。<br> 代码如下(适用于Python3)：</p> 
<pre><code>import win32clipboard as wc
import win32con
import sys

def stripClipboard():
    # 开始剪切板操作
    wc.OpenClipboard()
    # 尝试将剪切板内容读取为Unicode文本
    # 如果复制的内容是文件而非文本，读取为Unicode文本会报错，所以需要错误处理。
    try:
        txt = wc.GetClipboardData(win32con.CF_UNICODETEXT)
    except Exception as e:
        print("剪切板内容非文本，无法去除换行符。")
        wc.EmptyClipboard()
        sys.exit("已清空剪切板并退出。")
    txt = wc.GetClipboardData(win32con.CF_UNICODETEXT)
    txt = str(txt).strip()
    # 字符串按行分割
    txt = txt.splitlines()
    n = len(txt)
    # 用空格拼接每行
    txt = ' '.join(txt)
    # 将所有长度大于1的空白符转为1个空格
    txt = ' '.join(txt.split())
    # 清空剪切板
    wc.EmptyClipboard()
    # 尝试将处理完的字符放入剪切板，注意这里用的是win32con.CF_UNICODETEXT，
    # 如果使用win32con.CF_TEXT则需要对txt进行编码，否则会出现乱码。
    wc.SetClipboardData(win32con.CF_UNICODETEXT, txt)
    # 关闭剪切板
    wc.CloseClipboard()
    print('删除了{}个换行符\n'.format(n-1))
    print(txt+'\n')

if __name__ == '__main__':
    stripClipboard()
</code></pre> 
<p>保存并命名为“stripClipboard.py”。每当从论文里复制了文字后，只需运行<code>python stripClipboard.py</code>接着再ctrl+v就能粘贴已去除所有换行符的文字内容。</p> 
<p>例如，从论文中ctrl+v了如下文字：</p> 
<pre><code>In this paper, we propose a novel neural
network model called RNN Encoder–
Decoder that consists of two recurrent
neural networks (RNN). One RNN encodes
a sequence of symbols into a fixedlength
vector representation, and the other
decodes the representation into another sequence
of symbols. The encoder and decoder
of the proposed model are jointly
trained to maximize the conditional probability
of a target sequence given a source
sequence. The performance of a statistical
machine translation system is empirically
found to improve by using the conditional
probabilities of phrase pairs computed
by the RNN Encoder–Decoder as an
additional feature in the existing log-linear
model. Qualitatively, we show that the
proposed model learns a semantically and
syntactically meaningful representation of
linguistic phrases.
</code></pre> 
<p>运行<code>python stripClipboard.py</code>，则剪切板的内容变为：</p> 
<pre><code>In this paper, we propose a novel neural network model called RNN Encoder– Decoder that consists of two recurrent neural networks (RNN). One RNN encodes a sequence of symbols into a fixedlength vector representation, and the other decodes the representation into another sequence of symbols. The encoder and decoder of the proposed model are jointly trained to maximize the conditional probability of a target sequence given a source sequence. The performance of a statistical machine translation system is empirically found to improve by using the conditional probabilities of phrase pairs computed by the RNN Encoder–Decoder as an additional feature in the existing log-linear model. Qualitatively, we show that the proposed model learns a semantically and syntactically meaningful representation of linguistic phrases.
</code></pre> 
<p><strong><em>注1：</em> 要使用win32clipboard需安装pywin32，可用</strong><code>pip install -U pywin32</code><strong>来进行安装</strong><br> <strong><em>注2：</em> Mac下Python的剪切板操作将在<a href="http://blog.csdn.net/u010555997/article/details/77345764">另一篇文章</a>里介绍</strong><br> <s><em>注3：</em> 处理中文字符时会乱码</s><br> <strong><em>注3：</em> 如果有乱码现象，可能是因为中文Windows系统编码默认为GBK，请尝试将编码设置为UTF-8</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/fa3310b5ed6b3cd984db250df2e4e485/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">guacamole谷歌浏览器全屏时白屏问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/801a460b1c484035be8a03c7b4b1cb48/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">常见工具总结</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>