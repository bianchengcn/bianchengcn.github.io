<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>jsp服务器协议,用Java实现Web服务器  HTTP协议 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="jsp服务器协议,用Java实现Web服务器  HTTP协议" />
<meta property="og:description" content="一、HTTP协议的作用原理
HTTP协议的作用原理包括四个步骤：
1.连接：Web浏览器与Web服务器建立连接。2.请求：Web浏览器通过socket向Web服务器提交请求。3.应答：Web浏览器提交请求后，通过HTTP传送给Web服务器。Web服务器接到请求后，进行事务处理，处理结果又通过HTTP传回给Web浏览器，从而在Web浏览器上显示出所请求的页面。4.关系连接：当应答结束后，Web浏览器与Web服务器必须断开，以保证其它Web浏览器能够与Web服务器建立连接。
二、用Java实现Web服务器的程序设计
根据上述HTTP协议的作用原理，实现GET请求的Web服务器程序的方法如下：
1.创建ServerSocket类对象，监听端口8080。这是为了区别于HTTP的标准TCP／IP端口80而取的；2.等待、接受客户机连接到端口8080，得到与客户机连接的socket；3.创建与socket关联的输入流instream和输入出流outstream；
式为：GET路径／文件名HTTP／1.0;4.从与socket关联的输入流instream中读取一行客户机提交的请求信息，请求信息的格式为：GET路径／文件名HTTP／1.0;5.从请求信息中获取请求类型。如果请求类型是GET，则从请求信息中获取所访问的HTML文件名。没有HTML文件名时，则以index.htm1作为文件名；6.如果HTML文件存在，则打开HTML文件，把HTTP头信息和HTML文件内容通过socket传回给Web服务器，然后关闭文件，否则发送错误信息给Web浏览器；7.关闭与相应Web浏览器连接的socket字。
下面的程序是根据上述方法编写的，可实现多线程的Web服务器，以保证多个客户机能同时与该Web服务器连接。
／／WebServer.java用Java编写Web服务器
import java.io.＊；
import java.net.＊；
import java.util.Date；
public class WebServer{
public static void main(String args[])
{
int i=1,PORT=8080；
ServerSocket server=null；
Socketclient=null；
try{
server=new ServerSocket(PORT)；
System.out.println
(&#34;Web Server is listening on port&#34;
＋server.getLocalPort())；
for(；；){
client=server.accept()；
／／接受客户机的连接请求
new Connection Thread(client,i).start()；
i＋＋；
}
}catch(Exception e){System.out.println(e)；}
}
}
／＊Connnection Thread类完成
与一个Web浏览器的通信＊／
class Connection Thread extends Thread{
Socket client；／／连接Web浏览器的socket字
int counter；／／计数器
public Connection Thread(Socketcl,int c){
client=cl；" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/53d4ed967719281afef1bb084c275406/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-13T11:50:19+08:00" />
<meta property="article:modified_time" content="2021-08-13T11:50:19+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">jsp服务器协议,用Java实现Web服务器  HTTP协议</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div style="font-size:16px;"> 
 <p>一、HTTP协议的作用原理</p> 
 <p>HTTP协议的作用原理包括四个步骤：</p> 
 <p>1.连接：Web浏览器与Web服务器建立连接。2.请求：Web浏览器通过socket向Web服务器提交请求。3.应答：Web浏览器提交请求后，通过HTTP传送给Web服务器。Web服务器接到请求后，进行事务处理，处理结果又通过HTTP传回给Web浏览器，从而在Web浏览器上显示出所请求的页面。4.关系连接：当应答结束后，Web浏览器与Web服务器必须断开，以保证其它Web浏览器能够与Web服务器建立连接。</p> 
 <p>二、用Java实现Web服务器的程序设计</p> 
 <p>根据上述HTTP协议的作用原理，实现GET请求的Web服务器程序的方法如下：</p> 
 <p>1.创建ServerSocket类对象，监听端口8080。这是为了区别于HTTP的标准TCP／IP端口80而取的；2.等待、接受客户机连接到端口8080，得到与客户机连接的socket；3.创建与socket关联的输入流instream和输入出流outstream；</p> 
 <p>式为：GET路径／文件名HTTP／1.0;4.从与socket关联的输入流instream中读取一行客户机提交的请求信息，请求信息的格式为：GET路径／文件名HTTP／1.0;5.从请求信息中获取请求类型。如果请求类型是GET，则从请求信息中获取所访问的HTML文件名。没有HTML文件名时，则以index.htm1作为文件名；6.如果HTML文件存在，则打开HTML文件，把HTTP头信息和HTML文件内容通过socket传回给Web服务器，然后关闭文件，否则发送错误信息给Web浏览器；7.关闭与相应Web浏览器连接的socket字。</p> 
 <p>下面的程序是根据上述方法编写的，可实现多线程的Web服务器，以保证多个客户机能同时与该Web服务器连接。</p> 
 <p>／／WebServer.java用Java编写Web服务器</p> 
 <p>import java.io.＊；</p> 
 <p>import java.net.＊；</p> 
 <p>import java.util.Date；</p> 
 <p>public class WebServer{<!-- --></p> 
 <p>public static void main(String args[])</p> 
 <p>{<!-- --></p> 
 <p>int i=1,PORT=8080；</p> 
 <p>ServerSocket server=null；</p> 
 <p>Socketclient=null；</p> 
 <p>try{<!-- --></p> 
 <p>server=new ServerSocket(PORT)；</p> 
 <p>System.out.println</p> 
 <p>("Web Server is listening on port"</p> 
 <p>＋server.getLocalPort())；</p> 
 <p>for(；；){<!-- --></p> 
 <p>client=server.accept()；</p> 
 <p>／／接受客户机的连接请求</p> 
 <p>new Connection Thread(client,i).start()；</p> 
 <p>i＋＋；</p> 
 <p>}</p> 
 <p>}catch(Exception e){System.out.println(e)；}</p> 
 <p>}</p> 
 <p>}</p> 
 <p>／＊Connnection Thread类完成</p> 
 <p>与一个Web浏览器的通信＊／</p> 
 <p>class Connection Thread extends Thread{<!-- --></p> 
 <p>Socket client；／／连接Web浏览器的socket字</p> 
 <p>int counter；／／计数器</p> 
 <p>public Connection Thread(Socketcl,int c){<!-- --></p> 
 <p>client=cl；</p> 
 <p>counter=c；</p> 
 <p>}</p> 
 <p>public void run()／／线程体</p> 
 <p>{<!-- --></p> 
 <p>try{<!-- --></p> 
 <p>String deskIP=client.getInetAddress().toString()；</p> 
 <p>／／客户机IP地址</p> 
 <p>int destport=client.getPort()；</p> 
 <p>／／客户机端口号</p> 
 <p>System.out.println</p> 
 <p>("Connecction"＋counter＋"：</p> 
 <p>connected to "＋destIP＋"on port</p> 
 <p>"＋destport＋".")；</p> 
 <p>PrintStream outstream=new printStream</p> 
 <p>(client.getOoutputStream())；</p> 
 <p>DataInputStreaminstream＋new DataInputStream</p> 
 <p>(client.getInputStream())；</p> 
 <p>String inline=instream.readLine()；</p> 
 <p>／／读取Web浏览器提交的请求信息</p> 
 <p>System.out.println("Received："＋inline)；</p> 
 <p>if(getrequest(inline)){／／如果是GET请求</p> 
 <p>String filename=getfilename(inline)；</p> 
 <p>File file=new File (filename)；</p> 
 <p>if(file.exists()){<!-- --></p> 
 <p>／／若文件存在，则将文件送给Web浏览器</p> 
 <p>System.out.println(filename＋"requested.")；</p> 
 <p>outstream.println("HTTP／1.0200OK")；</p> 
 <p>outstream.println("MIME_version：1.0")；</p> 
 <p>outstream.println("Content_Type：text／htm1")；</p> 
 <p>int len=(int)file.length()；</p> 
 <p>outstream.println("Content_Length："＋len)；</p> 
 <p>outstream.println("")；</p> 
 <p>sendfile(outstream,file)；／／发送文件</p> 
 <p>outstream.flush()；</p> 
 <p>}else{／／文件不存在时</p> 
 <p>String notfound="</p> 
 <p>Not Found</p>Error404－File notfound 
 <p>"；</p> 
 <p>outstream.println("HTTP ／1.0 404 no found")；</p> 
 <p>outstream.println("Content_Type：text ／html")；</p> 
 <p>outstream.println</p> 
 <p>("Content_Length：" ＋notfound.length() ＋2)；</p> 
 <p>outstream.println("")；</p> 
 <p>outstream.println(notfound)；</p> 
 <p>outstream.flush()；</p> 
 <p>}</p> 
 <p>}</p> 
 <p>long m1=1；</p> 
 <p>while(m10)</p> 
 <p>{<!-- --></p> 
 <p>if(s.substring(0,3).equalsIgnoreCase</p> 
 <p>("GET"))return true；</p> 
 <p>}</p> 
 <p>return false；</p> 
 <p>}</p> 
 <p>／＊获取要访问的文件名＊／</p> 
 <p>String getfilename(String s){<!-- --></p> 
 <p>String f=s.substring(s.indexOf('')＋1)；</p> 
 <p>f=f.substring(0,f.indexOf(''))；</p> 
 <p>try{<!-- --></p> 
 <p>if(f.charAt(0)=='／')</p> 
 <p>f=f.substring(1)；</p> 
 <p>}catch(String IndexOutOfBoundsException e){<!-- --></p> 
 <p>System.out.println("Exception："＋e)；</p> 
 <p>}</p> 
 <p>if(f.equals(""))f="index.html"；</p> 
 <p>return f；</p> 
 <p>}</p> 
 <p>／＊把指定文件发送给Web浏览器＊／</p> 
 <p>void sendfile(PrintStream outs,File file){<!-- --></p> 
 <p>try{<!-- --></p> 
 <p>DataInputStreamin=new DataInputStream</p> 
 <p>(new FileInputStream(file))；</p> 
 <p>int len=(int)file.length()；</p> 
 <p>byte buf[]=new byte[len]；</p> 
 <p>in.readFully(buf)；</p> 
 <p>outs.write(buf,0,len)；</p> 
 <p>outs.flush()；</p> 
 <p>in.close()；</p> 
 <p>}catch(Exception e){<!-- --></p> 
 <p>System.out.println("Error retrieving file.")；</p> 
 <p>System.exit(1)；</p> 
 <p>}</p> 
 <p>}</p> 
 <p>}</p> 
 <p>程序中的Connection Thread线程子类用来分析一个Web浏览器提交的请求，并将应答信息传回给Web浏览器。其中，getrequest()方法用来检测客户的请求是否为"GET"；getfilename(s)方法是从客户请求信息s中获取要访问的HTML文件名；sendfile()方法把指定文件内容通过socket传回给Web浏览器。</p> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/eacc988c5910381e6b80ed1a134d74e1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">华为日志服务器文档,简单日志服务器</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dbc0e2fa20e45d0bab68dc9497e4a162/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">2008服务器系统关闭,Windows server 2008系统默认服务哪些可以关闭?</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>