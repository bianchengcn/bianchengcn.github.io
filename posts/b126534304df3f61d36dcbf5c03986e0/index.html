<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>java项目中导入excel数据，使用EasyExcel框架 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="java项目中导入excel数据，使用EasyExcel框架" />
<meta property="og:description" content="导入excel数据EasyExcel简介 ​ EasyExcel是阿里巴巴开源的一个excel处理框架，以使用简单，节省内存著称，EasyExcel在解析Excel时没有讲文件数据一次加载到内存中，而是从磁盘上一行一行读取数据，逐个解析。EsayExcel采用一行一行的解析模式，并将一行的解析结果以观察者的模式通知处理（AlaysisEventListener） EasyExcel进行读写操作 EasyExcel进行写操作 引入依赖
&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;easyexcel&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;4.1.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 创建实体类和excel数据对应
@Data public class WriteExcel { //设置excel表头名称 @ExcelProperty(&#34;学生编号&#34;) private Integer sno; @ExcelProperty(&#34;学生姓名&#34;) private String name; } 3.写入数据
/** * @author jia * @date 2022/9/8 * @description easyExcel 往excel写入数据 */ public class WriteExcelDemo { public static void main(String[] args) { //实现excel写的操作 // 1.设置写入文件夹地址和excel名称 String fileName = &#34;F:\\write.xlsx&#34;; //2.调用easyExcel里面的方法实现写操作 参数 文件路径 实体类名称 EasyExcel.write(fileName, WriteExcel." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/b126534304df3f61d36dcbf5c03986e0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-05T12:24:20+08:00" />
<meta property="article:modified_time" content="2022-10-05T12:24:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">java项目中导入excel数据，使用EasyExcel框架</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h4><a id="excelEasyExcel_2"></a>导入excel数据EasyExcel简介</h4> 
<ul><li>​ EasyExcel是阿里巴巴开源的一个excel处理框架，以使用简单，节省内存著称，EasyExcel在解析Excel时没有讲文件数据一次加载到内存中，而是从磁盘上一行一行读取数据，逐个解析。</li><li>EsayExcel采用一行一行的解析模式，并将一行的解析结果以观察者的模式通知处理（AlaysisEventListener）</li></ul> 
<h5><a id="EasyExcel_7"></a>EasyExcel进行读写操作</h5> 
<h6><a id="EasyExcel_9"></a>EasyExcel进行写操作</h6> 
<ol><li> <p>引入依赖</p> <pre><code>&lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;easyexcel&lt;/artifactId&gt;
            &lt;version&gt;3.1.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
            &lt;artifactId&gt;poi&lt;/artifactId&gt;
            &lt;version&gt;4.1.2&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre> </li><li> <p>创建实体类和excel数据对应</p> <pre><code>@Data
public class WriteExcel {
	//设置excel表头名称
    @ExcelProperty("学生编号")
    private Integer sno;
    @ExcelProperty("学生姓名")
    private String name;
}
</code></pre> <p>3.写入数据</p> <pre><code>/**
 * @author jia
 * @date 2022/9/8
 * @description easyExcel 往excel写入数据
 */
public class WriteExcelDemo {
    public static void main(String[] args) {
        //实现excel写的操作
        // 1.设置写入文件夹地址和excel名称
        String fileName = "F:\\write.xlsx";
        //2.调用easyExcel里面的方法实现写操作   参数 文件路径  实体类名称
        EasyExcel.write(fileName, WriteExcel.class).sheet("学生列表").doWrite(getData());  //doWrite()使用完毕后会自动关闭流
    }

    //创建一个方法,返回list集合
    private static List&lt;WriteExcel&gt; getData(){
        ArrayList&lt;WriteExcel&gt; excels = new ArrayList&lt;&gt;();
        for (int i = 0; i &lt; 10; i++) {
            WriteExcel excel = new WriteExcel();
            excel.setName("cici"+i);
            excel.setSno(i);
            excels.add(excel);
        }
        return excels;
    }
}
</code></pre> </li></ol> 
<h6><a id="EasyExcel_72"></a>EasyExcel进行读操作</h6> 
<ol><li> <p>​ 创建和excel对应的实体类，标记对应列关系</p> <pre><code>/**
 * @author jia
 * @date 2022/9/8
 * @description 读操作
 */
@Data
public class ReadExcel {
    //设置excel表头名称 index 是列 从0-1-2...
    @ExcelProperty(value = "学生编号",index = 0)
    private Integer sno;
    @ExcelProperty(value = "学生姓名",index = 1)
    private String name;
}
</code></pre> </li><li> <p>创建监听进行excel文件读取</p> <pre><code>public class ExcelListener extends AnalysisEventListener&lt;ReadExcel&gt; {
    //一行一行读取excel内容 此方法不读取表头
    @Override
    public void invoke(ReadExcel read, AnalysisContext analysisContext) {
        System.out.println("+++++++++++"+read);
    }

    //读取表头内容
    @Override
    public void invokeHeadMap(Map&lt;Integer, String&gt; headMap, AnalysisContext context){
        System.out.println("表头:"+headMap);
    }
    //读取完成之后
    @Override
    public void doAfterAllAnalysed(AnalysisContext analysisContext) {

    }
}
</code></pre> </li><li> <p>方法调用</p> <pre><code>/**
 * @author jia
 * @date 2022/9/8
 * @description 读操作
 */
public class ReadExcelDemo {
    public static void main(String[] args) {
        // 实现excel读操作
        String fileName = "F://write.xlsx";
        //读取完毕 流会自动关闭
        EasyExcel.read(fileName, ReadExcel.class,new ExcelListener()).sheet().doRead();
    }
}
</code></pre> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/ceb9c05955d607200eab64dc8a6d7255/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">web项目设置统一返回格式教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/b416c59ae15c0483aae4cdb8a9c9cb49/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mybatis_plus使用过程中NoSuchBeanDefinitionException，大概率是因为不能扫描到mapper文件</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>