<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>libcurl使用心得 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="libcurl使用心得" />
<meta property="og:description" content="libcurl使用心得 Libcurl为一个免费开源的，客户端url传输库，支持FTP，FTPS，TFTP，HTTP，HTTPS，GOPHER，TELNET，DICT，FILE和LDAP，跨平台，支持Windows，Unix，Linux等，线程安全，支持Ipv6。并且易于使用。
http://curl.haxx.se/libcurl/
从http://curl.haxx.se/libcurl/ 下载一个稳定的版本，注意选择OS。
在使用之前请大家多阅读libcurl的文档：因为如果要实际运用到项目中，最好对libcurl有具体的了解，具体在
http://curl.haxx.se/libcurl/c/
curl_easy_setopt() curl_easy_perform() curl_easy_getinfo() 这三个函数的使用上，需要多去钻研，多看Samples，你才能灵活使用libcurl。
感谢这篇文章:
http://blog.163.com/xu_chao2000/blog/static/27770610200801303252802/
给了我许多启发，再次感谢！
给出我的一个简单的代码例子：
说明:
1.关键在curl_easy_setopt函数设置option,可以设置ftp,http,get,post等许多选项，请根据具体使用情况设置。
2.对取回来的数据需要进行判断，比如http下载文件，如果文件不存在，需要进行处理。因为writer是可以将buf填充404 not found等网页内容的，不能将这个内容当成文件内容，所以需要判断http web返回来的code，进行判断。
3.我有个问题，就是想得到服务器上filename的具体名称，verbose调试已经返回了，但是我在getinfo的时候，试过好多选项，但未找到这个存放真实服务器文件名的选项，如果有知道的麻烦告诉我，谢谢了！
#include &#34; curl/curl.h &#34; #pragma comment(lib, &#34; libcurl.lib &#34; )
long writer(void * data, int size, int nmemb, string &amp; content);
bool CurlInit(CURL *&amp; curl, const char* url,string &amp; content);
bool GetURLDataBycurl(const char* URL, string &amp; content);
void main()
{
char *url =&#34;http://www.baidu.com/img/baidu.gif&#34;;
string content;
if ( GetURLDataBycurl(url,content))" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/45036100ae4835a8ab6b34454c2bd0b7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2011-11-02T09:35:12+08:00" />
<meta property="article:modified_time" content="2011-11-02T09:35:12+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">libcurl使用心得</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3><a id="viewpost1_TitleUrl" href="http://www.cppblog.com/qiujian5628/archive/2008/06/28/54873.html" rel="nofollow">libcurl使用心得</a></h3> 
<p>Libcurl为一个免费开源的，客户端url传输库，支持FTP，FTPS，TFTP，HTTP，HTTPS，GOPHER，TELNET，DICT，FILE和LDAP，跨平台，支持Windows，Unix，Linux等，线程安全，支持Ipv6。并且易于使用。</p> 
<p><a href="http://curl.haxx.se/libcurl/" rel="nofollow"><span style="color:#810081"><u>http://curl.haxx.se/libcurl/</u></span></a></p> 
<p>从http://curl.haxx.se/libcurl/ 下载一个稳定的版本，注意选择OS。<br> 在使用之前请大家多阅读libcurl的文档：因为如果要实际运用到项目中，最好对libcurl有具体的了解，具体在<br> <a href="http://curl.haxx.se/libcurl/c/" rel="nofollow"><u><span style="color:#800080">http://curl.haxx.se/libcurl/c/</span></u></a><br> <a href="http://curl.haxx.se/libcurl/c/curl_easy_setopt.html" rel="nofollow"><u><span style="color:#800080">curl_easy_setopt()</span></u></a> <br> <a href="http://curl.haxx.se/libcurl/c/curl_easy_perform.html" rel="nofollow"><u><span style="color:#0000ff">curl_easy_perform()</span></u></a> <br> <a href="http://curl.haxx.se/libcurl/c/curl_easy_getinfo.html" rel="nofollow"><u><span style="color:#800080">curl_easy_getinfo()</span></u></a> <br> 这三个函数的使用上，需要多去钻研，多看Samples，你才能灵活使用libcurl。<br> 感谢这篇文章:<br> <a href="http://blog.163.com/xu_chao2000/blog/static/27770610200801303252802/" rel="nofollow"><u><span style="color:#800080">http://blog.163.com/xu_chao2000/blog/static/27770610200801303252802/</span></u></a><br> 给了我许多启发，再次感谢！<br> <br> 给出我的一个简单的代码例子：<br> 说明:<br> 1.关键在curl_easy_setopt函数设置option,可以设置ftp,http,get,post等许多选项，请根据具体使用情况设置。<br> <br> 2.对取回来的数据需要进行判断，比如http下载文件，如果文件不存在，需要进行处理。因为writer是可以将buf填充404 not found等网页内容的，不能将这个内容当成文件内容，所以需要判断http web返回来的code，进行判断。<br> <br> 3.我有个问题，就是想得到服务器上filename的具体名称，verbose调试已经返回了，但是我在getinfo的时候，试过好多选项，但未找到这个存放真实服务器文件名的选项，如果有知道的麻烦告诉我，谢谢了！<br> </p> 
<div style="border:1px solid #cccccc; padding:4px 5px 4px 4px; font-size:13px; width:98%; background-color:#eeeeee"> 
 <img src="https://images2.imgbox.com/ba/3c/0o16z3Um_o.gif" align="top" alt=""> 
 <span style="color:#000000">#include </span> 
 <span style="color:#000000">"</span> 
 <span style="color:#000000">curl/curl.h</span> 
 <span style="color:#000000">"</span> 
 <span style="color:#000000"><br> <img src="https://images2.imgbox.com/9b/55/LsyViuyK_o.gif" align="top" alt="">#pragma comment(lib, </span> 
 <span style="color:#000000">"</span> 
 <span style="color:#000000">libcurl.lib</span> 
 <span style="color:#000000">"</span> 
 <span style="color:#000000">)<br> <img src="https://images2.imgbox.com/f3/18/9gA9TxZf_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/44/78/RCtviCma_o.gif" align="top" alt="">long writer(void </span> 
 <span style="color:#000000">*</span> 
 <span style="color:#000000">data, int size, int nmemb, string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content);<br> <img src="https://images2.imgbox.com/f0/a2/iKJJl8jq_o.gif" align="top" alt="">bool  CurlInit(CURL </span> 
 <span style="color:#000000">*&amp;</span> 
 <span style="color:#000000">curl, const char* url,string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content);<br> <img src="https://images2.imgbox.com/87/15/8m5713VF_o.gif" align="top" alt="">bool  GetURLDataBycurl(const char* URL, string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content);<br> <img src="https://images2.imgbox.com/10/88/ftzEgabJ_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/3d/3d/jUc03BJ5_o.gif" align="top" alt=""></span> 
 <span style="color:#0000ff">void</span> 
 <span style="color:#000000"> main()<br> <img id="Codehighlighter1_281_529_Open_Image" src="https://images2.imgbox.com/e8/4c/TPPAkffE_o.gif" align="top" alt=""></span> 
 <span id="Codehighlighter1_281_529_Open_Text"><span style="color:#000000">{<!-- --><br> </span><span style="color:#008000"></span><span style="color:#008000"><img src="https://images2.imgbox.com/18/be/Dv5nCCbk_o.gif" align="top" alt=""></span><span style="color:#000000">    char *url </span><span style="color:#000000">=</span><span style="color:#000000">"</span><span style="color:#000000">http://www.baidu.com/img/baidu.gif</span><span style="color:#000000">"</span><span style="color:#000000">;<br> <img src="https://images2.imgbox.com/4e/92/7X95HQEI_o.gif" align="top" alt="">    string content;<br> <img src="https://images2.imgbox.com/eb/5e/MACZHMSb_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> ( GetURLDataBycurl(url,content))<br> <img id="Codehighlighter1_484_515_Open_Image" src="https://images2.imgbox.com/ea/92/u8QXloe9_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_484_515_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/af/15/pvTRijSQ_o.gif" align="top" alt="">        printf(</span><span style="color:#000000">"</span><span style="color:#000000">%s\n</span><span style="color:#000000">"</span><span style="color:#000000">,content);<br> <img src="https://images2.imgbox.com/ea/d5/bAKaroed_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/78/16/2mZL7Xbw_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/a6/99/Z1nvG1UG_o.gif" align="top" alt="">    getchar();<br> <img src="https://images2.imgbox.com/25/12/SXZAkegn_o.gif" align="top" alt="">}</span></span> 
 <span style="color:#000000"><br> <img src="https://images2.imgbox.com/cc/66/ZoQpta0P_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/dd/4b/fzu5J79y_o.gif" align="top" alt="">bool CurlInit(CURL </span> 
 <span style="color:#000000">*&amp;</span> 
 <span style="color:#000000">curl, const char* url,string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content)<br> <img id="Codehighlighter1_595_1619_Open_Image" src="https://images2.imgbox.com/39/f0/fzgRbnYR_o.gif" align="top" alt=""></span> 
 <span id="Codehighlighter1_595_1619_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/a6/a2/8a80xW5J_o.gif" align="top" alt="">    CURLcode code;<br> <img src="https://images2.imgbox.com/61/87/SoY2eHbR_o.gif" align="top" alt="">    string error;<br> <img src="https://images2.imgbox.com/f4/c7/90TdEM87_o.gif" align="top" alt="">    curl </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_init();<br> <img src="https://images2.imgbox.com/fd/90/DRjIDanC_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (curl </span><span style="color:#000000">==</span><span style="color:#000000"> NULL)<br> <img id="Codehighlighter1_682_754_Open_Image" src="https://images2.imgbox.com/a0/ee/IiSKOTQw_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_682_754_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/bd/f3/qgR3aMJF_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to create CURL connection\n</span><span style="color:#000000">"</span><span style="color:#000000">);<br> <img src="https://images2.imgbox.com/d8/28/vpWGEuAq_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/75/c7/WtH0lYuR_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/f4/62/UqFmqFGH_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, error);<br> <img src="https://images2.imgbox.com/a9/24/X2Ayttx4_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_840_918_Open_Image" src="https://images2.imgbox.com/35/e1/MvaL8GgH_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_840_918_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/26/48/hK22oxrZ_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to set error buffer [%d]\n</span><span style="color:#000000">"</span><span style="color:#000000">, code );<br> <img src="https://images2.imgbox.com/95/da/ZymO7pxl_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/8e/90/6FwSPnK5_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/7d/86/3xnHR1Mw_o.gif" align="top" alt="">    curl_easy_setopt(curl, CURLOPT_VERBOSE, </span><span style="color:#000000">1L</span><span style="color:#000000">);<br> <img src="https://images2.imgbox.com/5b/da/g0MCDETB_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_setopt(curl, CURLOPT_URL, url);<br> <img src="https://images2.imgbox.com/6e/65/4I8jJNJ5_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_1040_1108_Open_Image" src="https://images2.imgbox.com/38/cb/Ou9IJFMQ_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_1040_1108_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/e8/e8/ndZrBSp3_o.gif" align="top" alt="">        printf(</span><span style="color:#000000">"</span><span style="color:#000000">Failed to set URL [%s]\n</span><span style="color:#000000">"</span><span style="color:#000000">, error);<br> <img src="https://images2.imgbox.com/88/3d/ALyGUPuy_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/24/b6/gp1xofkk_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/11/16/9qTZGwNy_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, </span><span style="color:#000000">1</span><span style="color:#000000">);<br> <img src="https://images2.imgbox.com/75/49/sRcXzYWh_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_1193_1275_Open_Image" src="https://images2.imgbox.com/6b/2c/At2IcYId_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_1193_1275_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/f2/31/KBJbUO6P_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to set redirect option [%s]\n</span><span style="color:#000000">"</span><span style="color:#000000">, error );<br> <img src="https://images2.imgbox.com/7c/5a/6d4gXLvQ_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/eb/78/S0OfCtyK_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/29/a0/F3muoLP6_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, writer);<br> <img src="https://images2.imgbox.com/29/d6/BPzayaXf_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_1364_1436_Open_Image" src="https://images2.imgbox.com/92/b4/fqWYKwmz_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_1364_1436_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/57/75/L1EIhSba_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to set writer [%s]\n</span><span style="color:#000000">"</span><span style="color:#000000">, error);<br> <img src="https://images2.imgbox.com/9c/91/A0T4VmsG_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/c0/11/00zsQ85U_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/2a/9b/XyEeXYDQ_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_setopt(curl, CURLOPT_WRITEDATA, </span><span style="color:#000000">&amp;</span><span style="color:#000000">content);<br> <img src="https://images2.imgbox.com/02/95/D9zxsGQR_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_1523_1600_Open_Image" src="https://images2.imgbox.com/55/ff/sCoQrvXE_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_1523_1600_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/47/e7/yFtrMP4N_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to set write data [%s]\n</span><span style="color:#000000">"</span><span style="color:#000000">, error );<br> <img src="https://images2.imgbox.com/33/0b/6JWL4T1Q_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/83/ad/S9lqOWAl_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/0d/52/n0B19Yqg_o.gif" align="top" alt="">    </span><span style="color:#0000ff">return</span><span style="color:#000000"> true;<br> <img src="https://images2.imgbox.com/ee/30/iotahAL0_o.gif" align="top" alt="">}</span></span> 
 <span style="color:#000000"><br> <img src="https://images2.imgbox.com/02/cc/rvyhpGGt_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/a9/28/S6T88hsX_o.gif" align="top" alt="">long writer(void </span> 
 <span style="color:#000000">*</span> 
 <span style="color:#000000">data, int size, int nmemb, string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content)<br> <img id="Codehighlighter1_1699_1804_Open_Image" src="https://images2.imgbox.com/39/96/arbTmTq6_o.gif" align="top" alt=""></span> 
 <span id="Codehighlighter1_1699_1804_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/58/b8/2ITY9pvc_o.gif" align="top" alt="">    long sizes </span><span style="color:#000000">=</span><span style="color:#000000"> size </span><span style="color:#000000">*</span><span style="color:#000000"> nmemb;<br> <img src="https://images2.imgbox.com/e2/6d/HYERgU25_o.gif" align="top" alt="">    string temp(data,sizes);<br> <img src="https://images2.imgbox.com/b6/72/HdtIjgfY_o.gif" align="top" alt="">    content </span><span style="color:#000000">+=</span><span style="color:#000000"> temp; <br> <img src="https://images2.imgbox.com/a2/e5/Gs58Ay7J_o.gif" align="top" alt="">    </span><span style="color:#0000ff">return</span><span style="color:#000000"> sizes;<br> <img src="https://images2.imgbox.com/60/7e/2uGMazbM_o.gif" align="top" alt="">}</span></span> 
 <span style="color:#000000"><br> <img src="https://images2.imgbox.com/5c/e5/Ovhc7o3V_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/bf/89/5Y81ky9Q_o.gif" align="top" alt="">bool GetURLDataBycurl(const char* URL,  string </span> 
 <span style="color:#000000">&amp;</span> 
 <span style="color:#000000">content)<br> <img id="Codehighlighter1_1868_3029_Open_Image" src="https://images2.imgbox.com/78/51/mnCO3zLN_o.gif" align="top" alt=""></span> 
 <span id="Codehighlighter1_1868_3029_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/17/ca/bglOKuo0_o.gif" align="top" alt="">    CURL </span><span style="color:#000000">*</span><span style="color:#000000">curl </span><span style="color:#000000">=</span><span style="color:#000000"> NULL;<br> <img src="https://images2.imgbox.com/fc/90/fyCiGTAe_o.gif" align="top" alt="">    CURLcode code;<br> <img src="https://images2.imgbox.com/7f/85/0DJVKbg3_o.gif" align="top" alt="">    string error;<br> <img src="https://images2.imgbox.com/4b/a9/LhP4o9m9_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/22/87/SOCbOMYv_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_global_init(CURL_GLOBAL_DEFAULT);<br> <img src="https://images2.imgbox.com/3e/e6/XVoSuw1V_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_2001_2082_Open_Image" src="https://images2.imgbox.com/0f/20/5ja7oxSY_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_2001_2082_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/69/10/0LYlWWEe_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to global init default [%d]\n</span><span style="color:#000000">"</span><span style="color:#000000">, code );<br> <img src="https://images2.imgbox.com/31/a2/wPgt9Rvj_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/3e/a1/le1opcdu_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"> <br> <img src="https://images2.imgbox.com/3e/33/TA1GTOn6_o.gif" align="top" alt="">    <br> <img src="https://images2.imgbox.com/38/85/j3b91Dx9_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> ( </span><span style="color:#000000">!</span><span style="color:#000000">CurlInit(curl,URL,content) )<br> <img id="Codehighlighter1_2127_2205_Open_Image" src="https://images2.imgbox.com/4d/78/0Z9l5F90_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_2127_2205_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/f2/ee/4qq8Yuro_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to global init default [%d]\n</span><span style="color:#000000">"</span><span style="color:#000000"> );<br> <img src="https://images2.imgbox.com/f2/01/6Tr5Ycip_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> PM_FALSE;<br> <img src="https://images2.imgbox.com/47/2c/NKD5mFmH_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/9a/70/fhrmK77h_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_perform(curl);<br> <img src="https://images2.imgbox.com/32/8a/7RKGB5XN_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> (code </span><span style="color:#000000">!=</span><span style="color:#000000"> CURLE_OK)<br> <img id="Codehighlighter1_2273_2363_Open_Image" src="https://images2.imgbox.com/c0/cb/TRiRDhov_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_2273_2363_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/f1/71/mcmPjipG_o.gif" align="top" alt="">        printf( </span><span style="color:#000000">"</span><span style="color:#000000">Failed to get '%s' [%s]\n</span><span style="color:#000000">"</span><span style="color:#000000">, URL, error);<br> <img src="https://images2.imgbox.com/18/00/yIj7Isq5_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/24/55/s5F5KEWw_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/33/67/qGysnYo7_o.gif" align="top" alt="">    long retcode </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">0</span><span style="color:#000000">;<br> <img src="https://images2.imgbox.com/f5/e3/DjoaN6bD_o.gif" align="top" alt="">    code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE , </span><span style="color:#000000">&amp;</span><span style="color:#000000">retcode); <br> <img src="https://images2.imgbox.com/8b/73/HrVaDRQA_o.gif" align="top" alt="">    </span><span style="color:#0000ff">if</span><span style="color:#000000"> ( (code </span><span style="color:#000000">==</span><span style="color:#000000"> CURLE_OK) </span><span style="color:#000000">&amp;&amp;</span><span style="color:#000000"> retcode </span><span style="color:#000000">==</span><span style="color:#000000"> </span><span style="color:#000000">200</span><span style="color:#000000"> )<br> <img id="Codehighlighter1_2506_2902_Open_Image" src="https://images2.imgbox.com/5d/78/nRvcTtja_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_2506_2902_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/29/a7/6DLH7oa2_o.gif" align="top" alt="">        double length </span><span style="color:#000000">=</span><span style="color:#000000"> </span><span style="color:#000000">0</span><span style="color:#000000">;<br> <img src="https://images2.imgbox.com/ef/2f/7jwvzHzl_o.gif" align="top" alt="">        code </span><span style="color:#000000">=</span><span style="color:#000000"> curl_easy_getinfo(curl, CURLINFO_CONTENT_LENGTH_DOWNLOAD , </span><span style="color:#000000">&amp;</span><span style="color:#000000">length); <br> <img src="https://images2.imgbox.com/f1/5b/jqWq3VFZ_o.gif" align="top" alt="">        printf(</span><span style="color:#000000">"</span><span style="color:#000000">%d</span><span style="color:#000000">"</span><span style="color:#000000">,retcode);<br> <img src="https://images2.imgbox.com/f1/65/jIfFVQ1K_o.gif" align="top" alt="">        FILE </span><span style="color:#000000">*</span><span style="color:#000000"> file </span><span style="color:#000000">=</span><span style="color:#000000"> fopen(</span><span style="color:#000000">"</span><span style="color:#000000">1.gif</span><span style="color:#000000">"</span><span style="color:#000000">,</span><span style="color:#000000">"</span><span style="color:#000000">wb</span><span style="color:#000000">"</span><span style="color:#000000">);<br> <img src="https://images2.imgbox.com/48/69/AguUmJWD_o.gif" align="top" alt="">        fseek(file,</span><span style="color:#000000">0</span><span style="color:#000000">,SEEK_SET);<br> <img src="https://images2.imgbox.com/b5/26/vnYp8qKo_o.gif" align="top" alt="">        fwrite(content.c_str(),</span><span style="color:#000000">1</span><span style="color:#000000">,length,file);<br> <img src="https://images2.imgbox.com/d4/fa/uGNOwItD_o.gif" align="top" alt="">        fclose(file);<br> <img src="https://images2.imgbox.com/cc/43/dEDchJT8_o.gif" align="top" alt=""><br> <img src="https://images2.imgbox.com/c4/4f/YCoiyNAd_o.gif" align="top" alt="">        </span><span style="color:#008000">//</span><span style="color:#008000">struct curl_slist *list;<br> <img src="https://images2.imgbox.com/7c/83/2b19FMf6_o.gif" align="top" alt="">        </span><span style="color:#008000">//</span><span style="color:#008000">code = curl_easy_getinfo(curl,CURLINFO_COOKIELIST,&amp;list);<br> <img src="https://images2.imgbox.com/ba/18/oqA4S0Kj_o.gif" align="top" alt="">        </span><span style="color:#008000">//</span><span style="color:#008000">curl_slist_free_all (list);</span><span style="color:#008000"><br> <img src="https://images2.imgbox.com/ed/6e/vVJ0JLuK_o.gif" align="top" alt=""></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/5e/b6/CTwCtcje_o.gif" align="top" alt="">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> true;<br> <img src="https://images2.imgbox.com/cb/22/1z3E7Emk_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/00/46/mG0ROb1x_o.gif" align="top" alt="">    </span><span style="color:#0000ff">else</span><span style="color:#000000"><br> <img id="Codehighlighter1_2911_2980_Open_Image" src="https://images2.imgbox.com/7c/e4/5plDWlHi_o.gif" align="top" alt="">    </span><span id="Codehighlighter1_2911_2980_Open_Text"><span style="color:#000000">{<!-- --><br> <img src="https://images2.imgbox.com/25/48/pHEf1F84_o.gif" align="top" alt="">    </span><span style="color:#008000">//</span><span style="color:#008000">    debug1( "%s \n ",getStatusCode(retcode));</span><span style="color:#008000"><br> <img src="https://images2.imgbox.com/70/51/5pitVRHm_o.gif" align="top" alt=""></span><span style="color:#000000">        </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/8a/6c/a2Px1p6m_o.gif" align="top" alt="">    }</span></span><span style="color:#000000"><br> <img src="https://images2.imgbox.com/23/c1/mEOXj0Oa_o.gif" align="top" alt="">    curl_easy_cleanup(curl);<br> <img src="https://images2.imgbox.com/41/e6/le1P4sCf_o.gif" align="top" alt="">    </span><span style="color:#0000ff">return</span><span style="color:#000000"> false;<br> <img src="https://images2.imgbox.com/81/83/94sJkFAJ_o.gif" align="top" alt="">}</span></span> 
 <span style="color:#000000"><br> <img src="https://images2.imgbox.com/f2/4b/0fLUIjor_o.gif" align="top" alt=""></span> 
</div> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2a2361a026ddaa56251b71f530bd0ede/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">12 个 windows 7 实用技巧</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0852477f665134f6a448a2d36459e16b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">如何撰写《软件需求规格说明书》</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>