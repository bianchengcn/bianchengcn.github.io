<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【网络基础】浏览器输入一个URL之后，都发生了什么（详细讲解） - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【网络基础】浏览器输入一个URL之后，都发生了什么（详细讲解）" />
<meta property="og:description" content="学习目标： 目标：掌握网络知识
学习内容： 本文内容：详解浏览器输入一个URL之后，都发生了什么
文章目录 学习目标：学习内容：1.前置知识1.1 TCP/IP五层模型1.2 DNS协议1.3 ARP协议1.4 NAT技术 2. 输入URL，发送请求流程2.1域名解析2.2封装2.3分用2.4 响应 1.前置知识 想要了解浏览器输入一个URL之后都发生了什么，我们要先认识以下几个知识
1.1 TCP/IP五层模型 在这里简单介绍一下TCP/IP的五层模型
TCP/IP是一组协议的代名词，他还包括许多协议，组成了TCP/IP协议簇
TCP/IP通讯协议采用了5层 的层次结构，每一层都呼叫他的下一层所提供的的网络来完成自己的需求，主要分为一下五层
物理层: 负责光/电信号的传递方式. 比如现在以太网通用的网线(双绞 线)、早期以太网采用的 的同轴电缆(现在主要用于有线电视)、光纤, 现在的wifi无线网使用电磁波等都属于物理层的概念。物理层的能力决定了最大传输速率、传输距离、抗干扰性等. 集线器(Hub)工作在物理 层.数据链路层: 负责设备之间的数据帧的传送和识别. 例如网卡设备的驱动、帧同步(就是说从网 线上检测到什么信号算作新帧的开始)、冲突检测(如果检测到冲突就自动重发)、数据差错校 验等工作. 有以太网、令牌环网, 无线LAN等标准. 交换机(Switch)工作在数据链路层.网络层: 负责地址管理和路由选择. 例如在IP协议中, 通过IP地址来标识一台主机, 并通过路由表的方式规划出两台主机之间的数据传输的线路(路由). 路由器(Router)工作在网路层.传输层: 负责两台主机之间的数据传输. 如传输控制协议 (TCP), 能够确保数据可靠的从源主机 发送到目标主机.应用层: 负责应用程序间沟通，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远程访问协议（Telnet）等. 1.2 DNS协议 什么是DNS协议？
DNS(域名系统)协议是一个应用层协议，可以将域名和IP地址相互映射的以层次结构分布的数据库系统，简单来说就是域名和ip之间相互转换的协议。
什么是域名？
比如www.baidu.com ，就是我们经常用的百度的域名，域名主要是为了人们方便记忆而设置的，而在网络传输中，是通过ip寻找主机的而不是域名，所以每一个域名都会对应一个ip ，我们可以通过ping的方式来获取到域名对应的ip：
其中14.215.177.38就是百度的域名对应的ip地址，ping 的时候使用ip地址和使用域名会有同样的效果
1.3 ARP协议 地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。主机发送信息时将包含目标IP地址的ARP请求广播到局域网络上的所有主机，并接收返回消息，以此确定目标的物理地址(MAC)；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。
1.4 NAT技术 NAT是路由器使用的一种技术，NAT能够将私有ip对外通信是转为全局ip，也就是一种将私有ip和全局ip相互转换的一种技术，可以很好地解决ip地址数量不够的问题。
对于NAT还存在着一个问题，就是当同一局域网内，有多个主机都访问同一外网服务器，那么对于服务器返回的数据中，目的ip都是相同的，那么NAT路由器如何判断这个数据包发送给局域网的那个主机？
为了解决这个问题又有了新技术就是NAPT技术，NAPT技术使用ip&#43;端口来建立这个关联关系
2. 输入URL，发送请求流程 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/98b9d9ebe9b6d681e665234a6bed30cd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-26T18:34:23+08:00" />
<meta property="article:modified_time" content="2021-07-26T18:34:23+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【网络基础】浏览器输入一个URL之后，都发生了什么（详细讲解）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>学习目标：</h2> 
<p><font color="#999AAA">目标：掌握网络知识</font></p> 
<hr color="#000000" size='1"'> 
<h2><a id="_5"></a>学习内容：</h2> 
<p><font color="#999AAA">本文内容：详解浏览器输入一个URL之后，都发生了什么</font></p> 
<hr color="#000000" size='1"'> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_0" rel="nofollow">学习目标：</a></li><li><a href="#_5" rel="nofollow">学习内容：</a></li><li><a href="#1_12" rel="nofollow">1.前置知识</a></li><li><ul><li><a href="#11_TCPIP_14" rel="nofollow">1.1 TCP/IP五层模型</a></li><li><a href="#12_DNS_28" rel="nofollow">1.2 DNS协议</a></li><li><a href="#13_ARP_39" rel="nofollow">1.3 ARP协议</a></li><li><a href="#14_NAT_41" rel="nofollow">1.4 NAT技术</a></li></ul> 
  </li><li><a href="#2_URL_45" rel="nofollow">2. 输入URL，发送请求流程</a></li><li><ul><li><a href="#21_46" rel="nofollow">2.1域名解析</a></li><li><a href="#22_48" rel="nofollow">2.2封装</a></li><li><a href="#23_64" rel="nofollow">2.3分用</a></li><li><a href="#24__81" rel="nofollow">2.4 响应</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1_12"></a>1.前置知识</h2> 
<p>想要了解浏览器输入一个URL之后都发生了什么，我们要先认识以下几个知识</p> 
<h3><a id="11_TCPIP_14"></a>1.1 TCP/IP五层模型</h3> 
<p>在这里简单介绍一下TCP/IP的五层模型<br> TCP/IP是一组协议的代名词，他还包括许多协议，组成了TCP/IP协议簇</p> 
<p>TCP/IP通讯协议采用了5层 的层次结构，每一层都呼叫他的下一层所提供的的网络来完成自己的需求，主要分为一下五层</p> 
<blockquote> 
 <ul><li><strong>物理层</strong>: 负责光/电信号的传递方式. 比如现在以太网通用的网线(双绞 线)、早期以太网采用的 的同轴电缆(现在主要用于有线电视)、光纤, 现在的wifi无线网使用电磁波等都属于物理层的概念。物理层的能力决定了最大传输速率、传输距离、抗干扰性等. 集线器(Hub)工作在物理 层.</li><li><strong>数据链路层</strong>: 负责设备之间的数据帧的传送和识别. 例如网卡设备的驱动、帧同步(就是说从网 线上检测到什么信号算作新帧的开始)、冲突检测(如果检测到冲突就自动重发)、数据差错校 验等工作. 有以太网、令牌环网, 无线LAN等标准. 交换机(Switch)工作在数据链路层.</li><li><strong>网络层</strong>: 负责地址管理和路由选择. 例如在IP协议中, 通过IP地址来标识一台主机, 并通过路由表的方式规划出两台主机之间的数据传输的线路(路由). 路由器(Router)工作在网路层.</li><li><strong>传输层</strong>: 负责两台主机之间的数据传输. 如传输控制协议 (TCP), 能够确保数据可靠的从源主机 发送到目标主机.</li><li><strong>应用层</strong>: 负责应用程序间沟通，如简单电子邮件传输（SMTP）、文件传输协议（FTP）、网络远程访问协议（Telnet）等.</li></ul> 
</blockquote> 
<p><img src="https://images2.imgbox.com/97/e0/voXF3WxV_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="12_DNS_28"></a>1.2 DNS协议</h3> 
<p><strong>什么是DNS协议？</strong></p> 
<blockquote> 
 <p>DNS(域名系统)协议是一个应用层协议，可以将域名和IP地址相互映射的以层次结构分布的数据库系统，简单来说就是域名和ip之间相互转换的协议。</p> 
</blockquote> 
<p><strong>什么是域名？</strong></p> 
<blockquote> 
 <p>比如www.baidu.com ，就是我们经常用的百度的域名，域名主要是为了人们方便记忆而设置的，而在网络传输中，是通过ip寻找主机的而不是域名，所以每一个域名都会对应一个ip ，我们可以通过ping的方式来获取到域名对应的ip：<br> <img src="https://images2.imgbox.com/82/c9/Pmhdi0kA_o.png" alt="在这里插入图片描述"><br> 其中14.215.177.38就是百度的域名对应的ip地址，ping 的时候使用ip地址和使用域名会有同样的效果<br> <img src="https://images2.imgbox.com/c0/15/q79um3wy_o.png" alt="在这里插入图片描述"></p> 
</blockquote> 
<h3><a id="13_ARP_39"></a>1.3 ARP协议</h3> 
<p>地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。主机发送信息时将包含目标IP地址的ARP请求广播到局域网络上的所有主机，并接收返回消息，以此确定目标的物理地址(MAC)；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。</p> 
<h3><a id="14_NAT_41"></a>1.4 NAT技术</h3> 
<p>NAT是路由器使用的一种技术，NAT能够将私有ip对外通信是转为全局ip，也就是一种将私有ip和全局ip相互转换的一种技术，可以很好地解决ip地址数量不够的问题。<br> 对于NAT还存在着一个问题，就是当同一局域网内，有多个主机都访问同一外网服务器，那么对于服务器返回的数据中，目的ip都是相同的，那么NAT路由器如何判断这个数据包发送给局域网的那个主机？<br> 为了解决这个问题又有了新技术就是<mark>NAPT技术</mark>，NAPT技术使用ip+端口来建立这个关联关系</p> 
<h2><a id="2_URL_45"></a>2. 输入URL，发送请求流程</h2> 
<h3><a id="21_46"></a>2.1域名解析</h3> 
<p>在浏览器输入一个URL之后，第一步就是基于DNS域名转IP协议获取到请求的IP也就是目的IP</p> 
<h3><a id="22_48"></a>2.2封装</h3> 
<p>得到了目的IP之后，就要对请求的数据进行封装，封装是时从上到下进行封装，封装的顺序就是应用层、传输层、网络层、数据链路层、物理层</p> 
<ol><li>应用层：<br> 当发送一个请求时，第一步封装就是在应用层，在应用层中，会根据应用层的HTTP协议将请求封装成HTPP格式，然后将封装好的数据交给传输层进一步封装</li><li>传输层：<br> 传输层得到应用层封装好的数据之后，传输层基于TCP协议进一步封装，在原有的数据中加上源端口和目的端口，然后发送给网络层</li><li>网络层：<br> 网络层得到传输层的数据之后，基于IP协议继续封装，加上源IP和目的IP，然后发送给数据链路层</li><li>数据链路层：<br> 得到网络层的数据之后基于以太网帧封装，加上帧头和帧尾，其中包含源MAC和目的MAC</li><li>物理层：<br> 将封装好的数据包通过硬件设备传输</li></ol> 
<blockquote> 
 <p>封装的时候时不知道MAC地址的，获取方式就是使用ARP地址解析协议，首先查看目的主机和源主机是否在同一网段，将目的IP和子网掩码按位相与得到网段，如果在同一网段就直接通过ARP获取目的MAC，如果不在同一网段就将数据交给网关处理，使用APR查找网关的MAC，目的MAC就是网关的MAC</p> 
</blockquote> 
<h3><a id="23_64"></a>2.3分用</h3> 
<p>网关得到数据报之后先进行从下到上分用</p> 
<ol><li>数据链路层<br> 在数据链路层解析出数据帧，剥离帧头帧尾，取出IP数据报交给网络层</li><li>网络层<br> 网络层拿到网络层数据报之后，再解析，去掉网络层协议报头，再交给传输层</li><li>传输层<br> 传输层得到传输层协议报之后，解析，去除传输层包头，交给应用层</li><li>应用的得到应用层数据报之后，解析应用层数据包，得到请求内容</li></ol> 
<p>分用完成之后，继续封装，这次封装时，进行以下操作</p> 
<ol><li>要修改源IP、源端口、源MAC、目的MAC</li><li>然后基于NAPT技术，将局域网IP，端口修改为公网IP，端口</li><li>基于路由技术，在路由表中查询下一跳设备IP</li><li>在通过ARP查找MAC地址</li></ol> 
<h3><a id="24__81"></a>2.4 响应</h3> 
<p>在路途中经过的设备，都需要经过以上的封装和分用，最后一步将请求消息成功交给目的主机后，先分用，然后交给目的端口对应的应用程序处理响应<br> 当应用时tomcat时：首先解析HTTP请求，然后判断URL请求的时静态资源还是动态资源</p> 
<ol><li>当请求资源时静态资源时，直接返回静态的响应数据</li><li>当请求时servlet时，首先将HTTP协议数据封装为HTTPServletRequest，然后调用service()方法,调用子类重写的doXXX()方法</li><li>执行完毕之后，tomcat将HTTP响应基于HTTPServletResponse封装</li><li>返回响应，从上到下封装，然后返回响应给请求的主机</li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e0895a143471dfc9f4cb4f747fd774fb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">安装博图v15每次让重启计算机,博途V15.1安装及无限重启和.net3.5SP1错误处理解决方法...</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e40f5edf4448ad8ae8f6e30323fef680/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">有序数组的平方(力扣)（冒泡排序）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>