<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python数据库sqlite3详解 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python数据库sqlite3详解" />
<meta property="og:description" content="提到数据库，大家第一时间想到的可能是 sql 数据库，
这种数据库****非常好用，但是对于新手就不是很容易上手，
需要熟悉一段时间才可以大概掌握。这种数据库在大型的
项目开发过程中用到的地方不会很多，但是一些普通的项目
还是很实用的，大大减少了代码量。
目录
sqlite3数据库
1.需要的模块（只有一个）
2.模块的使用
2.1创建与数据库的连接
2.2创建游标
2.3创建 table
2.4插入数据
2.5查找数据
快乐的coding时间！
最后
sqlite3数据库 sqlite3 数据库是 Python 自带的数据库，甚至不需要额外安装模块，而且操作简单。
Python &#43; Mysql = SQLite
但是这种数据库在网上的教程很少，因为我也是最近才知道，所以找了很长时间的资料，
今天终于找齐了，来总结一下。真的找了好长时间啊
1.需要的模块（只有一个） import sqlite3 2.模块的使用 首先打开我们的编译器（推荐使用vscode，因为数据库文件后缀是 .db，vscode里显示比较清楚）
2.1创建与数据库的连接 先放上代码
conn = sqlite3.connect(&#39;test.db&#39;) 使用 sqlite3 的 connect 函数可以创建数据库或者连接数据库，
如果这个数据库存在，就连接这个数据库，
如果这个库不存在，就创建数据库。
右边小括号里的是数据库名。
我们把这个保存在变量 conn 里，这个变量名可以自己起
公式：
变量名 = sqlite3.connect( &#39;你要的数据库名.db&#39; ) 2.2创建游标 还是先放代码
cur = conn.cursor() 在 2.1 中，我们创建了与数据库的连接，我们现在还需要一个游标来执行 sql 命令，" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/382ce30306c9de56b2791261c37e9e14/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-29T20:01:41+08:00" />
<meta property="article:modified_time" content="2022-07-29T20:01:41+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python数据库sqlite3详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p><strong>提到<strong><strong>数据库</strong></strong>，大家第一时间想到的可能是</strong> <strong>sql 数据库</strong>，</p> 
 <p><strong>这种数据库****非常好用，但是对于新手就不是很容易上手</strong>，</p> 
 <p><strong>需要熟悉一段时间才可以大概掌握。这种数据库在大型的</strong></p> 
 <p><strong>项目开发过程中用到的地方不会很多，但是一些普通的项目</strong></p> 
 <p><strong>还是很实用的，大大减少了代码量。</strong></p> 
</blockquote> 
<p><strong>目录</strong></p> 
<p><a href="#sqlite3%E6%95%B0%E6%8D%AE%E5%BA%93" rel="nofollow">sqlite3数据库</a></p> 
<p><a href="#1.%E9%9C%80%E8%A6%81%E7%9A%84%E6%A8%A1%E5%9D%97%EF%BC%88%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%EF%BC%89" rel="nofollow">1.需要的模块（只有一个）</a></p> 
<p><a href="#2.%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8" rel="nofollow">2.模块的使用</a></p> 
<p><a href="#2.1%E5%88%9B%E5%BB%BA%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E8%BF%9E%E6%8E%A5" rel="nofollow">2.1创建与数据库的连接</a></p> 
<p><a href="#2.2%E5%88%9B%E5%BB%BA%E6%B8%B8%E6%A0%87" rel="nofollow">2.2创建游标</a></p> 
<p><a href="#2.3%E5%88%9B%E5%BB%BA%20table" rel="nofollow">2.3创建 table</a></p> 
<p><a href="#2.4%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE" rel="nofollow">2.4插入数据</a></p> 
<p><a href="#2.5%E6%9F%A5%E6%89%BE%E6%95%B0%E6%8D%AE" rel="nofollow">2.5查找数据</a></p> 
<p><a href="#%E5%BF%AB%E4%B9%90%E7%9A%84coding%E6%97%B6%E9%97%B4%EF%BC%81" rel="nofollow">快乐的coding时间！</a></p> 
<p><a href="#%E6%9C%80%E5%90%8E" rel="nofollow">最后</a></p> 
<hr> 
<h2><a id="sqlite3_36"></a>sqlite3数据库</h2> 
<p><img src="https://images2.imgbox.com/97/18/TBa9VR31_o.jpg" alt=""></p> 
<p>sqlite3 数据库是 Python 自带的数据库，甚至不需要额外安装模块，而且操作简单。</p> 
<p>Python + Mysql = SQLite</p> 
<p><img src="https://images2.imgbox.com/32/1f/02KwqeL8_o.jpg" alt=""></p> 
<p><img src="https://images2.imgbox.com/bc/e0/0VgBNCJ9_o.jpg" alt=""></p> 
<p>但是这种数据库在网上的教程很少，因为我也是最近才知道，所以找了很长时间的资料，</p> 
<p>今天终于找齐了，来总结一下。真的找了好长时间啊</p> 
<h3><a id="1_53"></a>1.需要的模块（只有一个）</h3> 
<pre><code>import sqlite3
</code></pre> 
<h3><a id="2_58"></a>2.模块的使用</h3> 
<p>首先打开我们的编译器（推荐使用vscode，因为数据库文件后缀是 .db，vscode里显示比较清楚）</p> 
<h4><a id="21_63"></a>2.1创建与数据库的连接</h4> 
<p>先放上代码</p> 
<pre><code>conn = sqlite3.connect('test.db')
</code></pre> 
<p>使用 sqlite3 的 <strong>connect</strong> 函数可以创建数据库或者连接数据库，</p> 
<p>如果这个数据库存在，就连接这个数据库，</p> 
<p>如果这个库不存在，就创建数据库。</p> 
<p>右边小括号里的是数据库名。</p> 
<p>我们把这个保存在变量 conn 里，这个变量名可以自己起</p> 
<p><strong>公式：</strong></p> 
<pre><code>变量名 = sqlite3.connect( '你要的数据库名.db' )
</code></pre> 
<h4><a id="22_83"></a>2.2创建游标</h4> 
<p>还是先放代码</p> 
<pre><code>cur = conn.cursor()
</code></pre> 
<p>在 2.1 中，我们创建了与数据库的连接，我们现在还需要一个游标来执行 sql 命令，</p> 
<p>所以我们要用 conn 的 cursor 函数创建一个游标。</p> 
<p>conn 就是刚才 2.1 中创建的保存数据库的变量，你要用你定义的变量名，</p> 
<p>再定义一个变量表示这个游标。</p> 
<p>公式：</p> 
<pre><code>变量 = 数据库变量.cursor()
</code></pre> 
<h4><a id="23_table_101"></a>2.3创建 table</h4> 
<p>先放代码</p> 
<pre><code>import sqlite3
def check(db_name,table_name):
    conn = sqlite3.connect(db_name)
    cursor = conn.cursor()
    sql = '''SELECT tbl_name FROM sqlite_master WHERE type = 'table' '''
    cursor.execute(sql)
    values = cursor.fetchall()
    tables = []
    for v in values:
        tables.append(v[0])
    if table_name not in tables:
        return False # 可以建表
    else:
        return True # 不能建表
conn = sqlite3.connect('数据库名.db')
#创建一个游标 cursor
cur = conn.cursor()
if (check("数据库名.db","Table名") == False):
    sql_text_1 = '''CREATE TABLE 你的table名
            (xx XX,
                xx XX);'''
    # 执行sql语句
    cur.execute(sql_text_1)
</code></pre> 
<p>代码比较长，因为我把 2.1 和 2.2 的两行代码也加了上去。</p> 
<p>我们需要 table（表）来存数据，创建 table 的代码如下：</p> 
<pre><code>变量名 = '''CREATE TABLE 你的table名
            (xx XX,
                xx XX);'''
# 执行sql语句
cur.execute(上面的变量名)
</code></pre> 
<p>上面是用一个变量保存了创建 table 的 sql 语句，</p> 
<p>下面使用 cur（就是刚才那个游标）.execute() 函数执行创建 table 的语句。</p> 
<p>我们也可以使用 cur.executemany 函数来同时执行多条 sql 语句。</p> 
<p>sql 语句的内容，比如创建表的格式是上面这样的</p> 
<p><strong>格式：’ ’ ‘CREATE TABLE 你的 table 名 (xx XX, xx XX);’ ’ ’</strong></p> 
<p>这行代码里小写的 xx 就是你要的<strong>属性名</strong>，比如你的数据库是这样</p> 
<p>姓名</p> 
<p>班级</p> 
<p>张三</p> 
<p>1</p> 
<p>其中，<strong>属性名就是 “姓名” 和 “班级”，</strong></p> 
<p>小写的 xx 就应该分别写姓名和班级（注意，不带引号）</p> 
<p>后面的大写的XX就是这个属性所接受的数据的类型，</p> 
<p>就相当于Python中的 int 类型和 str 类型。</p> 
<p>只不过，我们在 sql 语句中，<strong>把 int 类型改成了 NUMBER，把 str 类型改成了 TEXT</strong>。</p> 
<p>当我们运行这个代码，我们的文件夹目录里会多出来一个 你的数据库名.db 文件</p> 
<p>当我们再次运行，会发现程序<strong>报错</strong>了。</p> 
<p>报错信息的大概意思是：table 已经存在了。</p> 
<p><strong>这是因为我们第一次运行时已经创建了 table ，我们再次运行时，</strong></p> 
<p><strong>程序会再次创建同名 table，就会报错。</strong></p> 
<p><strong>所以，我们创建 table 之前要判断一下这个table存不存在，如果存在就不创建，如果不存在就创建</strong></p> 
<p><strong>这个判断我把它写成了一个函数，就是我上面代码那个 check 函数。</strong></p> 
<p><strong>这一步也是我想了好长时间，还找资料找了好长时间才知道的</strong></p> 
<h4><a id="24_185"></a>2.4插入数据</h4> 
<p>先放代码</p> 
<pre><code>cur.executemany('INSERT INTO 你的table名 VALUES (?,?)', data)
conn.commit()
</code></pre> 
<p>其中<strong>第一行代码中 executemany() 函数的意思就是同时执行多个 sql 语句。</strong></p> 
<p>这个函数的括号里写的逗号前面就是插入数据的 sql 语句，后面 data 可以是一个列表或者元组。注意，如果是列表的话，必须是列表里面有若干个元组的形式。</p> 
<p>插入数据的 sql 语句的使用：</p> 
<p><strong>INSERT INTO 你的table名 VALUES (若干个逗号，用逗号分割)</strong></p> 
<p>这里我们要插入 data 这些数据，所以在括号里我们使用问号 “” 来代替这个元素。</p> 
<p>大家可以回去看一下 2.3 创建table 的讲解，在2.3中，我们创建了两个属性，分别是 “姓名” 和 “班级”。因为我们有两个属性，所以要有<strong>两个</strong>问号。</p> 
<h4><a id="25_204"></a>2.5查找数据</h4> 
<p>先放代码</p> 
<pre><code>def find_tb():
    cur.execute("select * from 你的table名")
    # 提取查询到的数据
    return cur.fetchall()
</code></pre> 
<p>这个就很简单了，我写这个函数使用时可以把你那个table里的所有数据都取出来。</p> 
<p>第一行是查找table的 sql 语句，格式是：</p> 
<p><strong>select * from 你的table名</strong></p> 
<p>下一行再用 fetchall() 函数把数据提取出来，直接 return 即可。</p> 
<h2><a id="coding_221"></a>快乐的coding时间！</h2> 
<p>好了，前面的东西大家应该也都看完了，来点 demo ？</p> 
<p>顺便说一下，我这个 demo 的灵感来源是最近在网上刷到很多高考查分的视频，恰好最近在做这个数据库，所以说我这个 demo 受考试的启发，就做了一个学生分数系统，其实这个特别爽，可以把自己的分数改成全部满分！虽然实际没啥用，但是还是很爽的</p> 
<p><img src="https://images2.imgbox.com/2e/af/VwYiimu0_o.jpg" alt=""></p> 
<p>代码里没有我没讲过的部分，大家可以对照上面的讲解看代码，VScode无报错运行。</p> 
<p>对了，如果有看不懂的可以私信我，不出意外的话一天之内就能回复。</p> 
<p>代码：</p> 
<pre><code>import sqlite3
import os
def check(db_name,table_name):
    conn = sqlite3.connect(db_name)
    cursor = conn.cursor()
    sql = '''SELECT tbl_name FROM sqlite_master WHERE type = 'table' '''
    cursor.execute(sql)
    values = cursor.fetchall()
    tables = []
    for v in values:
        tables.append(v[0])
    if table_name not in tables:
        return False # 可以建表
    else:
        return True # 不能建表
def find_tb():
    cur.execute("select * from scores")
    # 提取查询到的数据
    return cur.fetchall()
def zcd():
    os.system('cls')
    print("学生分数管理系统")
    print("1.增加学生分数信息")
    print("2.查看全部学生分数")
    print("3.查询分数段内学生分数")
    print("4.退出")

if __name__ == '__main__':
    # 创建与数据库的连接
    conn = sqlite3.connect('stuents_scores.db')
    #创建一个游标 cursor
    cur = conn.cursor()
    # 如果没有表则执行建表的sql语句
    if (check("stuents_scores.db","scores") == False):
        sql_text_1 = '''CREATE TABLE scores
                (姓名 TEXT,
                    班级 TEXT,
                    性别 TEXT,
                    语文 NUMBER,
                    数学 NUMBER,
                    英语 NUMBER,
                    总分 NUMBER);'''
        # 执行sql语句
        cur.execute(sql_text_1)
    zcd()
    while True:
        op = int(input("请输入:"))
        if op == 1:
            S_name = input("请输入要添加的学生的姓名(如:张三):")
            S_class = input("请输入要添加的学生的班级(如:一班):")
            S_xb = input("请输入该学生性别:")
            S_Chinese = int(input("请输入该学生语文成绩(只输入一个数字,如:82):"))
            S_Maths = int(input("请输入该学生数学成绩(只输入一个数字,如:95):"))
            S_English = int(input("请输入该学生英语成绩(只输入一个数字,如:98):"))
            S_gj = S_Maths+S_Chinese+S_English # 总分
            data = [(S_name, S_class, S_xb, S_Chinese, S_Maths, S_English,S_gj)]
            cur.executemany('INSERT INTO scores VALUES (?,?,?,?,?,?,?)', data)
            conn.commit()
            # cur.close()
            # conn.close()
            print("成功!")
            os.system('pause')
            os.system('cls')
            zcd()
        elif op == 2:
            info_list = find_tb()
            print("全部学生信息(排名不分前后):")
            for i in range(len(info_list)):
                print("第"+str(i+1)+"个:")
                print("学生姓名:"+str(info_list[i][0]))
                print("学生班级:"+str(info_list[i][1]))
                print("学生性别:"+str(info_list[i][2]))
                print("学生语文成绩:"+str(info_list[i][3]))
                print("学生数学成绩:"+str(info_list[i][4]))
                print("学生英语成绩:"+str(info_list[i][5]))
                print("学生总成绩:"+str(info_list[i][6]))
                os.system('pause')
                os.system('cls')
                zcd()
        elif op == 3:
            info_list = find_tb()
            fen = int(input("你要要查询总成绩高于n分的学生, 请输入n:"))
            for i in range(len(info_list)):
                if info_list[i][6] &gt;= fen:
                    print("查询结果:")
                    print("第"+str(i+1)+"个:")
                    print("学生总成绩:"+str(info_list[i][6]))
            os.system('pause')
            os.system('cls')
            zcd()
        elif op == 4:
            os.system('cls')
            break
</code></pre> 
<h2><a id="_332"></a>最后</h2> 
<blockquote> 
 <p>经典结束表情包走起！</p> 
 <p><img src="https://images2.imgbox.com/ab/66/GdSeUWVa_o.png" alt=""></p> 
 <p>3必回~</p> 
</blockquote> 
<p>先自我介绍一下，小编13年上师交大毕业，曾经在小公司待过，去过华为OPPO等大厂，18年进入阿里，直到现在。深知大多数初中级java工程师，想要升技能，往往是需要自己摸索成长或是报班学习，但对于培训机构动则近万元的学费，着实压力不小。自己不成体系的自学效率很低又漫长，而且容易碰到天花板技术停止不前。因此我收集了一份《java开发全套学习资料》送给大家，初衷也很简单，就是希望帮助到想自学又不知道该从何学起的朋友，同时减轻大家的负担。添加下方名片，即可获取全套学习资料哦</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5b0b3996a9bdc30f90ef5a94656894eb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unity场景优化工具：Mesh Baker 基础教程（贴图篇）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8d18f1706ddbb68d9e3f7617e471c8d6/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">nodeJs--fs模块</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>