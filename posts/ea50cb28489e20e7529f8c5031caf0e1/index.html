<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>PDF转OFD ~java实现 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="PDF转OFD ~java实现" />
<meta property="og:description" content="PDF转OFD ~java实现 上篇文章记录了一下我第一次对接“超阅云”实现了ofd转pdf功能，想了想，还是再写一篇pdf转ofd的实现，其实对接的API基本一样，如果你是第一次看，建议先看看上一篇文章-“ofd转pdf”
————————————————
准备工作 登录注册超阅云开发者账号，可直接微信扫码登录注册，一键搞定
进入个人中心，获取API开放秘钥
开始开发 1、接口概述
（1）采用HTTP接口模式，编码UTF-8
（2）接口地址： https://surread.esign.cn
（3）接口请求前必须先申请成为开发者，并获取accessKey和secretKey
（4）接口请求头需要带上鉴权参数Authorization ，详情见“鉴权方式&#34;
2、鉴权方式
（1）鉴权规则
第一步：参数签名signature
MD5(post &#43; url &#43; 请求时间戳 &#43; 请求随机串 &#43; MD5(ak&#43;sk))
第二步：base64加密 Authorization
base64(method=post,url=xxx,timestamp=xxx,nonce_str=xxx,ak=%s,signature=xxx)
第三步： 将生成的Authorization作为参数放到请求头中
（2）代码示例
import cn.hutool.core.codec.Base64; import cn.hutool.core.util.RandomUtil; import cn.hutool.crypto.digest.DigestAlgorithm; import cn.hutool.crypto.digest.Digester; public class AuthorizationUtil { public static void main(String[] args) { String ak = &#34;开发者标识&#34;; String sk = &#34;开发者秘钥&#34;; // 生成 String requestMethod = &#34;post&#34;.toUpperCase(); String url = &#34;/api/developer/convert/pdf2ofd&#34;; Long timestamp = System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ea50cb28489e20e7529f8c5031caf0e1/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-21T18:03:48+08:00" />
<meta property="article:modified_time" content="2022-11-21T18:03:48+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PDF转OFD ~java实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="PDFOFD_java_0"></a>PDF转OFD ~java实现</h2> 
<p>上篇文章记录了一下我第一次对接“超阅云”实现了ofd转pdf功能，想了想，还是再写一篇pdf转ofd的实现，其实对接的API基本一样，如果你是第一次看，建议先看看上一篇文章-“<a href="http://t.csdn.cn/JcMHs" rel="nofollow">ofd转pdf</a>”</p> 
<p>————————————————</p> 
<h3><a id="_6"></a>准备工作</h3> 
<ol><li> <p><a href="https://ofd.esign.cn/" rel="nofollow">登录注册超阅云开发者账号</a>，可直接微信扫码登录注册，一键搞定</p> </li><li> <p>进入个人中心，获取API开放秘钥</p> </li></ol> 
<h3><a id="_11"></a>开始开发</h3> 
<p>1、接口概述<br> （1）采用HTTP接口模式，编码UTF-8<br> （2）接口地址： https://surread.esign.cn<br> （3）接口请求前必须先申请成为开发者，并获取accessKey和secretKey<br> （4）接口请求头需要带上鉴权参数Authorization ，详情见“鉴权方式"</p> 
<p>2、鉴权方式<br> （1）鉴权规则<br> 第一步：参数签名signature<br> MD5(post + url + 请求时间戳 + 请求随机串 + MD5(ak+sk))<br> 第二步：base64加密 Authorization<br> base64(method=post,url=xxx,timestamp=xxx,nonce_str=xxx,ak=%s,signature=xxx)<br> 第三步： 将生成的Authorization作为参数放到请求头中<br> （2）代码示例</p> 
<pre><code>import cn.hutool.core.codec.Base64;
import cn.hutool.core.util.RandomUtil;
import cn.hutool.crypto.digest.DigestAlgorithm;
import cn.hutool.crypto.digest.Digester;

public class AuthorizationUtil {

    public static void main(String[] args) {

        String ak = "开发者标识";
        String sk = "开发者秘钥";
        // 生成
        String requestMethod = "post".toUpperCase();
        String url = "/api/developer/convert/pdf2ofd";
        Long timestamp = System.currentTimeMillis();
        String randomStr = RandomUtil.randomString(20);
        String authorization = generateAuthorization(requestMethod,url,timestamp,randomStr,ak,sk);
        System.out.println("生成:"+authorization);
    }

    public static String generateAuthorization(String requestMethod, String url, Long timestamp, String randomStr, String ak, String sk){
        Digester md5 = new Digester(DigestAlgorithm.MD5);
        // signature = MD5(requestMethod + url + 请求时间戳 + 请求随机串 + MD5(ak+sk))
        String signature = md5.digestHex(requestMethod+url+timestamp+randomStr+md5.digestHex(ak+sk));
        //   Authorization = base64(method=xxx,url=xxx,timestamp=xxx,nonce_str=xxx,ak=xxx,signature=xxx)
        return Base64.encode(String.format("method=%s,url=%s,timestamp=%s,nonce_str=%s,ak=%s,signature=%s",requestMethod,url,timestamp,randomStr,ak,signature));
    }
}
</code></pre> 
<p>（2）一些踩坑：<br> 鉴权方式其实就是base64+Md5的结合，这里我引了一个hutool工具包，挺好用的，大家也可以试试<br> 鉴权参数主要是不同的接口url参数对应的就是接口的url</p> 
<h3><a id="APIPOST_59"></a>API测试POST</h3> 
<p>postman调用测试</p> 
<pre><code>curl --location --request POST 'https://surread.esign.cn/api/developer/convert/pdf2ofd' \
--header 'Authorization: bWV0aG9kPVBPU1QsdXJsPS9hcGkvZGV2ZWxvcGVyL2NvbnZlcnQvb2ZkMnBkZix0aW1lc3RhbXA9MTY2ODQ5Mjg1NTI3Nyxub25jZV9zdHI9cnZsaXY1emY0bjByOWdqeGx6dW4sYWs9b3NlZjA2NGtjdnA1MzJ6a2k1dnYyaTJicGwzOHJyam4sc2lnbmF0dXJlPTAwZWRlOTY4YzNhMmM0MGY1ZTcwXXXXXXXXXX' \
--form 'file=@"/C:/Users/DESKTOP-J21/Documents/pdf/PFD小文档.pdf"'
</code></pre> 
<p><img src="https://images2.imgbox.com/2e/5e/S54gYI7t_o.png" alt="在这里插入图片描述"></p> 
<p>！！！注意： 同样再调用下载/预览文件的API接口去获取或者预览转换后的文档<br> 获取文档下载地址： /api/developer/convert/getDownUrlByFileKey<br> 获取文档预览地址： /api/developer/convert/getPreviewUrlByFileKey<br> 详细接口文档可以参考“超阅云”官网的<a href="https://ofd.esign.cn/develop/doc/index" rel="nofollow">文档介绍</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6246b7cf4aceed78528c18dfa27cfd36/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">[Java反序列化]—SnakeYaml反序列化</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7545f57245de1437505ad6897d4a8d22/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">OFD转PDF ~java实现</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>