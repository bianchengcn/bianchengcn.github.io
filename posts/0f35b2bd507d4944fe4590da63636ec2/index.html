<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>机器学习4-多元线性回归 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="机器学习4-多元线性回归" />
<meta property="og:description" content="多元线性回归(Multiple Linear Regression)是线性回归的一种扩展形式，用于建立因变量与多个自变量之间的关系。在简单线性回归中，我们考虑一个因变量和一个自变量之间的线性关系，而多元线性回归允许我们考虑多个自变量对因变量的影响。
一般的多元线性回归模型的数学表达式如下：
其中：
Y 是因变量（要预测的目标）。X1​,X2​,…,Xn​ 是自变量（特征）。β0​ 是截距（模型在X1​,X2​,…,Xn​ 都为0时的预测值）。β1​,β2​,…,βn​ 是各自变量的回归系数，表示自变量对因变量的影响。ε 是误差项，表示模型无法捕捉到的影响因素和随机误差。 多元线性回归的目标是找到合适的回归系数 β0​,β1​,…,βn​ 来最小化实际观测值 Y 与模型预测值之间的误差，通常使用最小二乘法进行优化。
模型训练后，可以使用这个模型进行预测。当有新的自变量值 X1​,X2​,…,Xn​ 时，通过带入这些值，就可以预测相应的因变量值 Y。
多元线性回归在实际应用中非常常见，例如在经济学中预测商品销售额，医学中预测疾病发生率，工程学中预测产品性能等。
需求：
根据现有数据预测公司的利润
数据示例：
R&amp;D SpendAdministrationMarketing SpendStateProfit165349.2136897.8471784.1New York192261.83162597.7151377.59443898.53California191792.06 程序：
## Step 1: Data Preprocessing ### Importing the libraries import pandas as pd import matplotlib.pyplot as plt import numpy as np ### Importing the dataset dataset = pd.read_csv(&#39;50_Startups.csv&#39;) X = dataset.iloc[:, :-1].values Y = dataset.iloc[:, 4].values ### Encoding Categorical data from sklearn." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0f35b2bd507d4944fe4590da63636ec2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-31T09:41:39+08:00" />
<meta property="article:modified_time" content="2024-01-31T09:41:39+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">机器学习4-多元线性回归</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><strong>多元线性回归</strong>(Multiple Linear Regression)是线性回归的一种扩展形式，用于建立因变量与多个自变量之间的关系。在简单线性回归中，我们考虑一个因变量和一个自变量之间的线性关系，而多元线性回归允许我们考虑多个自变量对因变量的影响。</p> 
<p>一般的多元线性回归模型的数学表达式如下：</p> 
<p><img alt="Y=\beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}+...++\beta_{n}X_{n}+\varepsilon" class="mathcode" src="https://images2.imgbox.com/1d/97/FHq9AQ1a_o.png"></p> 
<p>其中：</p> 
<ul><li><em>Y</em> 是因变量（要预测的目标）。</li><li><em>X</em>1​,<em>X</em>2​,…,<em>Xn</em>​ 是自变量（特征）。</li><li><em>β</em>0​ 是截距（模型在<em>X</em>1​,<em>X</em>2​,…,<em>Xn</em>​ 都为0时的预测值）。</li><li><em>β</em>1​,<em>β</em>2​,…,<em>βn</em>​ 是各自变量的回归系数，表示自变量对因变量的影响。</li><li><em>ε</em> 是误差项，表示模型无法捕捉到的影响因素和随机误差。</li></ul> 
<p>多元线性回归的目标是找到合适的回归系数 <em>β</em>0​,<em>β</em>1​,…,<em>βn</em>​ 来最小化实际观测值 <em>Y</em> 与模型预测值之间的误差，通常使用最小二乘法进行优化。</p> 
<p>模型训练后，可以使用这个模型进行预测。当有新的自变量值 <em>X</em>1​,<em>X</em>2​,…,<em>Xn</em>​ 时，通过带入这些值，就可以预测相应的因变量值 <em>Y</em>。</p> 
<p>多元线性回归在实际应用中非常常见，例如在经济学中预测商品销售额，医学中预测疾病发生率，工程学中预测产品性能等。</p> 
<p></p> 
<p><strong>需求：</strong></p> 
<p>根据现有数据预测公司的利润</p> 
<p></p> 
<p><strong>数据示例：</strong></p> 
<table><tbody><tr><th>R&amp;D Spend</th><th>Administration</th><th>Marketing Spend</th><th>State</th><th>Profit</th></tr><tr><td>165349.2</td><td>136897.8</td><td>471784.1</td><td>New York</td><td>192261.83</td></tr><tr><td>162597.7</td><td>151377.59</td><td>443898.53</td><td>California</td><td>191792.06</td></tr></tbody></table> 
<p></p> 
<p><strong>程序：</strong></p> 
<pre><code class="language-python">## Step 1: Data Preprocessing

### Importing the libraries
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

### Importing the dataset
dataset = pd.read_csv('50_Startups.csv')
X = dataset.iloc[:, :-1].values
Y = dataset.iloc[:, 4].values

### Encoding Categorical data
from sklearn.preprocessing import LabelEncoder, OneHotEncoder
from sklearn.compose import ColumnTransformer

labelencoder = LabelEncoder()
X[:, 3] = labelencoder.fit_transform(X[:, 3])

# Use ColumnTransformer for one-hot encoding
ct = ColumnTransformer(
    transformers=[
        ('onehot', OneHotEncoder(), [3])  # Apply one-hot encoding to column 3
    ],
    remainder='passthrough'  # Keep the rest of the columns unchanged
)

X = np.array(ct.fit_transform(X), dtype=np.float64)

### Avoiding Dummy Variable Trap
X = X[:, 1:]

### Splitting the dataset into the Training set and Test set
from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=0)

## Step 2: Fitting Multiple Linear Regression to the Training set
from sklearn.linear_model import LinearRegression
regressor = LinearRegression()
regressor.fit(X_train, Y_train)


## Step 3: Predicting the Test set results
Y_pred = regressor.predict(X_test)

print(Y_pred)

# Step 4: Visualizing the results
plt.scatter(Y_test, Y_pred, color='blue')
plt.plot([min(Y_test), max(Y_test)], [min(Y_test), max(Y_test)], linestyle='--', color='red', linewidth=2, label='Regression Line')

plt.title('Actual vs Predicted Profit')
plt.xlabel('Actual Profit')
plt.ylabel('Predicted Profit')
plt.show()</code></pre> 
<p></p> 
<p><strong>结果：</strong></p> 
<p></p> 
<p class="img-center"><img alt="" height="480" src="https://images2.imgbox.com/22/8d/WALNs5ut_o.png" width="640"></p> 
<p><strong>结论：</strong></p> 
<p>10个结果数据的预测值与真实值相差不多，大体落在<strong>线性回归模型</strong>的范围内。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a6ad86adecc341e4e2d0e078242f960/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">指剑邀请你参与【腾讯2024技术答人挑战赛】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/494b2807a244b926c5cc457ebca81376/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">腾讯云SSL证书在阿里云添加域名DNS解析</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>