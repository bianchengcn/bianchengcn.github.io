<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>看书标记【R语言数据分析与挖掘实战】5 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="看书标记【R语言数据分析与挖掘实战】5" />
<meta property="og:description" content="第五章 挖掘模型 5.1 分类预测 回归分析：回归分析是确定预测属性（数值型）与其他变量间相互依赖的定量。关系的最常用的统计学方法。包括线性回归、非线性回归、Logistic回归（因变量有0-1两种取值）、岭回归（自变量间有多重共线性）、主成分回归（自变量间有多重共线性）、偏最小二乘回归等模型。
# 设置工作空间 # 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间 setwd(&#34;F:/数据及程序/chapter5/示例程序&#34;) # 读入数据 Data &lt;- read.csv(&#34;./data/bankloan.csv&#34;)[2:701, ] # 数据命名 colnames(Data) &lt;- c(&#34;x1&#34;, &#34;x2&#34;, &#34;x3&#34;, &#34;x4&#34;, &#34;x5&#34;, &#34;x6&#34;, &#34;x7&#34;, &#34;x8&#34;, &#34;y&#34;) # logistic回归模型 glm &lt;- glm(y ~ x1 &#43; x2 &#43; x3 &#43; x4 &#43; x5 &#43; x6 &#43; x7 &#43; x8, family = binomial(link = logit), data = Data) summary(glm) # 逐步寻优法 logit.step &lt;- step(glm, direction = &#34;both&#34;) summary(logit.step) # 前向选择法 logit." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ed52fa314b03bcf41179d4e84b94687c/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-26T17:42:01+08:00" />
<meta property="article:modified_time" content="2023-03-26T17:42:01+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">看书标记【R语言数据分析与挖掘实战】5</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="___0"></a>第五章 挖掘模型</h2> 
<h3><a id="51__1"></a>5.1 分类预测</h3> 
<p><strong>回归分析</strong>：回归分析是确定预测属性（数值型）与其他变量间相互依赖的定量。关系的最常用的统计学方法。包括线性回归、非线性回归、Logistic回归（因变量有0-1两种取值）、岭回归（自变量间有多重共线性）、<em>主成分回归</em>（自变量间有多重共线性）、偏最小二乘回归等模型。</p> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
Data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/bankloan.csv"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">701</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
<span class="token comment"># 数据命名</span>
colnames<span class="token punctuation">(</span>Data<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"x1"</span><span class="token punctuation">,</span> <span class="token string">"x2"</span><span class="token punctuation">,</span> <span class="token string">"x3"</span><span class="token punctuation">,</span> <span class="token string">"x4"</span><span class="token punctuation">,</span> <span class="token string">"x5"</span><span class="token punctuation">,</span> <span class="token string">"x6"</span><span class="token punctuation">,</span> <span class="token string">"x7"</span><span class="token punctuation">,</span> <span class="token string">"x8"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
<span class="token comment"># logistic回归模型</span>
glm <span class="token operator">&lt;-</span> glm<span class="token punctuation">(</span>y <span class="token operator">~</span> x1 <span class="token operator">+</span> x2 <span class="token operator">+</span> x3 <span class="token operator">+</span> x4 <span class="token operator">+</span> x5 <span class="token operator">+</span> x6 <span class="token operator">+</span> x7 <span class="token operator">+</span> x8<span class="token punctuation">,</span>
           family <span class="token operator">=</span> binomial<span class="token punctuation">(</span>link <span class="token operator">=</span> logit<span class="token punctuation">)</span><span class="token punctuation">,</span> data <span class="token operator">=</span> Data<span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>glm<span class="token punctuation">)</span>
<span class="token comment"># 逐步寻优法</span>
logit.step <span class="token operator">&lt;-</span> step<span class="token punctuation">(</span>glm<span class="token punctuation">,</span> direction <span class="token operator">=</span> <span class="token string">"both"</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>logit.step<span class="token punctuation">)</span>
<span class="token comment"># 前向选择法</span>
logit.step <span class="token operator">&lt;-</span> step<span class="token punctuation">(</span>glm<span class="token punctuation">,</span> direction <span class="token operator">=</span> <span class="token string">"forward"</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>logit.step<span class="token punctuation">)</span>
<span class="token comment"># 后向选择法</span>
logit.step <span class="token operator">&lt;-</span> step<span class="token punctuation">(</span>glm<span class="token punctuation">,</span> direction <span class="token operator">=</span> <span class="token string">"backward"</span><span class="token punctuation">)</span>
summary<span class="token punctuation">(</span>logit.step<span class="token punctuation">)</span>
</code></pre> 
<p><strong>决策树</strong>：它采用自顶向下的<em>递归方式</em>，在决策树的内部结点进行属性值的比较，并根据不同的属性值从该结点向下分支，叶结点是要学习划分的类。<br> 在各个决策点上使用信息熵作为属性额选择标准，<strong>C4.5</strong>和<strong>CART算法</strong>是<strong>ID3算法</strong>的改进，后两种可以还可以描述连续属性。</p> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/sales_data.csv"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token comment"># 数据命名</span>
colnames<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"x1"</span><span class="token punctuation">,</span> <span class="token string">"x2"</span><span class="token punctuation">,</span> <span class="token string">"x3"</span><span class="token punctuation">,</span> <span class="token string">"result"</span><span class="token punctuation">)</span>
<span class="token comment"># 计算一列数据的信息熵</span>
calculateEntropy <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  t <span class="token operator">&lt;-</span> table<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    
  sum <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>t<span class="token punctuation">)</span>       
  t <span class="token operator">&lt;-</span> t<span class="token punctuation">[</span>t <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">]</span>        
  entropy <span class="token operator">&lt;-</span> <span class="token operator">-</span>sum<span class="token punctuation">(</span>log2<span class="token punctuation">(</span>t <span class="token operator">/</span> sum<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>t <span class="token operator">/</span> sum<span class="token punctuation">)</span><span class="token punctuation">)</span>
  return<span class="token punctuation">(</span>entropy<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment"># 计算两列数据的信息熵</span>
calculateEntropy2 <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  var <span class="token operator">&lt;-</span> table<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  p <span class="token operator">&lt;-</span> var<span class="token operator">/</span>sum<span class="token punctuation">(</span>var<span class="token punctuation">)</span>
  varnames <span class="token operator">&lt;-</span> names<span class="token punctuation">(</span>var<span class="token punctuation">)</span>
  array <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> varnames<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    array <span class="token operator">&lt;-</span> append<span class="token punctuation">(</span>array<span class="token punctuation">,</span> calculateEntropy<span class="token punctuation">(</span>subset<span class="token punctuation">(</span>data<span class="token punctuation">,</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> name<span class="token punctuation">,</span>
                                                   select <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  return<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>array <span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

buildTree <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>length<span class="token punctuation">(</span>unique<span class="token punctuation">(</span>data<span class="token operator">$</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    cat<span class="token punctuation">(</span>data<span class="token operator">$</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    return<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>length<span class="token punctuation">(</span>names<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    cat<span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span>
    return<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  entropy <span class="token operator">&lt;-</span> calculateEntropy<span class="token punctuation">(</span>data<span class="token operator">$</span>result<span class="token punctuation">)</span>  
  labels <span class="token operator">&lt;-</span> names<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  label <span class="token operator">&lt;-</span> <span class="token string">""</span>
  temp <span class="token operator">&lt;-</span> <span class="token number">Inf</span>
  subentropy <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token punctuation">(</span>length<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    temp2 <span class="token operator">&lt;-</span> calculateEntropy2<span class="token punctuation">(</span>data<span class="token punctuation">[</span>c<span class="token punctuation">(</span>i<span class="token punctuation">,</span> length<span class="token punctuation">(</span>labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>temp2 <span class="token operator">&lt;</span> temp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>         
      temp <span class="token operator">&lt;-</span> temp2          
      label <span class="token operator">&lt;-</span> labels<span class="token punctuation">[</span>i<span class="token punctuation">]</span>      
    <span class="token punctuation">}</span>
    subentropy <span class="token operator">&lt;-</span> append<span class="token punctuation">(</span>subentropy<span class="token punctuation">,</span>temp2<span class="token punctuation">)</span>  
  <span class="token punctuation">}</span>
  cat<span class="token punctuation">(</span>label<span class="token punctuation">)</span>
  cat<span class="token punctuation">(</span><span class="token string">"["</span><span class="token punctuation">)</span>
  nextLabels <span class="token operator">&lt;-</span> labels<span class="token punctuation">[</span>labels <span class="token operator">!=</span> label<span class="token punctuation">]</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>value <span class="token keyword">in</span> unlist<span class="token punctuation">(</span>unique<span class="token punctuation">(</span>data<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    cat<span class="token punctuation">(</span>value<span class="token punctuation">,</span><span class="token string">":"</span><span class="token punctuation">)</span>
    buildTree<span class="token punctuation">(</span>subset<span class="token punctuation">(</span>data<span class="token punctuation">,</span>data<span class="token punctuation">[</span>label<span class="token punctuation">]</span> <span class="token operator">==</span> value<span class="token punctuation">,</span> select <span class="token operator">=</span> nextLabels<span class="token punctuation">)</span><span class="token punctuation">)</span>
    cat<span class="token punctuation">(</span><span class="token string">";"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  cat<span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment"># 构建分类树</span>
buildTree<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre> 
<p><strong>人工神经网络ANN</strong>：一种模仿大脑神经网络结构和功能而建立的信息处理系统，表示神经网络的输入与输出变量之间关系的模型。<br> BP神经网络、LM神经网络（基于梯度下降法和牛顿法，收敛快）、RBF径向基神经网络（以任意精度逼近任意连续函数，适合分类问题）、FNN神经网络（汇聚了神经网络和模糊系统的优点）、GMDH神经网络（用于预测，其网路结构不固定，在训练过程中不断改变）、ANFIS自适应神经网络（同FNN）。</p> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
Data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/sales_data.csv"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token comment"># 数据命名</span>
library<span class="token punctuation">(</span>nnet<span class="token punctuation">)</span>
colnames<span class="token punctuation">(</span>Data<span class="token punctuation">)</span> <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">"x1"</span><span class="token punctuation">,</span> <span class="token string">"x2"</span><span class="token punctuation">,</span> <span class="token string">"x3"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">)</span>
<span class="token comment"># 最终模型</span>
model1 <span class="token operator">&lt;-</span> nnet<span class="token punctuation">(</span>y <span class="token operator">~</span> .<span class="token punctuation">,</span> data <span class="token operator">=</span> Data<span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span> decay <span class="token operator">=</span> <span class="token number">5e-4</span><span class="token punctuation">,</span> maxit <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">)</span>  

pred <span class="token operator">&lt;-</span> predict<span class="token punctuation">(</span>model1<span class="token punctuation">,</span> Data<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">"class"</span><span class="token punctuation">)</span>	
<span class="token punctuation">(</span>P <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>as.numeric<span class="token punctuation">(</span>pred <span class="token operator">==</span> Data<span class="token operator">$</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> nrow<span class="token punctuation">(</span>Data<span class="token punctuation">)</span><span class="token punctuation">)</span>
table<span class="token punctuation">(</span>Data<span class="token operator">$</span>y<span class="token punctuation">,</span> pred<span class="token punctuation">)</span>
prop.table<span class="token punctuation">(</span>table<span class="token punctuation">(</span>Data<span class="token operator">$</span>y<span class="token punctuation">,</span> pred<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>分类与预测算法评价</strong>：绝对误差与相对误差、平均绝对误差（避免正负相抵消）、均方误差（还原失真程度，加强了数值大的误差在指标中的作用，从而提高指标灵敏性）、均方根误差（代表了预测值的离散程度）、平均绝对百分误差MAPE、Kappa统计（比较多个观测者对同一事物的观测是否一致）、识别准确度Accuracy、识别精确度、反馈率、ROC曲线（反映分类器效率）、混淆矩阵（描绘样本数据的真实属性与识别结果类型之间的关系）<br> <strong>贝叶斯网络</strong>：贝叶斯网络又称信度网络，是Bayes方法的扩展，是目前不确定知识表达和推理领域最有效的理论模型之一。<br> <strong>支持向量机</strong>：SVM支持向量机根据有限的样本信息在模型的复杂性和学习能力之间寻求最佳折衷，以获得最好的推广能力。<br> <img src="https://images2.imgbox.com/f7/06/yHFg1zLS_o.png" alt="在这里插入图片描述"><br> knn对有交叉重叠的待分类样本有较好的判别效果。</p> 
<h3><a id="52__118"></a>5.2 聚类分析</h3> 
<p>根据数据距离或相似度进行分组的非监督学习算法，划分分组的原则是组内距离最小化而组间距离最大化。<br> <img src="https://images2.imgbox.com/de/07/WQfQQe9s_o.png" alt="在这里插入图片描述"><br> K-means聚类算法过程：<br> 1）从N个样本数据中随机选取K个对象作为初始的聚类中心；<br> 2）分别计算每个样本到各个聚类中心的距离，将对象分配到距离最近的聚类中；<br> 3）所有对象分配完成后，重新计算K个聚类的中心；<br> 4）与前一次计算得到的K个聚类中心比较，如果聚类中心发生变化，转2)，否则转5)；<br> 5）当质心不发生变化时停止并输出聚类结果。<br> 常规的连续型数据需要对各属性进行零-均值规范化，再度量样本间的距离和样本与簇的距离（用误差平方和SSE作为度量聚类质量的目标函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         S 
        
       
         S 
        
       
         E 
        
       
         = 
        
        
        
          ∑ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          K 
         
        
        
        
          ∑ 
         
         
         
           x 
          
         
           ∈ 
          
          
          
            E 
           
          
            i 
           
          
         
        
       
         d 
        
       
         i 
        
       
         s 
        
       
         t 
        
       
         ( 
        
        
        
          e 
         
        
          i 
         
        
       
         , 
        
       
         x 
        
        
        
          ) 
         
        
          2 
         
        
       
      
        SSE=\sum_{i=1}^{K}\sum_{x\in E_i}dist(e_i,x)^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">SSE</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.381em; vertical-align: -0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9812em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1786em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3281em;"><span class="" style="top: -2.357em; margin-left: -0.0576em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3998em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>）。文档数据时，需要先将文档整理成“文档——词矩阵”，再计算相似度（用余弦相似度度量<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         S 
        
       
         S 
        
       
         E 
        
       
         = 
        
        
        
          ∑ 
         
         
         
           i 
          
         
           = 
          
         
           1 
          
         
        
          K 
         
        
        
        
          ∑ 
         
         
         
           x 
          
         
           ∈ 
          
          
          
            E 
           
          
            i 
           
          
         
        
       
         c 
        
       
         o 
        
       
         s 
        
       
         ( 
        
        
        
          e 
         
        
          i 
         
        
       
         , 
        
       
         x 
        
        
        
          ) 
         
        
          2 
         
        
       
      
        SSE=\sum_{i=1}^{K}\sum_{x\in E_i}cos(e_i,x)^2 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">SSE</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.381em; vertical-align: -0.3998em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9812em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0715em;">K</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position: relative; top: 0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1786em;"><span class="" style="top: -2.4003em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0576em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3281em;"><span class="" style="top: -2.357em; margin-left: -0.0576em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3998em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">cos</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3117em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8141em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>）。</p> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
Data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/consumption_data.csv"</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span>
km <span class="token operator">&lt;-</span> kmeans<span class="token punctuation">(</span>Data<span class="token punctuation">,</span> center <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>km<span class="token punctuation">)</span>
km<span class="token operator">$</span>size <span class="token operator">/</span> sum<span class="token punctuation">(</span>km<span class="token operator">$</span>size<span class="token punctuation">)</span>
<span class="token comment"># 数据分组</span>
aaa <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>Data<span class="token punctuation">,</span> km<span class="token operator">$</span>cluster<span class="token punctuation">)</span>
Data1 <span class="token operator">&lt;-</span> Data<span class="token punctuation">[</span>which<span class="token punctuation">(</span>aaa<span class="token operator">$</span>km.cluster <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
Data2 <span class="token operator">&lt;-</span> Data<span class="token punctuation">[</span>which<span class="token punctuation">(</span>aaa<span class="token operator">$</span>km.cluster <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
Data3 <span class="token operator">&lt;-</span> Data<span class="token punctuation">[</span>which<span class="token punctuation">(</span>aaa<span class="token operator">$</span>km.cluster <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
<span class="token comment"># 客户分群“1”的概率密度函数图</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data1<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"R"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data1<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"F"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data1<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"M"</span><span class="token punctuation">)</span>
<span class="token comment"># 客户分群“2”的概率密度函数图</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data2<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"R"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data2<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"F"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data2<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"M"</span><span class="token punctuation">)</span>
<span class="token comment"># 客户分群“3”的概率密度函数图</span>
par<span class="token punctuation">(</span>mfrow <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data3<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"R"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data3<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"F"</span><span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>density<span class="token punctuation">(</span>Data3<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"red"</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"M"</span><span class="token punctuation">)</span>
</code></pre> 
<p>聚类分析算法的评价有：purity评价方法（正确的占总数的比例）、RI评价法（用排列组合原理对聚类进行评价的手段，准确率和召回率同样重要）、F值评价法（RI的衍生，对准确率或召回率有一点的偏倚）。<br> <strong>常用的聚类分析算法函数</strong><br> （1）kmeans(data,centers,iter.max,nstart,algorithm)<br> data为数据集，centers为预设类别k，iter.max迭代最大值默认为10，nstart为随机起始中心点的次数，algorithm为算法，有<strong>Hartigan-Wong</strong>、Lloyd、For-gy、MacQueen.</p> 
<pre><code class="prism language-r">set.seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
x <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>rnorm<span class="token punctuation">(</span><span class="token number">50</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span>
x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">4</span>
km.out <span class="token operator">&lt;-</span> kmeans<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> nstart <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
km.out<span class="token operator">$</span>cluster
plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token punctuation">(</span>km.out<span class="token operator">$</span>cluster <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> main <span class="token operator">=</span> <span class="token string">"K-Means Clustering Results with K=2"</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
km.out<span class="token operator">$</span>centers
points<span class="token punctuation">(</span>km.out<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> km.out<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>km.out<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> km.out<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> cex <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> 
<p>（2）pam(data,k,metric,…,medoids)<br> metric用于选择样本点间距离测算的方式，medoids默认取NULL，由软件选择中心点，也可以设定一个k维向量来指定初始点。<br> （3）dbscan(data,eps,MinPts,scale,method,…)<br> eps为考察每一样本点是否满足密度要求时，所划定考察领域的半径；MinPts为密度阈值；scale用于选择是否在聚类前先对数据进行标准化，method参数用于选择认定的data类型。<br> （4）Mclust(data,G,modeNames,…)<br> G为预设类别数，由BIC值选择最优值；modeNames设定模型类别，由函数自动选取最优值。</p> 
<h3><a id="53__180"></a>5.3 关联规则</h3> 
<p>关联规则也成为购物篮分析，用于发现两种行为的关联性。<br> <img src="https://images2.imgbox.com/35/b8/XEecuH2l_o.png" alt="在这里插入图片描述"><br> Apriori算法是经典的挖掘频繁项集的算法，通过连接产生候选项与其支持度然后通过剪枝生成频繁项集。支持度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         S 
        
       
         u 
        
       
         p 
        
       
         p 
        
       
         o 
        
       
         r 
        
       
         t 
        
       
         ( 
        
       
         A 
        
       
         ⇒ 
        
       
         B 
        
       
         ) 
        
       
         = 
        
       
         P 
        
       
         ( 
        
       
         A 
        
       
         ∪ 
        
       
         B 
        
       
         ) 
        
       
      
        Support(A\Rightarrow B)=P(A \cup B) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">S</span><span class="mord mathnormal">u</span><span class="mord mathnormal">pp</span><span class="mord mathnormal" style="margin-right: 0.0278em;">or</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span></span></span></span></span>，置信度<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         C 
        
       
         o 
        
       
         n 
        
       
         f 
        
       
         i 
        
       
         d 
        
       
         e 
        
       
         n 
        
       
         c 
        
       
         e 
        
       
         ( 
        
       
         A 
        
       
         ⇒ 
        
       
         B 
        
       
         ) 
        
       
         = 
        
       
         P 
        
       
         ( 
        
       
         A 
        
       
         ∣ 
        
       
         B 
        
       
         ) 
        
       
      
        Confidence(A\Rightarrow B)=P(A | B) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0715em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right: 0.1076em;">f</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">ce</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.1389em;">P</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord">∣</span><span class="mord mathnormal" style="margin-right: 0.0502em;">B</span><span class="mclose">)</span></span></span></span></span>，满足规定阈值的规则称为<strong>强规则</strong>。</p> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
install.packages<span class="token punctuation">(</span><span class="token string">"arules"</span><span class="token punctuation">)</span>
library <span class="token punctuation">(</span> arules <span class="token punctuation">)</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
tr <span class="token operator">&lt;-</span> read.transactions<span class="token punctuation">(</span><span class="token string">"./data/menu_orders.txt"</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">"basket"</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">","</span><span class="token punctuation">)</span>                              
summary<span class="token punctuation">(</span>tr<span class="token punctuation">)</span>                                  
inspect<span class="token punctuation">(</span>tr<span class="token punctuation">)</span>  
<span class="token comment"># 支持度0.2,置信度0.5</span>
rules0 <span class="token operator">&lt;-</span> apriori<span class="token punctuation">(</span>tr<span class="token punctuation">,</span> parameter <span class="token operator">=</span> list<span class="token punctuation">(</span>support <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span> confidence <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rules0
inspect<span class="token punctuation">(</span>rules0<span class="token punctuation">)</span>
</code></pre> 
<p>用<strong>连接-剪枝</strong>的方式依据最小支持度阈值（最低重要性）找到所有的频繁项集，然后再用最小置信度阈值（最低可靠性）挖掘得到强关联规则。</p> 
<h3><a id="54__200"></a>5.4 时序模式</h3> 
<p><img src="https://images2.imgbox.com/94/22/IzkNdOZ3_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/1e/67/0avs4tZD_o.png" alt="在这里插入图片描述"><img src="https://images2.imgbox.com/8f/aa/b3aedq7k_o.png" alt="在这里插入图片描述"><br> 定义序列X的自协方差函数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         γ 
        
       
         ( 
        
       
         t 
        
       
         , 
        
       
         t 
        
       
         ) 
        
       
         = 
        
       
         E 
        
       
         [ 
        
       
         ( 
        
        
        
          X 
         
        
          t 
         
        
       
         − 
        
        
        
          μ 
         
        
          t 
         
        
       
         ) 
        
       
         ( 
        
        
        
          X 
         
        
          s 
         
        
       
         − 
        
        
        
          μ 
         
        
          s 
         
        
       
         ) 
        
       
         ] 
        
       
         , 
        
       
         γ 
        
       
         ( 
        
       
         t 
        
       
         , 
        
       
         t 
        
       
         ) 
        
       
         = 
        
       
         γ 
        
       
         ( 
        
       
         0 
        
       
         ) 
        
       
         = 
        
       
         1 
        
       
         , 
        
        
        
          ρ 
         
        
          0 
         
        
       
         = 
        
       
         1 
        
       
      
        \gamma(t,t)=E[(X_t-\mu_t)(X_s-\mu_s)],\gamma(t,t)=\gamma(0)=1,\rho_0=1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mopen">[(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0785em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)]</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8389em; vertical-align: -0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">1</span></span></span></span></span>和自相关系数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ρ 
        
       
         ( 
        
       
         t 
        
       
         , 
        
       
         s 
        
       
         ) 
        
       
         = 
        
        
         
         
           c 
          
         
           o 
          
         
           v 
          
         
           ( 
          
          
          
            X 
           
          
            t 
           
          
         
           , 
          
          
          
            X 
           
          
            s 
           
          
         
           ) 
          
         
         
          
          
            σ 
           
          
            t 
           
          
          
          
            σ 
           
          
            s 
           
          
         
        
       
      
        \rho(t,s)=\frac{cov(X_t,X_s)}{\sigma_t\sigma_s} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">ρ</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.4551em; vertical-align: -0.4451em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2963em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: -0.0359em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">co</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">v</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2963em;"><span class="" style="top: -2.357em; margin-left: -0.0785em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0785em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: -0.0785em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4451em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>，两者衡量的是同一事件在两个不同时期t、s之间的相关程度，过去对未来的影响。<br> <strong>平稳序列</strong>：序列在某一常数附件波动且波动范围有限，即存在常数均值和方差，并且延迟k期的序列变量的自协方差和自相关系数是相等的，则称序列为平稳序列。看自相关图或单位根检验（存在单位根就是非平稳序列）都可以。<br> <strong>纯随机性检验</strong>：也称白噪声检验，若序列是纯随机的，则<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         γ 
        
       
         ( 
        
       
         k 
        
       
         ) 
        
       
         = 
        
       
         0 
        
       
         , 
        
       
         k 
        
       
         ≠ 
        
       
         0 
        
       
      
        \gamma(k)=0,k\ne0 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0556em;">γ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.1667em;"></span><span class="mord mathnormal" style="margin-right: 0.0315em;">k</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6444em;"></span><span class="mord">0</span></span></span></span></span>，常用的检验统计量为Q统计量、LB统计量，由样本延迟阶数可以算得检验统计量，从而得到p值。<br> 自回归移动平均模型（ARMA）是最常用的拟合平稳序列模型，都可以看做是多元线性回归模型。<br> <img src="https://images2.imgbox.com/f9/51/f1iSvT6g_o.png" alt="平稳时间序列建模步骤"><br> <strong>对于平稳序列分析</strong>：<br> 自相关系数ACF是用于观察序列X过去对未来的影响，包含了多期X的影响；偏自相关系数PACF仅用于观察X过去某一期t-s对t期的影响，不包含多期X的影响。<br> AR（p）：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          t 
         
        
       
         = 
        
        
        
          ϕ 
         
        
          0 
         
        
       
         + 
        
        
        
          ϕ 
         
        
          1 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           1 
          
         
        
       
         + 
        
        
        
          ϕ 
         
        
          2 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           2 
          
         
        
       
         + 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         + 
        
        
        
          ϕ 
         
        
          p 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           p 
          
         
        
       
         + 
        
        
        
          ε 
         
        
          t 
         
        
       
      
        x_t=\phi_0+\phi_1x_{t-1}+\phi_2x_{t-2}+...+\phi_px_{t-p}+\varepsilon_t 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，ACF 拖尾，PACF p阶截尾，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         E 
        
       
         ( 
        
        
        
          x 
         
        
          t 
         
        
       
         ) 
        
       
         = 
        
       
         μ 
        
       
         = 
        
        
         
         
           ϕ 
          
         
           0 
          
         
         
         
           1 
          
         
           − 
          
          
          
            ϕ 
           
          
            1 
           
          
         
           − 
          
          
          
            ϕ 
           
          
            2 
           
          
         
           − 
          
         
           . 
          
         
           . 
          
         
           . 
          
         
           − 
          
          
          
            ϕ 
           
          
            p 
           
          
         
        
       
      
        E(x_t)=\mu=\frac{\phi_0}{1-\phi_1-\phi_2-...-\phi_p} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0576em;">E</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.4745em; vertical-align: -0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.9322em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight">...</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1645em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2819em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.4461em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3173em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5423em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>。<br> MA（p）：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          t 
         
        
       
         = 
        
       
         μ 
        
       
         + 
        
        
        
          ε 
         
        
          t 
         
        
       
         − 
        
        
        
          θ 
         
        
          1 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           1 
          
         
        
       
         + 
        
        
        
          θ 
         
        
          2 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           2 
          
         
        
       
         + 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         + 
        
        
        
          θ 
         
        
          q 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           q 
          
         
        
       
      
        x_t=\mu+\varepsilon_t-\theta_1\varepsilon_{t-1}+\theta_2\varepsilon_{t-2}+...+\theta_q \varepsilon_{t-q} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7778em; vertical-align: -0.1944em;"></span><span class="mord mathnormal">μ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>，ACF q阶截尾，PACF拖尾。<br> ARMA（p，q）：<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          x 
         
        
          t 
         
        
       
         = 
        
        
        
          ϕ 
         
        
          0 
         
        
       
         + 
        
        
        
          ϕ 
         
        
          1 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           1 
          
         
        
       
         + 
        
        
        
          ϕ 
         
        
          2 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           2 
          
         
        
       
         + 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         + 
        
        
        
          ϕ 
         
        
          p 
         
        
        
        
          x 
         
         
         
           t 
          
         
           − 
          
         
           p 
          
         
        
       
         + 
        
        
        
          ε 
         
        
          t 
         
        
       
         − 
        
        
        
          θ 
         
        
          1 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           1 
          
         
        
       
         + 
        
        
        
          θ 
         
        
          2 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           2 
          
         
        
       
         + 
        
       
         . 
        
       
         . 
        
       
         . 
        
       
         + 
        
        
        
          θ 
         
        
          q 
         
        
        
        
          ε 
         
         
         
           t 
          
         
           − 
          
         
           q 
          
         
        
       
      
        x_t=\phi_0+\phi_1x_{t-1}+\phi_2x_{t-2}+...+\phi_px_{t-p}+\varepsilon_t-\theta_1\varepsilon_{t-1}+\theta_2\varepsilon_{t-2}+...+\theta_q \varepsilon_{t-q} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.5806em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.8889em; vertical-align: -0.1944em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.7333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9028em; vertical-align: -0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2083em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord">...</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 0.9805em; vertical-align: -0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.0359em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.ACF拖尾，PACF拖尾。<br> p、q的识别有助于模型定阶，然后参数检验、模型检验、模型优化、模型应用预测等。<br> <strong>对于非平稳序列分析</strong>：<br> 差分运算：p阶差分（相距一期的两个序列值之间的减法运算称为1阶差分运算）；k步差分（相距k期的两个序列值之间的减法运算称为k步差分运算）。<br> <img src="https://images2.imgbox.com/01/52/BRksfiD6_o.png" alt="差分平稳时间序列建模步骤"></p> 
<pre><code class="prism language-r">setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
library<span class="token punctuation">(</span>forecast<span class="token punctuation">)</span>
library<span class="token punctuation">(</span>fUnitRoots<span class="token punctuation">)</span>
Data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/arima_data.csv"</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
sales <span class="token operator">&lt;-</span> ts<span class="token punctuation">(</span>Data<span class="token punctuation">)</span>
plot.ts<span class="token punctuation">(</span>sales<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"时间"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"销量 / 元"</span><span class="token punctuation">)</span>
<span class="token comment"># 单位根检验</span>
unitrootTest<span class="token punctuation">(</span>sales<span class="token punctuation">)</span>
<span class="token comment"># 自相关图</span>
acf<span class="token punctuation">(</span>sales<span class="token punctuation">)</span>
<span class="token comment"># 一阶差分</span>
difsales <span class="token operator">&lt;-</span> diff<span class="token punctuation">(</span>sales<span class="token punctuation">)</span>
plot.ts<span class="token punctuation">(</span>difsales<span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"时间"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"销量残差 / 元"</span><span class="token punctuation">)</span>
<span class="token comment"># 自相关图</span>
acf<span class="token punctuation">(</span>difsales<span class="token punctuation">)</span>
<span class="token comment"># 单位根检验</span>
unitrootTest<span class="token punctuation">(</span>difsales<span class="token punctuation">)</span>
<span class="token comment"># 白噪声检验</span>
Box.test<span class="token punctuation">(</span>difsales<span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"Ljung-Box"</span><span class="token punctuation">)</span> 
<span class="token comment"># 偏自相关图</span>
pacf<span class="token punctuation">(</span>difsales<span class="token punctuation">)</span>
<span class="token comment"># ARIMA(1,1,0)模型</span>
arima <span class="token operator">&lt;-</span> arima<span class="token punctuation">(</span>sales<span class="token punctuation">,</span> order <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
arima
forecast <span class="token operator">&lt;-</span> forecast.Arima<span class="token punctuation">(</span>arima<span class="token punctuation">,</span> h <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> level <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">99.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
forecast
</code></pre> 
<p><img src="https://images2.imgbox.com/d2/3d/MA63UoRs_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="55__246"></a>5.5 离群点检测</h3> 
<pre><code class="prism language-r"><span class="token comment"># 设置工作空间</span>
<span class="token comment"># 把“数据及程序”文件夹拷贝到F盘下，再用setwd设置工作空间</span>
setwd<span class="token punctuation">(</span><span class="token string">"F:/数据及程序/chapter5/示例程序"</span><span class="token punctuation">)</span>
<span class="token comment"># 读入数据</span>
Data <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">"./data/consumption_data.csv"</span><span class="token punctuation">,</span> header <span class="token operator">=</span> <span class="token boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span>
Data <span class="token operator">&lt;-</span> scale<span class="token punctuation">(</span>Data<span class="token punctuation">)</span>
set.seed<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>
km <span class="token operator">&lt;-</span> kmeans<span class="token punctuation">(</span>Data<span class="token punctuation">,</span> center <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>km<span class="token punctuation">)</span>
km<span class="token operator">$</span>centers
<span class="token comment"># 各样本欧氏距离</span>
x1 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>km<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">940</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">,</span> byrow <span class="token operator">=</span> T<span class="token punctuation">)</span>
juli1 <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>rowSums<span class="token punctuation">(</span><span class="token punctuation">(</span>Data <span class="token operator">-</span> x1<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
x2 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>km<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">940</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">,</span> byrow <span class="token operator">=</span> T<span class="token punctuation">)</span>
juli2 <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>rowSums<span class="token punctuation">(</span><span class="token punctuation">(</span>Data <span class="token operator">-</span> x2<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
x3 <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span>km<span class="token operator">$</span>centers<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> nrow <span class="token operator">=</span> <span class="token number">940</span><span class="token punctuation">,</span> ncol <span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">,</span> byrow <span class="token operator">=</span> T<span class="token punctuation">)</span>
juli3 <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>rowSums<span class="token punctuation">(</span><span class="token punctuation">(</span>Data <span class="token operator">-</span> x3<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dist <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>juli1<span class="token punctuation">,</span> juli2<span class="token punctuation">,</span> juli3<span class="token punctuation">)</span>
<span class="token comment"># 欧氏距离最小值</span>
y <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> min<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">940</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> xlim <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">940</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xlab <span class="token operator">=</span> <span class="token string">"样本点"</span><span class="token punctuation">,</span> ylab <span class="token operator">=</span> <span class="token string">"欧氏距离"</span><span class="token punctuation">)</span>
points<span class="token punctuation">(</span>which<span class="token punctuation">(</span>y <span class="token operator">&gt;</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>which<span class="token punctuation">(</span>y <span class="token operator">&gt;</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pch <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e76c5d043126366f8c8c0766992e310c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何在 Python 中混合使用同步和异步函数？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8c57b6c005ae7dd2ee2b110311c51c36/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">stream().sorted()实现排序(升序、降序、多字段排序)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>