<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>数值计算作业：matlab实现 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="数值计算作业：matlab实现" />
<meta property="og:description" content="题目一 syms x; fx=inline(&#39;54*x^6&#43;45*x^5-102*x^4-69*x^3&#43;35*x^2&#43;16*x-4&#39;); % 首先利用diff(54*x^6&#43;45*x^5-102*x^4-69*x^3&#43;35*x^2&#43;16*x-4)求解函数的导数 dfx=inline(&#39;324*x^5 &#43; 225*x^4 - 408*x^3 - 207*x^2 &#43; 70*x &#43; 16&#39;); %% 绘图 x=-1.5:0.0001:1.2; y=54.*x.^6&#43;45.*x.^5-102.*x.^4-69.*x.^3&#43;35.*x.^2&#43;16.*x-4; y2=0.*(1&lt;=x);% 找到零点的大致范围，以便在牛顿迭代法中设置初值 plot(x,y,x,y2) %% 调用函数分别求出五个根 [re1,step1]=NewtonDiedai(fx,dfx,-1.39); [re2,step2]=NewtonDiedai(fx,dfx,-0.68); [re3,step3]=NewtonDiedai(fx,dfx,0.23); [re4,step4]=NewtonDiedai(fx,dfx,0.51); [re5,step5]=NewtonDiedai(fx,dfx,1.18); function [result,step] = NewtonDiedai(fx,dfx,x0) %此方法为牛顿迭代法求解非线性方程的根 % fx为原函数 dfx为导函数 x0为初值 % result为结果，step为迭代步数 x1=x0; step=1; while 1 x0=x1; x1=x0-feval(fx,x0)/feval(dfx,x0); %feval()函数执行指定的函数 if abs(x0-x1)&lt;0.0001 %判断迭代结果精度是否达到要求 break; end if(step&gt;50) %当步数大于50时认为迭代不收敛，退出 break; end step=step&#43;1; %记录步数 end result=x0; end 题目二 %% 求导 syms x; fx=(1-3/(4*x))^(1/3); diff(fx) %求出函数的导数 %% 绘图 x=-3:0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/53f924721602831e29f3322e8741c3bd/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-07-21T17:05:37+08:00" />
<meta property="article:modified_time" content="2021-07-21T17:05:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">数值计算作业：matlab实现</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="_0"></a>题目一</h3> 
<p><img src="https://images2.imgbox.com/2e/47/pswe1Erg_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c">syms x<span class="token punctuation">;</span>
fx<span class="token operator">=</span><span class="token keyword">inline</span><span class="token punctuation">(</span><span class="token string">'54*x^6+45*x^5-102*x^4-69*x^3+35*x^2+16*x-4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 首先利用<span class="token function">diff</span><span class="token punctuation">(</span><span class="token number">54</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">45</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">102</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">69</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">35</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">16</span><span class="token operator">*</span>x<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span>求解函数的导数
dfx<span class="token operator">=</span><span class="token keyword">inline</span><span class="token punctuation">(</span><span class="token string">'324*x^5 + 225*x^4 - 408*x^3 - 207*x^2 + 70*x + 16'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token operator">%</span> 绘图
x<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">1.2</span><span class="token punctuation">;</span>
y<span class="token operator">=</span><span class="token number">54.</span><span class="token operator">*</span>x<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">45.</span><span class="token operator">*</span>x<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">102.</span><span class="token operator">*</span>x<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">69.</span><span class="token operator">*</span>x<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">35.</span><span class="token operator">*</span>x<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">16.</span><span class="token operator">*</span>x<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token number">0.</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;=</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 找到零点的大致范围，以便在牛顿迭代法中设置初值
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y2<span class="token punctuation">)</span>
<span class="token operator">%</span><span class="token operator">%</span> 调用函数分别求出五个根
<span class="token punctuation">[</span>re1<span class="token punctuation">,</span>step1<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1.39</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>re2<span class="token punctuation">,</span>step2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">0.68</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>re3<span class="token punctuation">,</span>step3<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span><span class="token number">0.23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>re4<span class="token punctuation">,</span>step4<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span><span class="token number">0.51</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>re5<span class="token punctuation">,</span>step5<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span><span class="token number">1.18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>result<span class="token punctuation">,</span>step<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span>
<span class="token operator">%</span>此方法为牛顿迭代法求解非线性方程的根
<span class="token operator">%</span>   fx为原函数 dfx为导函数 x0为初值
<span class="token operator">%</span>   result为结果，step为迭代步数
x1<span class="token operator">=</span>x0<span class="token punctuation">;</span>
step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token number">1</span>
    x0<span class="token operator">=</span>x1<span class="token punctuation">;</span>
    x1<span class="token operator">=</span>x0<span class="token operator">-</span><span class="token function">feval</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">feval</span><span class="token punctuation">(</span>dfx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span><span class="token function">feval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数执行指定的函数
    <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span>x0<span class="token operator">-</span>x1<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0.0001</span>   <span class="token operator">%</span>判断迭代结果精度是否达到要求
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">if</span><span class="token punctuation">(</span>step<span class="token operator">&gt;</span><span class="token number">50</span><span class="token punctuation">)</span>  <span class="token operator">%</span>当步数大于<span class="token number">50</span>时认为迭代不收敛，退出
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    step<span class="token operator">=</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">%</span>记录步数
end
result<span class="token operator">=</span>x0<span class="token punctuation">;</span>
end
</code></pre> 
<p><img src="https://images2.imgbox.com/58/83/UtuC2fN1_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a8/39/94JpZkTT_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_45"></a>题目二</h3> 
<p><img src="https://images2.imgbox.com/b2/3c/WinhizsD_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/d7/e3/RB0JR5M9_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span><span class="token operator">%</span> 求导
syms x<span class="token punctuation">;</span>
fx<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">diff</span><span class="token punctuation">(</span>fx<span class="token punctuation">)</span>  <span class="token operator">%</span>求出函数的导数

<span class="token operator">%</span><span class="token operator">%</span> 绘图
x<span class="token operator">=</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">;</span>
y<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">3.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4.</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token number">0.</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;=</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span> 找到零点的大致范围，以便在牛顿迭代法中设置初值
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y2<span class="token punctuation">)</span>

<span class="token operator">%</span><span class="token operator">%</span> 调用函数求出根
fx_line<span class="token operator">=</span><span class="token keyword">inline</span><span class="token punctuation">(</span><span class="token string">'(1-3/(4*x))^(1/3)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dfx_line<span class="token operator">=</span><span class="token keyword">inline</span><span class="token punctuation">(</span><span class="token string">'1/(4*x^2*(1 - 3/(4*x))^(2/3))'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>re1<span class="token punctuation">,</span>step<span class="token punctuation">,</span>x0_list<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx_line<span class="token punctuation">,</span>dfx_line<span class="token punctuation">,</span><span class="token number">0.78</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>result<span class="token punctuation">,</span>step<span class="token punctuation">,</span>x0_list<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">NewtonDiedai</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>dfx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span>
<span class="token operator">%</span>此方法为牛顿迭代法求解非线性方程的根
<span class="token operator">%</span>   fx为原函数 dfx为导函数 x0为初值
<span class="token operator">%</span>   result为结果，step为迭代步数 x0_list为迭代结果的列表
x1<span class="token operator">=</span>x0<span class="token punctuation">;</span>
step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
x0_list<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token number">1</span>
    x0<span class="token operator">=</span>x1<span class="token punctuation">;</span>
    x1<span class="token operator">=</span>x0<span class="token operator">-</span><span class="token function">feval</span><span class="token punctuation">(</span>fx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">feval</span><span class="token punctuation">(</span>dfx<span class="token punctuation">,</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span><span class="token function">feval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数执行指定的函数
    <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span>x0<span class="token operator">-</span>x1<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0.0001</span>   <span class="token operator">%</span>判断迭代结果精度是否达到要求
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">if</span><span class="token punctuation">(</span>step<span class="token operator">&gt;</span><span class="token number">55</span><span class="token punctuation">)</span>  <span class="token operator">%</span>当步数大于<span class="token number">50</span>时认为迭代不收敛，退出
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    step<span class="token operator">=</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">%</span>记录步数
    x0_list<span class="token operator">=</span><span class="token punctuation">[</span>x0_list x0<span class="token punctuation">]</span><span class="token punctuation">;</span>
end
result<span class="token operator">=</span>x0<span class="token punctuation">;</span>
end
</code></pre> 
<p><img src="https://images2.imgbox.com/fd/28/lJxx0tYd_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/f4/05/IYDdyBqo_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_93"></a>题目三</h3> 
<p><img src="https://images2.imgbox.com/af/6a/Uq1AG78R_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span>设置矩阵维数分别为<span class="token number">100</span> <span class="token number">1000</span> <span class="token number">10000</span>
n<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
stepj_list<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>  <span class="token operator">%</span>存储Jacobi方法的迭代步数
stepgs_list<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">%</span>存储Gauss<span class="token operator">-</span>Seidel方法的迭代步数
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span>
    <span class="token operator">%</span>制造A矩阵
a<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  
<span class="token function">a</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    <span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span>    
end
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span>
     <span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token function">a</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>  
end
<span class="token operator">%</span>制造b向量
b<span class="token operator">=</span><span class="token function">ones</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">b</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token operator">%</span>分别调用函数，求解各自的方程解，以及迭代次数
<span class="token punctuation">[</span>xj<span class="token punctuation">,</span>countj<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">Jacobi</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>xgs<span class="token punctuation">,</span>countgs<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">Gauss_Seidel</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">n</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stepj_list<span class="token operator">=</span><span class="token punctuation">[</span>stepj_list<span class="token punctuation">,</span>countj<span class="token punctuation">]</span><span class="token punctuation">;</span>
stepgs_list<span class="token operator">=</span><span class="token punctuation">[</span>stepgs_list<span class="token punctuation">,</span>countgs<span class="token punctuation">]</span><span class="token punctuation">;</span>
end
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>x<span class="token punctuation">,</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Jacobi</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>b<span class="token punctuation">,</span>x0<span class="token punctuation">,</span>eps<span class="token punctuation">)</span>
<span class="token operator">%</span>利用jacobi计算Ax<span class="token operator">=</span>b的解
<span class="token operator">%</span>   x为计算所得解
<span class="token operator">%</span>   count为迭代次数
<span class="token operator">%</span>   A，b分别为Ax<span class="token operator">=</span>b的系数与常数 x0为初值，eps为精度
<span class="token operator">%</span>分离D L U 
D<span class="token operator">=</span><span class="token function">diag</span><span class="token punctuation">(</span><span class="token function">diag</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>A的对角矩阵   只有一个diag是一个列向量
L<span class="token operator">=</span><span class="token operator">-</span><span class="token function">tril</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>利用tril求解下三角矩阵，<span class="token operator">-</span><span class="token number">1</span>代表不包含对角线
U<span class="token operator">=</span><span class="token operator">-</span><span class="token function">triu</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>利用triu求解上三角矩阵，<span class="token number">1</span>代表不包含对角线
M<span class="token operator">=</span>D\<span class="token punctuation">(</span>L<span class="token operator">+</span>U<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>计算迭代矩阵
B<span class="token operator">=</span>D\b<span class="token punctuation">;</span>
x<span class="token operator">=</span>M<span class="token operator">*</span>x0<span class="token operator">+</span>B<span class="token punctuation">;</span>
count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token function">norm</span><span class="token punctuation">(</span>x<span class="token operator">-</span>x0<span class="token punctuation">)</span><span class="token operator">&gt;=</span>eps   <span class="token operator">%</span>循环，直至数值解满足精度要求
    x0<span class="token operator">=</span>x<span class="token punctuation">;</span>
    x<span class="token operator">=</span>M<span class="token operator">*</span>x0<span class="token operator">+</span>B<span class="token punctuation">;</span>
    count<span class="token operator">=</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> count<span class="token operator">&gt;=</span><span class="token number">10000</span>       <span class="token operator">%</span>当迭代次数过多，则不收敛
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Warning:迭代次数太多,仍未达精度要求,可能不收敛!'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
    end
end
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>x<span class="token punctuation">,</span>count<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Gauss_Seidel</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>b<span class="token punctuation">,</span>x0<span class="token punctuation">,</span>eps<span class="token punctuation">)</span>
<span class="token operator">%</span>GAUSS_SEIDEL 计算Ax<span class="token operator">=</span>b的解
<span class="token operator">%</span>   x为计算所得解
<span class="token operator">%</span>   count为迭代次数
<span class="token operator">%</span>   A，b分别为Ax<span class="token operator">=</span>b的系数与常数 x0为初值，eps为精度
<span class="token operator">%</span>分离D L U 
D<span class="token operator">=</span><span class="token function">diag</span><span class="token punctuation">(</span><span class="token function">diag</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>A的对角矩阵   只有一个diag是一个列向量
L<span class="token operator">=</span><span class="token operator">-</span><span class="token function">tril</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>利用tril求解下三角矩阵，<span class="token operator">-</span><span class="token number">1</span>代表不包含对角线
U<span class="token operator">=</span><span class="token operator">-</span><span class="token function">triu</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>利用triu求解上三角矩阵，<span class="token number">1</span>代表不包含对角线
M<span class="token operator">=</span><span class="token operator">-</span><span class="token punctuation">(</span>D<span class="token operator">+</span>L<span class="token punctuation">)</span>\U<span class="token punctuation">;</span>  <span class="token operator">%</span>计算迭代矩阵
B<span class="token operator">=</span><span class="token punctuation">(</span>D<span class="token operator">+</span>L<span class="token punctuation">)</span>\b<span class="token punctuation">;</span>
x<span class="token operator">=</span>M<span class="token operator">*</span>x0<span class="token operator">+</span>B<span class="token punctuation">;</span>
count<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token function">norm</span><span class="token punctuation">(</span>x<span class="token operator">-</span>x0<span class="token punctuation">)</span><span class="token operator">&gt;=</span>eps  <span class="token operator">%</span>循环，直至数值解满足精度要求
    x0<span class="token operator">=</span>x<span class="token punctuation">;</span> 
    x<span class="token operator">=</span>M<span class="token operator">*</span>x0<span class="token operator">+</span>B<span class="token punctuation">;</span>
    count<span class="token operator">=</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> count<span class="token operator">&gt;=</span><span class="token number">10000</span>     <span class="token operator">%</span>当迭代次数过多，则不收敛
            <span class="token function">disp</span><span class="token punctuation">(</span><span class="token string">'Warning:迭代次数太多,仍未达精度要求,可能不收敛!'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
    end
end
end
</code></pre> 
<p><img src="https://images2.imgbox.com/22/84/rUIAiW28_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/4a/b4/dgsNBckk_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_178"></a>题目四</h3> 
<p><img src="https://images2.imgbox.com/9d/8d/j2Fc8Iau_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span><span class="token operator">%</span> 提供原函数图像的点
x_yuan<span class="token operator">=</span><span class="token function">linspace</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
y_yuan<span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">+</span><span class="token number">12.</span><span class="token operator">*</span>x_yuan<span class="token punctuation">.</span><span class="token operator">*</span>x_yuan<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 分别用<span class="token number">4</span>次、<span class="token number">8</span>次、<span class="token number">16</span>次，<span class="token number">20</span>次插值多项式
dist<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>     <span class="token operator">%</span>区间长度
list_poly_count<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token operator">%</span>多项式的次数

<span class="token operator">%</span> 任意一个次数构造
<span class="token operator">%</span>四次
step<span class="token operator">=</span>dist<span class="token operator">/</span><span class="token function">list_poly_count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
x0<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token operator">%</span>计算需多少个节点
y0<span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">+</span><span class="token number">12.</span><span class="token operator">*</span>x0<span class="token punctuation">.</span><span class="token operator">*</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>调用函数计算
resultx4<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
resulty4<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>resultx4<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>计算resultx4对应的插值多项式的值，用于画图

<span class="token operator">%</span><span class="token number">8</span>次
step<span class="token operator">=</span>dist<span class="token operator">/</span><span class="token function">list_poly_count</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x0<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>           <span class="token operator">%</span>计算需多少个节点
y0<span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">+</span><span class="token number">12.</span><span class="token operator">*</span>x0<span class="token punctuation">.</span><span class="token operator">*</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">%</span>调用函数计算
resultx8<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
resulty8<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>resultx8<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>计算resultx8对应的插值多项式的值，用于画图

<span class="token operator">%</span><span class="token number">16</span>次
step<span class="token operator">=</span>dist<span class="token operator">/</span><span class="token function">list_poly_count</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x0<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token operator">%</span>计算需多少个节点
y0<span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">+</span><span class="token number">12.</span><span class="token operator">*</span>x0<span class="token punctuation">.</span><span class="token operator">*</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>调用函数计算
resultx16<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
resulty16<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>resultx16<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算resultx对应的插值多项式的值，用于画图


<span class="token operator">%</span><span class="token number">20</span>次
step<span class="token operator">=</span>dist<span class="token operator">/</span><span class="token function">list_poly_count</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x0<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y0<span class="token operator">=</span><span class="token number">1.</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.</span><span class="token operator">+</span><span class="token number">12.</span><span class="token operator">*</span>x0<span class="token punctuation">.</span><span class="token operator">*</span>x0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算需多少个节点
<span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>调用函数计算
resultx20<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
resulty20<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>resultx20<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算resultx对应的插值多项式的值，用于画图

<span class="token operator">%</span><span class="token operator">%</span> 图像绘制
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>resultx4<span class="token punctuation">,</span>resulty4<span class="token punctuation">,</span>x_yuan<span class="token punctuation">,</span>y_yuan<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}4次插值与原函数对比图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">"4次插值"</span><span class="token punctuation">,</span><span class="token string">"原函数图像"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>resultx8<span class="token punctuation">,</span>resulty8<span class="token punctuation">,</span>x_yuan<span class="token punctuation">,</span>y_yuan<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}8次插值与原函数对比图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">"8次插值"</span><span class="token punctuation">,</span><span class="token string">"原函数图像"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>resultx16<span class="token punctuation">,</span>resulty16<span class="token punctuation">,</span>x_yuan<span class="token punctuation">,</span>y_yuan<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}16次插值与原函数对比图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">"16次插值"</span><span class="token punctuation">,</span><span class="token string">"原函数图像"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>resultx20<span class="token punctuation">,</span>resulty20<span class="token punctuation">,</span>x_yuan<span class="token punctuation">,</span>y_yuan<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}20次插值与原函数对比图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">"20次插值"</span><span class="token punctuation">,</span><span class="token string">"原函数图像"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">)</span>
<span class="token operator">%</span>  Lagrange用于求解拉格朗日插值
<span class="token operator">%</span>  X为各插值点的x坐标  
<span class="token operator">%</span>  Y为各插值点的y坐标  
<span class="token operator">%</span>  C为返回的插值多项式系数
<span class="token operator">%</span>  L为插值多项式（sym）
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>求解共有多少插值点
<span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">:</span> m
    V <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">:</span> m
        <span class="token keyword">if</span> k <span class="token operator">~</span><span class="token operator">=</span> i
            <span class="token operator">%</span>求解每个基函数的每一项
            V <span class="token operator">=</span> <span class="token function">conv</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span><span class="token function">poly</span><span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">X</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>用conv进行多项式的计算 
                                                                            <span class="token operator">%</span>其中poly函数返回一个类似于x<span class="token operator">-</span>xi的形式
        end
    end
    <span class="token function">L1</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> V<span class="token punctuation">;</span> <span class="token operator">%</span>存储每个基函数的各个系数
    <span class="token function">l</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">poly2sym</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>将基函数的系数转为多项式形式，并存储
end
<span class="token operator">%</span>分别计算多项式系数以及sym形式的多项式，方便展示
C <span class="token operator">=</span> Y <span class="token operator">*</span> L1<span class="token punctuation">;</span>
L <span class="token operator">=</span> Y <span class="token operator">*</span> l<span class="token punctuation">;</span>
end
</code></pre> 
<p><img src="https://images2.imgbox.com/66/d5/hJ9u85pZ_o.png" alt="在这里插入图片描述"><br> 根据图4-1，我们可以发现对于拉格朗日插值多项式，插值的次数越高，中间部分对原函数的贴合程度越高，但是Runge现象会非常明显；次数较低时中间部分的逼近效果会比较差，但是Runge现象也会减弱。</p> 
<h3><a id="_276"></a>题目五</h3> 
<p><img src="https://images2.imgbox.com/bf/8f/nNNw4u66_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span><span class="token operator">%</span> 传入数据
year<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'1994'</span><span class="token punctuation">,</span><span class="token string">'1995'</span><span class="token punctuation">,</span><span class="token string">'1996'</span><span class="token punctuation">,</span><span class="token string">'1997'</span><span class="token punctuation">,</span><span class="token string">'1998'</span><span class="token punctuation">,</span><span class="token string">'1999'</span><span class="token punctuation">,</span><span class="token string">'2000'</span><span class="token punctuation">,</span><span class="token string">'2001'</span><span class="token punctuation">,</span><span class="token string">'2002'</span><span class="token punctuation">,</span><span class="token string">'2003'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
year0<span class="token operator">=</span><span class="token number">1994</span><span class="token punctuation">;</span>
year_add<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
bbl<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">67.052</span><span class="token punctuation">,</span><span class="token number">68.008</span><span class="token punctuation">,</span><span class="token number">69.803</span><span class="token punctuation">,</span><span class="token number">72.024</span><span class="token punctuation">,</span><span class="token number">73.400</span><span class="token punctuation">,</span><span class="token number">72.063</span><span class="token punctuation">,</span><span class="token number">74.669</span><span class="token punctuation">,</span><span class="token number">74.487</span><span class="token punctuation">,</span><span class="token number">74.065</span><span class="token punctuation">,</span><span class="token number">76.777</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 拉格朗日插值
<span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>为了方便计算，特将x化到<span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>
predit_x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.01</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token operator">%</span>计算需多少个节点
result<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>predit_x<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算predit_x对应的插值多项式的值，用于画图
<span class="token operator">%</span>绘制插值多项式图
hold on
<span class="token function">plot</span><span class="token punctuation">(</span>predit_x<span class="token punctuation">,</span>result<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTicklabel'</span><span class="token punctuation">,</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}9次插值多项式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span>  求解<span class="token number">2010</span>年
add<span class="token operator">=</span><span class="token number">2010</span><span class="token operator">-</span>year0<span class="token punctuation">;</span>
result_2010<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>计算<span class="token number">2010</span>年对应的插值多项式的值
<span class="token operator">%</span> 可以看出有Runge现象

<span class="token operator">%</span><span class="token operator">%</span> 求解三次插值
year_1_4<span class="token operator">=</span><span class="token function">year_add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bbl_1_4<span class="token operator">=</span><span class="token function">bbl</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>利用上述方法继续求解三次插值
<span class="token punctuation">[</span>C_4<span class="token punctuation">,</span>L_4<span class="token punctuation">,</span>L1_4<span class="token punctuation">,</span>l_4<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>year_1_4<span class="token punctuation">,</span>bbl_1_4<span class="token punctuation">)</span><span class="token punctuation">;</span>
predit_x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.01</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span>
result_1_4<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C_4<span class="token punctuation">,</span>predit_x<span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on
<span class="token function">plot</span><span class="token punctuation">(</span>predit_x<span class="token punctuation">,</span>result_1_4<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTicklabel'</span><span class="token punctuation">,</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}3次插值多项式'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用<span class="token number">3</span>次求<span class="token number">1998</span>年
add_98<span class="token operator">=</span><span class="token number">1998</span><span class="token operator">-</span>year0<span class="token punctuation">;</span>
result_98<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>C_4<span class="token punctuation">,</span>add_98<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 没有Runge现象

<span class="token operator">%</span><span class="token operator">%</span> 数据传入
year0<span class="token operator">=</span><span class="token number">1994</span><span class="token punctuation">;</span>
year_add<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
bbl<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">67.052</span><span class="token punctuation">,</span><span class="token number">68.008</span><span class="token punctuation">,</span><span class="token number">69.803</span><span class="token punctuation">,</span><span class="token number">72.024</span><span class="token punctuation">,</span><span class="token number">73.400</span><span class="token punctuation">,</span><span class="token number">72.063</span><span class="token punctuation">,</span><span class="token number">74.669</span><span class="token punctuation">,</span><span class="token number">74.487</span><span class="token punctuation">,</span><span class="token number">74.065</span><span class="token punctuation">,</span><span class="token number">76.777</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
year<span class="token operator">=</span><span class="token punctuation">{<!-- --></span><span class="token string">'1994'</span><span class="token punctuation">,</span><span class="token string">'1995'</span><span class="token punctuation">,</span><span class="token string">'1996'</span><span class="token punctuation">,</span><span class="token string">'1997'</span><span class="token punctuation">,</span><span class="token string">'1998'</span><span class="token punctuation">,</span><span class="token string">'1999'</span><span class="token punctuation">,</span><span class="token string">'2000'</span><span class="token punctuation">,</span><span class="token string">'2001'</span><span class="token punctuation">,</span><span class="token string">'2002'</span><span class="token punctuation">,</span><span class="token string">'2003'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 最小二乘直线拟合
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>year_add'<span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">%</span>运用最小二乘原理计算
a_predit_<span class="token operator">=</span><span class="token punctuation">(</span>a<span class="token string">'*a)\(a'</span><span class="token operator">*</span>bbl'<span class="token punctuation">)</span><span class="token punctuation">;</span>
x_predit_<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span>
y_predit_<span class="token operator">=</span>x_predit_<span class="token operator">*</span><span class="token function">a_predit_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">a_predit_</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x_predit_<span class="token punctuation">,</span>y_predit_<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTicklabel'</span><span class="token punctuation">,</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}最小二乘直线拟合'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 抛物线拟合
<span class="token operator">%</span>运用polyfit进行二次拟合
c_predit_2<span class="token operator">=</span><span class="token function">polyfit</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x_predit_2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span>
<span class="token operator">%</span>此处运用polyval计算拟合函数中各点坐标，用于绘图
y_predit_2<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>c_predit_2<span class="token punctuation">,</span>x_predit_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x_predit_2<span class="token punctuation">,</span>y_predit_2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTicklabel'</span><span class="token punctuation">,</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}抛物线拟合'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 三次多项式拟合
<span class="token operator">%</span>运用polyfit进行三次拟合
c_predit_3<span class="token operator">=</span><span class="token function">polyfit</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
x_predit_3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.0001</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span>
<span class="token operator">%</span>此处运用polyval计算拟合函数中各点坐标，用于绘图
y_predit_3<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>c_predit_3<span class="token punctuation">,</span>x_predit_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x_predit_3<span class="token punctuation">,</span>y_predit_3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set</span><span class="token punctuation">(</span>gca<span class="token punctuation">,</span><span class="token string">'XTicklabel'</span><span class="token punctuation">,</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}三次多项式拟合'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 综合图
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x_predit_<span class="token punctuation">,</span>y_predit_<span class="token punctuation">,</span>x_predit_2<span class="token punctuation">,</span>y_predit_2<span class="token punctuation">,</span>x_predit_3<span class="token punctuation">,</span>y_predit_3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">plot</span><span class="token punctuation">(</span>year_add<span class="token punctuation">,</span>bbl<span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'最小二乘'</span><span class="token punctuation">,</span><span class="token string">'抛物线'</span><span class="token punctuation">,</span><span class="token string">'三次多项式'</span><span class="token punctuation">,</span><span class="token string">'原图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'\fontsize{20}综合图像'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 预计<span class="token number">2010</span>年原油产量
add<span class="token operator">=</span><span class="token number">2010</span><span class="token operator">-</span><span class="token number">1994</span><span class="token punctuation">;</span>
<span class="token operator">%</span> 用最小二乘
predit_10_1<span class="token operator">=</span>add<span class="token operator">*</span><span class="token function">a_predit_</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">a_predit_</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 用抛物线拟合
predit_10_2<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>c_predit_2<span class="token punctuation">,</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span> 三次多项式拟合
predit_10_3<span class="token operator">=</span><span class="token function">polyval</span><span class="token punctuation">(</span>c_predit_3<span class="token punctuation">,</span>add<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>C<span class="token punctuation">,</span>L<span class="token punctuation">]</span><span class="token operator">=</span> <span class="token function">Lagrange</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">)</span>
<span class="token operator">%</span>  Lagrange用于求解拉格朗日插值
<span class="token operator">%</span>  X为各插值点的x坐标  
<span class="token operator">%</span>  Y为各插值点的y坐标  
<span class="token operator">%</span>  C为返回的插值多项式系数
<span class="token operator">%</span>  L为插值多项式（sym）
m <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>求解共有多少插值点
<span class="token keyword">for</span> k <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">:</span> m
    V <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">:</span> m
        <span class="token keyword">if</span> k <span class="token operator">~</span><span class="token operator">=</span> i
            <span class="token operator">%</span>求解每个基函数的每一项
            V <span class="token operator">=</span> <span class="token function">conv</span><span class="token punctuation">(</span>V<span class="token punctuation">,</span><span class="token function">poly</span><span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token function">X</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token function">X</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">%</span>用conv进行多项式的计算 
                                                                            <span class="token operator">%</span>其中poly函数返回一个类似于x<span class="token operator">-</span>xi的形式
        end
    end
    <span class="token function">L1</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> V<span class="token punctuation">;</span> <span class="token operator">%</span>存储每个基函数的各个系数
    <span class="token function">l</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">poly2sym</span><span class="token punctuation">(</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>将基函数的系数转为多项式形式，并存储
end
<span class="token operator">%</span>分别计算多项式系数以及sym形式的多项式，方便展示
C <span class="token operator">=</span> Y <span class="token operator">*</span> L1<span class="token punctuation">;</span>
L <span class="token operator">=</span> Y <span class="token operator">*</span> l<span class="token punctuation">;</span>
end
</code></pre> 
<p><img src="https://images2.imgbox.com/8c/92/BXmSYpPQ_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/a7/a0/IW7DkU6S_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/98/ee/mmPfOlS6_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ea/3e/0NV9OZWO_o.png" alt="在这里插入图片描述"><br> 经过分析图5-3以及表5-2，我们首先可以看出相比于插值多项式，三种类型的拟合多项式都可以比较好地预测原油产量。<br> 通过分析图5-4，我们可以发现,虽然最小二乘直线能比较好地刻画原油产量随时间的变化，但是通过散点图我们可以看出点的分布在之后有弯的趋势，这更加符合二次或者三次多项式的特征；<br> 在比较抛物线拟合与三次多项式拟合的图像后，我们可以发现三次多项式能顾及更多结点，而且走势也基本符合散点的走势，而且也没有出现过拟合的情况。<br> 综上所示，我们可以得出三次多项式拟合曲线更能最好的表示表格中的数据。</p> 
<h3><a id="_430"></a>题目六</h3> 
<p><img src="https://images2.imgbox.com/f3/eb/OynYvVhn_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span><span class="token operator">%</span> 用复合梯形公式计算第一题
ft1<span class="token operator">=</span>@<span class="token punctuation">(</span>x<span class="token punctuation">)</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>a<span class="token punctuation">,</span>nn<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fuhuatixing</span><span class="token punctuation">(</span>ft1<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token operator">%</span> 用复合梯形公式计算第二题
ft2<span class="token operator">=</span>@<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>a1<span class="token punctuation">,</span>nn1<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fuhuatixing</span><span class="token punctuation">(</span>ft2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token operator">%</span> 用复合梯形公式计算第三题
ft3<span class="token operator">=</span>@<span class="token punctuation">(</span>x<span class="token punctuation">)</span>x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">exp</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>a2<span class="token punctuation">,</span>nn2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fuhuatixing</span><span class="token punctuation">(</span>ft3<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用复合Simpson公式计算第一题
syms x<span class="token punctuation">;</span>
f1<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>s<span class="token punctuation">,</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Simpson</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用复合Simpson公式计算第二题
syms x<span class="token punctuation">;</span>
f2<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>s2<span class="token punctuation">,</span>n2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Simpson</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用复合Simpson公式计算第三题
syms x<span class="token punctuation">;</span>
f3<span class="token operator">=</span>x<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">exp</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>s3<span class="token punctuation">,</span>n3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Simpson</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>f3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用Romberg公式计算第一题
<span class="token punctuation">[</span>i1<span class="token punctuation">,</span>num1<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">Romberg</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 用Romberg公式计算第二题
<span class="token punctuation">[</span>i2<span class="token punctuation">,</span>num2<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">Romberg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>pi<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 用Romberg公式计算第三题
<span class="token punctuation">[</span>i3<span class="token punctuation">,</span>num3<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">Romberg</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>f3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>A<span class="token punctuation">,</span>N<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fuhuatixing</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
<span class="token operator">%</span>用复化梯形公式进行积分求解
<span class="token operator">%</span> a b：积分上下限  q<span class="token punctuation">:</span>精度
<span class="token operator">%</span>f1<span class="token punctuation">:</span> 为所求函数的句柄
<span class="token operator">%</span>A：积分结果
<span class="token operator">%</span>N：小区间数量
 m<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
 h<span class="token operator">=</span>b<span class="token operator">-</span>a<span class="token punctuation">;</span>
 <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>h<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">f1</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>初始值设定
 
 <span class="token operator">%</span>循环划分区间
 <span class="token keyword">while</span> <span class="token number">1</span>
    h<span class="token operator">=</span>h<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    sum<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        sum<span class="token operator">=</span>sum<span class="token operator">+</span><span class="token function">f1</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    <span class="token function">S</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>h<span class="token operator">*</span>sum<span class="token punctuation">;</span>
    <span class="token keyword">for</span> j<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>m
        <span class="token function">S</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">S</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">T</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">^</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">T</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>q<span class="token punctuation">)</span> <span class="token operator">%</span>直至精度满足要求
        A<span class="token operator">=</span><span class="token function">S</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    T<span class="token operator">=</span>S<span class="token punctuation">;</span>
    m<span class="token operator">=</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
 end
 <span class="token operator">%</span>计算区间数量
 N<span class="token operator">=</span><span class="token punctuation">(</span>b<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token operator">/</span>h<span class="token punctuation">;</span>
end
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>i<span class="token punctuation">,</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Romberg</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span>up<span class="token punctuation">,</span>L<span class="token punctuation">)</span>
<span class="token operator">%</span>利用ROMBERG 方法进行复化求积
<span class="token operator">%</span> low<span class="token punctuation">,</span>up是积分上下限
<span class="token operator">%</span>   L是公式（sym的形式）
<span class="token operator">%</span>   i为积分结果，num为区间数量
tolerance<span class="token operator">=</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>限差
h<span class="token operator">=</span><span class="token punctuation">(</span>up<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span>h<span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>low<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>up<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
<span class="token operator">%</span><span class="token function">subs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数 表示将符号表达式中的某些符号变量替换为指定的新的变量
k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>n<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
m<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">%</span>根据书中的伪代码，可以写出复化函数
<span class="token keyword">while</span> <span class="token number">1</span>    
    f<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
        f<span class="token operator">=</span>f<span class="token operator">+</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span><span class="token punctuation">(</span>low<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    <span class="token function">t</span><span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">t</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span>h<span class="token operator">*</span>f<span class="token punctuation">;</span>
    <span class="token keyword">for</span> m<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>k
        <span class="token function">t</span><span class="token punctuation">(</span>k<span class="token operator">-</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">^</span>m<span class="token operator">*</span><span class="token function">t</span><span class="token punctuation">(</span>k<span class="token operator">-</span>m<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">t</span><span class="token punctuation">(</span>k<span class="token operator">-</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">^</span>m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>tolerance
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    <span class="token operator">%</span>将区间分半，继续求解
    h<span class="token operator">=</span>h<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    n<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>n<span class="token punctuation">;</span>
    k<span class="token operator">=</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
end
<span class="token operator">%</span>取出romberg计算矩阵的最外侧数值即为最终积分解
i<span class="token operator">=</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">%</span>计算区间数量
num<span class="token operator">=</span><span class="token punctuation">(</span>up<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">/</span>h<span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c">function <span class="token punctuation">[</span>ss<span class="token punctuation">,</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">Simpson</span><span class="token punctuation">(</span>low<span class="token punctuation">,</span>up<span class="token punctuation">,</span>L<span class="token punctuation">)</span>
<span class="token operator">%</span>   Simpson方法进行复化求积
<span class="token operator">%</span> low<span class="token punctuation">,</span>up是积分上下限
<span class="token operator">%</span>   L是公式（sym的形式）
<span class="token operator">%</span>   ss为积分结果，num为区间数量
tolerance<span class="token operator">=</span><span class="token number">0.5</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">%</span>限差
<span class="token operator">%</span>进行初值计算
f1<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>low<span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>up<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
f2<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span><span class="token punctuation">(</span>low<span class="token operator">+</span>up<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
s0<span class="token operator">=</span><span class="token punctuation">(</span>up<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>f1<span class="token operator">+</span><span class="token number">4</span><span class="token operator">*</span>f2<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">;</span>
n<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
h<span class="token operator">=</span><span class="token punctuation">(</span>up<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">;</span>
st<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token operator">%</span>根据书中的伪代码，可以写出复化函数
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    f3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">:</span>n
        f3<span class="token operator">=</span>f3<span class="token operator">+</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">subs</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>low<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    end
    s<span class="token operator">=</span>h<span class="token operator">*</span><span class="token punctuation">(</span>f1<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>f2<span class="token operator">+</span><span class="token number">4</span><span class="token operator">*</span>f3<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token function">abs</span><span class="token punctuation">(</span>s<span class="token operator">-</span>s0<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">15</span><span class="token operator">*</span>tolerance   <span class="token operator">%</span>直至精度满足要求
        ss<span class="token operator">=</span>s<span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    end
    st<span class="token operator">=</span>st<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>将区间分半，继续求解
    n<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>n<span class="token punctuation">;</span>
    h<span class="token operator">=</span>h<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    f2<span class="token operator">=</span>f2<span class="token operator">+</span>f3<span class="token punctuation">;</span>
    s0<span class="token operator">=</span>s<span class="token punctuation">;</span>    
end
<span class="token operator">%</span>计算区间数量
num<span class="token operator">=</span><span class="token punctuation">(</span>up<span class="token operator">-</span>low<span class="token punctuation">)</span><span class="token operator">/</span>h<span class="token punctuation">;</span>
end
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/34/4cgb00gE_o.png" alt="在这里插入图片描述"><br> 根据表6-1、6-2、6-3所示，我们可以看出，两个方法在求不同的积分时，最终求得的值相等。<br> 但Romberg求积方法是在复化梯形求积公式的基础上，应用了Richardson外推法构造的一种算法，是一种加速计算方法，故而与复合梯形公式/Simpson公式相比，所需的区间数量更少，能更快地求解。</p> 
<h3><a id="_584"></a>题目七</h3> 
<p><img src="https://images2.imgbox.com/8f/e5/55E34dT9_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token operator">%</span>首先用<span class="token function">dsolve</span><span class="token punctuation">(</span><span class="token string">'Dy=x'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span>求解准确函数

<span class="token operator">%</span><span class="token operator">%</span> 准确函数绘制
x0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y0<span class="token operator">=</span>x0<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">2.</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 用euler法求解第一个函数
<span class="token operator">%</span>根据公式依次求解被积函数的积分值
<span class="token operator">%</span> 分别按照步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>计算求解
<span class="token operator">%</span> 步长为<span class="token number">0.1</span>求解
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>           
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token operator">%</span>euler法只与前一项有关，循环求解即可
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
end
<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
end
<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
end

<span class="token operator">%</span><span class="token operator">%</span> 绘制用Euler法求解y'<span class="token operator">=</span>x图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用Euler法求解y'=x"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用改进的euler法求解
<span class="token operator">%</span>根据公式依次求解被积函数的积分值
<span class="token operator">%</span> 分别按照步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>计算求解
<span class="token operator">%</span> 步长为<span class="token number">0.1</span>求解
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
y11<span class="token operator">=</span>y1<span class="token punctuation">;</span><span class="token operator">%</span>存储y<span class="token string">''</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
    <span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y21<span class="token operator">=</span>y2<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
    <span class="token operator">%</span>首先运用euler做预估校正
    <span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token operator">%</span>将预估校正的值代入进行迭代，所得为改进的euler法所求的积分值
end

<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y31<span class="token operator">=</span>y3<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
    <span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
<span class="token operator">%</span><span class="token operator">%</span> 绘制用改进的Euler法求解y'<span class="token operator">=</span>x图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用改进的Euler法求解y'=x"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<pre><code class="prism language-c"><span class="token operator">%</span>首先用<span class="token function">dsolve</span><span class="token punctuation">(</span><span class="token string">'Dy=x^2*y'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span>求解准确函数

<span class="token operator">%</span><span class="token operator">%</span> 准确函数
x0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y0<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span>x0<span class="token punctuation">.</span><span class="token operator">^</span><span class="token number">3.</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 用euler法求解
<span class="token operator">%</span>根据公式依次求解被积函数的积分值
<span class="token operator">%</span> 分别按照步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>计算求解
<span class="token operator">%</span> <span class="token number">0.1</span>
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end<span class="token operator">%</span>euler法只与前一项有关，循环求解即可

<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span><span class="token operator">%</span> 绘制用Euler法求解y'<span class="token operator">=</span>x<span class="token operator">^</span><span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span>y图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用Euler法求解y'=x^{2}y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用改进的euler法求解
<span class="token operator">%</span> 步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>
<span class="token operator">%</span> <span class="token number">0.1</span>
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y11<span class="token operator">=</span>y1<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>首先运用euler做预估校正
    <span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>将预估校正的值代入进行迭代，所得为改进的euler法所求的积分值
end

<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
y21<span class="token operator">=</span>y2<span class="token punctuation">;</span><span class="token operator">%</span>存储y<span class="token string">''</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y31<span class="token operator">=</span>y3<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
<span class="token operator">%</span><span class="token operator">%</span> 绘制用改进的Euler法求解y'<span class="token operator">=</span>x<span class="token operator">^</span><span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">}</span>y图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用改进的Euler法求解y'=x^{2}y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> 
<pre><code class="prism language-c"><span class="token operator">%</span>首先用<span class="token function">dsolve</span><span class="token punctuation">(</span><span class="token string">'Dy=2*(x+1)*y'</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span>求解准确函数

<span class="token operator">%</span><span class="token operator">%</span> 准确函数
x0<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0.001</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y0<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span>x0<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">(</span>x0<span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token operator">%</span><span class="token operator">%</span> 用euler法求解
<span class="token operator">%</span>根据公式依次求解被积函数的积分值
<span class="token operator">%</span> 分别按照步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>计算求解
<span class="token operator">%</span>步长： <span class="token number">0.1</span>
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">%</span>euler法只与前一项有关，循环求解即可
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span><span class="token operator">%</span> 绘制用Euler法求解y'<span class="token operator">=</span><span class="token function">2</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>y图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用Euler法求解y'=2(x+1)y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span> 用改进的euler法求解
<span class="token operator">%</span> 步长<span class="token number">0.1</span> <span class="token number">0.05</span> <span class="token number">0.025</span>
<span class="token operator">%</span> <span class="token number">0.1</span>
step<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">;</span>
x1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y11<span class="token operator">=</span>y1<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y1<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>首先运用euler做预估校正
    <span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y11</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x1</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">%</span>将预估校正的值代入进行迭代，所得为改进的euler法所求的积分值
end

<span class="token operator">%</span> <span class="token number">0.05</span>
step<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">;</span>
x2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">y2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
y21<span class="token operator">=</span>y2<span class="token punctuation">;</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y2<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y21</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x2</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end

<span class="token operator">%</span> <span class="token number">0.025</span>
step<span class="token operator">=</span><span class="token number">0.025</span><span class="token punctuation">;</span>
x3<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">:</span>step<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>
y3<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>step<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span>存储每次迭代值
<span class="token function">y3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token operator">%</span>初值为<span class="token number">1</span>
y31<span class="token operator">=</span>y3<span class="token punctuation">;</span><span class="token operator">%</span>存储y<span class="token string">''</span>
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token function">size</span><span class="token punctuation">(</span>y3<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">=</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>step<span class="token operator">/</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y31</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span><span class="token function">y3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token function">x3</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
end
<span class="token operator">%</span><span class="token operator">%</span> 绘制用改进的Euler法求解y'<span class="token operator">=</span><span class="token function">2</span><span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>y图
hold on<span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x3<span class="token punctuation">,</span>y3<span class="token punctuation">,</span><span class="token string">'linewidth'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'原函数'</span><span class="token punctuation">,</span><span class="token string">'步长为0.1'</span><span class="token punctuation">,</span><span class="token string">'步长为0.05'</span><span class="token punctuation">,</span><span class="token string">'步长为0.025'</span><span class="token punctuation">,</span><span class="token string">'Location'</span><span class="token punctuation">,</span><span class="token string">'Best'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"\fontsize{20}用改进的Euler法求解y'=2(x+1)y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ab/fe/yEB7kNDo_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/6a/6d/ZR9cP1Ac_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0d/a0/BAUv9EPm_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/9f/d5/Nd3WNn0J_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/c4/81/Z3Ii05Do_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d31c94b8b6bfa02f4a3be9d263a86724/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">缓和曲线放样资料计算与精度评定程序编写</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/82422dea1f39bb7a6b10d7ba23672d6d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">springboot2.3.0优雅停机</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>