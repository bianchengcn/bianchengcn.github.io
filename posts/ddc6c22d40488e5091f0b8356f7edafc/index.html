<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Shell脚本基础 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Shell脚本基础" />
<meta property="og:description" content="1.shell脚本的概念
将要执行的命令按顺序保存到一个文本文件
给该文件可执行权限
可结合各种shell控制语句以完成更复杂的操作
2.shell脚本应用场景
重复性操作
交互性任务
批量事务处理
服务运行状态监控
定时任务执行
.....
3.shell的作用
命令解释器，“翻译官”
介于系统内核与用户之间，负责解释命令行
用户登录后默认使用的shell程序，一般为 /bin/bash
不同shell的内部指令，运行环境等会有所区别
通过/etc/shells 文件可以了解当前系统所支持的 Shell 脚本种类
查看当前的系统支持的shell
bash:基于gun的框架下发展的shell
csh:类似c语言的shell
tcsh:整合了csh提供了更多功能
sh:已经被bash替换
nologin:让用户无法登录
4.shell脚本的构成
① 解释器 （脚本是用什么语言写的)
第一行开头 #！/bin/bash 表示此行以下的代码语句是通过/bin/bash程序来解释执行。
是默认的解释器，还有其他类型的解释器，#！/bin/python #！/bin/expect
②注释 （解释语句的含义）
以#开头的语句表示为注释信息 # 注 释
③ 执行语句
比如echo命令用于输出“ ”之间的字符串
5.如何执行脚本
①使用路径执行 （需要加执行权限）
②直接使用解释器 （不需要权限）
③source和 . 执行 （不需要权限）
使用前两种方式执行脚本会开启子bash去执行，一般用这两种
使用source和点 会影响当前的bash环境
6. 脚本错误调试
①命令错误
命令出错不会影响接下来的命令继续
②语法错误
会影响接下来的命令继续
③逻辑错误
只能自己去筛查
bash -n 脚本名称 （不在当前目录下加绝对路径） 检查语法错误" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ddc6c22d40488e5091f0b8356f7edafc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-30T14:39:40+08:00" />
<meta property="article:modified_time" content="2024-01-30T14:39:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Shell脚本基础</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>1.shell脚本的概念</p> 
<p>    将要执行的命令按顺序保存到一个文本文件</p> 
<p>    给该文件可执行权限</p> 
<p>    可结合各种shell控制语句以完成更复杂的操作</p> 
<p>2.shell脚本应用场景</p> 
<p>    重复性操作</p> 
<p>    交互性任务</p> 
<p>    批量事务处理</p> 
<p>    服务运行状态监控</p> 
<p>    定时任务执行</p> 
<p>    .....</p> 
<p>3.shell的作用</p> 
<p>    命令解释器，“翻译官”</p> 
<p>    介于系统内核与用户之间，负责解释命令行</p> 
<p>    用户登录后默认使用的shell程序，一般为 /bin/bash</p> 
<p>    不同shell的内部指令，运行环境等会有所区别</p> 
<p>    通过/etc/shells 文件可以了解当前系统所支持的 Shell 脚本种类</p> 
<p>查看当前的系统支持的shell</p> 
<p><img alt="" height="313" src="https://images2.imgbox.com/0e/5d/NhrwtfrV_o.png" width="508"></p> 
<p></p> 
<p>               bash:基于gun的框架下发展的shell</p> 
<p>               csh:类似c语言的shell</p> 
<p>               tcsh:整合了csh提供了更多功能</p> 
<p>               sh:已经被bash替换</p> 
<p>               nologin:让用户无法登录</p> 
<p>4.shell脚本的构成</p> 
<p>   ① 解释器   （脚本是用什么语言写的)</p> 
<p>       第一行开头 <strong> #！/bin/bash  </strong>  表示此行以下的代码语句是通过/bin/bash程序来解释执行。</p> 
<p>       是默认的解释器，还有其他类型的解释器，#！/bin/python        #！/bin/expect</p> 
<p>    ②注释       （解释语句的含义）</p> 
<p>        以#开头的语句表示为注释信息 # 注 释</p> 
<p>    ③ 执行语句</p> 
<p>        比如echo命令用于输出“ ”之间的字符串</p> 
<p><img alt="" height="434" src="https://images2.imgbox.com/70/98/aLmdPtxR_o.png" width="791"></p> 
<p><img alt="" height="96" src="https://images2.imgbox.com/b5/80/WfHcADCQ_o.png" width="488"></p> 
<p></p> 
<p>5.如何执行脚本</p> 
<p>    ①使用路径执行              （需要加执行权限）</p> 
<p><img alt="" height="462" src="https://images2.imgbox.com/b4/ff/2E57T3Mx_o.png" width="750">       </p> 
<p>    ②直接使用解释器           （不需要权限）</p> 
<p>    ③source和 . 执行            （不需要权限）</p> 
<p>使用前两种方式执行脚本会开启子bash去执行，一般用这两种</p> 
<p>使用source和点 会影响当前的bash环境</p> 
<p><img alt="" height="324" src="https://images2.imgbox.com/95/a3/QWvJk0eP_o.png" width="473"></p> 
<p></p> 
<p><img alt="" height="459" src="https://images2.imgbox.com/9a/a5/t4rrNMN2_o.png" width="920"></p> 
<p></p> 
<p>6.  脚本错误调试</p> 
<p>①命令错误</p> 
<p>命令出错不会影响接下来的命令继续</p> 
<p><img alt="" height="450" src="https://images2.imgbox.com/2d/72/n4ylaDfa_o.png" width="1200"></p> 
<p> ②语法错误</p> 
<p>  会影响接下来的命令继续</p> 
<p><img alt="" height="318" src="https://images2.imgbox.com/9b/b2/kzEiOdnM_o.png" width="1110"></p> 
<p> ③逻辑错误</p> 
<p> 只能自己去筛查</p> 
<p>bash -n 脚本名称 （不在当前目录下加绝对路径）     检查语法错误<br> bash -x 脚本名称 （不在当前目录下加绝对路径）     逻辑错误</p> 
<p>总结：脚本错误常见的有三种区别</p> 
<p>命令错误：默认后续的命令还会继续执行，用bash -n 无法检查出来 ，可以使用 bash -x 进行</p> 
<p>语法错误：会导致后续的命令不继续执行，可以用bash -n 检查错误，提示的出错行数不一定是准确的</p> 
<p>逻辑错误：只能使用 bash -x 进行</p> 
<p></p> 
<p>在脚本前面加上set  -e，表示脚本中如果出现错误，立即停止</p> 
<p>7. 重定向与管道符</p> 
<p>重定向:    不输出到默认设备上，输出到你指定的位置</p> 
<table><thead><tr><th><strong>类型</strong></th><th><strong>设备文件</strong></th><th><strong>文件描述编号</strong></th><th><strong>默认设备</strong></th></tr></thead><tbody><tr><td>标准输入</td><td>/dev/stdin</td><td>0</td><td>键盘</td></tr><tr><td>标准输出</td><td>/dev/stdout</td><td>1</td><td>显示器</td></tr><tr><td>标准错误输出</td><td>/dev/stderr</td><td>2</td><td>显示器</td></tr></tbody></table> 
<p> 这些设备在/dev/目录下<img alt="" height="117" src="https://images2.imgbox.com/a6/11/uZJaVxsL_o.png" width="1083"></p> 
<p>交互式硬件设备</p> 
<p>    标准输入：从该设备接收用户输入的数据</p> 
<p>    标准输出：通过该设备向用户输出数据</p> 
<p>    标准错误：通过该设备报告执行出错信息</p> 
<p><img alt="" height="421" src="https://images2.imgbox.com/6b/4e/NrQbqGua_o.png" width="1151"></p> 
<p></p> 
<p>重定向操作</p> 
<table><thead><tr><th><strong>类型</strong></th><th><strong>操作符</strong></th><th><strong>用途</strong></th></tr></thead><tbody><tr><td>重定向输入</td><td>&lt;</td><td>从指定的文件读取数据</td></tr><tr><td>重定向输出</td><td>&gt;</td><td>将标准输出结果保存到指定的文件，并且覆盖原有文件</td></tr><tr><td></td><td>&gt;&gt;</td><td>将标准输出追加到指定的文件的尾部，不覆盖原有内容</td></tr><tr><td>标准错误输出</td><td>2&gt;</td><td>将错误信息保存到指定文件，并且覆盖原有文件</td></tr><tr><td></td><td>2&gt;&gt;</td><td>将错误信息追加到指定文件的尾部，不覆盖原有内容</td></tr><tr><td>混合输出</td><td>&amp;&gt;和2&gt;&amp;1</td><td>将标准输出，标准错误保存到同—文件中</td></tr></tbody></table> 
<p><img alt="" height="460" src="https://images2.imgbox.com/e1/51/beuxlUTS_o.png" width="962"></p> 
<p> <img alt="" height="167" src="https://images2.imgbox.com/e7/ea/eGDs3Gyk_o.png" width="1123"></p> 
<p></p> 
<p>多行重定向</p> 
<p> 多行重定向通常用于将多行文本内容写入文件或从文件读取</p> 
<p>语法：命令 &gt; 文件名 &lt;&lt;自定义标记符 或 ： 命令  &lt;&lt;自定义标记符 &gt; 文件名</p> 
<p><img alt="" height="148" src="https://images2.imgbox.com/78/60/lufLA7Q6_o.png" width="1200"></p> 
<p>管道符</p> 
<p>将左侧的命令输出结果，作为右侧命令的输入（处理对象）可以 叠加使用</p> 
<p>管道符左边的命令一定要有标准输出</p> 
<p>管道符右边的命令一定要有接收标准输入</p> 
<p><img alt="" height="72" src="https://images2.imgbox.com/6b/1c/bs8Fy2x8_o.png" width="898"></p> 
<p> 在这个命令中，cat   /etc/passwd 列出文件内容，然后通过管道符将输出传递给 grep root。grep 命令会过滤出包含root字符串的行。</p> 
<p>8.变量</p> 
<p>Shell 变量用来存放系统和用户需要使用的特定参数（值）</p> 
<p>         (保存将来会变化的数据，即使数据变化，直接调用变量即可，各种 Shell 环境都使用到                   “变量”的概念)</p> 
<p>         这些参数可以根据用户的设定或系统环境的变化而相应变化</p> 
<p>         程序能够提供更加灵活的功能，适应性更强</p> 
<p>常见 Shell 变量的类型包括：</p> 
<p>     自定义变量：由用户自己定义，修改和使用<br>      预定义变量：Bash中内置的一类变量   不能修改    规定好的变量 放在那里让你使用</p> 
<p>     环境变量：由系统维护，用于设置工作环境      当前目录  当前主机名   $PATH     <br>      只读变量：只可以读取不可以更改    <br>      位置变量：通过命令行给脚本传递参数</p> 
<p>     系统内置变量：PATH，UID，HOSTNAME，USER</p> 
<p>命名要求:</p> 
<p>        区分大小写</p> 
<p>        不能使程序中的保留字和内置变量：如：if, for，hostname   命令  a=</p> 
<p>        只能使用数字、字母及下划线，且不能以数字开头，注意：不支持短横线 “ - ”，和主机名相反</p> 
<p>        不要使用内置的变量，使用英文尽量使用词义通俗易懂，PATH</p> 
<p>        大驼峰 StudentFirstName</p> 
<p>        小驼峰 studentFirstName</p> 
<p>        下划线 student_name</p> 
<p><strong>①自定义变量</strong></p> 
<p>变量名命名规则:由字母或下划线打头，不允许数字开头,后面由字母、数字或下划线组成，并且大                            小写字母意义不同。在使用变量时，在变量名前加$</p> 
<p>{}  可以定义变量的范围，确定变量的字符范围<br> “”（双引号） 可以识别变量<br> ' '（单引号） 不可以识别变量<br> ``  (反引号)可以调用命令的结果作为变量值            $（命令）也可以</p> 
<p>命名格式为：变量名=变量值</p> 
<p><img alt="" height="407" src="https://images2.imgbox.com/54/92/xzdQDoQY_o.png" width="867"></p> 
<p></p> 
<p>变量可以使用命令进行追加：变量名+=需要追加的变量值</p> 
<p><img alt="" height="256" src="https://images2.imgbox.com/d5/e6/EbwNFcyS_o.png" width="916"></p> 
<p>可以使用unset命令删除变量 ：unset 变量名</p> 
<p><img alt="" height="258" src="https://images2.imgbox.com/6b/8f/aIYIXFlf_o.png" width="688"></p> 
<p></p> 
<p>也可以通过修改配置文件<strong> /etc/profile</strong> 去自定义变量</p> 
<p>添加后重新执行下文件</p> 
<p>vim /etc/profile</p> 
<p><img alt="" height="540" src="https://images2.imgbox.com/0b/1c/1gNOTtWw_o.png" width="1097"></p> 
<p> <img alt="" height="422" src="https://images2.imgbox.com/4a/1e/fKvysNyf_o.png" width="993"></p> 
<p>还可以通过交互的方式自定义变量</p> 
<p>read -p “提示信息” 变量名</p> 
<p><img alt="" height="245" src="https://images2.imgbox.com/64/07/6Vqrhv5E_o.png" width="1083"></p> 
<p><strong>②预定义变量</strong></p> 
<p>Shell在启动时就已经存在的变量，由系统自动初始化，具有特定含义和用途 </p> 
<p>$HOME            当前用户的家目录路径。<br> $PATH              用于查找可执行文件的路径列表。<br> $PWD               当前工作目录（Present Working Directory）</p> 
<p><img alt="" height="178" src="https://images2.imgbox.com/41/36/3qQYeKRs_o.png" width="775"></p> 
<p>env命令可查看当前系统有哪些预定义变量 </p> 
<p><img alt="" height="815" src="https://images2.imgbox.com/c9/f7/SppqQCQf_o.png" width="701"></p> 
<p><strong>③环境变量</strong></p> 
<p>环境变量是一种特殊的预定义变量，不仅在当前Shell会话中可用，还会被所有子进程继承。</p> 
<p>当前shell环境中定义的变量是无法自动被其它子进程继承的</p> 
<p>需要通过export命令去赋予</p> 
<p><img alt="" height="677" src="https://images2.imgbox.com/c8/8c/ZyRPDln0_o.png" width="1050"></p> 
<p></p> 
<p><strong>  ④只读变量</strong></p> 
<p>通过readonly 命令来声明位置变量</p> 
<p>只读变量不能更改或取消设置，这是bash中只读变量的一个特性</p> 
<p>bash手册:  declare -r (与readonly相同)  -r 使名称成为只读的</p> 
<p>                  这样，就不能通过后续赋值语句或unset为这些名称赋值</p> 
<p>(只能重启shell环境来进行删除)</p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/a9/7d/MlssaSUe_o.png" width="1119"></p> 
<p><strong>⑤位置变量</strong></p> 
<p>从命令行传递给脚本或函数的参数</p> 
<p>每个参数都有一个编号，从 $0 开始，而 $1、$2、$3 等依次对应第一个、第二个、第三个参数...</p> 
<p>$0是一个特殊变量，它代表脚本的文件名</p> 
<p><img alt="" height="273" src="https://images2.imgbox.com/c4/7f/vs14RjAb_o.png" width="792"></p> 
<p><img alt="" height="295" src="https://images2.imgbox.com/aa/bf/hFsE1URP_o.png" width="949"></p> 
<p><strong> ⑥特殊变量</strong></p> 
<p>在预定义变量中，还存在一些特殊变量，比如在之前说到的$0就是一种特殊变量</p> 
<p>$*         代表一个整体，把所有位置参数当成整体返回<br> $@       代表独立个体，把所有位置参数当成个体返回<br> $？       上一条命令的执行结果是否成功。正确为0，返回任何非0值为异常<br> $#         代表位置参数个数<br> $0         代表当前脚本的名称<br> $$         当前bash的pid<br>  </p> 
<p>9.整数的运算</p> 
<p>expr只能进行整数的运算</p> 
<p>格式： expr 变量1 运算符 变量2 [运算符 变量3]</p> 
<p>运算符：+加法 、-减法 、*乘法、 /除法 、%取余（取模） </p> 
<p><img alt="" height="507" src="https://images2.imgbox.com/ef/51/6QiS4H8S_o.png" width="1199"></p> 
<p>expr 变量 + 变量 进行运算</p> 
<p><img alt="" height="205" src="https://images2.imgbox.com/4b/ed/f1bYIP0u_o.png" width="526"></p> 
<p>定义变量时使用[]运算</p> 
<p><img alt="" height="213" src="https://images2.imgbox.com/b5/7f/YY9ecCkX_o.png" width="599"></p> 
<p> 使用（（   ））进行运算</p> 
<p><img alt="" height="202" src="https://images2.imgbox.com/48/9f/zBBl66FU_o.png" width="573"></p> 
<p> 使用let运算</p> 
<p><img alt="" height="120" src="https://images2.imgbox.com/1b/e5/kb2XeD68_o.png" width="512"></p> 
<p> 使用管道符给bc运算（可以运算小数）</p> 
<p><img alt="" height="72" src="https://images2.imgbox.com/e5/f4/dqkIDffn_o.png" width="492"></p> 
<p>i++</p> 
<p> ​​​​<img alt="" height="88" src="https://images2.imgbox.com/ec/d1/EKLosZ4A_o.png" width="865"></p> 
<p> i++和++i之间的区别(i++ 是先赋值给j后再加     ++i是加后再赋值)</p> 
<p><img alt="" height="127" src="https://images2.imgbox.com/93/24/iZdyAExL_o.png" width="600"></p> 
<p> 随机取余</p> 
<p><img alt="" height="457" src="https://images2.imgbox.com/32/28/1aqPbFhe_o.png" width="911"></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4095c6736819436a974572de30a58dee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">MySQL运维实战(5.2) charset基本概念</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/14ab60e0c66975465826c39915efb98a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">关于监控的那些事，你有必要了解一下</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>