<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用yolo对图片,视频,连接相机进行物体检测 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="使用yolo对图片,视频,连接相机进行物体检测" />
<meta property="og:description" content="最近要用yolov4进行物体检测,把其中的一些问题写下来,
首先按照要求安装yolov4需要的各种东西opencv,cudnn,cuda版本等等,去官网学习怎么安装,然后将源码下载下来编译,将makefile里要用的改为=1,然后make,下载对应的权重weight
一.终端输入命令检测:
在终端运行:以下的v3也可以用v4的权重
1.检测视频MP4或者avi
./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights &lt;filename…&gt;
2.网络相机实时检测
./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights rtsp://admin:password@192.168.1.64(相机ip地址),这种方法的延迟很严重
3.检测示例图片
./darknet detect cfg/yolov3.cfg yolov3.weights data/giraffe.jpg(路径加图片名称)
二.调用Python脚本实时检测
更改darknet_video.py里的line82/83,根据需要选择是读取视频还是相机实时检测,注释不要的那一行;
运行ls /dev/video*看USB接口的相机是第几个,一般0代表
用自带Python运行检测,更改括号里面的数字,0一般代表笔记本前置摄像头,1和2代表其他相机摄像头;
如果搞不清要写几,终端运行ls /dev/video*.我的会出来/dev/video0 /dev/video1 /dev/video2
三个, 不知道为什么那么多,我把参数改为2就可以调用usb口的摄像头,但是我要连接网络相机(网线接口),暂时还没搞出来怎弄.
终端输入运行python darknet_video.py
有时候会报错,换成python3 darknet_video.py
然后也许还有错(python:10196): GStreamer-CRITICAL **: gst_caps_get_structure: assertion ‘index &lt; GST CAPS LEN (caps)’ failed
改一下这个
给cv2.so改个名字
cd /opt/ros/kinetic/lib/python2.7/dist-packages/
sudo mv cv2.so cv2_ros.so
因为可能安装Python和cv的时候有弄混的情况,根据情况改
如果视频卡顿,更改yolov3.cfg/yolov4.cfg里的width和height,改小一点416足够(32的倍数);
Python脚本运行实时检测网络摄像头更新
用yolo实时调用海康威视云台相机进行物体检测用自带Python脚本运行
将前面的 更改darknet_video.py里的line82/83,改为
cap = cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/adfc1e4ef89d151b4c38946cec4edf80/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-05-21T22:47:31+08:00" />
<meta property="article:modified_time" content="2020-05-21T22:47:31+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用yolo对图片,视频,连接相机进行物体检测</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>最近要用yolov4进行物体检测,把其中的一些问题写下来,</p> 
<p>首先按照要求安装yolov4需要的各种东西opencv,cudnn,cuda版本等等,去官网学习怎么安装,然后将源码下载下来编译,将makefile里要用的改为=1,然后make,下载对应的权重weight</p> 
<p><strong>一.终端输入命令检测:</strong><br> 在终端运行:以下的v3也可以用v4的权重<br> 1.检测视频MP4或者avi<br> ./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights &lt;filename…&gt;<br> 2.网络相机实时检测<br> ./darknet detector demo cfg/coco.data cfg/yolov3.cfg yolov3.weights rtsp://admin:password@192.168.1.64(相机ip地址),这种方法的延迟很严重<br> 3.检测示例图片<br> ./darknet detect cfg/yolov3.cfg yolov3.weights data/giraffe.jpg(路径加图片名称)</p> 
<p><strong>二.调用Python脚本实时检测</strong><br> 更改darknet_video.py里的line82/83,根据需要选择是读取视频还是相机实时检测,注释不要的那一行;</p> 
<p>运行ls /dev/video*看USB接口的相机是第几个,一般0代表<br> 用自带Python运行检测,更改括号里面的数字,0一般代表笔记本前置摄像头,1和2代表其他相机摄像头;</p> 
<p>如果搞不清要写几,终端运行ls /dev/video*.我的会出来/dev/video0 /dev/video1 /dev/video2<br> 三个, 不知道为什么那么多,我把参数改为2就可以调用usb口的摄像头,但是我要连接网络相机(网线接口),暂时还没搞出来怎弄.</p> 
<p>终端输入运行python darknet_video.py<br> 有时候会报错,换成python3 darknet_video.py</p> 
<p>然后也许还有错(python:10196): GStreamer-CRITICAL **: gst_caps_get_structure: assertion ‘index &lt; GST CAPS LEN (caps)’ failed</p> 
<p>改一下这个<br> 给cv2.so改个名字<br> cd /opt/ros/kinetic/lib/python2.7/dist-packages/<br> sudo mv cv2.so cv2_ros.so<br> 因为可能安装Python和cv的时候有弄混的情况,根据情况改</p> 
<p>如果视频卡顿,更改yolov3.cfg/yolov4.cfg里的width和height,改小一点416足够(32的倍数);</p> 
<p>Python脚本运行实时检测网络摄像头更新</p> 
<p>用yolo实时调用海康威视云台相机进行物体检测用自带Python脚本运行<br> 将前面的 更改darknet_video.py里的line82/83,改为<br> cap = cv2.VideoCapture(“rtsp://admin:password@192.168.1.64/h264/ch1/main/av_stream”)<br> 但是实时卡顿还是很严重,好像可以通过开多个线程对数据流进行实时处理,但是我没学过Python,不会改,哪位大神可以指点一下??</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d7b4846a966347c080f9c1261c30c5e4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">基于AutoJs的抖音短视频养号Apk文件</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/efe2dcd56506821cb747dbf98ba5a7ba/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">图形类设计——c&#43;&#43;圆、矩形、三角形类的设计</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>