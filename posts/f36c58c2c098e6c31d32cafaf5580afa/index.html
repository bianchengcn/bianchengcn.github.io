<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>html5&#43; downloader-下载管理 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="html5&#43; downloader-下载管理" />
<meta property="og:description" content="downloader-下载管理 Downloader模块管理网络文件下载任务，用于从服务器下载各种文件，并支持跨域访问操作。通过plus.downloader获取下载管理对象。Downloader下载使用HTTP的GET/POST方式请求下载文件，符合标准HTTP/HTTPS传输协议。
方法： createDownload: 新建下载任务enumerate: 枚举下载任务clear: 清除下载任务startAll: 开始所有下载任务 对象： Download: Download对象管理一个下载任务DownloadEvent: 下载任务事件类型DownloadState: 下载任务状态DownloadOptions: 下载任务参数 回调方法： DownloadCompletedCallback: 下载任务完成时的回调DownloadStateChangedCallback: 下载任务状态变化回调DownloadEnumerateCallback: 枚举下载任务回调 权限： 5&#43;功能模块（permissions）
{ // ... &#34;permissions&#34;:{ // ... &#34;Downloader&#34;: { &#34;description&#34;: &#34;文件下载，管理文件下载任务&#34; } } } Download Download对象管理一个下载任务
interface Download { readonly attribute String id; readonly attribute String url; readonly attribute Number state; readonly attribute DownloadOptions options; readonly attribute String filename; readonly attribute Number downloadedSize; readonly attribute Number totalSize; function void abort(); function void addEventListener( String event, function Callback listener, Boolean capture ); function String getAllResponseHeaders(); function String getResponseHeader( headerName ); function void pause(); function void resume(); function void setRequestHeader( String headerName, String headerValue ); function void start(); } 属性： id: 下载任务的标识url: 下载文件的地址state: 任务的状态options: 下载任务的参数filename: 下载的文件名称downloadedSize: 已完成下载文件的大小totalSize: 下载任务文件的总大小 方法： abort: 取消下载任务addEventListener: 添加下载任务事件监听器getAllResponseHeaders: 获取下载请求HTTP响应头部信息getResponseHeader: 获取下载请求指定的HTTP响应头部的值pause: 暂停下载任务resume: 恢复暂停的下载任务setRequestHeader: 设置下载请求的HTTP头数据start: 开始下载任务 DownloadEvent 下载任务事件类型" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f36c58c2c098e6c31d32cafaf5580afa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-10-08T16:57:42+08:00" />
<meta property="article:modified_time" content="2018-10-08T16:57:42+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">html5&#43; downloader-下载管理</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="downloader_0"></a>downloader-下载管理</h2> 
<p>Downloader模块管理网络文件下载任务，用于从服务器下载各种文件，并支持跨域访问操作。通过plus.downloader获取下载管理对象。Downloader下载使用HTTP的GET/POST方式请求下载文件，符合标准HTTP/HTTPS传输协议。</p> 
<h3><a id="_5"></a>方法：</h3> 
<ul><li><a href="#plus.downloader.createDownload" rel="nofollow">createDownload</a>: 新建下载任务</li><li><a href="#plus.downloader.enumerate" rel="nofollow">enumerate</a>: 枚举下载任务</li><li><a href="#plus.downloader.clear" rel="nofollow">clear</a>: 清除下载任务</li><li><a href="#plus.downloader.startAll" rel="nofollow">startAll</a>: 开始所有下载任务</li></ul> 
<h3><a id="_13"></a>对象：</h3> 
<ul><li><a href="#plus.downloader.Download" rel="nofollow">Download</a>: Download对象管理一个下载任务</li><li><a href="#plus.downloader.DownloadEvent" rel="nofollow">DownloadEvent</a>: 下载任务事件类型</li><li><a href="#plus.downloader.DownloadState" rel="nofollow">DownloadState</a>: 下载任务状态</li><li><a href="#plus.downloader.DownloadOptions" rel="nofollow">DownloadOptions</a>: 下载任务参数</li></ul> 
<h3><a id="_21"></a>回调方法：</h3> 
<ul><li><a href="#plus.downloader.DownloadCompletedCallback" rel="nofollow">DownloadCompletedCallback</a>: 下载任务完成时的回调</li><li><a href="#plus.downloader.DownloadStateChangedCallback" rel="nofollow">DownloadStateChangedCallback</a>: 下载任务状态变化回调</li><li><a href="#plus.downloader.DownloadEnumerateCallback" rel="nofollow">DownloadEnumerateCallback</a>: 枚举下载任务回调</li></ul> 
<h3><a id="_28"></a>权限：</h3> 
<p>5+功能模块（permissions）</p> 
<pre class=" language-js"><code class="prism  language-js"><span class="token punctuation">{<!-- --></span>
<span class="token comment">// ...</span>
<span class="token string">"permissions"</span><span class="token punctuation">:</span><span class="token punctuation">{<!-- --></span>
	<span class="token comment">// ...</span>
	<span class="token string">"Downloader"</span><span class="token punctuation">:</span> <span class="token punctuation">{<!-- --></span>
		<span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"文件下载，管理文件下载任务"</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="Download_46"></a>Download</h2> 
<p>Download对象管理一个下载任务</p> 
<pre class=" language-js"><code class="prism  language-js"><span class="token keyword">interface</span> <span class="token class-name">Download</span> <span class="token punctuation">{<!-- --></span>
	readonly attribute String id<span class="token punctuation">;</span>
	readonly attribute String url<span class="token punctuation">;</span>
	readonly attribute Number state<span class="token punctuation">;</span>
	readonly attribute DownloadOptions options<span class="token punctuation">;</span>
	readonly attribute String filename<span class="token punctuation">;</span>
	readonly attribute Number downloadedSize<span class="token punctuation">;</span>
	readonly attribute Number totalSize<span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">addEventListener</span><span class="token punctuation">(</span> String event<span class="token punctuation">,</span> <span class="token keyword">function</span> Callback listener<span class="token punctuation">,</span> Boolean capture <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> String <span class="token function">getAllResponseHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> String <span class="token function">getResponseHeader</span><span class="token punctuation">(</span> headerName <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">setRequestHeader</span><span class="token punctuation">(</span> String headerName<span class="token punctuation">,</span> String headerValue <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">function</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_72"></a>属性：</h3> 
<ul><li><a href="#plus.downloader.Download.id" rel="nofollow">id</a>: 下载任务的标识</li><li><a href="#plus.downloader.Download.url" rel="nofollow">url</a>: 下载文件的地址</li><li><a href="#plus.downloader.Download.state" rel="nofollow">state</a>: 任务的状态</li><li><a href="#plus.downloader.Download.options" rel="nofollow">options</a>: 下载任务的参数</li><li><a href="#plus.downloader.Download.filename" rel="nofollow">filename</a>: 下载的文件名称</li><li><a href="#plus.downloader.Download.downloadedSize" rel="nofollow">downloadedSize</a>: 已完成下载文件的大小</li><li><a href="#plus.downloader.Download.totalSize" rel="nofollow">totalSize</a>: 下载任务文件的总大小</li></ul> 
<h3><a id="_83"></a>方法：</h3> 
<ul><li><a href="#plus.downloader.Download.abort" rel="nofollow">abort</a>: 取消下载任务</li><li><a href="#plus.downloader.Download.addEventListener" rel="nofollow">addEventListener</a>: 添加下载任务事件监听器</li><li><a href="#plus.downloader.Download.getAllResponseHeaders" rel="nofollow">getAllResponseHeaders</a>: 获取下载请求HTTP响应头部信息</li><li><a href="#plus.downloader.Download.getResponseHeader" rel="nofollow">getResponseHeader</a>: 获取下载请求指定的HTTP响应头部的值</li><li><a href="#plus.downloader.Download.pause" rel="nofollow">pause</a>: 暂停下载任务</li><li><a href="#plus.downloader.Download.resume" rel="nofollow">resume</a>: 恢复暂停的下载任务</li><li><a href="#plus.downloader.Download.setRequestHeader" rel="nofollow">setRequestHeader</a>: 设置下载请求的HTTP头数据</li><li><a href="#plus.downloader.Download.start" rel="nofollow">start</a>: 开始下载任务</li></ul> 
<h2><a id="DownloadEvent_95"></a>DownloadEvent</h2> 
<p>下载任务事件类型</p> 
<h3><a id="_100"></a>常量：</h3> 
<ul><li> <p>“statechanged”: _(String 类型 )_下载任务状态变化事件</p> <p>当下载任务状态发生变化时触发此事件，事件原型参考DownloadStateChangedCallback。</p> </li></ul> 
<h2><a id="DownloadState_108"></a>DownloadState</h2> 
<p>下载任务状态</p> 
<h3><a id="_113"></a>常量：</h3> 
<ul><li> <p>undefined: _(undefined 类型 )_下载任务未开始</p> <p>通过plus.downloader.createDownload()方法创建下载任务后的初始状态，此时可调用其start()方法开始下载。</p> </li><li> <p>0: _(Number 类型 )_下载任务开始调度</p> <p>调用下载任务的start()方法之后处于此状态，此时下载任务处于可调度下载状态。</p> </li><li> <p>1: _(Number 类型 )_下载任务开始请求</p> <p>下载任务建立网络连接，发送请求到服务器并等待服务器的响应。</p> </li><li> <p>2: _(Number 类型 )_下载任务请求已经接收</p> <p>下载任务网络连接已建立，服务器返回响应，准备传输数据内容。</p> </li><li> <p>3: _(Number 类型 )_下载任务接收数据</p> <p>下载任务接收数据，监听statechanged事件时可多次触发此状态。</p> </li><li> <p>4: _(Number 类型 )_下载任务已完成</p> <p>下载任务完成数据传输并断开连接，下载成功或失败都会设置为此状态。</p> </li><li> <p>5: _(Number 类型 )_下载任务已暂停</p> <p>调用下载任务的pause()方法将任务暂停，此时可调用其resume()方法重新开始下载。</p> </li><li> <p>-1: _(Number 类型 )_枚举任务状态</p> <p>非下载任务状态，泛指所有下载任务的状态，用于enumerate()和clear()操作时指定作用于所有下载任务。</p> </li></ul> 
<h2><a id="DownloadOptions_149"></a>DownloadOptions</h2> 
<p>下载任务参数</p> 
<h3><a id="_154"></a>说明：</h3> 
<p>在创建下载任务时设置的参数，如设置下载任务使用的HTTP协议类型、优先级等。</p> 
<h3><a id="_159"></a>属性：</h3> 
<ul><li> <p>method: _(String 类型 )_网络请求类型</p> <p>支持http协议的“GET”、“POST”，默认为“GET”请求。</p> </li><li> <p>data: _(String 类型 )_POST请求时提交的数据</p> <p>仅在网络请求类型method设置为"POST"时有效，"GET"请求时忽略此数据。</p> </li><li> <p>filename: _(String 类型 )_下载文件保存的路径</p> <p>保存文件路径仅支持以"_downloads/"、"_doc/"、"_documents/“开头的字符串。 文件路径以文件后缀名结尾（如”_doc/download/a.doc"）表明指定保存文件目录及名称，以“/”结尾则认为指定保存文件的目录（此时程序自动生成文件名）。 如果指定的文件已经存在，则自动在文件名后面加"(i)"，其中i为数字，如果文件名称后面已经是此格式，则数字i递增，如"download(1).doc"。 默认保存目录为（"_downloads"），并自动生成文件名称。</p> </li><li> <p>priority: _(Number 类型 )_下载任务的优先级</p> <p>数值类型，数值越大优先级越高，默认优先级值为0。</p> </li><li> <p>timeout: _(Number 类型 )_下载任务超时时间</p> <p>数值类型，单位为s(秒)，默认值为120s。 超时时间为服务器响应请求的时间（不是下载任务完成的总时间），如果设置为0则表示永远不超时。</p> </li><li> <p>retry: _(Number 类型 )_下载任务重试次数</p> <p>数值类型，默认为重试3次。</p> </li><li> <p>retryInterval: _(Number 类型 )_下载任务重试间隔时间</p> <p>数值类型，单位为s(秒)，默认值为30s。</p> </li></ul> 
<h2><a id="DownloadCompletedCallback_191"></a>DownloadCompletedCallback</h2> 
<p>下载任务完成时的回调</p> 
<pre class=" language-js"><code class="prism  language-js">vaoid <span class="token function">onCompleted</span><span class="token punctuation">(</span> Download download<span class="token punctuation">,</span> Number status <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// Download file complete code</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_203"></a>说明：</h3> 
<p>下载任务完成时的回调函数，在下载任务完成时调用。 下载任务失败也将触发此回调。</p> 
<h3><a id="_208"></a>参数：</h3> 
<ul><li> <p>download : <em>( <a href="#plus.downloader.Download" rel="nofollow">Download</a> ) 必选</em> 下载任务对象</p> </li><li> <p>status: <em>( Number ) 必选</em> 下载结果状态码<br> HTTP传输协议状态码，如果未获取传输状态则其值则为0，如下载成功其值通常为200。</p> </li></ul> 
<h3><a id="_216"></a>返回值：</h3> 
<p>void : 无</p> 
<h2><a id="DownloadStateChangedCallback_221"></a>DownloadStateChangedCallback</h2> 
<p>下载任务状态变化回调</p> 
<pre class=" language-js"><code class="prism  language-js"><span class="token keyword">void</span> <span class="token function">onStateChanged</span><span class="token punctuation">(</span> Download download<span class="token punctuation">,</span> status <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// Download state changed code.</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_233"></a>参数：</h3> 
<ul><li> <p>download : <em>( <a href="#plus.downloader.Download" rel="nofollow">Download</a> ) 必选</em> 下载任务对象</p> </li><li> <p>status: <em>( Number ) 必选</em> 下载结果状态码<br> HTTP传输协议状态码，如果未获取传输状态则其值则为0，如下载成功其值通常为200。</p> </li></ul> 
<h3><a id="_241"></a>返回值：</h3> 
<p>void : 无</p> 
<h2><a id="DownloadEnumerateCallback_246"></a>DownloadEnumerateCallback</h2> 
<p>枚举下载任务回调</p> 
<pre class=" language-js"><code class="prism  language-js"><span class="token keyword">void</span> <span class="token function">onEnumerated</span><span class="token punctuation">(</span> Download\<span class="token punctuation">[</span>\<span class="token punctuation">]</span> downloads <span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
	<span class="token comment">// Enumerate success code</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="_258"></a>参数：</h3> 
<ul><li>downloads: <em>( Array[ Download ] ) 必选</em> 枚举到的下载任务对象数组</li></ul> 
<h3><a id="_264"></a>返回值：</h3> 
<p>void : 无</p> 
<pre><code class="language-html"><code class="prism  language-html"><span class="token doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initial-scale=1.0, maximum-scale=1.0, user-scalable=no<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>HandheldFriendly<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>MobileOptimized<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>320<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hello H5+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
			<span class="token keyword">var</span> dtask <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

			<span class="token keyword">function</span> <span class="token function">createDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>dtask<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token function">outLine</span><span class="token punctuation">(</span><span class="token string">"下载任务已创建！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">"http://snip.qq.com/resources/Snip_V2.0_5771.dmg"</span><span class="token punctuation">;</span>
				<span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
					method<span class="token punctuation">:</span> <span class="token string">"GET"</span>
				<span class="token punctuation">}</span><span class="token punctuation">;</span>
				dtask <span class="token operator">=</span> plus<span class="token punctuation">.</span>downloader<span class="token punctuation">.</span><span class="token function">createDownload</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
				dtask<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"statechanged"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>task<span class="token punctuation">,</span> status<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dtask<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">return</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
					<span class="token keyword">switch</span> <span class="token punctuation">(</span>task<span class="token punctuation">.</span>state<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
						<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment">// 开始</span>
							<span class="token function">outLine</span><span class="token punctuation">(</span><span class="token string">"开始下载..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token comment">// 已连接到服务器</span>
							<span class="token function">outLine</span><span class="token punctuation">(</span><span class="token string">"链接到服务器..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token comment">// 已接收到数据</span>
							<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"下载数据更新:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token function">outLine</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span>downloadedSize <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> task<span class="token punctuation">.</span>totalSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token comment">// 下载完成</span>
							<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"下载完成！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token function">outLine</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span>totalSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"创建下载任务成功！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">function</span> <span class="token function">startDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dtask<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
					<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"请先创建下载任务！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">return</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				dtask<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 暂停下载任务</span>
			<span class="token keyword">function</span> <span class="token function">pauseDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				dtask<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"暂停下载！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 恢复下载任务</span>
			<span class="token keyword">function</span> <span class="token function">resumeDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				dtask<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"恢复下载！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">function</span> <span class="token function">cancelDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				dtask<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				dtask <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
				<span class="token function">outSet</span><span class="token punctuation">(</span><span class="token string">"取消下载任务！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">function</span> <span class="token function">clearDownloadTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

			<span class="token punctuation">}</span>

			<span class="token keyword">function</span> <span class="token function">startAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
				plus<span class="token punctuation">.</span>downloader<span class="token punctuation">.</span><span class="token function">startAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nvbt iback<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>back()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nvtt<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Downloader<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nvbt idoc<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openDoc(<span class="token punctuation">'</span>Downloader Document<span class="token punctuation">'</span>,<span class="token punctuation">'</span>/doc/downloader.html<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dcontent<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dcontent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dlist<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ditem<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>createDownloadTask()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>创建下载任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ditem<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>startDownloadTask()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>启动下载任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ditem<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pauseDownloadTask()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>暂停下载任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ditem<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>resumeDownloadTask()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>恢复下载任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ditem<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cancelDownloadTask()<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>取消下载任务<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
				<span class="token comment">&lt;!--&lt;li class="ditem" onclick="clearDownloadTask()"&gt;清除所有任务&lt;/li&gt;--&gt;</span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>output<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
			Downloader用于管理文件的下载，可从网络下载各种文件，并支持跨域访问。
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/5de4c67ca09d3840b51247e88ad1c266/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">移动互联网浩荡十年 有的升腾，有的陨落</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/455e4083da6846e27f385e4a30980431/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">hml5&#43; Android创建快捷方式</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>