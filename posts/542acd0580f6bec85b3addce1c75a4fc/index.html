<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Java项目】 在线OJ系统 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【Java项目】 在线OJ系统" />
<meta property="og:description" content="项目Gitee源码链接：https://gitee.com/zx201014/ojproject
项目GitHub源码链接：https://github.com/zx04180521/OJProject
目录 项目简介1.项目实现步骤1.1数据库的创建1.2创建数据库工具类Util1.3创建能够实现运行命令的类CommandUtil1.4创建生成目录以及构造指令的类Task1.5创建数据库的实体类Problem以及数据库操作类ProblemDAO1.6 创建Servlet代码1.7代码中用到的一些文件操作工具类 2 单元测试2.1插入数据测试2.2删除数据测试2.3 查询所有题目列表2.4 查询题目详情2.5 Task编译运行的测试 项目简介 在线OJ系统就是大家平时刷题的网站，比如力扣，我的这个系统就是模仿力扣网站做了一个简单的OJ系统，不过目前只实现了部分功能，比如展示题目列表，查看题目详情，编写代码，提交运行
1.项目实现步骤 1.1数据库的创建 这个项目的数据库比较简单，只有一张表：题目表，其中表的字段有题目id、题目名称、题目难度、题目描述、题目模板代码、题目测试代码。
解释：题目的模板代码指的是用户可以看到的代码，也就是给用户提供了一个实现的函数，题目的测试代码指的是用户提交代码之后，进行运行校验结果时的测试代码，也就是主函数
创建数据库代码：
create database if not exists ojProject; use ojProject; create table oj_table( id int primary key auto_increment, title varchar(50), level varchar(20), description varchar(4096), templateCode varchar(4096), testCode varchar(4096) ); 1.2创建数据库工具类Util 在这个类中，能够向其他类提供建立数据库连接的接口以及关闭数据库连接的接口
public class DBUtil { //连接数据库的URL public static String URL = &#34;jdbc:mysql://localhost:3306/ojProject?characterEncoding=utf8&amp;useSSL=true&#34;; //数据库的用户名 public static String USER = &#34;root&#34;; //数据库的密码 public static String PASSWORD = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/542acd0580f6bec85b3addce1c75a4fc/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-08-19T23:57:06+08:00" />
<meta property="article:modified_time" content="2021-08-19T23:57:06+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Java项目】 在线OJ系统</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><mark>项目Gitee源码链接：https://gitee.com/zx201014/ojproject<br> 项目GitHub源码链接：https://github.com/zx04180521/OJProject</mark></p> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li><a href="#_6" rel="nofollow">项目简介</a></li><li><a href="#1_9" rel="nofollow">1.项目实现步骤</a></li><li><ul><li><a href="#11_10" rel="nofollow">1.1数据库的创建</a></li><li><a href="#12Util_29" rel="nofollow">1.2创建数据库工具类Util</a></li><li><a href="#13CommandUtil_96" rel="nofollow">1.3创建能够实现运行命令的类CommandUtil</a></li><li><a href="#14Task_159" rel="nofollow">1.4创建生成目录以及构造指令的类Task</a></li><li><a href="#15ProblemProblemDAO_334" rel="nofollow">1.5创建数据库的实体类Problem以及数据库操作类ProblemDAO</a></li><li><a href="#16_Servlet_531" rel="nofollow">1.6 创建Servlet代码</a></li><li><a href="#17_759" rel="nofollow">1.7代码中用到的一些文件操作工具类</a></li></ul> 
  </li><li><a href="#2__853" rel="nofollow">2 单元测试</a></li><li><ul><li><a href="#21_854" rel="nofollow">2.1插入数据测试</a></li><li><a href="#22_924" rel="nofollow">2.2删除数据测试</a></li><li><a href="#23__938" rel="nofollow">2.3 查询所有题目列表</a></li><li><a href="#24__951" rel="nofollow">2.4 查询题目详情</a></li><li><a href="#25_Task_961" rel="nofollow">2.5 Task编译运行的测试</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_6"></a>项目简介</h2> 
<p>在线OJ系统就是大家平时刷题的网站，比如力扣，我的这个系统就是模仿力扣网站做了一个简单的OJ系统，不过目前只实现了部分功能，比如展示题目列表，查看题目详情，编写代码，提交运行</p> 
<h2><a id="1_9"></a>1.项目实现步骤</h2> 
<h3><a id="11_10"></a>1.1数据库的创建</h3> 
<p>这个项目的数据库比较简单，只有一张表：题目表，其中表的字段有题目id、题目名称、题目难度、题目描述、题目模板代码、题目测试代码。</p> 
<p><strong>解释</strong>：题目的模板代码指的是用户可以看到的代码，也就是给用户提供了一个实现的函数，题目的测试代码指的是用户提交代码之后，进行运行校验结果时的测试代码，也就是主函数</p> 
<p><strong>创建数据库代码：</strong></p> 
<pre><code class="prism language-java">create database <span class="token keyword">if</span> not exists ojProject<span class="token punctuation">;</span>

use ojProject<span class="token punctuation">;</span>
create table <span class="token function">oj_table</span><span class="token punctuation">(</span>
    id <span class="token keyword">int</span> primary key auto_increment<span class="token punctuation">,</span>
    title <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    level <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    description <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    templateCode <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    testCode <span class="token function">varchar</span><span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h3><a id="12Util_29"></a>1.2创建数据库工具类Util</h3> 
<p>在这个类中，能够向其他类提供建立数据库连接的接口以及关闭数据库连接的接口</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DBUtil</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//连接数据库的URL</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> URL <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/ojProject?characterEncoding=utf8&amp;useSSL=true"</span><span class="token punctuation">;</span>
    <span class="token comment">//数据库的用户名</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> USER <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>
    <span class="token comment">//数据库的密码</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> PASSWORD <span class="token operator">=</span> <span class="token string">"123456"</span><span class="token punctuation">;</span>
    <span class="token comment">//数据库连接池对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">MysqlDataSource</span> dataSource <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">//创建数据库连接对象的方法</span>
    <span class="token comment">// 在这个方法中，使用的双重判断加上synchronize锁的单例模式</span>
    <span class="token comment">// 能够保证在多线程下只创建出一个数据库连接池对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">MysqlDataSource</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataSource <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>dataSource <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MysqlDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataSource<span class="token punctuation">.</span><span class="token function">setURL</span><span class="token punctuation">(</span>URL<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataSource<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>USER<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>PASSWORD<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//获取数据库连接的方法</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token function">getDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//关闭数据库连接的方法</span>
    <span class="token comment">//其中关闭数据库连接必须按照ResultSet、PrepareStatement、Connection的顺序关闭</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> connection<span class="token punctuation">,</span> <span class="token class-name">PreparedStatement</span> statement<span class="token punctuation">,</span> <span class="token class-name">ResultSet</span> resultSet<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>statement <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="13CommandUtil_96"></a>1.3创建能够实现运行命令的类CommandUtil</h3> 
<p>在这个类中，对外提供了一个run(String cmd, String stdoutFile, String stderrFile)方法。<br> <strong>其中第一个参数cmd</strong>表示需要执行的指令，比如javac、java等等，运行这些指令之后会有标准错误以及标准输出的内容，比如运行java指令之后的标准输出指的是程序运行的结果，对应的标准错误指的是程序运行出错的原因。<br> <strong>第二个参数</strong>表示运行指令之后将运行的标准输出存储到参数指定的文件中<br> <strong>第三个参数</strong>表示运行指令之后将运行的标准错误存储到参数指定的文件中</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommandUtil</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//run方法主要用于进行创建线程并执行命令</span>
    <span class="token comment">//cmd表示要执行的命令，比如javac</span>
    <span class="token comment">//stdoutFile指定标准输出写到哪个文件</span>
    <span class="token comment">//stderrFile指定标准错误写到那个文件中</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">String</span> cmd<span class="token punctuation">,</span> <span class="token class-name">String</span> stdoutFile<span class="token punctuation">,</span>
                          <span class="token class-name">String</span> stderrFile<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//java中对于多进程的操作比较粗糙，不方便进行精细化的操作</span>
        <span class="token comment">//但是当前业够用</span>
        <span class="token comment">//使用Runtime这样的类来创建进程</span>
        <span class="token comment">//注意Runtime比较特殊，使用的时候不需要手动创建实例，而是使用现有的实际就可以了</span>
        <span class="token comment">//一个java程序中，Runtime的实例只有一个，不应该有多个，成为"单例模式"</span>
        <span class="token comment">//Process对象其实就是用来表示新创建出来的进程</span>
        <span class="token comment">//新进程创建出来之后，新的进程和当前的进程是一个并列关系，并发执行，</span>
        <span class="token comment">// 但是执行的先后顺序不确定</span>
        <span class="token class-name">Process</span> process <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//当新的进程跑起来时候。就需要获取新的进程的输出结果</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stdoutFile <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//读入写出</span>
            <span class="token comment">//getInputStream()得到的标准输出</span>
            <span class="token comment">// 通过这个对象，就可以读取到新进程的标准输出内容</span>
            <span class="token class-name">InputStream</span> stdoutFrom <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">FileOutputStream</span> stdoutTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>stdoutFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//接下来就从新进程一次读取每个字节，写入到stdoutFile文件中</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> c <span class="token operator">=</span> stdoutFrom<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                stdoutTo<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//文件读写完毕，关闭文件</span>
            stdoutFrom<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            stdoutTo<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stderrFile <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//getErrorStream()得到的是标准错误</span>
            <span class="token class-name">InputStream</span> stderrFrom <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">getErrorStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileOutputStream</span> stderrTo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>stderrFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">int</span> c <span class="token operator">=</span> stderrFrom<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                stderrTo<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            stderrFrom<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            stderrTo<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//等待新进程结束并获取到退出码</span>
        <span class="token keyword">int</span> exitCode <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> exitCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="14Task_159"></a>1.4创建生成目录以及构造指令的类Task</h3> 
<p>在这个类中，我们需要在构造方法中每次生成独立目录，目的就是为了多次执行指令两两之间不会互相影响<br> 生成随机目录我用的方法是UUID.randomUUID()<br> 1.这个类涉及到最终的编译运行，左移方法参数中需要传进来最终需要编译运行的代码，这个代码通过自定义的类Quesition来表示，里面只要一个字符串属性 code 表示最终的代码，还有对应的get，set方法<br> 2. 将最终的响应结果也包装成一个Answer类，属性有整型的错误码error，0表示运行成功，1表示编译出错，2表示运行出错，还有属性reason 表示错误的原因，stdout标准输出的内容。</p> 
<p>Quesition类的代码：</p> 
<pre><code class="prism language-java"><span class="token comment">//表示编译运行的输入</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//编译运行的代码</span>
    <span class="token comment">//用户在网页上编辑的代码</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> code<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>Answer类：</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">compile</span><span class="token punctuation">;</span>

<span class="token comment">//表示编译运行的结果</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Answer</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//这里的字段就是最终反馈到页面的信息</span>
    <span class="token comment">//运行结果是否正确</span>
    <span class="token comment">// 0表示编译运行正常，1 表示编译运行出错，2 表示运行异常</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> error<span class="token punctuation">;</span>
    <span class="token comment">//如果出错了，原因是什么</span>
    <span class="token comment">// error 是 1，reason包含了编译错误的信息</span>
    <span class="token comment">// error 是 2，reason包含了异常的调用栈信息</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> reason<span class="token punctuation">;</span>
    <span class="token comment">//程序的标准输出</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> stdout<span class="token punctuation">;</span>
    <span class="token comment">//程序的标准错误</span>
<span class="token comment">//    private String stderr;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setError</span><span class="token punctuation">(</span><span class="token keyword">int</span> error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getReason</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setReason</span><span class="token punctuation">(</span><span class="token class-name">String</span> reason<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>reason <span class="token operator">=</span> reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getStdout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> stdout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStdout</span><span class="token punctuation">(</span><span class="token class-name">String</span> stdout<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stdout <span class="token operator">=</span> stdout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Answer{"</span> <span class="token operator">+</span>
                <span class="token string">"error="</span> <span class="token operator">+</span> error <span class="token operator">+</span>
                <span class="token string">", reason='"</span> <span class="token operator">+</span> reason <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", stdout='"</span> <span class="token operator">+</span> stdout <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>Tast类</p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">compile</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token class-name">Util<span class="token punctuation">.</span>FileUtil</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>UUID<span class="token punctuation">;</span>

<span class="token comment">//用这个类表示一个完整的编译运行过程</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Task</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//此处罗列出需要的临时文件（用于进程间通信） 文件名约定</span>
    <span class="token comment">//所有的临时文件要放到这个目录中</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> WORK_DIR<span class="token punctuation">;</span>
    <span class="token comment">//要编译执行的类的名字，影响到源代码的文件名</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> CLASS <span class="token operator">=</span> <span class="token string">"Solution"</span><span class="token punctuation">;</span>
    <span class="token comment">//要编译执行的文件名</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> CODE<span class="token punctuation">;</span>
    <span class="token comment">//程序标准输出放置的文件</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> STDOUT<span class="token punctuation">;</span>
    <span class="token comment">//程序标准错误放置的文件</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> STDERR<span class="token punctuation">;</span>
    <span class="token comment">//程序编译出错详细信息放置的文件</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> COMPILE_ERROR<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//生成唯一ID,根据这个id拼装出目录的名字</span>
        WORK_DIR<span class="token operator">=</span><span class="token string">"./tmp/"</span><span class="token operator">+</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"/"</span><span class="token punctuation">;</span>
        CODE<span class="token operator">=</span>WORK_DIR<span class="token operator">+</span>CLASS<span class="token operator">+</span><span class="token string">".java"</span><span class="token punctuation">;</span>
        STDOUT<span class="token operator">=</span>WORK_DIR<span class="token operator">+</span><span class="token string">"stdout.txt"</span><span class="token punctuation">;</span>
        STDERR<span class="token operator">=</span>WORK_DIR<span class="token operator">+</span><span class="token string">"stderr.txt"</span><span class="token punctuation">;</span>
        COMPILE_ERROR<span class="token operator">=</span>WORK_DIR<span class="token operator">+</span><span class="token string">"compile_error.txt"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//Question表示用户提交的代码</span>
    <span class="token comment">//Answer表示代码的编译运行结果</span>
    <span class="token keyword">public</span> <span class="token class-name">Answer</span> <span class="token function">compileAndRun</span><span class="token punctuation">(</span><span class="token class-name">Question</span> question<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Answer</span> answer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Answer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> file<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>WORK_DIR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//创建对应的目录</span>
            file<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//1.先准备需要用到的临时文件</span>
        <span class="token comment">//  要编译的原代码的文件</span>
        <span class="token comment">//  编译出错要放到一个文件中</span>
        <span class="token comment">//  最终的运行标准输出 标准错误分别放到文件中</span>
        <span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>CODE<span class="token punctuation">,</span>question<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.构造编译指令(javac),并进行执行，预期得到的结果</span>
        <span class="token comment">//  就是一个.class文件，以及编译出错文件</span>
        <span class="token comment">//-d 表示 生成的 .class 文件的放置位置</span>
        <span class="token comment">// javac -encoding utf-8 ./tmp/UUID/Solution.java -d ./tmp/UUID/</span>
        <span class="token class-name">String</span> compileCmd<span class="token operator">=</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"javac -encoding utf-8 %s -d %s"</span><span class="token punctuation">,</span>CODE<span class="token punctuation">,</span>WORK_DIR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>compileCmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CommandUtil</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>compileCmd<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span>COMPILE_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//此处需要判断一下编译是否出错，判断COMPILE_ERROR是否为空即可</span>
        <span class="token class-name">String</span> compileError<span class="token operator">=</span><span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>COMPILE_ERROR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>compileError<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//得到的compileError不为空，说明编译出错</span>
            answer<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            answer<span class="token punctuation">.</span><span class="token function">setReason</span><span class="token punctuation">(</span>compileError<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> answer<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//3.构造运行指令(java)，并进行执行，预期得到的结果</span>
        <span class="token comment">//  就是这个代码标准输出文件 和 标准错误文件</span>
        <span class="token class-name">String</span> runCmd<span class="token operator">=</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"java -classpath %s %s"</span><span class="token punctuation">,</span>WORK_DIR<span class="token punctuation">,</span>CLASS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>runCmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CommandUtil</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>runCmd<span class="token punctuation">,</span>STDOUT<span class="token punctuation">,</span>STDERR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> runErr<span class="token operator">=</span><span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>STDERR<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>runErr<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            answer<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            answer<span class="token punctuation">.</span><span class="token function">setReason</span><span class="token punctuation">(</span>runErr<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> answer<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//4.把最终结果构造成 Answer 对象，并返回</span>
        <span class="token class-name">String</span> stdOut<span class="token operator">=</span><span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>STDOUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        answer<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        answer<span class="token punctuation">.</span><span class="token function">setStdout</span><span class="token punctuation">(</span>stdOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> answer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Task</span> task<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Question</span> question<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        question<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token string">"public class Solution {\n"</span> <span class="token operator">+</span>
                <span class="token string">"    public static void main(String[] args) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"        System.out.println(\"hello\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"    }\n"</span> <span class="token operator">+</span>
                <span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">compileAndRun</span><span class="token punctuation">(</span>question<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="15ProblemProblemDAO_334"></a>1.5创建数据库的实体类Problem以及数据库操作类ProblemDAO</h3> 
<p>实体类Problem就是数据库表对应的类，参数就是表中的属性<br> 数据库操作类ProblemDAO就是JDBC代码，主要有插入操作，删除操作，查询一个题目详情操作，操作所有题目列表操作</p> 
<p>ProblemDAO代码</p> 
<pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProblemDAO</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//向数据库中插入一条数据</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Problem</span> problem<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//获取连接</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span> <span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> statement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//拼装SQL语句</span>
            <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"insert into oj_table values(null,?,?,?,?,?)"</span><span class="token punctuation">;</span>
            statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>problem<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>problem<span class="token punctuation">.</span><span class="token function">getLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>problem<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>problem<span class="token punctuation">.</span><span class="token function">getTemplateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>problem<span class="token punctuation">.</span><span class="token function">getTestCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//执行SQL</span>
            statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//释放连接</span>
            <span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">int</span> problemId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//建立连接</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> statement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">//拼装SQL</span>
        <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"delete from  oj_table where id=?"</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>problemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//执行SQL</span>
            res<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//释放连接</span>
            <span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> res<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//查找全部题目（用来实现题目列表功能）</span>
    <span class="token comment">//只需要查找 id  title  level</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Problem</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Problem</span><span class="token punctuation">&gt;</span></span> problems<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//建立连接</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> statement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">//拼装SQL</span>
        <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"select id,title,level from oj_table"</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//执行SQL</span>
            <span class="token class-name">ResultSet</span> resultSet<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Problem</span> problem<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Problem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"level"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> problems<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//查找指定题目（实现题目详情页面功能）</span>
    <span class="token comment">//需要Problem的每个字段</span>
    <span class="token keyword">public</span> <span class="token class-name">Problem</span> <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token keyword">int</span> problemId<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//建立连接</span>
        <span class="token class-name">Connection</span> connection<span class="token operator">=</span><span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PreparedStatement</span> statement<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">ResultSet</span> resultSet<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">//构造SQL</span>
        <span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"select * from oj_table where id=?"</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            statement<span class="token operator">=</span>connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
            statement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>problemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            resultSet<span class="token operator">=</span>statement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">Problem</span> problem<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Problem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"level"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"description"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setTemplateCode</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"templateCode"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                problem<span class="token punctuation">.</span><span class="token function">setTestCode</span><span class="token punctuation">(</span>resultSet<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"testCode"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> problem<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> throwables<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            throwables<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">DBUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">,</span>statement<span class="token punctuation">,</span>resultSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>Problem实体类代码</p> 
<pre><code class="prism language-java">
<span class="token keyword">package</span> <span class="token namespace">problem</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Problem</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//题目的编号</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token comment">//题目的标题</span>
    <span class="token keyword">private</span>  <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token comment">//题目的难度</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> level<span class="token punctuation">;</span>
    <span class="token comment">//题目的详细信息</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
    <span class="token comment">//题目的代码模板</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> templateCode<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Problem{"</span> <span class="token operator">+</span>
                <span class="token string">"id="</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">", title='"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", level='"</span> <span class="token operator">+</span> level <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", description='"</span> <span class="token operator">+</span> description <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", templateCode='"</span> <span class="token operator">+</span> templateCode <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">", testCode='"</span> <span class="token operator">+</span> testCode <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>
                <span class="token string">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//题目的测试用例代码</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> testCode<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> level<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLevel</span><span class="token punctuation">(</span><span class="token class-name">String</span> level<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>level <span class="token operator">=</span> level<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> description<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token class-name">String</span> description<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>description <span class="token operator">=</span> description<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTemplateCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> templateCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTemplateCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> templateCode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>templateCode <span class="token operator">=</span> templateCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTestCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> testCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTestCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> testCode<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>testCode <span class="token operator">=</span> testCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="16_Servlet_531"></a>1.6 创建Servlet代码</h3> 
<ol><li>请求的实体类 CompileRequest，主要就是将从前端请求的数据包装成一个类对象，属性有题目的id，请求的代码code</li><li>响应的实体类CompileResponse，这个和刚才的Answer一样的功能，主要就是为了区分</li><li>CompileServlet，主要功能就是接受前端数据并解析，第一步就是解析前端数据的body并创建成CompileRequest对象，第二步根据题目的id得到题目的测试代码，第三步将测试代码和前端请求的代码进行字符串拼接，形成完整的代码并构造成Question对象，第四步创建Task类，调用run()方法，将构造的Question作为参数传入，run的返回值为Answer对象，在通过这个对象构造CompileResponse对象，序列化为json格式字符串返回给前端页面</li><li>ProblemServlet数据库操作的Servlet类<br> <strong>CompileRequest</strong></li></ol> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">api</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompileRequest</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> code<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>CompileResponse</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">api</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompileResponse</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> error<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> reason<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> stdout<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setError</span><span class="token punctuation">(</span><span class="token keyword">int</span> error<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>error <span class="token operator">=</span> error<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getReason</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setReason</span><span class="token punctuation">(</span><span class="token class-name">String</span> reason<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>reason <span class="token operator">=</span> reason<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getStdout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> stdout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStdout</span><span class="token punctuation">(</span><span class="token class-name">String</span> stdout<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>stdout <span class="token operator">=</span> stdout<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>CompileServlet</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token class-name">Util<span class="token punctuation">.</span>HttpUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">Gson</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">GsonBuilder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">compile<span class="token punctuation">.</span></span><span class="token class-name">Answer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">compile<span class="token punctuation">.</span></span><span class="token class-name">Question</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">compile<span class="token punctuation">.</span></span><span class="token class-name">Task</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">problem<span class="token punctuation">.</span></span><span class="token class-name">Problem</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">problem<span class="token punctuation">.</span></span><span class="token class-name">ProblemDAO</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/compile"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompileServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Gson</span> gson<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GsonBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.先从请求中读取body信息</span>
        <span class="token class-name">String</span> body<span class="token operator">=</span> <span class="token class-name">HttpUtil</span><span class="token punctuation">.</span><span class="token function">readBody</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2.把这个json数据转换成请求对象</span>
        <span class="token class-name">CompileRequest</span> compileRequest<span class="token operator">=</span>gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span><span class="token class-name">CompileRequest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//3.根据数据中的id获取数据库中测试用例代码</span>
        <span class="token class-name">ProblemDAO</span> problemDAO<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Problem</span> problem<span class="token operator">=</span>problemDAO<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>compileRequest<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//testCode 就是当前这个题目的测试代码b</span>
        <span class="token class-name">String</span> testCode<span class="token operator">=</span>problem<span class="token punctuation">.</span><span class="token function">getTestCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//4.把这个用户提交的代码和测试代码拼接在一起。拼接成一个完整的代码</span>
        <span class="token comment">//  requestCode就表示用户提交的代码</span>
        <span class="token comment">//  finalCode就表示测试代码</span>
        <span class="token class-name">String</span> requestCode<span class="token operator">=</span>compileRequest<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> finalCode<span class="token operator">=</span><span class="token function">merge</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span>testCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//5.创建task对象，借助Task对象完成编译运行这个代码</span>
        <span class="token class-name">Task</span> task<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Question</span> question<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        question<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>finalCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Answer</span> answer<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            answer<span class="token operator">=</span>task<span class="token punctuation">.</span><span class="token function">compileAndRun</span><span class="token punctuation">(</span>question<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//把这个运行结果包装成相应数据，吧数据返回给页面即可</span>
        <span class="token class-name">CompileResponse</span> compileResponse<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">CompileResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        compileResponse<span class="token punctuation">.</span><span class="token function">setError</span><span class="token punctuation">(</span>answer<span class="token punctuation">.</span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        compileResponse<span class="token punctuation">.</span><span class="token function">setReason</span><span class="token punctuation">(</span>answer<span class="token punctuation">.</span><span class="token function">getReason</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        compileResponse<span class="token punctuation">.</span><span class="token function">setStdout</span><span class="token punctuation">(</span>answer<span class="token punctuation">.</span><span class="token function">getStdout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> respString<span class="token operator">=</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>compileResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>respString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token class-name">String</span> requestCode<span class="token punctuation">,</span><span class="token class-name">String</span> testCode<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">//先找到requestCode末尾的 } ，并截取出前面的代码</span>
        <span class="token keyword">int</span> pos<span class="token operator">=</span>requestCode<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>pos<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//2.把testCode拼接到后面再拼接上 } 即可</span>
        <span class="token keyword">return</span> requestCode<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>pos<span class="token punctuation">)</span><span class="token operator">+</span>testCode<span class="token operator">+</span><span class="token string">"}"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>ProblemServlet</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token namespace">api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token class-name">Util<span class="token punctuation">.</span>HttpUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">Gson</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">GsonBuilder</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">problem<span class="token punctuation">.</span></span><span class="token class-name">Problem</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">problem<span class="token punctuation">.</span></span><span class="token class-name">ProblemDAO</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span><span class="token string">"/problem"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProblemServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">Gson</span> gson<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">GsonBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//查询题目列表/详细信息</span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> id<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">||</span>id<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//查找题目列表</span>
            <span class="token function">selectAll</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//查看题目详情页面</span>
            <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token keyword">int</span> parseInt<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//创建ProblemDAO对象</span>
        <span class="token class-name">ProblemDAO</span> problemDAO<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//查找指定的结果</span>
        <span class="token class-name">Problem</span> problem<span class="token operator">=</span>problemDAO<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>parseInt<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//将结果包装成JSOn格式</span>
        <span class="token class-name">String</span> respString<span class="token operator">=</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//将结果写回前端</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>respString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//创建ProblemDAO对象</span>
        <span class="token class-name">ProblemDAO</span> problemDAO<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//查找所有结果</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Problem</span><span class="token punctuation">&gt;</span></span> problems<span class="token operator">=</span>problemDAO<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//将结果包装成JSON格式</span>
        <span class="token class-name">String</span> respString<span class="token operator">=</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>problems<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//把结果写会前端</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>respString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//插入一个题目</span>
        <span class="token comment">//1.读取到请求中的body信息</span>
        <span class="token comment">//  进一步就可以插入数据库</span>
        <span class="token class-name">String</span> body<span class="token operator">=</span> <span class="token class-name">HttpUtil</span><span class="token punctuation">.</span><span class="token function">readBody</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Problem</span> problem<span class="token operator">=</span>gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span><span class="token class-name">Problem</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProblemDAO</span> problemDAO<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problemDAO<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span><span class="token punctuation">;</span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"{\"ok\":1}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doDelete</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"application/json;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> id<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>id<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">||</span>id<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
            resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"{\"ok\":0,\"reason\":\"id不存在\"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">ProblemDAO</span> problemDAO<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problemDAO<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"{\"ok\":1}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h3><a id="17_759"></a>1.7代码中用到的一些文件操作工具类</h3> 
<p><strong>文件读写操作：FileUtil</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">Util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileUtil</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> filePath<span class="token punctuation">,</span><span class="token class-name">String</span> content<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">FileOutputStream</span> fileOutputStream<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
             fileOutputStream<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
             fileOutputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token class-name">String</span> filePath<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token class-name">StringBuffer</span> stringBuffer<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileInputStream</span> fileInputStream<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
             fileInputStream<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">int</span> c<span class="token operator">=</span>fileInputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                     <span class="token keyword">break</span><span class="token punctuation">;</span>
                 <span class="token punctuation">}</span>
                 <span class="token comment">//每次read方法只能读取到一个字节</span>
                 <span class="token comment">//read设计成返回int的原因知识为了能多表示 -1 的情况</span>
                 <span class="token comment">//把结果往StringBuffer里面插的时候要转成char</span>
                 stringBuffer<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                fileInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> stringBuffer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p><strong>读取请求body数据操作HttpUtil</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">package</span> <span class="token class-name">Util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">UnsupportedEncodingException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpUtil</span> <span class="token punctuation">{<!-- --></span>



    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">readBody</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">//1.先获取请求中的body长度，进行分配空间</span>
        <span class="token comment">//  单位是字节</span>
        <span class="token keyword">int</span> contentLength<span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getContentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>contentLength<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token class-name">ServletInputStream</span> inputStream<span class="token operator">=</span><span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
            inputStream <span class="token operator">=</span>req<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            inputStream<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">finally</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">try</span> <span class="token punctuation">{<!-- --></span>
                inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<h2><a id="2__853"></a>2 单元测试</h2> 
<h3><a id="21_854"></a>2.1插入数据测试</h3> 
<p>插入题目无重复字符的最长子串<br> 代码:</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Problem</span> problem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Problem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problem<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">"无重复字符的最长子串"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problem<span class="token punctuation">.</span><span class="token function">setLevel</span><span class="token punctuation">(</span><span class="token string">"中等"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problem<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token string">"给定一个字符串 s ，请你找出其中不含有重复字符的 最长子串 的长度。\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">" \n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"示例 1:\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输入: s = \"abcabcbb\"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输出: 3 \n"</span> <span class="token operator">+</span>
                <span class="token string">"解释: 因为无重复字符的最长子串是 \"abc\"，所以其长度为 3。\n"</span> <span class="token operator">+</span>
                <span class="token string">"示例 2:\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输入: s = \"bbbbb\"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输出: 1\n"</span> <span class="token operator">+</span>
                <span class="token string">"解释: 因为无重复字符的最长子串是 \"b\"，所以其长度为 1。\n"</span> <span class="token operator">+</span>
                <span class="token string">"示例 3:\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输入: s = \"pwwkew\"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输出: 3\n"</span> <span class="token operator">+</span>
                <span class="token string">"解释: 因为无重复字符的最长子串是 \"wke\"，所以其长度为 3。\n"</span> <span class="token operator">+</span>
                <span class="token string">"     请注意，你的答案必须是 子串 的长度，\"pwke\" 是一个子序列，不是子串。\n"</span> <span class="token operator">+</span>
                <span class="token string">"示例 4:\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输入: s = \"\"\n"</span> <span class="token operator">+</span>
                <span class="token string">"输出: 0\n"</span> <span class="token operator">+</span>
                <span class="token string">" \n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"提示：\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"0 &lt;= s.length &lt;= 5 * 104\n"</span> <span class="token operator">+</span>
                <span class="token string">"s 由英文字母、数字、符号和空格组成"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problem<span class="token punctuation">.</span><span class="token function">setTemplateCode</span><span class="token punctuation">(</span><span class="token string">"class Solution {\n"</span> <span class="token operator">+</span>
                <span class="token string">"    public int lengthOfLongestSubstring(String s) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"    }\n"</span> <span class="token operator">+</span>
                <span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problem<span class="token punctuation">.</span><span class="token function">setTestCode</span><span class="token punctuation">(</span><span class="token string">"    public static void main(String[] args) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"        Solution solution = new Solution();\n"</span> <span class="token operator">+</span>
                <span class="token string">"        String str=\"pwwkew\";\n"</span> <span class="token operator">+</span>
                <span class="token string">"        int result = solution.lengthOfLongestSubstring(str);\n"</span> <span class="token operator">+</span>
                <span class="token string">"        if (result==3) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"            System.out.println(\"TestCase OK!\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"        } else {\n"</span> <span class="token operator">+</span>
                <span class="token string">"            System.out.println(\"TestCase Failed! String=\\\"pwwkew\\\"\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"        }\n"</span> <span class="token operator">+</span>
                <span class="token string">"\n"</span> <span class="token operator">+</span>
                <span class="token string">"        String str2=\"abcabcbb\";\n"</span> <span class="token operator">+</span>
                <span class="token string">"        int result2 = solution.lengthOfLongestSubstring(str);\n"</span> <span class="token operator">+</span>
                <span class="token string">"        if (result2==3) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"            System.out.println(\"TestCaseOK!\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"        } else {\n"</span> <span class="token operator">+</span>
                <span class="token string">"            System.out.println(\"TestCase Failed! String=\\\"abcabcbb\\\"\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"        }\n"</span> <span class="token operator">+</span>
                <span class="token string">"    }"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ProblemDAO</span> problemDAO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        problemDAO<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>数据库表<br> <img src="https://images2.imgbox.com/b4/bf/3Jj7kyiy_o.png" alt="在这里插入图片描述"><br> 插入题目也有可能超出字段长度的范围</p> 
<h3><a id="22_924"></a>2.2删除数据测试</h3> 
<p>删除题目无重复字符的最长子串<br> 代码</p> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ProblemDAO</span> problemDAO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> res<span class="token operator">=</span>problemDAO<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>运行结果 true<br> 数据库表：<br> <img src="https://images2.imgbox.com/cc/c9/K0nrTFrj_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="23__938"></a>2.3 查询所有题目列表</h3> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ProblemDAO</span> problemDAO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Problem</span><span class="token punctuation">&gt;</span></span> problems <span class="token operator">=</span> problemDAO<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>problems<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>运行结果<br> <img src="https://images2.imgbox.com/22/2f/iTRQEKtm_o.png" alt="在这里插入图片描述"><br> 因为查询所有题目我们只需要题目id，题目标题，题目难度三个字段，所以其他字段为空</p> 
<h3><a id="24__951"></a>2.4 查询题目详情</h3> 
<pre><code class="prism language-java">    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ProblemDAO</span> problemDAO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProblemDAO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Problem</span> problem <span class="token operator">=</span> problemDAO<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>problem<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5b/3d/AyFQ4iWX_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="25_Task_961"></a>2.5 Task编译运行的测试</h3> 
<pre><code class="prism language-java">   <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">compileAndRun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">Task</span> task<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Question</span> question<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        question<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token string">"public class Solution {\n"</span> <span class="token operator">+</span>
                <span class="token string">"    public static void main(String[] args) {\n"</span> <span class="token operator">+</span>
                <span class="token string">"        System.out.println(\"hello\");\n"</span> <span class="token operator">+</span>
                <span class="token string">"    }\n"</span> <span class="token operator">+</span>
                <span class="token string">"}"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>task<span class="token punctuation">.</span><span class="token function">compileAndRun</span><span class="token punctuation">(</span>question<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>运行结果<br> <img src="https://images2.imgbox.com/1a/e7/Yjy2e4AP_o.png" alt="在这里插入图片描述"><br> 第一行的指令javac表示编译的指令，后面的参数是.java文件的目录以及文件名，第二个参数指生成的.class文件的存放位置<br> 第二行的指令java表示运行指令，参数表示.class文件的位置以及类名<br> 第三行表示运行之后的结果，error=0表示运行成功，标准输出是hello,也就是我的代码的运行结果</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/72b585d2777203bd82b3bf43445c4ff6/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【字节跳动青训营】- 如何写好JS？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/68eb1cdf90054883f75f7ccf1203eea4/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">46.python之异步</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>