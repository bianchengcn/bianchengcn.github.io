<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>GDBè°ƒè¯•-ä»å…¥é—¨å®è·µåˆ°åŸç† - ç¼–ç¨‹ä¸­å›½çš„åšå®¢</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="GDBè°ƒè¯•-ä»å…¥é—¨å®è·µåˆ°åŸç†" />
<meta property="og:description" content="å…³æ³¨å…¬ä¼—å·ã€é«˜æ€§èƒ½æ¶æ„æ¢ç´¢ã€‘ï¼Œå›å¤ã€pdfã€‘ï¼Œå…è´¹è·å–è®¡ç®—æœºç»å…¸èµ„æ–™
åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†çº¿ä¸Šcoredumpäº§ç”Ÿçš„åŸå› ï¼Œå…¶ä¸­ç”¨åˆ°äº†coredumpåˆ†æå·¥å…·gdbï¼Œè¿™å‡ å¤©ä¸€ç›´æœ‰è¯»è€…åœ¨é—®ï¼Œèƒ½ä¸èƒ½å†™ä¸€ç¯‡å…³äºgdbè°ƒè¯•æ–¹é¢çš„æ–‡ç« ï¼Œä»Šå¤©å€ŸåŠ©æ­¤æ–‡ï¼Œåˆ†äº«ä¸€äº›å·¥ä½œä¸­çš„è°ƒè¯•ç»éªŒï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°å¤§å®¶ã€‚
å†™åœ¨å‰é¢ åœ¨æˆ‘çš„å·¥ä½œç»å†ä¸­ï¼Œå‰å‡ å¹´åœ¨Windowsä¸Šè¿›è¡Œå¼€å‘ï¼Œä½¿ç”¨Visual Studioè¿›è¡Œè°ƒè¯•ï¼Œç®€ç›´æ˜¯åˆ©å™¨ï¼Œå„ç§æ–­ç‚¹ç­‰ç”¨é¼ æ ‡ç‚¹ç‚¹ç‚¹å°±èƒ½è®¾ç½®ï¼›å¤§æ¦‚ä»12å¹´å¼€å§‹è½¬Linuxå¼€å‘äº†ï¼Œæ‰€ä»¥è°ƒè¯•éƒ½æ˜¯åŸºäºGDBçš„ã€‚æœ¬æ¥è¿™ç¯‡æ–‡ç« ä¹Ÿæƒ³å†™å†™Windowsä¸‹è°ƒè¯•ç›¸å…³ï¼Œå¥ˆä½•å¥½å¤šå¹´æ²¡ç”¨äº†ï¼Œå†åŠ ä¸Šå·¥ä½œå¤ªå¿™ï¼Œæ‰€ä»¥æœ¬æ–‡å°±åªå†™äº†Linuxä¸‹GDBè°ƒè¯•ç›¸å…³ï¼Œå¯¹äºWindowså¼€å‘äººå‘˜ï¼Œå®åœ¨å¯¹ä¸ä½äº†ğŸ˜ƒã€‚
è¿™ç¯‡æ–‡ç« ï¼Œæ¶‰åŠçš„æ¯”è¾ƒå…¨é¢ï¼Œæ€»ç»“äº†è¿™äº›å¹´çš„gdbè°ƒè¯•ç»éªŒ(éƒ½æ˜¯å°å„¿ç§‘ğŸ˜)ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€äº›è°ƒè¯•æŠ€å·§ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä»äº‹Linuxå¼€å‘çš„ç›¸å…³äººå‘˜æœ‰æ‰€å¸®åŠ©
èƒŒæ™¯ ä½œä¸ºC/C&#43;&#43;å¼€å‘äººå‘˜ï¼Œä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œæ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç›®çš„ã€‚è€Œä¸ºäº†ä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè°ƒè¯•åˆ™æ˜¯æœ€åŸºæœ¬çš„æ‰‹æ®µï¼Œç†Ÿæ‚‰è¿™äº›è°ƒè¯•æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„å®šä½ç¨‹åºé—®é¢˜æ‰€åœ¨ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚
åœ¨å¼€å‘è¿‡ç¨‹ï¼Œå¦‚æœç¨‹åºçš„è¿è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œç¬¬ä¸€æ—¶é—´å°±æ˜¯æ‰“å¼€GDBè¿›è¡Œè°ƒè¯•ï¼Œåœ¨å¯¹åº”çš„åœ°æ–¹è®¾ç½®æ–­ç‚¹ï¼Œç„¶ååˆ†æåŸå› ï¼›å½“çº¿ä¸ŠæœåŠ¡å‡ºäº†é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´æŸ¥çœ‹è¿›ç¨‹åœ¨ä¸åœ¨ï¼Œå¦‚æœä¸åœ¨çš„è¯ï¼Œæ˜¯å¦ç”Ÿæˆäº†coredumpæ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨gdbè°ƒè¯•coredumpæ–‡ä»¶ï¼Œå¦åˆ™é€šè¿‡dmesgæ¥åˆ†æå†…æ ¸æ—¥å¿—æ¥æŸ¥æ‰¾åŸå› ã€‚
æ¦‚å¿µ GDBæ˜¯ä¸€ä¸ªç”±GNUå¼€æºç»„ç»‡å‘å¸ƒçš„ã€UNIX/LINUXæ“ä½œç³»ç»Ÿä¸‹çš„ã€åŸºäºå‘½ä»¤è¡Œçš„ã€åŠŸèƒ½å¼ºå¤§çš„ç¨‹åºè°ƒè¯•å·¥å…·ã€‚
GDBæ”¯æŒæ–­ç‚¹ã€å•æ­¥æ‰§è¡Œã€æ‰“å°å˜é‡ã€è§‚å¯Ÿå˜é‡ã€æŸ¥çœ‹å¯„å­˜å™¨ã€æŸ¥çœ‹å †æ ˆç­‰è°ƒè¯•æ‰‹æ®µã€‚åœ¨Linuxç¯å¢ƒè½¯ä»¶å¼€å‘ä¸­ï¼ŒGDBæ˜¯ä¸»è¦çš„è°ƒè¯•å·¥å…·ï¼Œç”¨æ¥è°ƒè¯•Cå’Œ C&#43;&#43;ç¨‹åº(ä¹Ÿæ”¯æŒgoç­‰å…¶ä»–è¯­è¨€)ã€‚
å¸¸ç”¨å‘½ä»¤ æ–­ç‚¹ æ–­ç‚¹æ˜¯æˆ‘ä»¬åœ¨è°ƒè¯•ä¸­ç»å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨æŒ‡å®šä½ç½®è®¾ç½®æ–­ç‚¹ä¹‹åï¼Œç¨‹åºè¿è¡Œåˆ°è¯¥ä½ç½®å°†ä¼šæš‚åœï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œæ›´å¤šçš„æ“ä½œï¼Œæ¯”å¦‚æŸ¥çœ‹å˜é‡å†…å®¹ï¼Œå †æ ˆæƒ…å†µç­‰ç­‰ï¼Œä»¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ç¨‹åºã€‚
ä»¥è®¾ç½®æ–­ç‚¹çš„å‘½ä»¤åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š
breakpointwatchpointcatchpoint breakpoint å¯ä»¥æ ¹æ®è¡Œå·ã€å‡½æ•°ã€æ¡ä»¶ç”Ÿæˆæ–­ç‚¹ï¼Œä¸‹é¢æ˜¯ç›¸å…³å‘½ä»¤ä»¥åŠå¯¹åº”çš„ä½œç”¨è¯´æ˜ï¼š
å‘½ä»¤ä½œç”¨break [file]:functionåœ¨æ–‡ä»¶fileçš„functionå‡½æ•°å…¥å£è®¾ç½®æ–­ç‚¹break [file]:lineåœ¨æ–‡ä»¶fileçš„ç¬¬lineè¡Œè®¾ç½®æ–­ç‚¹info breakpointsæŸ¥çœ‹æ–­ç‚¹åˆ—è¡¨break [Â±]offsetåœ¨å½“å‰ä½ç½®åç§»é‡ä¸º[Â±]offsetå¤„è®¾ç½®æ–­ç‚¹break *addråœ¨åœ°å€addrå¤„è®¾ç½®æ–­ç‚¹break â€¦ if exprè®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼Œä»…ä»…åœ¨æ¡ä»¶æ»¡è¶³æ—¶ignore n countæ¥ä¸‹æ¥å¯¹äºç¼–å·ä¸ºnçš„æ–­ç‚¹å¿½ç•¥countæ¬¡clearåˆ é™¤æ‰€æœ‰æ–­ç‚¹clear functionåˆ é™¤æ‰€æœ‰ä½äºfunctionå†…çš„æ–­ç‚¹delete nåˆ é™¤æŒ‡å®šç¼–å·çš„æ–­ç‚¹enable nå¯ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹disable nç¦ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹save breakpoints fileä¿å­˜æ–­ç‚¹ä¿¡æ¯åˆ°æŒ‡å®šæ–‡ä»¶source fileå¯¼å…¥æ–‡ä»¶ä¸­ä¿å­˜çš„æ–­ç‚¹ä¿¡æ¯breakåœ¨ä¸‹ä¸€ä¸ªæŒ‡ä»¤å¤„è®¾ç½®æ–­ç‚¹clear [file:]lineåˆ é™¤ç¬¬lineè¡Œçš„æ–­ç‚¹ watchpoint watchpointæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–­ç‚¹ï¼Œç±»ä¼¼äºæ­£å¸¸æ–­ç‚¹ï¼Œæ˜¯è¦æ±‚GDBæš‚åœç¨‹åºæ‰§è¡Œçš„å‘½ä»¤ã€‚åŒºåˆ«åœ¨äºwatchpointæ²¡æœ‰é©»ç•™æŸä¸€è¡Œæºä»£ç ä¸­ï¼Œè€Œæ˜¯æŒ‡ç¤ºGDBæ¯å½“æŸä¸ªè¡¨è¾¾å¼æ”¹å˜äº†å€¼å°±æš‚åœæ‰§è¡Œçš„å‘½ä»¤ã€‚
watchpointåˆ†ä¸ºç¡¬ä»¶å®ç°å’Œè½¯ä»¶å®ç°ä¸¤ç§ã€‚å‰è€…éœ€è¦ç¡¬ä»¶ç³»ç»Ÿçš„æ”¯æŒï¼›åè€…çš„åŸç†å°±æ˜¯æ¯æ­¥æ‰§è¡Œåéƒ½æ£€æŸ¥å˜é‡çš„å€¼æ˜¯å¦æ”¹å˜ã€‚GDBåœ¨æ–°å»ºæ•°æ®æ–­ç‚¹æ—¶ä¼šä¼˜å…ˆå°è¯•ç¡¬ä»¶æ–¹å¼ï¼Œå¦‚æœå¤±è´¥å†å°è¯•è½¯ä»¶å®ç°ã€‚
å‘½ä»¤ä½œç”¨watch variableè®¾ç½®å˜é‡æ•°æ®æ–­ç‚¹watch var1 &#43; var2è®¾ç½®è¡¨è¾¾å¼æ•°æ®æ–­ç‚¹rwatch variableè®¾ç½®è¯»æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°awatch variableè®¾ç½®è¯»å†™æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°info watchpointsæŸ¥çœ‹æ•°æ®æ–­ç‚¹åˆ—è¡¨set can-use-hw-watchpoints 0å¼ºåˆ¶åŸºäºè½¯ä»¶æ–¹å¼å®ç° ä½¿ç”¨æ•°æ®æ–­ç‚¹æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š
å½“ç›‘æ§å˜é‡ä¸ºå±€éƒ¨å˜é‡æ—¶ï¼Œä¸€æ—¦å±€éƒ¨å˜é‡å¤±æ•ˆï¼Œæ•°æ®æ–­ç‚¹ä¹Ÿä¼šå¤±æ•ˆå¦‚æœç›‘æ§çš„æ˜¯æŒ‡é’ˆå˜é‡pï¼Œåˆ™watch *pç›‘æ§çš„æ˜¯pæ‰€æŒ‡å†…å­˜æ•°æ®çš„å˜åŒ–æƒ…å†µï¼Œè€Œwatch pç›‘æ§çš„æ˜¯pæŒ‡é’ˆæœ¬èº«æœ‰æ²¡æœ‰æ”¹å˜æŒ‡å‘ æœ€å¸¸è§çš„æ•°æ®æ–­ç‚¹åº”ç”¨åœºæ™¯ï¼šå®šä½å †ä¸Šçš„ç»“æ„ä½“å†…éƒ¨æˆå‘˜ä½•æ—¶è¢«ä¿®æ”¹ã€‚ç”±äºæŒ‡é’ˆä¸€èˆ¬ä¸ºå±€éƒ¨å˜é‡ï¼Œä¸ºäº†è§£å†³æ–­ç‚¹å¤±æ•ˆï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ã€‚
å‘½ä»¤ä½œç”¨print &amp;variableæŸ¥çœ‹å˜é‡çš„å†…å­˜åœ°å€watch *(type *)addressé€šè¿‡å†…å­˜åœ°å€é—´æ¥è®¾ç½®æ–­ç‚¹watch -l variableæŒ‡å®šlocationå‚æ•°watch variable thread 1ä»…ç¼–å·ä¸º1çš„çº¿ç¨‹ä¿®æ”¹å˜é‡varå€¼æ—¶ä¼šä¸­æ–­ catchpoint ä»å­—é¢æ„æ€ç†è§£ï¼Œæ˜¯æ•è·æ–­ç‚¹ï¼Œå…¶ä¸»è¦ç›‘æµ‹ä¿¡å·çš„äº§ç”Ÿã€‚ä¾‹å¦‚c&#43;&#43;çš„throwï¼Œæˆ–è€…åŠ è½½åº“çš„æ—¶å€™ï¼Œäº§ç”Ÿæ–­ç‚¹è¡Œä¸ºã€‚
å‘½ä»¤å«ä¹‰catch forkç¨‹åºè°ƒç”¨forkæ—¶ä¸­æ–­tcatch forkè®¾ç½®çš„æ–­ç‚¹åªè§¦å‘ä¸€æ¬¡ï¼Œä¹‹åè¢«è‡ªåŠ¨åˆ é™¤catch syscall ptraceä¸ºptraceç³»ç»Ÿè°ƒç”¨è®¾ç½®æ–­ç‚¹ åœ¨commandå‘½ä»¤ååŠ æ–­ç‚¹ç¼–å·ï¼Œå¯ä»¥å®šä¹‰æ–­ç‚¹è§¦å‘åæƒ³è¦æ‰§è¡Œçš„æ“ä½œã€‚åœ¨ä¸€äº›é«˜çº§çš„è‡ªåŠ¨åŒ–è°ƒè¯•åœºæ™¯ä¸­å¯èƒ½ä¼šç”¨åˆ°ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/37e6519f6ef60a3d8932cfbdcc183f03/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-05T14:12:49+08:00" />
<meta property="article:modified_time" content="2022-01-05T14:12:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹ä¸­å›½çš„åšå®¢" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹ä¸­å›½çš„åšå®¢</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">GDBè°ƒè¯•-ä»å…¥é—¨å®è·µåˆ°åŸç†</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>å…³æ³¨å…¬ä¼—å·ã€<strong>é«˜æ€§èƒ½æ¶æ„æ¢ç´¢</strong>ã€‘ï¼Œå›å¤ã€<strong>pdf</strong>ã€‘ï¼Œå…è´¹è·å–è®¡ç®—æœºç»å…¸èµ„æ–™</p> 
</blockquote> 
<p>åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åˆ†æäº†çº¿ä¸Šcoredumpäº§ç”Ÿçš„åŸå› ï¼Œå…¶ä¸­ç”¨åˆ°äº†coredumpåˆ†æå·¥å…·gdbï¼Œè¿™å‡ å¤©ä¸€ç›´æœ‰è¯»è€…åœ¨é—®ï¼Œèƒ½ä¸èƒ½å†™ä¸€ç¯‡å…³äºgdbè°ƒè¯•æ–¹é¢çš„æ–‡ç« ï¼Œä»Šå¤©å€ŸåŠ©æ­¤æ–‡ï¼Œåˆ†äº«ä¸€äº›å·¥ä½œä¸­çš„è°ƒè¯•ç»éªŒï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åˆ°å¤§å®¶ã€‚</p> 
<h3><a id="_7"></a>å†™åœ¨å‰é¢</h3> 
<p>åœ¨æˆ‘çš„å·¥ä½œç»å†ä¸­ï¼Œå‰å‡ å¹´åœ¨Windowsä¸Šè¿›è¡Œå¼€å‘ï¼Œä½¿ç”¨Visual Studioè¿›è¡Œè°ƒè¯•ï¼Œç®€ç›´æ˜¯åˆ©å™¨ï¼Œå„ç§æ–­ç‚¹ç­‰ç”¨é¼ æ ‡ç‚¹ç‚¹ç‚¹å°±èƒ½è®¾ç½®ï¼›å¤§æ¦‚ä»12å¹´å¼€å§‹è½¬Linuxå¼€å‘äº†ï¼Œæ‰€ä»¥è°ƒè¯•éƒ½æ˜¯åŸºäºGDBçš„ã€‚æœ¬æ¥è¿™ç¯‡æ–‡ç« ä¹Ÿæƒ³å†™å†™Windowsä¸‹è°ƒè¯•ç›¸å…³ï¼Œå¥ˆä½•å¥½å¤šå¹´æ²¡ç”¨äº†ï¼Œå†åŠ ä¸Šå·¥ä½œå¤ªå¿™ï¼Œæ‰€ä»¥æœ¬æ–‡å°±åªå†™äº†Linuxä¸‹GDBè°ƒè¯•ç›¸å…³ï¼Œå¯¹äºWindowså¼€å‘äººå‘˜ï¼Œå®åœ¨å¯¹ä¸ä½äº†ğŸ˜ƒã€‚</p> 
<p>è¿™ç¯‡æ–‡ç« ï¼Œæ¶‰åŠçš„æ¯”è¾ƒå…¨é¢ï¼Œæ€»ç»“äº†è¿™äº›å¹´çš„gdbè°ƒè¯•ç»éªŒ(éƒ½æ˜¯å°å„¿ç§‘ğŸ˜)ï¼Œç»å¸¸ç”¨åˆ°çš„ä¸€äº›è°ƒè¯•æŠ€å·§ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä»äº‹Linuxå¼€å‘çš„ç›¸å…³äººå‘˜æœ‰æ‰€å¸®åŠ©</p> 
<p><img src="https://images2.imgbox.com/6a/e7/rHXpAW77_o.png" alt=""></p> 
<h3><a id="_20"></a>èƒŒæ™¯</h3> 
<p>ä½œä¸ºC/C++å¼€å‘äººå‘˜ï¼Œä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œæ˜¯æœ€åŸºæœ¬ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ç›®çš„ã€‚è€Œä¸ºäº†ä¿è¯ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè°ƒè¯•åˆ™æ˜¯æœ€åŸºæœ¬çš„æ‰‹æ®µï¼Œç†Ÿæ‚‰è¿™äº›è°ƒè¯•æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ›´å¿«çš„å®šä½ç¨‹åºé—®é¢˜æ‰€åœ¨ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p> 
<p>åœ¨å¼€å‘è¿‡ç¨‹ï¼Œå¦‚æœç¨‹åºçš„è¿è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œç¬¬ä¸€æ—¶é—´å°±æ˜¯æ‰“å¼€GDBè¿›è¡Œè°ƒè¯•ï¼Œåœ¨å¯¹åº”çš„åœ°æ–¹<code>è®¾ç½®æ–­ç‚¹</code>ï¼Œç„¶ååˆ†æåŸå› ï¼›å½“çº¿ä¸ŠæœåŠ¡å‡ºäº†é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´æŸ¥çœ‹è¿›ç¨‹åœ¨ä¸åœ¨ï¼Œå¦‚æœä¸åœ¨çš„è¯ï¼Œæ˜¯å¦ç”Ÿæˆäº†<code>coredumpæ–‡ä»¶</code>ï¼Œå¦‚æœæœ‰ï¼Œåˆ™ä½¿ç”¨gdbè°ƒè¯•coredumpæ–‡ä»¶ï¼Œå¦åˆ™é€šè¿‡<code>dmesg</code>æ¥åˆ†æå†…æ ¸æ—¥å¿—æ¥æŸ¥æ‰¾åŸå› ã€‚</p> 
<h3><a id="_30"></a>æ¦‚å¿µ</h3> 
<p>GDBæ˜¯ä¸€ä¸ªç”±GNUå¼€æºç»„ç»‡å‘å¸ƒçš„ã€UNIX/LINUXæ“ä½œç³»ç»Ÿä¸‹çš„ã€<strong>åŸºäºå‘½ä»¤è¡Œçš„ã€åŠŸèƒ½å¼ºå¤§çš„ç¨‹åºè°ƒè¯•å·¥å…·</strong>ã€‚</p> 
<p>GDBæ”¯æŒæ–­ç‚¹ã€å•æ­¥æ‰§è¡Œã€æ‰“å°å˜é‡ã€è§‚å¯Ÿå˜é‡ã€æŸ¥çœ‹å¯„å­˜å™¨ã€æŸ¥çœ‹å †æ ˆç­‰è°ƒè¯•æ‰‹æ®µã€‚åœ¨Linuxç¯å¢ƒè½¯ä»¶å¼€å‘ä¸­ï¼ŒGDBæ˜¯ä¸»è¦çš„è°ƒè¯•å·¥å…·ï¼Œç”¨æ¥è°ƒè¯•Cå’Œ C++ç¨‹åº(ä¹Ÿæ”¯æŒgoç­‰å…¶ä»–è¯­è¨€)ã€‚</p> 
<h3><a id="_38"></a>å¸¸ç”¨å‘½ä»¤</h3> 
<h4><a id="_40"></a>æ–­ç‚¹</h4> 
<p>æ–­ç‚¹æ˜¯æˆ‘ä»¬åœ¨è°ƒè¯•ä¸­ç»å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨æŒ‡å®šä½ç½®è®¾ç½®æ–­ç‚¹ä¹‹åï¼Œç¨‹åºè¿è¡Œåˆ°è¯¥ä½ç½®å°†ä¼š<code>æš‚åœ</code>ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œæ›´å¤šçš„æ“ä½œï¼Œæ¯”å¦‚æŸ¥çœ‹<code>å˜é‡å†…å®¹ï¼Œå †æ ˆæƒ…å†µ</code>ç­‰ç­‰ï¼Œä»¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•ç¨‹åºã€‚</p> 
<p>ä»¥è®¾ç½®æ–­ç‚¹çš„å‘½ä»¤åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p> 
<ul><li>breakpoint</li><li>watchpoint</li><li>catchpoint</li></ul> 
<h5><a id="breakpoint_52"></a>breakpoint</h5> 
<p>å¯ä»¥æ ¹æ®è¡Œå·ã€å‡½æ•°ã€æ¡ä»¶ç”Ÿæˆæ–­ç‚¹ï¼Œä¸‹é¢æ˜¯ç›¸å…³å‘½ä»¤ä»¥åŠå¯¹åº”çš„ä½œç”¨è¯´æ˜ï¼š</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>break [file]:function</td><td>åœ¨æ–‡ä»¶fileçš„functionå‡½æ•°å…¥å£è®¾ç½®æ–­ç‚¹</td></tr><tr><td>break [file]:line</td><td>åœ¨æ–‡ä»¶fileçš„ç¬¬lineè¡Œè®¾ç½®æ–­ç‚¹</td></tr><tr><td>info breakpoints</td><td>æŸ¥çœ‹æ–­ç‚¹åˆ—è¡¨</td></tr><tr><td>break [Â±]offset</td><td>åœ¨å½“å‰ä½ç½®åç§»é‡ä¸º[Â±]offsetå¤„è®¾ç½®æ–­ç‚¹</td></tr><tr><td>break *addr</td><td>åœ¨åœ°å€addrå¤„è®¾ç½®æ–­ç‚¹</td></tr><tr><td>break â€¦ if expr</td><td>è®¾ç½®æ¡ä»¶æ–­ç‚¹ï¼Œä»…ä»…åœ¨æ¡ä»¶æ»¡è¶³æ—¶</td></tr><tr><td>ignore n count</td><td>æ¥ä¸‹æ¥å¯¹äºç¼–å·ä¸ºnçš„æ–­ç‚¹å¿½ç•¥countæ¬¡</td></tr><tr><td>clear</td><td>åˆ é™¤æ‰€æœ‰æ–­ç‚¹</td></tr><tr><td>clear function</td><td>åˆ é™¤æ‰€æœ‰ä½äºfunctionå†…çš„æ–­ç‚¹</td></tr><tr><td>delete n</td><td>åˆ é™¤æŒ‡å®šç¼–å·çš„æ–­ç‚¹</td></tr><tr><td>enable n</td><td>å¯ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹</td></tr><tr><td>disable n</td><td>ç¦ç”¨æŒ‡å®šç¼–å·çš„æ–­ç‚¹</td></tr><tr><td>save breakpoints file</td><td>ä¿å­˜æ–­ç‚¹ä¿¡æ¯åˆ°æŒ‡å®šæ–‡ä»¶</td></tr><tr><td>source file</td><td>å¯¼å…¥æ–‡ä»¶ä¸­ä¿å­˜çš„æ–­ç‚¹ä¿¡æ¯</td></tr><tr><td>break</td><td>åœ¨ä¸‹ä¸€ä¸ªæŒ‡ä»¤å¤„è®¾ç½®æ–­ç‚¹</td></tr><tr><td>clear [file:]line</td><td>åˆ é™¤ç¬¬lineè¡Œçš„æ–­ç‚¹</td></tr></tbody></table> 
<h5><a id="watchpoint_79"></a>watchpoint</h5> 
<p>watchpointæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ–­ç‚¹ï¼Œç±»ä¼¼äºæ­£å¸¸æ–­ç‚¹ï¼Œæ˜¯è¦æ±‚GDBæš‚åœç¨‹åºæ‰§è¡Œçš„å‘½ä»¤ã€‚åŒºåˆ«åœ¨äºwatchpoint<code>æ²¡æœ‰é©»ç•™</code>æŸä¸€è¡Œæºä»£ç ä¸­ï¼Œè€Œæ˜¯æŒ‡ç¤ºGDBæ¯å½“æŸä¸ªè¡¨è¾¾å¼æ”¹å˜äº†å€¼å°±<code>æš‚åœæ‰§è¡Œ</code>çš„å‘½ä»¤ã€‚</p> 
<p>watchpointåˆ†ä¸º<code>ç¡¬ä»¶å®ç°å’Œè½¯ä»¶å®ç°</code>ä¸¤ç§ã€‚å‰è€…éœ€è¦ç¡¬ä»¶ç³»ç»Ÿçš„æ”¯æŒï¼›åè€…çš„åŸç†å°±æ˜¯æ¯æ­¥æ‰§è¡Œåéƒ½æ£€æŸ¥å˜é‡çš„å€¼æ˜¯å¦æ”¹å˜ã€‚GDBåœ¨æ–°å»ºæ•°æ®æ–­ç‚¹æ—¶ä¼šä¼˜å…ˆå°è¯•ç¡¬ä»¶æ–¹å¼ï¼Œå¦‚æœå¤±è´¥å†å°è¯•è½¯ä»¶å®ç°ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>watch variable</td><td>è®¾ç½®å˜é‡æ•°æ®æ–­ç‚¹</td></tr><tr><td>watch var1 + var2</td><td>è®¾ç½®è¡¨è¾¾å¼æ•°æ®æ–­ç‚¹</td></tr><tr><td>rwatch variable</td><td>è®¾ç½®è¯»æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°</td></tr><tr><td>awatch variable</td><td>è®¾ç½®è¯»å†™æ–­ç‚¹ï¼Œä»…æ”¯æŒç¡¬ä»¶å®ç°</td></tr><tr><td>info watchpoints</td><td>æŸ¥çœ‹æ•°æ®æ–­ç‚¹åˆ—è¡¨</td></tr><tr><td>set can-use-hw-watchpoints 0</td><td>å¼ºåˆ¶åŸºäºè½¯ä»¶æ–¹å¼å®ç°</td></tr></tbody></table> 
<p>ä½¿ç”¨æ•°æ®æ–­ç‚¹æ—¶ï¼Œéœ€è¦æ³¨æ„ï¼š</p> 
<ul><li>å½“ç›‘æ§å˜é‡ä¸ºå±€éƒ¨å˜é‡æ—¶ï¼Œä¸€æ—¦å±€éƒ¨å˜é‡å¤±æ•ˆï¼Œæ•°æ®æ–­ç‚¹ä¹Ÿä¼šå¤±æ•ˆ</li><li>å¦‚æœç›‘æ§çš„æ˜¯æŒ‡é’ˆå˜é‡<code>p</code>ï¼Œåˆ™<code>watch *p</code>ç›‘æ§çš„æ˜¯<code>p</code>æ‰€æŒ‡å†…å­˜æ•°æ®çš„å˜åŒ–æƒ…å†µï¼Œè€Œ<code>watch p</code>ç›‘æ§çš„æ˜¯<code>p</code>æŒ‡é’ˆæœ¬èº«æœ‰æ²¡æœ‰æ”¹å˜æŒ‡å‘</li></ul> 
<p>æœ€å¸¸è§çš„æ•°æ®æ–­ç‚¹åº”ç”¨åœºæ™¯ï¼š<strong>å®šä½å †ä¸Šçš„ç»“æ„ä½“å†…éƒ¨æˆå‘˜ä½•æ—¶è¢«ä¿®æ”¹</strong>ã€‚ç”±äºæŒ‡é’ˆä¸€èˆ¬ä¸ºå±€éƒ¨å˜é‡ï¼Œä¸ºäº†è§£å†³æ–­ç‚¹å¤±æ•ˆï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>print &amp;variable</td><td>æŸ¥çœ‹å˜é‡çš„å†…å­˜åœ°å€</td></tr><tr><td>watch *(type *)address</td><td>é€šè¿‡å†…å­˜åœ°å€é—´æ¥è®¾ç½®æ–­ç‚¹</td></tr><tr><td>watch -l variable</td><td>æŒ‡å®šlocationå‚æ•°</td></tr><tr><td>watch variable thread 1</td><td>ä»…ç¼–å·ä¸º1çš„çº¿ç¨‹ä¿®æ”¹å˜é‡varå€¼æ—¶ä¼šä¸­æ–­</td></tr></tbody></table> 
<h5><a id="catchpoint_118"></a>catchpoint</h5> 
<p>ä»å­—é¢æ„æ€ç†è§£ï¼Œæ˜¯æ•è·æ–­ç‚¹ï¼Œå…¶ä¸»è¦ç›‘æµ‹ä¿¡å·çš„äº§ç”Ÿã€‚ä¾‹å¦‚c++çš„throwï¼Œæˆ–è€…åŠ è½½åº“çš„æ—¶å€™ï¼Œäº§ç”Ÿæ–­ç‚¹è¡Œä¸ºã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>catch fork</td><td>ç¨‹åºè°ƒç”¨forkæ—¶ä¸­æ–­</td></tr><tr><td>tcatch fork</td><td>è®¾ç½®çš„æ–­ç‚¹åªè§¦å‘ä¸€æ¬¡ï¼Œä¹‹åè¢«è‡ªåŠ¨åˆ é™¤</td></tr><tr><td>catch syscall ptrace</td><td>ä¸ºptraceç³»ç»Ÿè°ƒç”¨è®¾ç½®æ–­ç‚¹</td></tr></tbody></table> 
<blockquote> 
 <p>åœ¨<code>command</code>å‘½ä»¤ååŠ æ–­ç‚¹ç¼–å·ï¼Œå¯ä»¥å®šä¹‰æ–­ç‚¹è§¦å‘åæƒ³è¦æ‰§è¡Œçš„æ“ä½œã€‚åœ¨ä¸€äº›é«˜çº§çš„è‡ªåŠ¨åŒ–è°ƒè¯•åœºæ™¯ä¸­å¯èƒ½ä¼šç”¨åˆ°ã€‚</p> 
</blockquote> 
<h4><a id="_132"></a>å‘½ä»¤è¡Œ</h4> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>run arglist</td><td>ä»¥arglistä¸ºå‚æ•°åˆ—è¡¨è¿è¡Œç¨‹åº</td></tr><tr><td>set args arglist</td><td>æŒ‡å®šå¯åŠ¨å‘½ä»¤è¡Œå‚æ•°</td></tr><tr><td>set args</td><td>æŒ‡å®šç©ºçš„å‚æ•°åˆ—è¡¨</td></tr><tr><td>show args</td><td>æ‰“å°å‘½ä»¤è¡Œåˆ—è¡¨</td></tr></tbody></table> 
<h4><a id="_143"></a>ç¨‹åºæ ˆ</h4> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>backtrace [n]</td><td>æ‰“å°æ ˆå¸§</td></tr><tr><td>frame [n]</td><td>é€‰æ‹©ç¬¬nä¸ªæ ˆå¸§ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ‰“å°å½“å‰æ ˆå¸§</td></tr><tr><td>up n</td><td>é€‰æ‹©å½“å‰æ ˆå¸§ç¼–å·+nçš„æ ˆå¸§</td></tr><tr><td>down n</td><td>é€‰æ‹©å½“å‰æ ˆå¸§ç¼–å·-nçš„æ ˆå¸§</td></tr><tr><td>info frame [addr]</td><td>æè¿°å½“å‰é€‰æ‹©çš„æ ˆå¸§</td></tr><tr><td>info args</td><td>å½“å‰æ ˆå¸§çš„å‚æ•°åˆ—è¡¨</td></tr><tr><td>info locals</td><td>å½“å‰æ ˆå¸§çš„å±€éƒ¨å˜é‡</td></tr></tbody></table> 
<h4><a id="_157"></a>å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹</h4> 
<h5><a id="_159"></a>å¤šè¿›ç¨‹</h5> 
<p>GDBåœ¨è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºï¼ˆç¨‹åºå«<code>fork</code>è°ƒç”¨ï¼‰æ—¶ï¼Œé»˜è®¤åªè¿½è¸ªçˆ¶è¿›ç¨‹ã€‚å¯ä»¥é€šè¿‡å‘½ä»¤è®¾ç½®ï¼Œå®ç°åªè¿½è¸ªçˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹ï¼Œæˆ–è€…åŒæ—¶è°ƒè¯•çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>info inferiors</td><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>attach pid</td><td>ç»‘å®šè¿›ç¨‹id</td></tr><tr><td>inferior num</td><td>åˆ‡æ¢åˆ°æŒ‡å®šè¿›ç¨‹ä¸Šè¿›è¡Œè°ƒè¯•</td></tr><tr><td>print $_exitcode</td><td>æ˜¾ç¤ºç¨‹åºé€€å‡ºæ—¶çš„è¿”å›å€¼</td></tr><tr><td>set follow-fork-mode child</td><td>è¿½è¸ªå­è¿›ç¨‹</td></tr><tr><td>set follow-fork-mode parent</td><td>è¿½è¸ªçˆ¶è¿›ç¨‹</td></tr><tr><td>set detach-on-fork on</td><td>forkè°ƒç”¨æ—¶åªè¿½è¸ªå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹</td></tr><tr><td>set detach-on-fork off</td><td>forkè°ƒç”¨æ—¶ä¼šåŒæ—¶è¿½è¸ªçˆ¶å­è¿›ç¨‹</td></tr></tbody></table> 
<p>åœ¨è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºæ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤äº†å½“å‰è°ƒè¯•çš„è¿›ç¨‹ï¼Œå…¶ä»–è¿›ç¨‹éƒ½å¤„äºæŒ‚èµ·çŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œå¦‚æœéœ€è¦åœ¨è°ƒè¯•å½“å‰è¿›ç¨‹çš„æ—¶å€™ï¼Œå…¶ä»–è¿›ç¨‹ä¹Ÿèƒ½æ­£å¸¸æ‰§è¡Œï¼Œé‚£ä¹ˆé€šè¿‡è®¾ç½®<code>set schedule-multiple on</code>å³å¯ã€‚</p> 
<h5><a id="_182"></a>å¤šçº¿ç¨‹</h5> 
<p>å¤šçº¿ç¨‹å¼€å‘åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­å¾ˆå¸¸è§ï¼Œæ‰€ä»¥å¤šçº¿ç¨‹çš„è°ƒè¯•æŠ€å·§éå¸¸æœ‰å¿…è¦æŒæ¡ã€‚</p> 
<p>é»˜è®¤è°ƒè¯•å¤šçº¿ç¨‹æ—¶ï¼Œä¸€æ—¦ç¨‹åºä¸­æ–­ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å°†æš‚åœã€‚å¦‚æœæ­¤æ—¶å†ç»§ç»­æ‰§è¡Œå½“å‰çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿä¼šåŒæ—¶æ‰§è¡Œã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>info threads</td><td>æŸ¥çœ‹çº¿ç¨‹åˆ—è¡¨</td></tr><tr><td>print $_thread</td><td>æ˜¾ç¤ºå½“å‰æ­£åœ¨è°ƒè¯•çš„çº¿ç¨‹ç¼–å·</td></tr><tr><td>set scheduler-locking on</td><td>è°ƒè¯•ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œå…¶ä»–çº¿ç¨‹æš‚åœæ‰§è¡Œ</td></tr><tr><td>set scheduler-locking off</td><td>è°ƒè¯•ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œå…¶ä»–çº¿ç¨‹åŒæ­¥æ‰§è¡Œ</td></tr><tr><td>set scheduler-locking step</td><td>ä»…ç”¨stepè°ƒè¯•çº¿ç¨‹æ—¶å…¶ä»–çº¿ç¨‹ä¸æ‰§è¡Œï¼Œç”¨å…¶ä»–å‘½ä»¤å¦‚nextè°ƒè¯•æ—¶ä»æ‰§è¡Œ</td></tr></tbody></table> 
<p>å¦‚æœåªå…³å¿ƒå½“å‰çº¿ç¨‹ï¼Œå»ºè®®ä¸´æ—¶è®¾ç½® <code>scheduler-locking</code> ä¸º <code>on</code>ï¼Œé¿å…å…¶ä»–çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¯¼è‡´å‘½ä¸­å…¶ä»–æ–­ç‚¹åˆ†æ•£æ³¨æ„åŠ›ã€‚</p> 
<h4><a id="_202"></a>æ‰“å°è¾“å‡º</h4> 
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹æŸä¸ªå˜é‡çš„å€¼ï¼Œä»¥åˆ†æå…¶æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ‰“å°è¾“å‡ºå˜é‡å€¼ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>whatis variable</td><td>æŸ¥çœ‹å˜é‡çš„ç±»å‹</td></tr><tr><td>ptype variable</td><td>æŸ¥çœ‹å˜é‡è¯¦ç»†çš„ç±»å‹ä¿¡æ¯</td></tr><tr><td>info variables var</td><td>æŸ¥çœ‹å®šä¹‰è¯¥å˜é‡çš„æ–‡ä»¶ï¼Œä¸æ”¯æŒå±€éƒ¨å˜é‡</td></tr></tbody></table> 
<h6><a id="_214"></a>æ‰“å°å­—ç¬¦ä¸²</h6> 
<p>ä½¿ç”¨<code>x/s</code>å‘½ä»¤æ‰“å°<code>ASCII</code>å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯å®½å­—ç¬¦å­—ç¬¦ä¸²ï¼Œéœ€è¦å…ˆçœ‹å®½å­—ç¬¦çš„é•¿åº¦ <code>print sizeof(str)</code>ã€‚</p> 
<p>å¦‚æœé•¿åº¦ä¸º<code>2</code>ï¼Œåˆ™ä½¿ç”¨<code>x/hs</code>æ‰“å°ï¼›å¦‚æœé•¿åº¦ä¸º<code>4</code>ï¼Œåˆ™ä½¿ç”¨<code>x/ws</code>æ‰“å°ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>x/s str</td><td>æ‰“å°å­—ç¬¦ä¸²</td></tr><tr><td>set print elements 0</td><td>æ‰“å°ä¸é™åˆ¶å­—ç¬¦ä¸²é•¿åº¦/æˆ–ä¸é™åˆ¶æ•°ç»„é•¿åº¦</td></tr><tr><td>call printf("%s\n",xxx)</td><td>è¿™æ—¶æ‰“å°å‡ºçš„å­—ç¬¦ä¸²ä¸ä¼šå«æœ‰å¤šä½™çš„è½¬ä¹‰ç¬¦</td></tr><tr><td>printf â€œ%s\nâ€,xxx</td><td>åŒä¸Š</td></tr></tbody></table> 
<h6><a id="_229"></a>æ‰“å°æ•°ç»„</h6> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>print *array@10</td><td>æ‰“å°ä»æ•°ç»„å¼€å¤´è¿ç»­10ä¸ªå…ƒç´ çš„å€¼</td></tr><tr><td>print array[60]@10</td><td>æ‰“å°arrayæ•°ç»„ä¸‹æ ‡ä»60å¼€å§‹çš„10ä¸ªå…ƒç´ ï¼Œå³ç¬¬60~69ä¸ªå…ƒç´ </td></tr><tr><td>set print array-indexes on</td><td>æ‰“å°æ•°ç»„å…ƒç´ æ—¶ï¼ŒåŒæ—¶æ‰“å°æ•°ç»„çš„ä¸‹æ ‡</td></tr></tbody></table> 
<h6><a id="_239"></a>æ‰“å°æŒ‡é’ˆ</h6> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>print ptr</td><td>æŸ¥çœ‹è¯¥æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹åŠæŒ‡é’ˆåœ°å€</td></tr><tr><td>print *(struct xxx *)ptr</td><td>æŸ¥çœ‹æŒ‡å‘çš„ç»“æ„ä½“çš„å†…å®¹</td></tr></tbody></table> 
<h6><a id="_248"></a>æ‰“å°æŒ‡å®šå†…å­˜åœ°å€çš„å€¼</h6> 
<p>ä½¿ç”¨<code>x</code>å‘½ä»¤æ¥æ‰“å°å†…å­˜çš„å€¼ï¼Œæ ¼å¼ä¸º<code>x/nfu addr</code>ï¼Œä»¥<code>f</code>æ ¼å¼æ‰“å°ä»<code>addr</code>å¼€å§‹çš„<code>n</code>ä¸ªé•¿åº¦å•å…ƒä¸º<code>u</code>çš„å†…å­˜å€¼ã€‚</p> 
<ul><li><code>n</code>ï¼šè¾“å‡ºå•å…ƒçš„ä¸ªæ•°</li><li><code>f</code>ï¼šè¾“å‡ºæ ¼å¼ï¼Œå¦‚<code>x</code>è¡¨ç¤ºä»¥<code>16</code>è¿›åˆ¶è¾“å‡ºï¼Œ<code>o</code>è¡¨ç¤ºä»¥<code>8</code>è¿›åˆ¶è¾“å‡ºï¼Œé»˜è®¤ä¸º<code>x</code></li><li><code>u</code>ï¼šä¸€ä¸ªå•å…ƒçš„é•¿åº¦ï¼Œ<code>b</code>è¡¨ç¤º<code>1</code>ä¸ª<code>byte</code>ï¼Œ<code>h</code>è¡¨ç¤º<code>2</code>ä¸ª<code>byte</code>ï¼ˆ<code>half word</code>ï¼‰ï¼Œ<code>w</code>è¡¨ç¤º<code>4</code>ä¸ª<code>byte</code>ï¼Œ<code>g</code>è¡¨ç¤º<code>8</code>ä¸ª<code>byte</code>ï¼ˆ<code>giant word</code>ï¼‰</li></ul> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>x/8xb array</td><td>ä»¥16è¿›åˆ¶æ‰“å°æ•°ç»„arrayçš„å‰8ä¸ªbyteçš„å€¼</td></tr><tr><td>x/8xw array</td><td>ä»¥16è¿›åˆ¶æ‰“å°æ•°ç»„arrayçš„å‰16ä¸ªwordçš„å€¼</td></tr></tbody></table> 
<h6><a id="_263"></a>æ‰“å°å±€éƒ¨å˜é‡</h6> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>info locals</td><td>æ‰“å°å½“å‰å‡½æ•°å±€éƒ¨å˜é‡çš„å€¼</td></tr><tr><td>backtrace full</td><td>æ‰“å°å½“å‰æ ˆå¸§å„ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡å€¼ï¼Œå‘½ä»¤å¯ç¼©å†™ä¸ºbt</td></tr><tr><td>bt full n</td><td>ä»å†…åˆ°å¤–æ˜¾ç¤ºnä¸ªæ ˆå¸§åŠå…¶å±€éƒ¨å˜é‡</td></tr><tr><td>bt full -n</td><td>ä»å¤–å‘å†…æ˜¾ç¤ºnä¸ªæ ˆå¸§åŠå…¶å±€éƒ¨å˜é‡</td></tr></tbody></table> 
<h6><a id="_272"></a>æ‰“å°ç»“æ„ä½“</h6> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>set print pretty on</td><td>æ¯è¡Œåªæ˜¾ç¤ºç»“æ„ä½“çš„ä¸€åæˆå‘˜</td></tr><tr><td>set print null-stop</td><td>ä¸æ˜¾ç¤ºâ€™\000â€™è¿™ç§</td></tr></tbody></table> 
<h4><a id="_279"></a>å‡½æ•°è·³è½¬</h4> 
<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>set step-mode on</td><td>ä¸è·³è¿‡ä¸å«è°ƒè¯•ä¿¡æ¯çš„å‡½æ•°ï¼Œå¯ä»¥æ˜¾ç¤ºå’Œè°ƒè¯•æ±‡ç¼–ä»£ç </td></tr><tr><td>finish</td><td>æ‰§è¡Œå®Œå½“å‰å‡½æ•°å¹¶æ‰“å°è¿”å›å€¼ï¼Œç„¶åè§¦å‘ä¸­æ–­</td></tr><tr><td>return 0</td><td>ä¸å†æ‰§è¡Œåé¢çš„æŒ‡ä»¤ï¼Œç›´æ¥è¿”å›ï¼Œå¯ä»¥æŒ‡å®šè¿”å›å€¼</td></tr><tr><td>call printf("%s\n", str)</td><td>è°ƒç”¨printfå‡½æ•°ï¼Œæ‰“å°å­—ç¬¦ä¸²(å¯ä»¥ä½¿ç”¨callæˆ–è€…printè°ƒç”¨å‡½æ•°)</td></tr><tr><td>print func()</td><td>è°ƒç”¨funcå‡½æ•°(å¯ä»¥ä½¿ç”¨callæˆ–è€…printè°ƒç”¨å‡½æ•°)</td></tr><tr><td>set var variable=xxx</td><td>è®¾ç½®å˜é‡variableçš„å€¼ä¸ºxxx</td></tr><tr><td>set {type}address = xxx</td><td>ç»™å­˜å‚¨åœ°å€ä¸ºaddressï¼Œç±»å‹ä¸ºtypeçš„å˜é‡èµ‹å€¼</td></tr><tr><td>info frame</td><td>æ˜¾ç¤ºå‡½æ•°å †æ ˆçš„ä¿¡æ¯ï¼ˆå †æ ˆå¸§åœ°å€ã€æŒ‡ä»¤å¯„å­˜å™¨çš„å€¼ç­‰ï¼‰</td></tr></tbody></table> 
<h4><a id="_294"></a>å…¶å®ƒ</h4> 
<h5><a id="_296"></a>å›¾å½¢åŒ–</h5> 
<p>tuiä¸º<code>terminal user interface</code>çš„ç¼©å†™ï¼Œåœ¨å¯åŠ¨æ—¶å€™æŒ‡å®š<code>-tui</code>å‚æ•°ï¼Œæˆ–è€…è°ƒè¯•æ—¶ä½¿ç”¨<code>ctrl+x+a</code>ç»„åˆé”®ï¼Œå¯è¿›å…¥æˆ–é€€å‡ºå›¾å½¢åŒ–ç•Œé¢ã€‚</p> 
<table><thead><tr><th>å‘½ä»¤</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>layout src</td><td>æ˜¾ç¤ºæºç çª—å£</td></tr><tr><td>layout asm</td><td>æ˜¾ç¤ºæ±‡ç¼–çª—å£</td></tr><tr><td>layout split</td><td>æ˜¾ç¤ºæºç  + æ±‡ç¼–çª—å£</td></tr><tr><td>layout regs</td><td>æ˜¾ç¤ºå¯„å­˜å™¨ + æºç æˆ–æ±‡ç¼–çª—å£</td></tr><tr><td>winheight src +5</td><td>æºç çª—å£é«˜åº¦å¢åŠ 5è¡Œ</td></tr><tr><td>winheight asm -5</td><td>æ±‡ç¼–çª—å£é«˜åº¦å‡å°5è¡Œ</td></tr><tr><td>winheight cmd +5</td><td>æ§åˆ¶å°çª—å£é«˜åº¦å¢åŠ 5è¡Œ</td></tr><tr><td>winheight regs -5</td><td>å¯„å­˜å™¨çª—å£é«˜åº¦å‡å°5è¡Œ</td></tr></tbody></table> 
<h5><a id="_311"></a>æ±‡ç¼–</h5> 
<table><thead><tr><th>å‘½ä»¤</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>disassemble function</td><td>æŸ¥çœ‹å‡½æ•°çš„æ±‡ç¼–ä»£ç </td></tr><tr><td>disassemble /mr function</td><td>åŒæ—¶æ¯”è¾ƒå‡½æ•°æºä»£ç å’Œæ±‡ç¼–ä»£ç </td></tr></tbody></table> 
<h5><a id="core_318"></a>è°ƒè¯•å’Œä¿å­˜coreæ–‡ä»¶</h5> 
<table><thead><tr><th>å‘½ä»¤</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>file exec_file *# *</td><td>åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶çš„ç¬¦å·è¡¨ä¿¡æ¯</td></tr><tr><td>core core_file</td><td>åŠ è½½core-dumpæ–‡ä»¶</td></tr><tr><td>gcore core_file</td><td>ç”Ÿæˆcore-dumpæ–‡ä»¶ï¼Œè®°å½•å½“å‰è¿›ç¨‹çš„çŠ¶æ€</td></tr></tbody></table> 
<h3><a id="_326"></a>å¯åŠ¨æ–¹å¼</h3> 
<p>ä½¿ç”¨gdbè°ƒè¯•ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§å¯åŠ¨æ–¹å¼ï¼š</p> 
<ul><li>gdb filename: è°ƒè¯•å¯æ‰§è¡Œç¨‹åº</li><li>gdb attach pid: é€šè¿‡â€ç»‘å®šâ€œè¿›ç¨‹IDæ¥è°ƒè¯•æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</li><li>gdb filename -c coredump_file: è°ƒè¯•å¯æ‰§è¡Œæ–‡ä»¶</li></ul> 
<p>åœ¨ä¸‹é¢çš„å‡ èŠ‚ä¸­ï¼Œå°†åˆ†åˆ«å¯¹ä¸Šè¿°å‡ ç§è°ƒè¯•æ–¹å¼è¿›è¡Œè®²è§£ï¼Œä»ä¾‹å­çš„è§’åº¦å‡ºå‘ï¼Œä½¿å¾—å¤§å®¶èƒ½å¤Ÿæ›´å¥½çš„æŒæ¡è°ƒè¯•æŠ€å·§ã€‚</p> 
<h3><a id="_338"></a>è°ƒè¯•</h3> 
<h4><a id="_340"></a>å¯æ‰§è¡Œæ–‡ä»¶</h4> 
<h5><a id="_342"></a>å•çº¿ç¨‹</h5> 
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€æ®µä»£ç ï¼š</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span> xx<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>xxptr<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"In print():\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"   xx is %d and is stored at %p.\n"</span><span class="token punctuation">,</span> xx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>xx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"   ptr points to %p which holds %d.\n"</span><span class="token punctuation">,</span> xxptr<span class="token punctuation">,</span> <span class="token operator">*</span>xxptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> <span class="token operator">*</span>ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"In main():\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"   x is %d and is stored at %p.\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"   ptr points to %p which holds %d.\n"</span><span class="token punctuation">,</span> ptr<span class="token punctuation">,</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> ptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™ä¸ªä»£ç æ¯”è¾ƒç®€å•ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹è¿›å…¥è°ƒè¯•ï¼š</p> 
<pre><code class="prism language-shell">gdb ./test_main
GNU gdb <span class="token punctuation">(</span>GDB<span class="token punctuation">)</span> Red Hat Enterprise Linux <span class="token number">7.6</span>.1-114.el7
Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2013</span> Free Software Foundation, Inc.
License GPLv3+: GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http://gnu.org/licenses/gpl.html<span class="token operator">&gt;</span>
This is <span class="token function">free</span> software: you are <span class="token function">free</span> to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type <span class="token string">"show copying"</span>
and <span class="token string">"show warranty"</span> <span class="token keyword">for</span> details.
This GDB was configured as <span class="token string">"x86_64-redhat-linux-gnu"</span><span class="token builtin class-name">.</span>
For bug reporting instructions, please see:
<span class="token operator">&lt;</span>http://www.gnu.org/software/gdb/bugs/<span class="token operator">&gt;</span><span class="token punctuation">..</span>.
Reading symbols from /root/test_main<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /root/./test_main
In main<span class="token punctuation">(</span><span class="token punctuation">)</span>:
   x is <span class="token number">10</span> and is stored at 0x7fffffffe424.
   ptr points to 0x7fffffffe424 <span class="token function">which</span> holds <span class="token number">10</span>.
In print<span class="token punctuation">(</span><span class="token punctuation">)</span>:
   xx is <span class="token number">10</span> and is stored at 0x7fffffffe40c.
   xxptr points to 0x7fffffffe424 <span class="token function">which</span> holds <span class="token number">10</span>.
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">31518</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64
</code></pre> 
<p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡gdb testå‘½ä»¤å¯åŠ¨è°ƒè¯•ï¼Œç„¶åé€šè¿‡æ‰§è¡Œr(runå‘½ä»¤çš„ç¼©å†™)æ‰§è¡Œç¨‹åºï¼Œç›´è‡³é€€å‡ºï¼Œ<em>æ¢å¥è¯è¯´ï¼Œä¸Šè¿°å‘½ä»¤æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨gdbè¿è¡Œå¯æ‰§è¡Œç¨‹åºçš„å®Œæ•´è¿‡ç¨‹(åªä½¿ç”¨äº†rå‘½ä»¤)</em>ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»¥æ­¤ä¸ºä¾‹å­ï¼Œä»‹ç»å‡ ç§æ¯”è¾ƒå¸¸è§çš„å‘½ä»¤ã€‚</p> 
<h6><a id="_398"></a>æ–­ç‚¹</h6> 
<pre><code class="prism language-c"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> b <span class="token number">15</span>
Breakpoint <span class="token number">1</span> at <span class="token number">0x400601</span><span class="token operator">:</span> file test_main<span class="token punctuation">.</span>cc<span class="token punctuation">,</span> line <span class="token number">15.</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info b
Num     Type           Disp Enb Address            What
<span class="token number">1</span>       breakpoint     keep y   <span class="token number">0x0000000000400601</span> in <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> at test_main<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">15</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program<span class="token operator">:</span> <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">/</span>test_main
In <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
   x is <span class="token number">10</span> and is stored at <span class="token number">0x7fffffffe424.</span>
   ptr points to <span class="token number">0x7fffffffe424</span> which holds <span class="token number">10.</span>

Breakpoint <span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> at test_main<span class="token punctuation">.</span>cc<span class="token operator">:</span><span class="token number">15</span>
<span class="token number">15</span>	  <span class="token function">print</span><span class="token punctuation">(</span>xx<span class="token punctuation">,</span> xxptr<span class="token punctuation">)</span><span class="token punctuation">;</span>
Missing separate debuginfos<span class="token punctuation">,</span> use<span class="token operator">:</span> debuginfo<span class="token operator">-</span>install glibc<span class="token operator">-</span><span class="token number">2.17</span><span class="token operator">-</span><span class="token number">260.</span>el7<span class="token punctuation">.</span><span class="token function">x86_64</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<h6><a id="backtrace_420"></a>backtrace</h6> 
<pre><code>(gdb) backtrace
#0  main () at test_main.cc:15
(gdb)
</code></pre> 
<p>backtraceå‘½ä»¤æ˜¯åˆ—å‡ºå½“å‰å †æ ˆä¸­çš„æ‰€æœ‰å¸§ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ ˆä¸Šåªæœ‰ä¸€å¸§ï¼Œç¼–å·ä¸º0ï¼Œå±äºmainå‡½æ•°ã€‚</p> 
<pre><code>(gdb) step
print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
4	  printf("In print():\n");
(gdb)
</code></pre> 
<p>æ¥ç€ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†stepå‘½ä»¤ï¼Œå³è¿›å…¥å‡½æ•°å†…ã€‚ä¸‹é¢æˆ‘ä»¬ç»§ç»­é€šè¿‡backtraceå‘½ä»¤æ¥æŸ¥çœ‹æ ˆå¸§ä¿¡æ¯ã€‚</p> 
<pre><code>(gdb) backtrace
#0  print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
#1  0x0000000000400612 in main () at test_main.cc:15
(gdb)
</code></pre> 
<p>ä»ä¸Šé¢è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºï¼Œæœ‰ä¸¤ä¸ªæ ˆå¸§ï¼Œç¬¬1å¸§å±äºmainå‡½æ•°ï¼Œç¬¬0å¸§å±äºprintå‡½æ•°ã€‚</p> 
<p>æ¯ä¸ªæ ˆå¸§éƒ½åˆ—å‡ºäº†è¯¥å‡½æ•°çš„å‚æ•°åˆ—è¡¨ã€‚ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œmainå‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œè€Œprintå‡½æ•°æœ‰å‚æ•°ï¼Œå¹¶ä¸”æ˜¾ç¤ºäº†å…¶å‚æ•°çš„å€¼ã€‚</p> 
<p>æœ‰ä¸€ç‚¹æˆ‘ä»¬å¯èƒ½æ¯”è¾ƒè¿·æƒ‘ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œbacktraceçš„æ—¶å€™ï¼Œmainå‡½æ•°æ‰€åœ¨çš„æ ˆå¸§ç¼–å·ä¸º0ï¼Œè€Œç¬¬äºŒæ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œmainå‡½æ•°çš„æ ˆå¸§ä¸º1ï¼Œè€Œprintå‡½æ•°çš„æ ˆå¸§ä¸º0ï¼Œè¿™æ˜¯å› ä¸º_ä¸æ ˆçš„å‘ä¸‹å¢é•¿_è§„å¾‹ä¸€è‡´ï¼Œæˆ‘ä»¬åªéœ€è¦è®°ä½_ç¼–å·æœ€å°å¸§å·å°±æ˜¯æœ€è¿‘ä¸€æ¬¡è°ƒç”¨çš„å‡½æ•°_ã€‚</p> 
<h6><a id="frame_458"></a>frame</h6> 
<p>æ ˆå¸§ç”¨æ¥å­˜å‚¨å‡½æ•°çš„å˜é‡å€¼ç­‰ä¿¡æ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒGDBæ€»æ˜¯ä½äºå½“å‰æ­£åœ¨æ‰§è¡Œå‡½æ•°å¯¹åº”æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­ã€‚</p> 
<p>åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œç”±äºå½“å‰æ­£åœ¨print()å‡½æ•°ä¸­æ‰§è¡Œï¼ŒGDBä½äºç¬¬0å¸§çš„ä¸Šä¸‹æ–‡ä¸­ã€‚<em>å¯ä»¥é€šè¿‡frameå‘½ä»¤æ¥è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸Šä¸‹æ–‡æ‰€åœ¨çš„å¸§</em>ã€‚</p> 
<pre><code>(gdb) frame
#0  print (xx=10, xxptr=0x7fffffffe424) at test_main.cc:4
4	  printf("In print():\n");
(gdb)
</code></pre> 
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨printå‘½ä»¤æ‰“å°ä¸‹å½“å‰æ ˆå¸§çš„å€¼ï¼Œå¦‚ä¸‹ï¼š</p> 
<pre><code>(gdb) print xx
$1 = 10
(gdb) print xxptr
$2 = (int *) 0x7fffffffe424
(gdb)
</code></pre> 
<p>å¦‚æœæˆ‘ä»¬æƒ³çœ‹å…¶ä»–æ ˆå¸§çš„å†…å®¹å‘¢ï¼Ÿæ¯”å¦‚mainå‡½æ•°ä¸­xå’Œptrçš„ä¿¡æ¯å‘¢ï¼Ÿå‡å¦‚ç›´æ¥æ‰“å°è¿™ä¿©å€¼çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°å¦‚ä¸‹ï¼š</p> 
<pre><code>(gdb) print x
No symbol "x" in current context.
(gdb) print xxptr
No symbol "ptr" in current context.
(gdb)
</code></pre> 
<p>åœ¨æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡_frame num_æ¥åˆ‡æ¢æ ˆå¸§ï¼Œå¦‚ä¸‹ï¼š</p> 
<pre><code>(gdb) frame 1
#1  0x0000000000400612 in main () at test_main.cc:15
15	  print(x, ptr);
(gdb) print x
$3 = 10
(gdb) print ptr
$4 = (int *) 0x7fffffffe424
(gdb)
</code></pre> 
<h5><a id="_512"></a>å¤šçº¿ç¨‹</h5> 
<p>ä¸ºäº†æ–¹ä¾¿è¿›è¡Œæ¼”ç¤ºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c++">#include &lt;chrono&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;thread&gt;
#include &lt;vector&gt;

int fun_int(int n) {
  std::this_thread::sleep_for(std::chrono::seconds(10));
  std::cout &lt;&lt; "in fun_int n = " &lt;&lt; n &lt;&lt; std::endl;
  
  return 0;
}

int fun_string(const std::string &amp;s) {
  std::this_thread::sleep_for(std::chrono::seconds(10));
  std::cout &lt;&lt; "in fun_string s = " &lt;&lt; s &lt;&lt; std::endl;
  
  return 0;
}

int main() {
  std::vector&lt;int&gt; v;
  v.emplace_back(1);
  v.emplace_back(2);
  v.emplace_back(3);

  std::cout &lt;&lt; v.size() &lt;&lt; std::endl;

  std::thread t1(fun_int, 1);
  std::thread t2(fun_string, "test");

  std::cout &lt;&lt; "after thread create" &lt;&lt; std::endl;
  t1.join();
  t2.join();
  return 0;
}
</code></pre> 
<p>ä¸Šè¿°ä»£ç æ¯”è¾ƒç®€å•ï¼š</p> 
<ul><li>å‡½æ•°fun_intçš„åŠŸèƒ½æ˜¯ä¼‘çœ 10sï¼Œç„¶åæ‰“å°å…¶å‚æ•°</li><li>å‡½æ•°fun_stringåŠŸèƒ½æ˜¯ä¼‘çœ 10sï¼Œç„¶åæ‰“å°å…¶å‚æ•°</li><li>mainå‡½æ•°ä¸­ï¼Œåˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«æ‰§è¡Œä¸Šè¿°ä¸¤ä¸ªå‡½æ•°</li></ul> 
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„è°ƒè¯•è¿‡ç¨‹ï¼š</p> 
<pre><code class="prism language-c++">(gdb) b 27
Breakpoint 1 at 0x4013d5: file test.cc, line 27.
(gdb) b test.cc:32
Breakpoint 2 at 0x40142d: file test.cc, line 32.
(gdb) info b
Num     Type           Disp Enb Address            What
1       breakpoint     keep y   0x00000000004013d5 in main() at test.cc:27
2       breakpoint     keep y   0x000000000040142d in main() at test.cc:32
(gdb) r
Starting program: /root/test
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib64/libthread_db.so.1".

Breakpoint 1, main () at test.cc:27
(gdb) c
Continuing.
3
[New Thread 0x7ffff6fd2700 (LWP 44996)]
in fun_int n = 1
[New Thread 0x7ffff67d1700 (LWP 44997)]

Breakpoint 2, main () at test.cc:32
32	  std::cout &lt;&lt; "after thread create" &lt;&lt; std::endl;
(gdb) info threads
  Id   Target Id         Frame
  3    Thread 0x7ffff67d1700 (LWP 44997) "test" 0x00007ffff7051fc3 in new_heap () from /lib64/libc.so.6
  2    Thread 0x7ffff6fd2700 (LWP 44996) "test" 0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6
* 1    Thread 0x7ffff7fe7740 (LWP 44987) "test" main () at test.cc:32
(gdb) thread 2
[Switching to thread 2 (Thread 0x7ffff6fd2700 (LWP 44996))]
#0  0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6
(gdb) bt
#0  0x00007ffff7097e2d in nanosleep () from /lib64/libc.so.6
#1  0x00007ffff7097cc4 in sleep () from /lib64/libc.so.6
#2  0x00007ffff796ceb9 in std::this_thread::__sleep_for(std::chrono::duration&lt;long, std::ratio&lt;1l, 1l&gt; &gt;, std::chrono::duration&lt;long, std::ratio&lt;1l, 1000000000l&gt; &gt;) () from /lib64/libstdc++.so.6
#3  0x00000000004018cc in std::this_thread::sleep_for&lt;long, std::ratio&lt;1l, 1l&gt; &gt; (__rtime=...) at /usr/include/c++/4.8.2/thread:281
#4  0x0000000000401307 in fun_int (n=1) at test.cc:9
#5  0x0000000000404696 in std::_Bind_simple&lt;int (*(int))(int)&gt;::_M_invoke&lt;0ul&gt;(std::_Index_tuple&lt;0ul&gt;) (this=0x609080)
    at /usr/include/c++/4.8.2/functional:1732
#6  0x000000000040443d in std::_Bind_simple&lt;int (*(int))(int)&gt;::operator()() (this=0x609080) at /usr/include/c++/4.8.2/functional:1720
#7  0x000000000040436e in std::thread::_Impl&lt;std::_Bind_simple&lt;int (*(int))(int)&gt; &gt;::_M_run() (this=0x609068) at /usr/include/c++/4.8.2/thread:115
#8  0x00007ffff796d070 in ?? () from /lib64/libstdc++.so.6
#9  0x00007ffff7bc6dd5 in start_thread () from /lib64/libpthread.so.0
#10 0x00007ffff70d0ead in clone () from /lib64/libc.so.6
(gdb) c
Continuing.
after thread create
in fun_int n = 1
[Thread 0x7ffff6fd2700 (LWP 45234) exited]
in fun_string s = test
[Thread 0x7ffff67d1700 (LWP 45235) exited]
[Inferior 1 (process 45230) exited normally]
(gdb) q
</code></pre> 
<p>åœ¨ä¸Šè¿°è°ƒè¯•è¿‡ç¨‹ä¸­ï¼š</p> 
<ol><li> <p>b 27 åœ¨ç¬¬27è¡ŒåŠ ä¸Šæ–­ç‚¹</p> </li><li> <p>b test.cc:32 åœ¨ç¬¬32è¡ŒåŠ ä¸Šæ–­ç‚¹(æ•ˆæœä¸b 32ä¸€è‡´)</p> </li><li> <p>info b è¾“å‡ºæ‰€æœ‰çš„æ–­ç‚¹ä¿¡æ¯</p> </li><li> <p>r ç¨‹åºå¼€å§‹è¿è¡Œï¼Œå¹¶åœ¨ç¬¬ä¸€ä¸ªæ–­ç‚¹å¤„æš‚åœ</p> </li><li> <p>c æ‰§è¡Œcå‘½ä»¤ï¼Œåœ¨ç¬¬äºŒä¸ªæ–­ç‚¹å¤„æš‚åœï¼Œåœ¨ç¬¬ä¸€ä¸ªæ–­ç‚¹å’Œç¬¬äºŒä¸ªæ–­ç‚¹ä¹‹é—´ï¼Œåˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹t1å’Œt2</p> </li><li> <p>info threads è¾“å‡ºæ‰€æœ‰çš„çº¿ç¨‹ä¿¡æ¯ï¼Œä»è¾“å‡ºä¸Šå¯ä»¥çœ‹å‡ºï¼Œæ€»å…±æœ‰3ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«ä¸ºmainçº¿ç¨‹ã€t1å’Œt2</p> </li><li> <p>thread 2 åˆ‡æ¢è‡³çº¿ç¨‹2</p> </li><li> <p>bt è¾“å‡ºçº¿ç¨‹2çš„å †æ ˆä¿¡æ¯</p> </li><li> <p>c ç›´è‡³ç¨‹åºç»“æŸ</p> </li><li> <p>q é€€å‡ºgdb</p> </li></ol> 
<h5><a id="_641"></a>å¤šè¿›ç¨‹</h5> 
<p>åŒä¸Šé¢ä¸€æ ·ï¼Œæˆ‘ä»¬ä»ç„¶ä»¥ä¸€ä¸ªä¾‹å­è¿›è¡Œæ¨¡æ‹Ÿå¤šè¿›ç¨‹è°ƒè¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">pid_t</span> pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
       <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"fork error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token keyword">if</span><span class="token punctuation">(</span>pid <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// å­è¿›ç¨‹</span>
        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
          <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is child,pid = %d\n"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span> <span class="token comment">// çˆ¶è¿›ç¨‹</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"this is parent,pid = %d\n"</span><span class="token punctuation">,</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">wait</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ç­‰å¾…å­è¿›ç¨‹é€€å‡º</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼ŒåŒ…å«ä¸¤ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªæ˜¯çˆ¶è¿›ç¨‹(ä¹Ÿå°±æ˜¯mainè¿›ç¨‹)ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ç”±fork()å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ã€‚</p> 
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å¤šè¿›ç¨‹ç¨‹åºä¸­ï¼ŒGDBåªè°ƒè¯•mainè¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºç¨‹åºè°ƒç”¨äº†å¤šå°‘æ¬¡fork()å‡½æ•°åˆ›å»ºäº†å¤šå°‘ä¸ªå­è¿›ç¨‹ï¼ŒGDBåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªè°ƒè¯•çˆ¶è¿›ç¨‹ã€‚ä¸ºäº†æ”¯æŒå¤šè¿›ç¨‹è°ƒè¯•ï¼Œä»GDBç‰ˆæœ¬7.0å¼€å§‹æ”¯æŒå•ç‹¬è°ƒè¯•(è°ƒè¯•çˆ¶è¿›ç¨‹æˆ–è€…å­è¿›ç¨‹)å’ŒåŒæ—¶è°ƒè¯•å¤šä¸ªè¿›ç¨‹ã€‚</p> 
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è°ƒè¯•å­è¿›ç¨‹å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‡ ç§æ–¹å¼è¿›è¡Œå­è¿›ç¨‹è°ƒè¯•ã€‚</p> 
<h6><a id="attach_683"></a>attach</h6> 
<p>é¦–å…ˆï¼Œæ— è®ºæ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ï¼Œéƒ½å¯ä»¥é€šè¿‡attachå‘½ä»¤å¯åŠ¨gdbè¿›è¡Œè°ƒè¯•ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äºæ¯ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿéƒ½ä¼šä¸ºå…¶åˆ†é…ä¸€ä¸ªå”¯ä¸€IDå·ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹IDã€‚å¦‚æœæˆ‘ä»¬çŸ¥é“äº†è¿›ç¨‹IDï¼Œå°±å¯ä»¥ä½¿ç”¨attachå‘½ä»¤å¯¹å…¶è¿›è¡Œè°ƒè¯•äº†ã€‚</p> 
<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œfork()å‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹å†…éƒ¨ï¼Œé¦–å…ˆä¼šè¿›å…¥whileå¾ªç¯sleepï¼Œç„¶ååœ¨whileå¾ªç¯ä¹‹åè°ƒç”¨printfå‡½æ•°ã€‚è¿™æ ·åšçš„ç›®çš„æœ‰å¦‚ä¸‹ï¼š</p> 
<ul><li>å¸®åŠ©attachæ•è·è¦è°ƒè¯•çš„è¿›ç¨‹id</li><li>åœ¨ä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼ŒçœŸæ­£çš„ä»£ç (å³printå‡½æ•°)æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè¿™æ ·å°±å¯ä»¥ä»å¤´å¼€å§‹å¯¹å­è¿›ç¨‹è¿›è¡Œè°ƒè¯•</li></ul> 
<blockquote> 
 <p>å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼Œä¸Šé¢ä»£ç ä»¥åŠè¿›å…¥whileå¾ªç¯ï¼Œæ— è®ºå¦‚ä½•æ˜¯ä¸ä¼šæ‰§è¡Œåˆ°ä¸‹é¢printfå‡½æ•°ã€‚å…¶å®ï¼Œè¿™å°±æ˜¯gdbçš„å‰å®³ä¹‹å¤„ï¼Œå¯ä»¥é€šè¿‡gdbå‘½ä»¤ä¿®æ”¹numçš„å€¼ï¼Œä»¥ä¾¿å…¶è·³å‡ºwhileå¾ªç¯</p> 
</blockquote> 
<p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶test_process</p> 
<pre><code class="prism language-shell">g++ -g test_process.cc -o test_process
</code></pre> 
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹å°è¯•å¯åŠ¨è°ƒè¯•ã€‚</p> 
<pre><code class="prism language-shell">gdb -q ./test_process
Reading symbols from /root/test_process<span class="token punctuation">..</span>.done.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<p>è¿™é‡Œéœ€è¦è¯´æ˜ä¸‹ï¼Œä¹‹æ‰€ä»¥åŠ -qé€‰é¡¹ï¼Œæ˜¯æƒ³å»æ‰å…¶ä»–ä¸å¿…è¦çš„è¾“å‡ºï¼Œqä¸ºquiteçš„ç¼©å†™ã€‚</p> 
<pre><code class="prism language-shell"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /root/./test_process
Detaching after fork from child process <span class="token number">37482</span>.
this is parent,pid <span class="token operator">=</span> <span class="token number">37478</span>
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">37478</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> attach <span class="token number">37482</span>
//ç¬¦å·ç±»è¾“å‡ºï¼Œæ­¤å¤„ç•¥å»
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
Single stepping <span class="token keyword">until</span> <span class="token builtin class-name">exit</span> from <span class="token keyword">function</span> __nanosleep_nocancel,
<span class="token function">which</span> has no line number information.
0x00007ffff72b3cc4 <span class="token keyword">in</span> <span class="token function">sleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from /lib64/libc.so.6
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
Single stepping <span class="token keyword">until</span> <span class="token builtin class-name">exit</span> from <span class="token keyword">function</span> sleep,
<span class="token function">which</span> has no line number information.
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test_process.cc:8
<span class="token number">8</span>	      while<span class="token punctuation">(</span>num<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†n(nextçš„ç¼©å†™)ï¼Œä½¿å…¶é‡æ–°å¯¹whileå¾ªç¯çš„åˆ¤æ–­ä½“è¿›è¡Œåˆ¤æ–­ã€‚</p> 
<pre><code class="prism language-shell"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> num <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
<span class="token number">12</span>	      printf<span class="token punctuation">(</span><span class="token string">"this is child,pid = %d<span class="token entity" title="\n">\n</span>"</span>,getpid<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> c
Continuing.
this is child,pid <span class="token operator">=</span> <span class="token number">37482</span>
<span class="token punctuation">[</span>Inferior <span class="token number">1</span> <span class="token punctuation">(</span>process <span class="token number">37482</span><span class="token punctuation">)</span> exited normally<span class="token punctuation">]</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<p>ä¸ºäº†é€€å‡ºwhileå¾ªç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨setå‘½ä»¤è®¾ç½®äº†numçš„å€¼ä¸º1ï¼Œè¿™æ ·æ¡ä»¶å°±ä¼šå¤±æ•ˆé€€å‡ºwhileå¾ªç¯ï¼Œè¿›è€Œæ‰§è¡Œä¸‹é¢çš„printf()å‡½æ•°ï¼›åœ¨æœ€åæˆ‘ä»¬æ‰§è¡Œäº†c(continueçš„ç¼©å†™)å‘½ä»¤ï¼Œæ”¯æŒç¨‹åºé€€å‡ºã€‚</p> 
<blockquote> 
 <p>å¦‚æœç¨‹åºæ­£åœ¨æ­£å¸¸è¿è¡Œï¼Œå‡ºç°äº†æ­»é”ç­‰ç°è±¡ï¼Œåˆ™å¯ä»¥é€šè¿‡psè·å–è¿›ç¨‹IDï¼Œç„¶åæ ¹æ®gdb attach pidè¿›è¡Œç»‘å®šï¼Œè¿›è€ŒæŸ¥çœ‹å †æ ˆä¿¡æ¯</p> 
</blockquote> 
<h6><a id="_756"></a>æŒ‡å®šè¿›ç¨‹</h6> 
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGDBè°ƒè¯•å¤šè¿›ç¨‹ç¨‹åºæ—¶å€™ï¼Œåªè°ƒè¯•çˆ¶è¿›ç¨‹ã€‚GDBæä¾›äº†ä¸¤ä¸ªå‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡follow-fork-modeå’Œdetach-on-forkæ¥æŒ‡å®šè°ƒè¯•çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ã€‚</p> 
<h6><a id="followforkmode_760"></a>follow-fork-mode</h6> 
<p>è¯¥å‘½ä»¤çš„ä½¿ç”¨æ–¹å¼ä¸ºï¼š</p> 
<pre><code class="prism language-shell"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode mode
</code></pre> 
<p>å…¶ä¸­ï¼Œmodeæœ‰ä»¥ä¸‹ä¸¤ä¸ªé€‰é¡¹ï¼š</p> 
<ul><li>parent:çˆ¶è¿›ç¨‹ï¼Œmodeçš„é»˜è®¤é€‰é¡¹</li><li>child:å­è¿›ç¨‹ï¼Œå…¶ç›®çš„æ˜¯å‘Šè¯‰ gdb åœ¨ç›®æ ‡åº”ç”¨è°ƒç”¨forkä¹‹åæ¥ç€è°ƒè¯•å­è¿›ç¨‹è€Œä¸æ˜¯çˆ¶è¿›ç¨‹ï¼Œå› ä¸ºåœ¨Linuxç³»ç»Ÿä¸­fork()ç³»ç»Ÿè°ƒç”¨æˆåŠŸä¼šè¿”å›ä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨çˆ¶è¿›ç¨‹ï¼Œä¸€æ¬¡åœ¨å­è¿›ç¨‹</li></ul> 
<pre><code class="prism language-shell"><span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show follow-fork-mode
Debugger response to a program call of fork or vfork is <span class="token string">"parent"</span><span class="token builtin class-name">.</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">set</span> follow-fork-mode child
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> r
Starting program: /root/./test_process
<span class="token punctuation">[</span>New process <span class="token number">37830</span><span class="token punctuation">]</span>
this is parent,pid <span class="token operator">=</span> <span class="token number">37826</span>

^C
Program received signal SIGINT, Interrupt.
<span class="token punctuation">[</span>Switching to process <span class="token number">37830</span><span class="token punctuation">]</span>
0x00007ffff72b3e10 <span class="token keyword">in</span> __nanosleep_nocancel <span class="token punctuation">(</span><span class="token punctuation">)</span> from /lib64/libc.so.6
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
Single stepping <span class="token keyword">until</span> <span class="token builtin class-name">exit</span> from <span class="token keyword">function</span> __nanosleep_nocancel,
<span class="token function">which</span> has no line number information.
0x00007ffff72b3cc4 <span class="token keyword">in</span> <span class="token function">sleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from /lib64/libc.so.6
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> n
Single stepping <span class="token keyword">until</span> <span class="token builtin class-name">exit</span> from <span class="token keyword">function</span> sleep,
<span class="token function">which</span> has no line number information.
main <span class="token punctuation">(</span><span class="token punctuation">)</span> at test_process.cc:8
<span class="token number">8</span>	      while<span class="token punctuation">(</span>num<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> show follow-fork-mode
Debugger response to a program call of fork or vfork is <span class="token string">"child"</span><span class="token builtin class-name">.</span>
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬åšäº†å¦‚ä¸‹æ“ä½œï¼š</p> 
<ol><li>show follow-fork-mode:é€šè¿‡è¯¥å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰å¤„äºä»€ä¹ˆæ¨¡å¼ä¸‹ï¼Œé€šè¿‡è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œå¤„äºparentå³çˆ¶è¿›ç¨‹æ¨¡å¼</li><li>set follow-fork-mode child:æŒ‡å®šè°ƒè¯•å­è¿›ç¨‹æ¨¡å¼</li><li>r:è¿è¡Œç¨‹åºï¼Œç›´æ¥è¿è¡Œç¨‹åºï¼Œæ­¤æ—¶ä¼šè¿›å…¥å­è¿›ç¨‹ï¼Œç„¶åæ‰§è¡Œwhileå¾ªç¯</li><li>ctrl + c:é€šè¿‡è¯¥å‘½ä»¤ï¼Œå¯ä»¥ä½¿å¾—GDBæ”¶åˆ°SIGINTå‘½ä»¤ï¼Œä»è€Œæš‚åœæ‰§è¡Œwhileå¾ªç¯</li><li>n(next):ç»§ç»­æ‰§è¡Œï¼Œè¿›è€Œè¿›å…¥åˆ°whileå¾ªç¯çš„æ¡ä»¶åˆ¤æ–­å¤„</li><li>show follow-fork-mode:å†æ¬¡æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œé€šè¿‡è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œå½“å‰å¤„äºchildæ¨¡å¼ä¸‹</li></ol> 
<h6><a id="detachonfork_810"></a>detach-on-fork</h6> 
<p>å¦‚æœä¸€å¼€å§‹æŒ‡å®šè¦è°ƒè¯•å­è¿›ç¨‹è¿˜æ˜¯çˆ¶è¿›ç¨‹ï¼Œé‚£ä¹ˆä½¿ç”¨follow-fork-modeå‘½ä»¤å®Œå…¨å¯ä»¥æ»¡è¶³éœ€æ±‚;ä½†æ˜¯å¦‚æœæƒ³åœ¨è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œæƒ³æ ¹æ®å®é™…æƒ…å†µåœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢è°ƒè¯•å‘¢ï¼Ÿ</p> 
<p>GDBæä¾›äº†å¦å¤–ä¸€ä¸ªå‘½ä»¤ï¼š</p> 
<pre><code>(gdb) set detach-on-fork mode
</code></pre> 
<p>å…¶ä¸­modeæœ‰å¦‚ä¸‹ä¸¤ä¸ªå€¼ï¼š</p> 
<p>on:é»˜è®¤å€¼ï¼Œå³è¡¨æ˜åªè°ƒè¯•ä¸€ä¸ªè¿›ç¨‹ï¼Œå¯ä»¥æ˜¯å­è¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯çˆ¶è¿›ç¨‹</p> 
<p>off:ç¨‹åºä¸­çš„æ¯ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«è®°å½•ï¼Œè¿›è€Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰€æœ‰çš„è¿›ç¨‹è¿›è¡Œè°ƒè¯•</p> 
<p>å¦‚æœé€‰æ‹©å…³é—­<code>detach-on-fork</code>æ¨¡å¼(modeä¸ºoff)ï¼Œé‚£ä¹ˆGDBå°†ä¿ç•™å¯¹æ‰€æœ‰è¢«forkå‡ºæ¥çš„è¿›ç¨‹æ§åˆ¶ï¼Œå³å¯ç”¨è°ƒè¯•æ‰€æœ‰è¢«forkå‡ºæ¥çš„è¿›ç¨‹ã€‚å¯ç”¨ ä½¿ç”¨<code>info forks</code>å‘½ä»¤åˆ—å‡ºæ‰€æœ‰çš„å¯è¢«GDBè°ƒè¯•çš„forkè¿›ç¨‹ï¼Œå¹¶å¯ç”¨ä½¿ç”¨forkå‘½ä»¤ä»ä¸€ä¸ªforkè¿›ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªforkè¿›ç¨‹ã€‚</p> 
<ul><li>info forks: æ‰“å°DGBæ§åˆ¶ä¸‹çš„æ‰€æœ‰è¢«forkå‡ºæ¥çš„è¿›ç¨‹åˆ—è¡¨ã€‚è¯¥åˆ—è¡¨åŒ…æ‹¬fork idã€è¿›ç¨‹idå’Œå½“å‰è¿›ç¨‹çš„ä½ç½®</li><li>fork fork-id: å‚æ•°fork-idæ˜¯GDBåˆ†é…çš„å†…éƒ¨forkç¼–å·ï¼Œè¯¥ç¼–å·å¯ç”¨é€šè¿‡ä¸Šé¢çš„å‘½ä»¤<code>info forks</code>è·å–</li></ul> 
<h4><a id="coredump_839"></a>coredump</h4> 
<p>å½“æˆ‘ä»¬å¼€å‘æˆ–è€…ä½¿ç”¨ä¸€ä¸ªç¨‹åºæ—¶å€™ï¼Œæœ€æ€•çš„è«è¿‡äºç¨‹åºè«åå…¶å¦™å´©æºƒã€‚ä¸ºäº†åˆ†æå´©æºƒäº§ç”Ÿçš„åŸå› ï¼Œæ“ä½œç³»ç»Ÿçš„å†…å­˜å†…å®¹ï¼ˆåŒ…æ‹¬ç¨‹åºå´©æºƒæ—¶å€™çš„å †æ ˆç­‰ä¿¡æ¯ï¼‰ä¼šåœ¨ç¨‹åºå´©æºƒçš„æ—¶å€™dumpå‡ºæ¥ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶åä¸ºcore.pidï¼Œå…¶ä¸­pidä¸ºè¿›ç¨‹idï¼‰ï¼Œè¿™ä¸ªdumpæ“ä½œå«åšcoredump(æ ¸å¿ƒè½¬å‚¨)ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç”¨è°ƒè¯•å™¨è°ƒè¯•æ­¤æ–‡ä»¶ï¼Œä»¥è¿˜åŸç¨‹åºå´©æºƒæ—¶å€™çš„åœºæ™¯ã€‚</p> 
<p>åœ¨æˆ‘ä»¬åˆ†æå¦‚æœç”¨gdbè°ƒè¯•coredumpæ–‡ä»¶ä¹‹å‰ï¼Œå…ˆéœ€è¦ç”Ÿæˆä¸€ä¸ªcoredumpï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°±ç”¨å¦‚ä¸‹ä¾‹å­æ¥ç”Ÿæˆï¼š</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>v<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"elem[%d] = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">int</span> v<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">print</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>ç¼–è¯‘å¹¶è¿è¡Œè¯¥ç¨‹åºï¼š</p> 
<pre><code class="prism language-shell">g++ -g test_core.cc -o test_core
./test_core
</code></pre> 
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p> 
<pre><code>elem[775] = 1702113070
elem[776] = 1667200115
elem[777] = 6648431
elem[778] = 0
elem[779] = 0
æ®µé”™è¯¯(åæ ¸)
</code></pre> 
<p>å¦‚æˆ‘ä»¬é¢„æœŸï¼Œç¨‹åºäº§ç”Ÿäº†å¼‚å¸¸ï¼Œä½†æ˜¯å´æ²¡æœ‰ç”Ÿæˆcoredumpæ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç³»ç»Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œcoredumpç”Ÿæˆæ˜¯å…³é—­çš„ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®å¯¹åº”çš„é€‰é¡¹ä»¥æ‰“å¼€coredumpç”Ÿæˆã€‚</p> 
<p>é’ˆå¯¹å¤šçº¿ç¨‹ç¨‹åºäº§ç”Ÿçš„coredumpï¼Œæœ‰æ—¶å€™å…¶å †æ ˆä¿¡æ¯å¹¶ä¸èƒ½å®Œæ•´çš„å»åˆ†æåŸå› ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬å¾—æœ‰å…¶ä»–æ–¹å¼ã€‚</p> 
<p>18å¹´æœ‰ä¸€æ¬¡çº¿ä¸Šæ•…éšœï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯åœ¨çº¿ä¸Šçš„æ—¶å€™ï¼Œå°±ä¼šcoredumpï¼Œæ ¹æ®gdbè°ƒè¯•coredumpï¼Œåªèƒ½å®šä½åˆ°äº†libcurlé‡Œé¢ï¼Œä½†å´å®šä½ä¸å‡ºåŸå› ï¼Œç”¨äº†å¤§æ¦‚ä¸¤å¤©çš„æ—¶é—´ï¼Œå‘ç°åªæœ‰åœ¨è¶…æ—¶çš„æ—¶å€™ï¼Œæ‰ä¼šcoredumpï¼Œè€Œæµ‹è¯•ç¯å¢ƒå› ä¸ºé…ç½®æ¯”è¾ƒå·®è¶…æ—¶è®¾ç½®çš„æ˜¯20msï¼Œè€Œçº¿ä¸Šæ˜¯5msï¼ŒçŸ¥é“coredumpåŸå› åï¼Œé‡‡ç”¨<code>é€æ­¥å®šä½ç¼©å°èŒƒå›´æ³•</code>ï¼Œé€æ­¥ç¼©å°ä»£ç èŒƒå›´ï¼Œæœ€ç»ˆå®šä½åˆ°æ˜¯libcurlä¸€ä¸ªbugå¯¼è‡´ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œå®šä½çº¿ä¸Šé—®é¢˜éœ€è¦ç»“åˆå®é™…æƒ…å†µï¼Œé‡‡å–åˆé€‚çš„æ–¹æ³•æ¥å®šä½é—®é¢˜ã€‚</p> 
<h6><a id="_891"></a>é…ç½®</h6> 
<p>é…ç½®coredumpç”Ÿæˆï¼Œæœ‰ä¸´æ—¶é…ç½®(é€€å‡ºç»ˆç«¯åï¼Œé…ç½®å¤±æ•ˆ)å’Œæ°¸ä¹…é…ç½®ä¸¤ç§ã€‚</p> 
<h6><a id="_895"></a>ä¸´æ—¶</h6> 
<p>é€šè¿‡ulimit -aå¯ä»¥åˆ¤æ–­å½“å‰æœ‰æ²¡æœ‰é…ç½®coredumpç”Ÿæˆï¼š</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">ulimit</span> -a
core <span class="token function">file</span> size          <span class="token punctuation">(</span>blocks, -c<span class="token punctuation">)</span> <span class="token number">0</span>
data seg size           <span class="token punctuation">(</span>kbytes, -d<span class="token punctuation">)</span> unlimited
scheduling priority             <span class="token punctuation">(</span>-e<span class="token punctuation">)</span> <span class="token number">0</span>
</code></pre> 
<p>ä»ä¸Šé¢è¾“å‡ºå¯ä»¥çœ‹å‡ºcore file sizeåé¢çš„æ•°ä¸º0ï¼Œå³ä¸ç”Ÿæˆcoredumpæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œè®¾ç½®</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">ulimit</span> -c size
</code></pre> 
<p>å…¶ä¸­sizeä¸ºå…è®¸ç”Ÿæˆçš„coredumpå¤§å°ï¼Œè¿™ä¸ªä¸€èˆ¬å°½é‡è®¾ç½®å¤§ç‚¹ï¼Œä»¥é˜²æ­¢ç”Ÿæˆçš„coredumpä¿¡æ¯ä¸å…¨ï¼Œç¬”è€…ä¸€èˆ¬è®¾ç½®ä¸ºä¸é™ã€‚</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">ulimit</span> -c unlimited
</code></pre> 
<p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¸´æ—¶é…ç½®çš„coredumpé€‰é¡¹ï¼Œå…¶é»˜è®¤ç”Ÿæˆè·¯å¾„ä¸ºæ‰§è¡Œè¯¥å‘½ä»¤æ—¶å€™çš„è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ¥è¿›è¡Œè·¯å¾„ä¿®æ”¹ã€‚</p> 
<h6><a id="_920"></a>æ°¸ä¹…</h6> 
<p>ä¸Šé¢çš„è®¾ç½®åªæ˜¯ä½¿èƒ½äº†core dumpåŠŸèƒ½ï¼Œç¼ºçœæƒ…å†µä¸‹ï¼Œå†…æ ¸åœ¨coredumpæ—¶æ‰€äº§ç”Ÿçš„coreæ–‡ä»¶æ”¾åœ¨ä¸è¯¥ç¨‹åºç›¸åŒçš„ç›®å½•ä¸­ï¼Œå¹¶ä¸”æ–‡ä»¶åå›ºå®šä¸ºcoreã€‚å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœæœ‰å¤šä¸ªç¨‹åºäº§ç”Ÿcoreæ–‡ä»¶ï¼Œæˆ–è€…åŒä¸€ä¸ªç¨‹åºå¤šæ¬¡å´©æºƒï¼Œå°±ä¼šé‡å¤è¦†ç›–åŒä¸€ä¸ªcoreæ–‡ä»¶ã€‚</p> 
<p>è¿‡ä¿®æ”¹kernelçš„å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šå†…æ ¸æ‰€ç”Ÿæˆçš„coredumpæ–‡ä»¶çš„æ–‡ä»¶åã€‚ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå¯ä»¥å®ç°coredumpæ°¸ä¹…é…ç½®ã€å­˜æ”¾è·¯å¾„ä»¥åŠç”Ÿæˆcoredumpåç§°ç­‰ã€‚</p> 
<pre><code class="prism language-shell"><span class="token function">mkdir</span> -p /www/coredump/
<span class="token function">chmod</span> <span class="token number">777</span> /www/coredump/

/etc/profile
<span class="token builtin class-name">ulimit</span> -c unlimited

/etc/security/limits.conf
*          soft     core   unlimited

<span class="token builtin class-name">echo</span> <span class="token string">"/www/coredump/core-%e-%p-%h-%t"</span> <span class="token operator">&gt;</span> /proc/sys/kernel/core_pattern
</code></pre> 
<h6><a id="_943"></a>è°ƒè¯•</h6> 
<p>ç°åœ¨ï¼Œæˆ‘ä»¬é‡æ–°æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŒ‰ç…§é¢„æœŸäº§ç”Ÿcoredumpæ–‡ä»¶ï¼š</p> 
<pre><code class="prism language-shell">./test_coredump

elem<span class="token punctuation">[</span><span class="token number">955</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1702113070</span>
elem<span class="token punctuation">[</span><span class="token number">956</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1667200115</span>
elem<span class="token punctuation">[</span><span class="token number">957</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6648431</span>
elem<span class="token punctuation">[</span><span class="token number">958</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
elem<span class="token punctuation">[</span><span class="token number">959</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
æ®µé”™è¯¯<span class="token punctuation">(</span>åæ ¸<span class="token punctuation">)</span>
</code></pre> 
<p>ç„¶åä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œcoredumpè°ƒè¯•ï¼š</p> 
<pre><code class="prism language-shell">gdb ./test_core -c /www/coredump/core_test_core_1640765384_38924 -q
</code></pre> 
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-shell"><span class="token comment">#0  0x0000000000400569 in print (v=0x7fff3293c100, size=1000) at test_core.cc:5</span>
<span class="token number">5</span>	    printf<span class="token punctuation">(</span><span class="token string">"elem[%d] = %d<span class="token entity" title="\n">\n</span>"</span>, i, v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64 libgcc-4.8.5-36.el7.x86_64 libstdc++-4.8.5-36.el7.x86_64
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span>
</code></pre> 
<p>å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºcoreåœ¨äº†ç¬¬5è¡Œï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>where</code>å‘½ä»¤æ¥æŸ¥çœ‹å †æ ˆå›æº¯ä¿¡æ¯ã€‚</p> 
<blockquote> 
 <p>åœ¨gdbä¸­è¾“å…¥whereå‘½ä»¤ï¼Œå¯ä»¥è·å–å †æ ˆè°ƒç”¨ä¿¡æ¯ã€‚å½“è¿›è¡Œcoredumpè°ƒè¯•æ—¶å€™ï¼Œè¿™ä¸ªæ˜¯æœ€åŸºæœ¬ä¸”æœ€æœ‰ç”¨å¤„çš„å‘½ä»¤ã€‚whereå‘½ä»¤è¾“å‡ºçš„ç»“æœåŒ…å«ç¨‹åºä¸­ çš„å‡½æ•°åç§°å’Œç›¸å…³å‚æ•°å€¼ã€‚</p> 
</blockquote> 
<p>é€šè¿‡whereå‘½ä»¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘ç°ç¨‹åºcoreåœ¨äº†ç¬¬5è¡Œï¼Œé‚£ä¹ˆæ ¹æ®åˆ†ææºç åŸºæœ¬å°±èƒ½å®šä½åŸå› ã€‚</p> 
<blockquote> 
 <p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œcoreä¸ä¸€å®šåœ¨å½“å‰çº¿ç¨‹ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬å¯¹ä»£ç æœ‰ä¸€å®šçš„äº†è§£ï¼Œèƒ½å¤Ÿä¿è¯å“ªå—ä»£ç æ˜¯å®‰å…¨çš„ï¼Œç„¶åé€šè¿‡thread numåˆ‡æ¢çº¿ç¨‹ï¼Œç„¶åå†é€šè¿‡btæˆ–è€…whereå‘½ä»¤æŸ¥çœ‹å †æ ˆä¿¡æ¯ï¼Œè¿›è€Œå®šä½coredumpåŸå› ã€‚</p> 
</blockquote> 
<h3><a id="_987"></a>åŸç†</h3> 
<p>åœ¨å‰é¢å‡ èŠ‚ï¼Œæˆ‘ä»¬è®²äº†gdbçš„å‘½ä»¤ï¼Œä»¥åŠè¿™äº›å‘½ä»¤åœ¨è°ƒè¯•æ—¶å€™çš„ä½œç”¨ï¼Œå¹¶ä»¥ä¾‹å­è¿›è¡Œäº†æ¼”ç¤ºã€‚ä½œä¸ºC/C++ coderï¼Œè¦çŸ¥å…¶ç„¶ï¼Œæ›´è¦çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚æ‰€ä»¥ï¼Œå€ŸåŠ©æœ¬èŠ‚ï¼Œæˆ‘ä»¬å¤§æ¦‚è®²ä¸‹GDBè°ƒè¯•çš„åŸç†ã€‚</p> 
<p>gdb é€šè¿‡ç³»ç»Ÿè°ƒç”¨ <code>ptrace</code> æ¥æ¥ç®¡ä¸€ä¸ªè¿›ç¨‹çš„æ‰§è¡Œã€‚ptrace ç³»ç»Ÿè°ƒç”¨æä¾›äº†ä¸€ç§æ–¹æ³•ä½¿å¾—çˆ¶è¿›ç¨‹å¯ä»¥è§‚å¯Ÿå’Œæ§åˆ¶å…¶å®ƒè¿›ç¨‹çš„æ‰§è¡Œï¼Œæ£€æŸ¥å’Œæ”¹å˜å…¶æ ¸å¿ƒæ˜ åƒä»¥åŠå¯„å­˜å™¨ã€‚å®ƒä¸»è¦ç”¨æ¥å®ç°æ–­ç‚¹è°ƒè¯•å’Œç³»ç»Ÿè°ƒç”¨è·Ÿè¸ªã€‚</p> 
<p><img src="https://images2.imgbox.com/1d/d6/EIX3h4CX_o.png" alt=""></p> 
<p>ptraceç³»ç»Ÿè°ƒç”¨å®šä¹‰å¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/ptrace.h&gt;</span></span>
<span class="token keyword">long</span> <span class="token function">ptrace</span><span class="token punctuation">(</span><span class="token keyword">enum</span> <span class="token class-name">__ptrace_request</span> request<span class="token punctuation">,</span> <span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>addr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>data<span class="token punctuation">)</span>
</code></pre> 
<ul><li>pid_t pidï¼šæŒ‡ç¤º ptrace è¦è·Ÿè¸ªçš„è¿›ç¨‹</li><li>void *addrï¼šæŒ‡ç¤ºè¦ç›‘æ§çš„å†…å­˜åœ°å€</li><li>enum __ptrace_request requestï¼šå†³å®šäº†ç³»ç»Ÿè°ƒç”¨çš„åŠŸèƒ½ï¼Œå‡ ä¸ªä¸»è¦çš„é€‰é¡¹ï¼š 
  <ul><li><em>PTRACE_TRACEME</em>ï¼šè¡¨ç¤ºæ­¤è¿›ç¨‹å°†è¢«çˆ¶è¿›ç¨‹è·Ÿè¸ªï¼Œä»»ä½•ä¿¡å·ï¼ˆé™¤äº† <code>SIGKILL</code>ï¼‰éƒ½ä¼šæš‚åœå­è¿›ç¨‹ï¼Œæ¥ç€é˜»å¡äº <code>wait()</code> ç­‰å¾…çš„çˆ¶è¿›ç¨‹è¢«å”¤é†’ã€‚å­è¿›ç¨‹å†…éƒ¨å¯¹ <code>exec()</code> çš„è°ƒç”¨å°†å‘å‡º <code>SIGTRAP</code> ä¿¡å·ï¼Œè¿™å¯ä»¥è®©çˆ¶è¿›ç¨‹åœ¨å­è¿›ç¨‹æ–°ç¨‹åºå¼€å§‹è¿è¡Œä¹‹å‰å°±å®Œå…¨æ§åˆ¶å®ƒ</li><li><em>PTRACE_ATTACH</em>ï¼šattach åˆ°ä¸€ä¸ªæŒ‡å®šçš„è¿›ç¨‹ï¼Œä½¿å…¶æˆä¸ºå½“å‰è¿›ç¨‹è·Ÿè¸ªçš„å­è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹çš„è¡Œä¸ºç­‰åŒäºå®ƒè¿›è¡Œäº†ä¸€æ¬¡ PTRACE_TRACEME æ“ä½œã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å½“å‰è¿›ç¨‹æˆä¸ºè¢«è·Ÿè¸ªè¿›ç¨‹çš„çˆ¶è¿›ç¨‹ï¼Œä½†æ˜¯å­è¿›ç¨‹ä½¿ç”¨ <code>getppid()</code> çš„åˆ°çš„ä»å°†æ˜¯å…¶åŸå§‹çˆ¶è¿›ç¨‹çš„pid</li><li><em>PTRACE_CONT</em>ï¼šç»§ç»­è¿è¡Œä¹‹å‰åœæ­¢çš„å­è¿›ç¨‹ã€‚å¯åŒæ—¶å‘å­è¿›ç¨‹äº¤ä»˜æŒ‡å®šçš„ä¿¡å·</li></ul> </li></ul> 
<h4><a id="_1016"></a>è°ƒè¯•åŸç†</h4> 
<h5><a id="_1018"></a>è¿è¡Œå¹¶è°ƒè¯•æ–°è¿›ç¨‹</h5> 
<p>è¿è¡Œå¹¶è°ƒè¯•æ–°è¿›ç¨‹ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p> 
<ul><li>è¿è¡Œgdb exe</li><li>è¾“å…¥runå‘½ä»¤ï¼Œgdbæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š 
  <ul><li>é€šè¿‡fork()ç³»ç»Ÿè°ƒç”¨åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹</li><li>åœ¨æ–°åˆ›å»ºçš„å­è¿›ç¨‹ä¸­æ‰§è¡Œptrace(PTRACE_TRACEME, 0, 0, 0)æ“ä½œ</li><li>åœ¨å­è¿›ç¨‹ä¸­é€šè¿‡execv()ç³»ç»Ÿè°ƒç”¨åŠ è½½æŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶</li></ul> </li></ul> 
<h5><a id="attach_1028"></a>attachè¿è¡Œçš„è¿›ç¨‹</h5> 
<p>å¯ä»¥é€šè¿‡gdb attach pidæ¥è°ƒè¯•ä¸€ä¸ªè¿è¡Œçš„è¿›ç¨‹ï¼Œgdbå°†å¯¹æŒ‡å®šè¿›ç¨‹æ‰§è¡Œptrace(PTRACE_ATTACH, pid, 0, 0)æ“ä½œã€‚</p> 
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬attachä¸€ä¸ªè¿›ç¨‹idæ—¶å€™ï¼Œå¯èƒ½ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p> 
<pre><code class="prism language-shell">Attaching to process <span class="token number">28849</span>
ptrace: Operation not permitted.
</code></pre> 
<p>è¿™æ˜¯å› ä¸ºæ²¡æœ‰æƒé™è¿›è¡Œæ“ä½œï¼Œå¯ä»¥æ ¹æ®å¯åŠ¨è¯¥è¿›ç¨‹ç”¨æˆ·ä¸‹æˆ–è€…rootä¸‹è¿›è¡Œæ“ä½œã€‚</p> 
<h4><a id="_1045"></a>æ–­ç‚¹åŸç†</h4> 
<h5><a id="_1047"></a>å®ç°åŸç†</h5> 
<p>å½“æˆ‘ä»¬é€šè¿‡bæˆ–è€…breakè®¾ç½®æ–­ç‚¹æ—¶å€™ï¼Œå°±æ˜¯åœ¨æŒ‡å®šä½ç½®æ’å…¥æ–­ç‚¹æŒ‡ä»¤ï¼Œå½“è¢«è°ƒè¯•çš„ç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹çš„æ—¶å€™ï¼Œäº§ç”ŸSIGTRAPä¿¡å·ã€‚è¯¥ä¿¡å·è¢«gdbæ•è·å¹¶ è¿›è¡Œæ–­ç‚¹å‘½ä¸­åˆ¤æ–­ã€‚</p> 
<h5><a id="_1053"></a>è®¾ç½®åŸç†</h5> 
<p>åœ¨ç¨‹åºä¸­è®¾ç½®æ–­ç‚¹ï¼Œå°±æ˜¯å…ˆåœ¨è¯¥ä½ç½®ä¿å­˜åŸæŒ‡ä»¤ï¼Œç„¶ååœ¨è¯¥ä½ç½®å†™å…¥int 3ã€‚å½“æ‰§è¡Œåˆ°int 3æ—¶ï¼Œå‘ç”Ÿè½¯ä¸­æ–­ï¼Œå†…æ ¸ä¼šå‘å­è¿›ç¨‹å‘é€SIGTRAPä¿¡å·ã€‚å½“ç„¶ï¼Œè¿™ä¸ªä¿¡å·ä¼šè½¬å‘ç»™çˆ¶è¿›ç¨‹ã€‚ç„¶åç”¨ä¿å­˜çš„æŒ‡ä»¤æ›¿æ¢int 3å¹¶ç­‰å¾…æ“ä½œæ¢å¤ã€‚</p> 
<h5><a id="_1059"></a>å‘½ä¸­åˆ¤æ–­</h5> 
<p>gdbå°†æ‰€æœ‰æ–­ç‚¹ä½ç½®å­˜å‚¨åœ¨ä¸€ä¸ª<code>é“¾è¡¨</code>ä¸­ã€‚å‘½ä¸­åˆ¤å®šå°†è¢«è°ƒè¯•ç¨‹åºçš„å½“å‰åœæ­¢ä½ç½®ä¸é“¾è¡¨ä¸­çš„æ–­ç‚¹ä½ç½®è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æŸ¥çœ‹æ–­ç‚¹äº§ç”Ÿçš„ä¿¡å·ã€‚</p> 
<h5><a id="_1065"></a>æ¡ä»¶åˆ¤æ–­</h5> 
<p>åœ¨æ–­ç‚¹å¤„æ¢å¤æŒ‡ä»¤åï¼Œå¢åŠ äº†ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­ã€‚å¦‚æœè¡¨è¾¾å¼ä¸ºçœŸï¼Œåˆ™è§¦å‘æ–­ç‚¹ã€‚ç”±äºéœ€è¦åˆ¤æ–­ä¸€æ¬¡ï¼Œæ·»åŠ æ¡ä»¶æ–­ç‚¹åï¼Œæ˜¯å¦è§¦å‘æ¡ä»¶æ–­ç‚¹ï¼Œéƒ½ä¼šå½±å“æ€§èƒ½ã€‚åœ¨ x86 å¹³å°ä¸Šï¼Œéƒ¨åˆ†ç¡¬ä»¶æ”¯æŒç¡¬ä»¶æ–­ç‚¹ã€‚ä¸æ˜¯åœ¨æ¡ä»¶æ–­ç‚¹å¤„æ’å…¥ int 3ï¼Œè€Œæ˜¯æ’å…¥å¦ä¸€æ¡æŒ‡ä»¤ã€‚å½“ç¨‹åºåˆ°è¾¾è¿™ä¸ªåœ°å€æ—¶ï¼Œä¸æ˜¯å‘å‡ºint 3ä¿¡å·ï¼Œè€Œæ˜¯è¿›è¡Œæ¯”è¾ƒã€‚ç‰¹å®šå¯„å­˜å™¨çš„å†…å®¹å’ŒæŸä¸ªåœ°å€ï¼Œç„¶åå†³å®šæ˜¯å¦å‘é€int 3ã€‚å› æ­¤ï¼Œå½“ä½ çš„æ–­ç‚¹ä½ç½®è¢«ç¨‹åºé¢‘ç¹â€œé€šè¿‡â€æ—¶ï¼Œå°½é‡ä½¿ç”¨ç¡¬ä»¶æ–­ç‚¹ï¼Œè¿™å°†æœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚</p> 
<h4><a id="_1071"></a>å•æ­¥åŸç†</h4> 
<p>è¿™ä¸ªptraceå‡½æ•°æœ¬èº«å°±æ”¯æŒï¼Œå¯ä»¥é€šè¿‡ptrace(PTRACE_SINGLESTEP, pid,â€¦)è°ƒç”¨æ¥å®ç°å•æ­¥ã€‚</p> 
<pre><code class="prism language-c"> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"attaching to PID %d\n"</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ptrace</span><span class="token punctuation">(</span>PTRACE_ATTACH<span class="token punctuation">,</span> pid<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"attach failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> waitStat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> waitRes <span class="token operator">=</span> <span class="token function">waitpid</span><span class="token punctuation">(</span>pid<span class="token punctuation">,</span> <span class="token operator">&amp;</span>waitStat<span class="token punctuation">,</span> WUNTRACED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>waitRes <span class="token operator">!=</span> pid <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">WIFSTOPPED</span><span class="token punctuation">(</span>waitStat<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"unexpected waitpid result!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
   
    <span class="token class-name">int64_t</span> numSteps <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>true<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">auto</span> res <span class="token operator">=</span> <span class="token function">ptrace</span><span class="token punctuation">(</span>PTRACE_SINGLESTEP<span class="token punctuation">,</span> pid<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>ä¸Šè¿°ä»£ç ï¼Œé¦–å…ˆæ¥æ”¶ä¸€ä¸ªpidï¼Œç„¶åå¯¹å…¶è¿›è¡Œattachï¼Œæœ€åè°ƒç”¨ptraceè¿›è¡Œå•æ­¥è°ƒè¯•ã€‚</p> 
<h3><a id="_1101"></a>å…¶å®ƒ</h3> 
<p>å€ŸåŠ©æœ¬æ–‡ï¼Œç®€å•ä»‹ç»ä¸‹ç¬”è€…å·¥ä½œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸€äº›å…¶ä»–å‘½ä»¤æˆ–è€…å·¥å…·ã€‚</p> 
<h4><a id="pstack_1105"></a>pstack</h4> 
<p>æ­¤å‘½ä»¤å¯æ˜¾ç¤ºæ¯ä¸ªè¿›ç¨‹çš„æ ˆè·Ÿè¸ªã€‚pstack å‘½ä»¤å¿…é¡»ç”±ç›¸åº”è¿›ç¨‹çš„å±ä¸»æˆ– root è¿è¡Œã€‚å¯ä»¥ä½¿ç”¨ pstack æ¥ç¡®å®šè¿›ç¨‹æŒ‚èµ·çš„ä½ç½®ã€‚æ­¤å‘½ä»¤å…è®¸ä½¿ç”¨çš„å”¯ä¸€é€‰é¡¹æ˜¯è¦æ£€æŸ¥çš„è¿›ç¨‹çš„ PIDã€‚</p> 
<p>è¿™ä¸ªå‘½ä»¤åœ¨æ’æŸ¥è¿›ç¨‹é—®é¢˜æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å‘ç°ä¸€ä¸ªæœåŠ¡ä¸€ç›´å¤„äºworkçŠ¶æ€ï¼ˆå¦‚å‡æ­»çŠ¶æ€ï¼Œå¥½ä¼¼æ­»å¾ªç¯ï¼‰ï¼Œä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°±èƒ½è½»æ¾å®šä½é—®é¢˜æ‰€åœ¨ï¼›å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œå¤šæ‰§è¡Œå‡ æ¬¡pstackï¼Œè‹¥å‘ç°ä»£ç æ ˆæ€»æ˜¯åœåœ¨åŒä¸€ä¸ªä½ç½®ï¼Œé‚£ä¸ªä½ç½®å°±éœ€è¦é‡ç‚¹å…³æ³¨ï¼Œå¾ˆå¯èƒ½å°±æ˜¯å‡ºé—®é¢˜çš„åœ°æ–¹ï¼›</p> 
<p>ä»¥å‰é¢çš„å¤šçº¿ç¨‹ä»£ç ä¸ºä¾‹ï¼Œå…¶è¿›ç¨‹IDæ˜¯4507(åœ¨ç¬”è€…æœ¬åœ°)ï¼Œé‚£ä¹ˆé€šè¿‡</p> 
<p>pstack 4507è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c">Thread <span class="token number">3</span> <span class="token punctuation">(</span>Thread <span class="token number">0</span><span class="token function">x7f07aaa69700</span> <span class="token punctuation">(</span>LWP <span class="token number">45708</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
#<span class="token number">0</span>  <span class="token number">0x00007f07aab2ee2d</span> in <span class="token function">nanosleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">1</span>  <span class="token number">0x00007f07aab2ecc4</span> in <span class="token function">sleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">2</span>  <span class="token number">0x00007f07ab403eb9</span> in std<span class="token operator">::</span>this_thread<span class="token operator">::</span><span class="token function">__sleep_for</span><span class="token punctuation">(</span>std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">,</span> std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1000000000l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">3</span>  <span class="token number">0x00000000004018cc</span> in <span class="token keyword">void</span> std<span class="token operator">::</span>this_thread<span class="token operator">::</span>sleep_for<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">4</span>  <span class="token number">0x00000000004012de</span> in <span class="token function">fun_int</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">5</span>  <span class="token number">0x0000000000404696</span> in <span class="token keyword">int</span> std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">::</span>_M_invoke<span class="token operator">&lt;</span><span class="token number">0ul</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>_Index_tuple<span class="token operator">&lt;</span><span class="token number">0ul</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">6</span>  <span class="token number">0x000000000040443d</span> in std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">7</span>  <span class="token number">0x000000000040436e</span> in std<span class="token operator">::</span>thread<span class="token operator">::</span>_Impl<span class="token operator">&lt;</span>std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">_M_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">8</span>  <span class="token number">0x00007f07ab404070</span> in <span class="token operator">?</span><span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">9</span>  <span class="token number">0x00007f07ab65ddd5</span> in <span class="token function">start_thread</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libpthread<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">0</span>
#<span class="token number">10</span> <span class="token number">0x00007f07aab67ead</span> in <span class="token function">clone</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
Thread <span class="token number">2</span> <span class="token punctuation">(</span>Thread <span class="token number">0</span><span class="token function">x7f07aa268700</span> <span class="token punctuation">(</span>LWP <span class="token number">45709</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
#<span class="token number">0</span>  <span class="token number">0x00007f07aab2ee2d</span> in <span class="token function">nanosleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">1</span>  <span class="token number">0x00007f07aab2ecc4</span> in <span class="token function">sleep</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">2</span>  <span class="token number">0x00007f07ab403eb9</span> in std<span class="token operator">::</span>this_thread<span class="token operator">::</span><span class="token function">__sleep_for</span><span class="token punctuation">(</span>std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">,</span> std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1000000000l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">3</span>  <span class="token number">0x00000000004018cc</span> in <span class="token keyword">void</span> std<span class="token operator">::</span>this_thread<span class="token operator">::</span>sleep_for<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>chrono<span class="token operator">::</span>duration<span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token punctuation">,</span> std<span class="token operator">::</span>ratio<span class="token operator">&lt;</span><span class="token number">1l</span><span class="token punctuation">,</span> <span class="token number">1l</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span> <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">4</span>  <span class="token number">0x0000000000401340</span> in <span class="token function">fun_string</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">5</span>  <span class="token number">0x000000000040459f</span> in <span class="token keyword">int</span> std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">::</span>_M_invoke<span class="token operator">&lt;</span><span class="token number">0ul</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>std<span class="token operator">::</span>_Index_tuple<span class="token operator">&lt;</span><span class="token number">0ul</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">6</span>  <span class="token number">0x000000000040441f</span> in std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">7</span>  <span class="token number">0x0000000000404350</span> in std<span class="token operator">::</span>thread<span class="token operator">::</span>_Impl<span class="token operator">&lt;</span>std<span class="token operator">::</span>_Bind_simple<span class="token operator">&lt;</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token keyword">const</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>std<span class="token operator">::</span>string <span class="token keyword">const</span><span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">_M_run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
#<span class="token number">8</span>  <span class="token number">0x00007f07ab404070</span> in <span class="token operator">?</span><span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">9</span>  <span class="token number">0x00007f07ab65ddd5</span> in <span class="token function">start_thread</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libpthread<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">0</span>
#<span class="token number">10</span> <span class="token number">0x00007f07aab67ead</span> in <span class="token function">clone</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
Thread <span class="token number">1</span> <span class="token punctuation">(</span>Thread <span class="token number">0</span><span class="token function">x7f07aba80740</span> <span class="token punctuation">(</span>LWP <span class="token number">45707</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span>
#<span class="token number">0</span>  <span class="token number">0x00007f07ab65ef47</span> in <span class="token function">pthread_join</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libpthread<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">0</span>
#<span class="token number">1</span>  <span class="token number">0x00007f07ab403e37</span> in std<span class="token operator">::</span>thread<span class="token operator">::</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> from <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span>
#<span class="token number">2</span>  <span class="token number">0x0000000000401455</span> in <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>åœ¨ä¸Šè¿°è¾“å‡ºç»“æœä¸­ï¼Œå°†è¿›ç¨‹å†…éƒ¨çš„è¯¦ç»†ä¿¡æ¯éƒ½è¾“å‡ºåœ¨ç»ˆç«¯ï¼Œä»¥æ–¹ä¾¿åˆ†æé—®é¢˜ã€‚</p> 
<h4><a id="ldd_1154"></a>ldd</h4> 
<p>åœ¨æˆ‘ä»¬ç¼–è¯‘è¿‡ç¨‹ä¸­é€šå¸¸ä¼šæç¤ºç¼–è¯‘å¤±è´¥ï¼Œé€šè¿‡è¾“å‡ºé”™è¯¯ä¿¡æ¯å‘ç°æ˜¯æ‰¾ä¸åˆ°å‡½æ•°å®šä¹‰ï¼Œå†æˆ–è€…ç¼–è¯‘æˆåŠŸäº†ï¼Œä½†æ˜¯è¿è¡Œæ—¶å€™å¤±è´¥(å¾€å¾€æ˜¯å› ä¸ºä¾èµ–äº†éæ­£å¸¸ç‰ˆæœ¬çš„libåº“å¯¼è‡´)ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡lddæ¥åˆ†æè¯¥å¯æ‰§è¡Œæ–‡ä»¶ä¾èµ–äº†å“ªäº›åº“ä»¥åŠè¿™äº›åº“æ‰€åœ¨çš„è·¯å¾„ã€‚</p> 
<p>ç”¨æ¥æŸ¥çœ‹ç¨‹å¼è¿è¡Œæ‰€éœ€çš„å…±äº«åº“,å¸¸ç”¨æ¥è§£å†³ç¨‹å¼å› ç¼ºå°‘æŸä¸ªåº“æ–‡ä»¶è€Œä¸èƒ½è¿è¡Œçš„ä¸€äº›é—®é¢˜ã€‚</p> 
<p>ä»ç„¶æŸ¥çœ‹å¯æ‰§è¡Œç¨‹åºtest_threadçš„ä¾èµ–åº“ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c">ldd <span class="token operator">-</span>r <span class="token punctuation">.</span><span class="token operator">/</span>test_thread
	linux<span class="token operator">-</span>vdso<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token punctuation">(</span><span class="token number">0x00007ffde43bc000</span><span class="token punctuation">)</span>
	libpthread<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">0</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libpthread<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5e310000</span><span class="token punctuation">)</span>
	libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5e009000</span><span class="token punctuation">)</span>
	libm<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libm<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5dd07000</span><span class="token punctuation">)</span>
	libgcc_s<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libgcc_s<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5daf1000</span><span class="token punctuation">)</span>
	libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5d724000</span><span class="token punctuation">)</span>
	<span class="token operator">/</span>lib64<span class="token operator">/</span>ld<span class="token operator">-</span>linux<span class="token operator">-</span>x86<span class="token operator">-</span><span class="token number">64.</span>so<span class="token punctuation">.</span><span class="token number">2</span> <span class="token punctuation">(</span><span class="token number">0x00007f8c5e52c000</span><span class="token punctuation">)</span>
</code></pre> 
<p>åœ¨ä¸Šè¿°è¾“å‡ºä¸­ï¼š</p> 
<ul><li>ç¬¬ä¸€åˆ—ï¼šç¨‹åºéœ€è¦ä¾èµ–ä»€ä¹ˆåº“</li><li>ç¬¬äºŒåˆ—ï¼šç³»ç»Ÿæä¾›çš„ä¸ç¨‹åºéœ€è¦çš„åº“æ‰€å¯¹åº”çš„åº“</li><li>ç¬¬ä¸‰åˆ—ï¼šåº“åŠ è½½çš„å¼€å§‹åœ°å€</li></ul> 
<p>åœ¨æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡lddæŸ¥çœ‹ä¾èµ–åº“çš„æ—¶å€™ï¼Œä¼šæç¤ºæ‰¾ä¸åˆ°åº“ï¼Œå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c">ldd <span class="token operator">-</span>r test_process
	linux<span class="token operator">-</span>vdso<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">=</span><span class="token operator">&gt;</span>  <span class="token punctuation">(</span><span class="token number">0x00007ffc71b80000</span><span class="token punctuation">)</span>
	libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libstdc<span class="token operator">++</span><span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007fe4badd5000</span><span class="token punctuation">)</span>
	libm<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libm<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007fe4baad3000</span><span class="token punctuation">)</span>
	libgcc_s<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libgcc_s<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">1</span> <span class="token punctuation">(</span><span class="token number">0x00007fe4ba8bd000</span><span class="token punctuation">)</span>
	libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">/</span>lib64<span class="token operator">/</span>libc<span class="token punctuation">.</span>so<span class="token punctuation">.</span><span class="token number">6</span> <span class="token punctuation">(</span><span class="token number">0x00007fe4ba4f0000</span><span class="token punctuation">)</span>
	<span class="token operator">/</span>lib64<span class="token operator">/</span>ld<span class="token operator">-</span>linux<span class="token operator">-</span>x86<span class="token operator">-</span><span class="token number">64.</span>so<span class="token punctuation">.</span><span class="token number">2</span> <span class="token punctuation">(</span><span class="token number">0x00007fe4bb0dc000</span><span class="token punctuation">)</span>
	 liba<span class="token punctuation">.</span>so <span class="token operator">=</span><span class="token operator">&gt;</span> not found
</code></pre> 
<p>æ¯”å¦‚ä¸Šé¢æœ€åä¸€å¥æç¤ºï¼Œliba.soæ‰¾ä¸åˆ°ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦æˆ‘ä»¬çŸ¥é“liba.soçš„è·¯å¾„ï¼Œæ¯”å¦‚åœ¨/path/to/liba.soï¼Œé‚£ä¹ˆå¯ä»¥æœ‰ä¸‹é¢ä¸¤ç§æ–¹å¼ï¼š</p> 
<pre><code class="prism language-shell"><span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span><span class="token variable">$LD_LIBRARY_PATH</span>:/path/to/
</code></pre> 
<p>è¿™æ ·åœ¨é€šè¿‡lddæŸ¥çœ‹ï¼Œå°±èƒ½æ‰¾åˆ°å¯¹åº”çš„libåº“ï¼Œä½†æ˜¯è¿™ä¸ªç¼ºç‚¹æ˜¯ä¸´æ—¶çš„ï¼Œå³é€€å‡ºç»ˆç«¯åï¼Œå†æ‰§è¡Œlddï¼Œä»ç„¶ä¼šæç¤ºæ‰¾ä¸åˆ°è¯¥åº“ï¼Œæ‰€ä»¥å°±æœ‰äº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå³é€šè¿‡ä¿®æ”¹/etc/ld.so.confï¼Œåœ¨è¯¥æ–‡ä»¶çš„åé¢åŠ ä¸Šéœ€è¦çš„è·¯å¾„ï¼Œå³</p> 
<pre><code>include ld.so.conf.d/*.conf
/path/to/
</code></pre> 
<p>ç„¶åé€šè¿‡å¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯æ°¸ä¹…ç”Ÿæ•ˆ</p> 
<pre><code class="prism language-shell"> /sbin/ldconfig
</code></pre> 
<h4><a id="cfilter_1217"></a>c++filter</h4> 
<p>å› ä¸ºc++æ”¯æŒé‡è½½ï¼Œä¹Ÿå°±å¼•å‡ºäº†ç¼–è¯‘å™¨çš„<code>name mangling</code>æœºåˆ¶ï¼Œå¯¹å‡½æ•°è¿›è¡Œé‡å‘½åã€‚</p> 
<p>æˆ‘ä»¬é€šè¿‡stringså‘½ä»¤æŸ¥çœ‹test_threadä¸­çš„å‡½æ•°ä¿¡æ¯(ä»…è¾“å‡ºfunç­‰ç›¸å…³)</p> 
<pre><code class="prism language-shell">strings test_thread <span class="token operator">|</span> <span class="token function">grep</span> fun_
<span class="token keyword">in</span> fun_int n <span class="token operator">=</span>
<span class="token keyword">in</span> fun_string s <span class="token operator">=</span>
_GLOBAL__sub_I__Z7fun_inti
_Z10fun_stringRKSs
</code></pre> 
<p>å¯ä»¥çœ‹åˆ°_Z10fun_stringRKSsè¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœæƒ³çŸ¥é“è¿™ä¸ªå‡½æ•°å®šä¹‰çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨c++filtå‘½ä»¤ï¼Œå¦‚ä¸‹ï¼š</p> 
<pre><code class="prism language-c++"> c++filt _Z10fun_stringRKSs
fun_string(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;)
</code></pre> 
<p>é€šè¿‡ä¸Šè¿°è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥å°†ç¼–è¯‘å™¨ç”Ÿæˆçš„å‡½æ•°åè¿˜åŸåˆ°æˆ‘ä»¬ä»£ç ä¸­çš„å‡½æ•°åå³fun_stringã€‚</p> 
<h3><a id="_1242"></a>ç»“è¯­</h3> 
<p>GDBæ˜¯ä¸€ä¸ªåœ¨Linuxä¸Šè¿›è¡Œå¼€å‘çš„ä¸€ä¸ªå¿…ä¸å¯å°‘çš„è°ƒè¯•å·¥å…·ï¼Œä½¿ç”¨åœºæ™¯ä¾èµ–äºå…·ä½“çš„éœ€æ±‚æˆ–è€…é‡åˆ°çš„å…·ä½“é—®é¢˜ã€‚åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œç†Ÿç»ƒä½¿ç”¨GDBåŠ ä»¥è¾…åŠ©ï¼Œèƒ½å¤Ÿä½¿å¾—å¼€å‘è¿‡ç¨‹äº‹åŠåŠŸå€ã€‚</p> 
<p>æœ¬æ–‡ä»ä¸€äº›ç®€å•çš„å‘½ä»¤å‡ºå‘ï¼Œé€šè¿‡ä¸¾ä¾‹è°ƒè¯•å¯æ‰§è¡Œç¨‹åº(å•çº¿ç¨‹ã€å¤šçº¿ç¨‹ä»¥åŠå¤šè¿›ç¨‹åœºæ™¯)ã€coredumpæ–‡ä»¶ç­‰å„ä¸ªåœºæ™¯ï¼Œä½¿å¾—å¤§å®¶èƒ½å¤Ÿæ›´åŠ ç›´è§‚çš„äº†è§£GDBçš„ä½¿ç”¨ã€‚GDBåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œç¬”è€…å·¥ä½œä¸­ä½¿ç”¨çš„éƒ½æ˜¯éå¸¸åŸºæœ¬çš„ä¸€äº›åŠŸèƒ½ï¼Œå¦‚æœæƒ³æ·±å…¥ç†è§£GDBï¼Œåˆ™éœ€è¦å»å®˜ç½‘è¿›è¡Œé˜…è¯»äº†è§£ã€‚</p> 
<blockquote> 
 <p>æœ¬æ–‡ä»æ„æ€åˆ°å®Œæˆï¼Œå¤§æ¦‚ç”¨äº†ä¸‰å‘¨æ—¶é—´ï¼Œå†™ä½œè¿‡ç¨‹æ˜¯ç—›è‹¦çš„(éœ€è¦æ•´ç†èµ„æ–™ä»¥åŠæ„å»ºå„ç§åœºæ™¯ï¼Œä»¥åŠå°†å„ç§ç°åœºè¿˜åŸ)ï¼ŒåŒæ—¶åˆæ˜¯æ”¶è·æ»¡æ»¡çš„ã€‚é€šè¿‡æœ¬æ–‡ï¼Œè¿›ä¸€æ­¥åŠ æ·±äº†å¯¹GDBçš„åº•å±‚åŸç†ç†è§£ã€‚</p> 
</blockquote> 
<h3><a id="_1256"></a>å‚è€ƒ</h3> 
<p>(https://www.codetd.com/en/article/13107993)</p> 
<p>https://users.ece.utexas.edu/~adnan/gdb-refcard.pdf<br> https://www.cloudsavvyit.com/10921/debugging-with-gdb-getting-started/<br> https://blog.birost.com/a?ID=00650-b03e2257-94bf-41f3-b0fc-d352d5b02431<br> https://www.cnblogs.com/xsln/p/ptrace.html</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8f7931e4f462d967208c1834b23779fc/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Springboot ç›®å½•ç»“æ„</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba82e2deb375da99e40234185afc64cb/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">springæ¥å£è¶…æ—¶æ—¶é—´é…ç½®</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹ä¸­å›½çš„åšå®¢.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>