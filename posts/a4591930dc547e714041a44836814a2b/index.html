<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>STM32——SPI - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="STM32——SPI" />
<meta property="og:description" content="STM32——SPI 1.SPI介绍 SPI是什么?
SPI是串行外设接口（Serial Peripheral Interface）的缩写，是一种高速的，全双工，同步的通信总线，并且在芯片的管脚上只占用四根线，节约了芯片的管脚，同时为PCB的布局上节省空间，提供方便，正是出于这种简单易用的特性，越来越多的芯片集成了这种通信协议，比如 AT91RM9200 。
SPI 物理架构
SPI 包含 4 条总线，SPI 总线包含 4 条总线，分别为SS、SCK、MOSI、MISO。它们的作用介绍如下 ：
(1) MISO – Master Input Slave Output，主设备数据输入，从设备数据输出
(2) MOSI – Master Output Slave Input，主设备数据输出，从设备数据输入
(3) SCK – Serial Clock，时钟信号，由主设备产生
(4) CS – Chip Select，片选信号，由主设备控制
SPI 工作原理
SPI 工作模式
时钟极性（CPOL）：
没有数据传输时时钟线的空闲状态电平
0：SCK在空闲状态保持低电平
1：SCK在空闲状态保持高电平
时钟相位（CPHA）：
时钟线在第几个时钟边沿采样数据
0：SCK的第一（奇数）边沿进行数据位采样，数据在第一个时钟边沿被锁存
1：SCK的第二（偶数）边沿进行数据位采样，数据在第二个时钟边沿被锁存
模式 0 和模式 3 最常用。
模式 0 时序图：
模式 3 时序图：
2.W25Q128 介绍 什么是 W25Q128 ？" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/a4591930dc547e714041a44836814a2b/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-31T16:48:36+08:00" />
<meta property="article:modified_time" content="2024-01-31T16:48:36+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">STM32——SPI</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="STM32SPI_0"></a>STM32——SPI</h2> 
<h3><a id="1SPI_2"></a>1.SPI介绍</h3> 
<p><strong>SPI是什么?</strong></p> 
<p>SPI是串行外设接口（Serial Peripheral Interface）的缩写，是一种高速的，全双工，同步的通信总线，并且在芯片的管脚上只占用四根线，节约了芯片的管脚，同时为PCB的布局上节省空间，提供方便，正是出于这种简单易用的特性，越来越多的芯片集成了这种通信协议，比如 AT91RM9200 。</p> 
<p><strong>SPI</strong> <strong>物理架构</strong><br> <img src="https://images2.imgbox.com/2a/73/bR0sKST6_o.jpg" alt="在这里插入图片描述"></p> 
<p>SPI 包含 4 条总线，SPI 总线包含 4 条总线，分别为SS、SCK、MOSI、MISO。它们的作用介绍如下 ：</p> 
<p>(1) <strong>MISO</strong> – Master Input Slave Output，主设备数据输入，从设备数据输出</p> 
<p>(2) <strong>MOSI</strong> – Master Output Slave Input，主设备数据输出，从设备数据输入</p> 
<p>(3) <strong>SCK</strong> – Serial Clock，时钟信号，由主设备产生</p> 
<p>(4) <strong>CS</strong> – Chip Select，片选信号，由主设备控制</p> 
<p><strong>SPI</strong> <strong>工作原理</strong><br> <img src="https://images2.imgbox.com/83/95/RBeQXGtA_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>SPI</strong> <strong>工作模式</strong></p> 
<p><strong>时钟极性（CPOL</strong>）：</p> 
<p>没有数据传输时时钟线的空闲状态电平</p> 
<p>0：SCK在空闲状态保持低电平</p> 
<p>1：SCK在空闲状态保持高电平</p> 
<p><strong>时钟相位（CPHA）</strong>：</p> 
<p>时钟线在第几个时钟边沿采样数据</p> 
<p>0：SCK的第一（奇数）边沿进行数据位采样，数据在第一个时钟边沿被锁存</p> 
<p>1：SCK的第二（偶数）边沿进行数据位采样，数据在第二个时钟边沿被锁存<br> <img src="https://images2.imgbox.com/f5/75/9AwmV7lu_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>模式</strong> <strong>0</strong> <strong>和模式</strong> <strong>3</strong> <strong>最常用。</strong></p> 
<p>模式 0 时序图：<br> <img src="https://images2.imgbox.com/7e/35/4i4HWmqC_o.jpg" alt="在这里插入图片描述"></p> 
<p>模式 3 时序图：<br> <img src="https://images2.imgbox.com/28/35/OkOQAKsP_o.jpg" alt="在这里插入图片描述"></p> 
<h3><a id="2W25Q128__53"></a>2.<strong>W25Q128</strong> <strong>介绍</strong></h3> 
<p><strong>什么是</strong> <strong>W25Q128</strong> <strong>？</strong></p> 
<p>W25Q128 是华邦公司推出的一款 SPI 接口的 NOR Flash 芯片，其存储空间为 128 Mbit，相当于 16M 字节。</p> 
<p>Flash 是常用的用于储存数据的半导体器件，它具有容量大，可重复擦写、按“扇区/块”擦除、掉电后数据可继续保存的特性。</p> 
<p>Flash 是有一个物理特性：只能写 0 ，不能写 1 ，写 1 靠擦除。</p> 
<p><strong>W25Q128</strong> <strong>存储架构</strong><br> <img src="https://images2.imgbox.com/25/5e/r6pq1bLl_o.jpg" alt="在这里插入图片描述"></p> 
<p>一般按扇区（4k）进行擦除。</p> 
<p>可以按 章 – 节 – 页 – 字 进行理解。</p> 
<p><strong>W25Q128</strong> <strong>常用指令</strong></p> 
<p><img src="https://images2.imgbox.com/93/ac/albNFWWK_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>写使能</strong> <strong>(06H)</strong></p> 
<p>执行页写，扇区擦除，块擦除，片擦除，写状态寄存器等指令前，需要写使能。</p> 
<p>拉低CS片选 → 发送06H → 拉高CS片选</p> 
<p><strong>读状态寄存器（05H）</strong></p> 
<p>拉低CS片选 → 发送05H→ 返回SR1的值 → 拉高CS片选</p> 
<p><strong>读时序（03H）</strong></p> 
<p>拉低CS片选 → 发送03H→ 发送24位地址 → 读取数据（1~n） → 拉高CS片选</p> 
<p><strong>页写时序</strong> <strong>(02H)</strong></p> 
<p>页写命令最多可以向FLASH传输256个字节的数据。</p> 
<p>拉低CS片选 → 发送02H→ 发送24位地址 → 发送数据（1~n） → 拉高CS片选</p> 
<p><strong>扇区擦除时序（20H）</strong></p> 
<p>写入数据前，检查内存空间是否全部都是 0XFF ，不满足需擦除。</p> 
<p>拉低CS片选 → 发送20H→ 发送24位地址 → 拉高CS片选</p> 
<p><strong>W25Q128</strong> <strong>状态寄存器</strong></p> 
<p>W25Q128 一共有 3 个状态寄存器，它们的作用是跟踪芯片的状态。</p> 
<p>其中，状态寄存器 1 较为常用。<br> <img src="https://images2.imgbox.com/2c/63/Pc3JbIav_o.jpg" alt="在这里插入图片描述"></p> 
<p>BUSY：指示当前的状态，0 表示空闲，1 表示忙碌</p> 
<p>WEL：写使能锁定，为 1 时，可以操作页/扇区/块。为 0 时，写禁止。</p> 
<p><strong>W25Q128</strong> <strong>常见操作流程</strong></p> 
<p>以下流程省略了拉低/拉高片选信号CS。</p> 
<p><strong>读操作：</strong><br> <img src="https://images2.imgbox.com/01/21/mOkojmOk_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>擦除扇区：</strong><br> <img src="https://images2.imgbox.com/00/19/mX0ZtHWT_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>写操作</strong><br> <img src="https://images2.imgbox.com/2a/54/Pkmzzt7E_o.jpg" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f2990edc2aaf1c6bc12a2467bf4e252e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">学网络，这5个基础概念这样解释，有意思！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/267492588310b43c3974754b795dad2f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">每日一练 | 华为认证真题练习Day43</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>