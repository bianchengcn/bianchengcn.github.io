<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>eval跟new Function的区别是什么?是否有共同点? - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="eval跟new Function的区别是什么?是否有共同点?" />
<meta property="og:description" content="eval() 函数会将传入的字符串当做 JavaScript 代码进行执行
console.log(eval(&#39;2 &#43; 2&#39;));// 4 let p = 1; let aa = eval(&#39;(function a(){console.log(&#34;eval定义的函数&#34;,p)})()&#39;); console.log(aa);// &#34;eval定义的函数&#34; 1 建议在nodejs模式下执行，浏览器会报安全问题！
入参只有一个，是string类型：
一个表示 JavaScript 表达式、语句或一系列语句的字符串。表达式可以包含变量与已存在对象的属性
new Function 每个 JavaScript 函数实际上都是一个 Function 对象。运行 (function(){}).constructor === Function // true 便可以得到这个结论。
由 Function 构造函数创建的函数不会创建当前环境的闭包，它们总是被创建于全局环境，因此在运行时它们只能访问全局变量和自己的局部变量，不能访问它们被 Function 构造函数创建时所在的作用域的变量。这一点与使用 eval() 执行创建函数的代码不同。
需要在浏览器上运行，在nodejs上运行的结果是不一样的
var x = 10; function createFunction1() { var x = 20; return new Function(&#39;return x;&#39;); // 这里的 x 指向最上面全局作用域内的 x } var f1 = createFunction1(); console." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f832588daa186f9ce81ab6ad1329edf8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-19T23:37:26+08:00" />
<meta property="article:modified_time" content="2022-04-19T23:37:26+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">eval跟new Function的区别是什么?是否有共同点?</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><br><img alt="" height="965" src="https://images2.imgbox.com/8f/77/HHRTARx5_o.jpg" width="960"><strong>eval() 函数会将传入的字符串当做 JavaScript 代码进行执行</strong></p> 
<pre><code class="language-javascript">console.log(eval('2 + 2'));// 4
let p = 1;
let aa = eval('(function a(){console.log("eval定义的函数",p)})()');
console.log(aa);// "eval定义的函数" 1</code></pre> 
<p><br> 建议在nodejs模式下执行，浏览器会报安全问题！<br> 入参只有一个，是string类型：<br> 一个表示 JavaScript 表达式、语句或一系列语句的字符串。表达式可以包含变量与<span style="color:#fe2c24;">已存</span>在对象的属性</p> 
<p><strong>new Function 每个 JavaScript 函数实际上都是一个 <code>Function</code> 对象。运行 <code>(function(){}).constructor === Function // true</code> 便可以得到这个结论。</strong></p> 
<p>由 <code>Function</code> 构造函数创建的函数不会创建当前环境的闭包，它们总是被创建于全局环境，因此在运行时它们只能访问全局变量和自己的局部变量，不能访问它们被 <code>Function</code> 构造函数创建时所在的作用域的变量。这一点与使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/eval" rel="nofollow" title="eval()">eval()</a> 执行创建函数的代码不同。</p> 
<p><span style="color:#fe2c24;">需要在浏览器上运行，在nodejs上运行的结果是不一样的</span></p> 
<pre><code class="language-javascript">var x = 10;
function createFunction1() {
    var x = 20;
    return new Function('return x;'); // 这里的 x 指向最上面全局作用域内的 x
}
var f1 = createFunction1();
console.log(f1());// 10</code></pre> 
<p><span style="color:#fe2c24;">nodejs中是无法读取到new Function外声明的变量的，因为Node.js 中 <code>f1()</code> 会产生一个“找不到变量 <code>x</code>”的 <code>ReferenceError</code>。这是因为在 Node 中顶级作用域不是全局作用域，而 <code>x</code> 其实是在当前模块的作用域之中。</span></p> 
<p><strong>eval和new Function在浏览器上运行时都存在安全风险，因为浏览器无法感知你里面的字符串是否安全！</strong></p> 
<p></p> 
<h3 id="don.27t_use_eval.21"><strong><span style="color:#fe2c24;">永远不要使用 eval！底层实现的库一般都是使用new Function的形式</span></strong></h3> 
<p><code>eval()</code> 是一个危险的函数， 它使用与调用者相同的权限执行代码。如果你用 <code>eval()</code> 运行的字符串代码被恶意方（不怀好意的人）修改，您最终可能会在您的网页/扩展程序的权限下，在用户计算机上运行恶意代码。更重要的是，第三方代码可以看到某一个 <code>eval()</code> 被调用时的作用域，这也有可能导致一些不同方式的攻击。相似的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" title="Function">Function</a> 就不容易被攻击。</p> 
<p><code>eval()</code> 通常比其他替代方法更慢，因为它必须调用 JS 解释器，而许多其他结构则可被现代 JS 引擎进行优化。</p> 
<p>此外，现代JavaScript解释器将javascript转换为机器代码。 这意味着任何变量命名的概念都会被删除。 因此，任意一个eval的使用都会强制浏览器进行冗长的变量名称查找，以确定变量在机器代码中的位置并设置其值。 另外，新内容将会通过 <code>eval()</code> 引进给变量， 比如更改该变量的类型，因此会强制浏览器重新执行所有已经生成的机器代码以进行补偿。 但是，（谢天谢地）存在一个非常好的eval替代方法：只需使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" title="window.Function">window.Function</a>。 这有个例子方便你了解如何将<code>eval()</code>的使用转变为<code>Function()</code>。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26d675575d31fdf31ea5cc1ade1f0125/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">matlab无法打开excel的问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ba50d8b378eb07b8a3b0606e13e194cc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">业内视频超分辨率新标杆，快手&amp;大连理工研究登上CVPR 2022</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>