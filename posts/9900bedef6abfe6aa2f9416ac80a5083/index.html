<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>获取地理位置请求免费天气接口 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="获取地理位置请求免费天气接口" />
<meta property="og:description" content="需求：根据地理位置信息去请求免费的天气接口数据，拿到数据后进行展示，这边我用到了俩个key，一个是腾讯位置服务的key和心知天气的key，为什么要这么麻烦呢，是因为之前写过一版不需要获取地理位置，直接就可以请求天气获取数据，但是用了不到一个月，崩了，要我用升级版...，所以还是就麻烦一点吧。
1.获取腾讯位置服务的key，通过key获取到当前所在地区的位置信息
2.通过获取到的位置信息，比如武汉市，去请求心知天气的key，可以获取到当前地区的温度湿度等信息。
结果得到效果如下图
1.腾讯位置服务获取key需要注册开发者，在控制台申请
1.腾讯位置服务天气获取key 首先要注册成为个人或者企业的开发者。
其次点击右上角控制台点击应用管理==》我的应用==》创建应用如下图，名称随意填，类型选择出行
点击添加key
如下填写就行，得到了key
2.心知天气获取key 心知天气右上角注册登录后，点击右上角控制台，进入后会让你选产品==》选择免费就行，选好如下：
点击产品管理，得到公钥和私钥，复制私钥的key就行
3.请求地理位置接口获取数据请求天气接口完整代码 &lt;template&gt; &lt;div class=&#34;box&#34;&gt; &lt;p class=&#34;boxTemperature&#34;&gt;{{ weatcherData.tem }}°&lt;/p&gt; &lt;p class=&#34;boxWeather&#34;&gt;{{ weatcherData.wea }}&lt;/p&gt; &lt;p class=&#34;boxCity&#34;&gt;{{ weatcherData.city }}市&lt;/p&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import axios from &#34;axios&#34;; export default { data() { return { weatcherData: { tem: &#34;&#34;, wea: &#34;&#34;, city: &#34;&#34; }, ipV: &#34;&#34;, city: &#34;&#34; }; }, //生命周期 - 挂载完成（可以访问DOM元素） mounted() { this.gettianiq(); }, methods: { gettianiq() { axios({ url: &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/9900bedef6abfe6aa2f9416ac80a5083/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-29T14:56:00+08:00" />
<meta property="article:modified_time" content="2023-08-29T14:56:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">获取地理位置请求免费天气接口</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>需求：根据地理位置信息去请求免费的天气接口数据，拿到数据后进行展示，这边我用到了俩个key，一个是腾讯位置服务的key和心知天气的key，为什么要这么麻烦呢，是因为之前写过一版不需要获取地理位置，直接就可以请求天气获取数据，但是用了不到一个月，崩了，要我用升级版...，所以还是就麻烦一点吧。</p> 
<blockquote> 
 <p>1.获取腾讯位置服务的key，通过key获取到当前所在地区的位置信息</p> 
 <p>2.通过获取到的位置信息，比如武汉市，去请求心知天气的key，可以获取到当前地区的温度湿度等信息。</p> 
</blockquote> 
<p>结果得到效果如下图</p> 
<p><img alt="" height="52" src="https://images2.imgbox.com/9d/22/h0CWAtf9_o.png" width="211"></p> 
<p>1.<a class="link-info" href="https://lbs.qq.com/dev/console/application/mine" rel="nofollow" title="腾讯位置服务获取key">腾讯位置服务获取key</a>需要注册开发者，在控制台申请</p> 
<h4>1.腾讯位置服务天气获取key</h4> 
<p>首先要注册成为个人或者企业的开发者。</p> 
<p>其次点击右上角控制台点击应用管理==》我的应用==》创建应用如下图，名称随意填，类型<span style="color:#fe2c24;">选择出行</span></p> 
<p><img alt="" height="337" src="https://images2.imgbox.com/70/0b/i0IhpQc6_o.png" width="1200"></p> 
<p> </p> 
<p><img alt="" height="319" src="https://images2.imgbox.com/76/09/2Qq8A4Sf_o.png" width="352"></p> 
<p>点击添加key</p> 
<p><img alt="" height="80" src="https://images2.imgbox.com/c6/e2/FvdRKWts_o.png" width="365"></p> 
<p>如下填写就行，得到了key</p> 
<p> <img alt="" height="489" src="https://images2.imgbox.com/78/c4/RRwJth8W_o.png" width="416"></p> 
<h4> 2.心知天气获取key</h4> 
<p><a class="link-info" href="https://www.seniverse.com/" rel="nofollow" title="心知天气">心知天气</a>右上角注册登录后，点击右上角控制台，进入后会让你选产品==》选择免费就行，选好如下：</p> 
<p><img alt="" height="463" src="https://images2.imgbox.com/e6/63/g9nnLaKt_o.png" width="861"></p> 
<p> 点击产品管理，得到公钥和私钥，复制私钥的key就行</p> 
<p><img alt="" height="454" src="https://images2.imgbox.com/87/20/iGpZBFse_o.png" width="960"></p> 
<h4> 3.请求地理位置接口获取数据请求天气接口完整代码</h4> 
<pre><code class="language-javascript">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;p class="boxTemperature"&gt;{<!-- -->{ weatcherData.tem }}°&lt;/p&gt;
    &lt;p class="boxWeather"&gt;{<!-- -->{ weatcherData.wea }}&lt;/p&gt;
    &lt;p class="boxCity"&gt;{<!-- -->{ weatcherData.city }}市&lt;/p&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from "axios";
export default {
  data() {
    return {
      weatcherData: {
        tem: "",
        wea: "",
        city: ""
      },
      ipV: "",
      city: ""
    };
  },
  //生命周期 - 挂载完成（可以访问DOM元素）
  mounted() {
    this.gettianiq();
  },
  methods: {
    gettianiq() {
      axios({
        url: "/ws/location/v1/ip", //接口地址（代理把起码路径去掉）
        params: { key: "高德地图的位置key", output: "jsonp" }, //参数格式必须用到output传参为jsonp，否则会报跨域问题
      //   responseType: "jsonp" //跨域，必须用到jsonp
      }).then(res =&gt; {
        var ip = res.data.replace("QQmap&amp;&amp;QQmap(", "").replace(");", "");
        this.ipV = JSON.parse(ip);
        let {result}=this.ipV;

           this.city=result.ad_info.city;
           console.log(this.city,this.ipV.result);
           this.$nextTick(()=&gt;{
            this.weather()
           })

      });
    },
    weather() {
      axios({
        url: "https://api.seniverse.com/v3/weather/now.json", //接口地址（代理把起码路径去掉）
        params: { key: "天气的私钥", location: this.city, unit: "c" } //参数格式必须用到
      }).then(res =&gt; {
        let { data } = res;
        console.log(data, "获取到数据");
        let { results } = data;
        this.weatcherData.tem = results[0].now.temperature;
        this.weatcherData.wea = results[0].now.text;
        this.weatcherData.city = results[0].location.name;
        console.log(results[0].now.temperature);
      });
    }
  }
};
&lt;/script&gt;

&lt;style scoped&gt;
.box {
  display: flex;
  align-items: center;
  color: #5e5757;
  margin-right: 20px;
}
.boxTemperature {
  font-size: 18px;
}
.boxWeather {
  font-size: 14px;
  margin: 0 0 0 15px;
}
.boxCity {
  margin-left: 10px;
  font-size: 16px;
}
&lt;/style&gt;
</code></pre> 
<h4>4.代理问题</h4> 
<p>直接请求直接出现跨域问题，解决方法如下：</p> 
<p>1.在vue.config.js的devServer下配置proxy代理跨域</p> 
<pre><code class="language-javascript">module.exports = {
  devServer: {
    // 反向代理配置
    proxy: {
      '/ws': {
        target: 'https://apis.map.qq.com/',
        ws: true,
        changOrigin: true,//允许跨域
        pathRewrite: {
          '^/ws': '/ws'
        }
      },
    }
  },
}</code></pre> 
<h4>5.数据实现</h4> 
<p>高德接口得到的位置信息如下，把city提出来去请求天气接口了</p> 
<p><img alt="" height="431" src="https://images2.imgbox.com/e9/40/mHdIhtUn_o.png" width="400"></p> 
<p></p> 
<p>天气接口得到的数据格式如下</p> 
<p><img alt="" height="219" src="https://images2.imgbox.com/20/9d/FGzqDVbT_o.png" width="519"></p> 
<h4>6.效果</h4> 
<p><img alt="" height="64" src="https://images2.imgbox.com/5b/e9/sGjAMmjF_o.png" width="209"> </p> 
<p> 这样就实现啦，文章到此结束，希望对你有所帮助~</p> 
<p></p> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c686393e167f717e86241225e39b29b8/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">windows的django项目部署到linux的docker上</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/80678894563f6ce56b3dba536321376b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">bootloader串口更新程序[瑕疵学习板]</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>