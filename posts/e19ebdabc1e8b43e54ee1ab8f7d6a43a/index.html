<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ueditor 富文本编辑器粘贴图片时让图片居中 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="ueditor 富文本编辑器粘贴图片时让图片居中" />
<meta property="og:description" content="需求
今天碰到个需求，客户要求在把微信公众号中的文章粘贴到富文本框时将文字向左对齐，图片居中
作为一个已经几年没碰前端的我来说有点头大，百度google了一番未果，只好自己研究去了
花了2个多小时终于搞定
话不多说，直接上代码
主要是 retainOnlyLabelPasted 和 filterRules
retainOnlyLabelPasted 会删掉所有乱七八糟的格式
filterRules 配置很多标签粘贴时的过滤规则，其中我配置了
img:function(node){ console.log(node.getAttr(&#34;style&#34;)); node.setAttr(&#39;style&#39;,&#39;display:block;margin:0 auto;&#39;); console.log(node.getAttr(&#34;style&#34;)); }, 主要是重置一下style
其他的啥也没改
至于这个node怎么用可以去下面的API链接看
然后其他的配置都是官网默认的的
还有一个autotypeset 不知道做什么用的
设置的那些东西似乎没有生效
不过既然写好了就懒得改了
$(document).ready(function () {
postContent = UE.getEditor(“content”, {
autoHeightEnabled: false,
initialFrameHeight: KaTeX parse error: Expected &#39;}&#39;, got &#39;&amp;&#39; at position 932: ….browser.ie ? &#39;&amp;̲nbsp;&#39; : &#39;&lt;br&gt;&#39;…block[tmpNode.tagName]) {
p.appendChild(tmpNode);
} else {
if (p.firstChild()) {
node.parentNode.insertBefore(p, node);
p = UE.uNode.createElement(‘p’);
} else {
node.parentNode.insertBefore(tmpNode, node);" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/e19ebdabc1e8b43e54ee1ab8f7d6a43a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-28T10:11:29+08:00" />
<meta property="article:modified_time" content="2023-12-28T10:11:29+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ueditor 富文本编辑器粘贴图片时让图片居中</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>需求<br> 今天碰到个需求，客户要求在把微信公众号中的文章粘贴到富文本框时将文字向左对齐，图片居中<br> 作为一个已经几年没碰前端的我来说有点头大，百度google了一番未果，只好自己研究去了<br> 花了2个多小时终于搞定</p> 
<p>话不多说，直接上代码<br> 主要是 retainOnlyLabelPasted 和 filterRules<br> retainOnlyLabelPasted 会删掉所有乱七八糟的格式<br> filterRules 配置很多标签粘贴时的过滤规则，其中我配置了</p> 
<pre><code class="prism language-cpp">img<span class="token operator">:</span><span class="token function">function</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
	    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getAttr</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    node<span class="token punctuation">.</span><span class="token function">setAttr</span><span class="token punctuation">(</span><span class="token char">'style'</span><span class="token punctuation">,</span><span class="token char">'display:block;margin:0 auto;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">getAttr</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p>主要是重置一下style<br> 其他的啥也没改<br> 至于这个node怎么用可以去下面的API链接看</p> 
<p>然后其他的配置都是官网默认的的</p> 
<p>还有一个autotypeset 不知道做什么用的<br> 设置的那些东西似乎没有生效<br> 不过既然写好了就懒得改了</p> 
<p>$(document).ready(function () {<!-- --><br> postContent = UE.getEditor(“content”, {<!-- --><br> autoHeightEnabled: false,<br> initialFrameHeight: <span class="katex--inline">KaTeX parse error: Expected '}', got '&amp;' at position 932: ….browser.ie ? '&amp;̲nbsp;' : '&lt;br&gt;'…</span>block[tmpNode.tagName]) {<!-- --><br> p.appendChild(tmpNode);<br> } else {<!-- --><br> if (p.firstChild()) {<!-- --><br> node.parentNode.insertBefore(p, node);<br> p = UE.uNode.createElement(‘p’);<br> } else {<!-- --><br> node.parentNode.insertBefore(tmpNode, node);<br> }<br> }<br> }<br> if (p.firstChild()) {<!-- --><br> node.parentNode.insertBefore(p, node);<br> }<br> node.parentNode.removeChild(node);<br> },<br> //<span class="katex--inline">KaTeX parse error: Expected '}', got 'EOF' at end of input: … br: {<!-- --></span>: {}},<br> ol:{<!-- --><span class="katex--inline">KaTeX parse error: Expected 'EOF', got '}' at position 5: : {}}̲, …</span>: {}},</p> 
<pre><code>            dl:function(node){
                node.tagName = 'ul';
                node.setAttr()
            },
            dt:function(node){
                node.tagName = 'li';
                node.setAttr()
            },
            dd:function(node){
                node.tagName = 'li';
                node.setAttr()
            },
            li: function (node) {

                var className = node.getAttr('class');
                if (!className || !/list\-/.test(className)) {
                    node.setAttr()
                }
                var tmpNodes = node.getNodesByTagName('ol ul');
                UE.utils.each(tmpNodes,function(n){
                    node.parentNode.insertAfter(n,node);

                })

            },
            table: function (node) {
                UE.utils.each(node.getNodesByTagName('table'), function (t) {
                    UE.utils.each(t.getNodesByTagName('tr'), function (tr) {
                        var p = UE.uNode.createElement('p'), child, html = [];
                        while (child = tr.firstChild()) {
                            html.push(child.innerHTML());
                            tr.removeChild(child);
                        }
                        p.innerHTML(html.join('&amp;nbsp;&amp;nbsp;'));
                        t.parentNode.insertBefore(p, t);
                    })
                    t.parentNode.removeChild(t)
                });
                var val = node.getAttr('width');
                node.setAttr();
                if (val) {
                    node.setAttr('width', val);
                }
            },
            tbody: {$: {}},
            caption: {$: {}},
            th: {$: {}},
            td: {$: {valign: 1, align: 1,rowspan:1,colspan:1,width:1,height:1}},
            tr: {$: {}},
            h3: {$: {}},
            h2: {$: {}},
            //黑名单，以下标签及其子节点都会被过滤掉
            '-': 'script style meta iframe embed object'
        }
    }(),

    autotypeset: {
        mergeEmptyline: true, //合并空行
        removeClass: true, //去掉冗余的class
        removeEmptyline: false, //去掉空行
        textAlign: "left", //段落的排版方式，可以是 left，right，center，justify 去掉这个属性表示不执行排版
        imageBlockLine: 'center', //图片的浮动方式，独占一行剧中，左右浮动，默认: center，left，right，none 去掉这个属性表示不执行排版
        pasteFilter: true, //根据规则过滤没事粘贴进来的内容
        clearFontSize: true, //去掉所有的内嵌字号，使用编辑器默认的字号
        clearFontFamily: true, //去掉所有的内嵌字体，使用编辑器默认的字体
        removeEmptyNode: false, // 去掉空节点
        //可以去掉的标签
        removeTagNames: {标签名字: 1
        },
        indent: false, // 行首缩进
        indentValue: '2em', //行首缩进的大小
        bdc2sb: false,
        tobdc: false
    }
});
</code></pre> 
<p>});</p> 
<p>参考文章：http://blog.ncmem.com/wordpress/2023/12/28/ueditor-%e5%af%8c%e6%96%87%e6%9c%ac%e7%bc%96%e8%be%91%e5%99%a8%e7%b2%98%e8%b4%b4%e5%9b%be%e7%89%87%e6%97%b6%e8%ae%a9%e5%9b%be%e7%89%87%e5%b1%85%e4%b8%ad/<br> 欢迎入群一起讨论</p> 
<p><img src="https://images2.imgbox.com/f7/df/FOKt4Hq5_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b952e286f2208013e96d4d358567a7d2/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Unix/Linux操作系统介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/530e7ad6d3ac5b6ec2826bea7de1c20f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">PHP实现视频文件上传完整实例</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>