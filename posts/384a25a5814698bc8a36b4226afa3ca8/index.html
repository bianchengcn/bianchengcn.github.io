<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>c&#43;&#43;继承 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="c&#43;&#43;继承" />
<meta property="og:description" content="继承 一、继承的概念和定义 继承是面向对象程序设计中使代码可以复用的手段，他是在原有类（也叫父类，基类）的基础上进行扩展增加功能，这样产生的新类叫做派生类，也叫子类。
class Person { public: void print() { std::cout &lt;&lt; name &lt;&lt; std::endl; std::cout &lt;&lt; _age &lt;&lt; std::endl; } protected: std::string name = &#34;小明&#34;; int _age = 18; }; class Student : public Person { protected: int stu_id = 111; }; int main() { Student st; st.print(); return 0; } 继承后父类的Person的成员都会变成子类的一部分，这里体现出了Student复用了Person的成员，调用print可以看到成员函数的复用。
定义 class 子类 ：继承方式 父类
继承方式有三种：public；protected；private。
总结 父类private成员在派生类中无论采用哪种继承方式，都是不可见的。这里的不可见是指基类的私有成员还是被继承到了派生类对象中，但是语法上限制派生类对象不管在类里面还是类外面都不能去访问它。基类private成员在派生类中是不能被访问，如果基类成员不想在类外直接被访问，但需要在派生类中能访问，就定义为protected。可以看出保护成员限定符是因继承才出现的。除了父类的私有成员在子类中都是不可见的，父类的其他成员在子类中的访问方式：成员在父类的访问限定符和继承方式中的较小的一个。 public &gt; protected &gt; private。 二、父类和子类的对象赋值转换 子类对象可以赋值给 **父类的对象 / 基类的指针 / 基类的引用。**这里有个形象的说法叫切片或者切割。寓意把子类类中父类那部分切来赋值过去。父类对象不能赋值给子类对象。父类的指针可以通过强制类型转换赋值给子类的指针。但是必须是父类的指针是指向子类对象时才是安全的。 class Person { protected: string name = &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/384a25a5814698bc8a36b4226afa3ca8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-20T21:44:10+08:00" />
<meta property="article:modified_time" content="2022-01-20T21:44:10+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">c&#43;&#43;继承</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>继承</h2> 
<h3><a id="_2"></a>一、继承的概念和定义</h3> 
<p>继承是面向对象程序设计中使代码可以复用的手段，他是在原有类（也叫父类，基类）的基础上进行扩展增加功能，这样产生的新类叫做派生类，也叫子类。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
        std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> _age <span class="token operator">&lt;&lt;</span> std<span class="token operator">::</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    std<span class="token operator">::</span>string name <span class="token operator">=</span> <span class="token string">"小明"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> _age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">int</span> stu_id <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Student st<span class="token punctuation">;</span>
    st<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>继承后父类的Person的成员都会变成子类的一部分，这里体现出了Student复用了Person的成员，调用print可以看到成员函数的复用。</p> 
<h4><a id="_36"></a>定义</h4> 
<p><strong>class 子类 ：继承方式 父类</strong></p> 
<p>继承方式有三种：public；protected；private。</p> 
<p><img src="https://images2.imgbox.com/a8/4d/vMTxVxIc_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-z6qBqsW7-1642685890217)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211212153608256.png)]"></p> 
<h4><a id="_45"></a>总结</h4> 
<ol><li>父类private成员在派生类中无论采用哪种继承方式，都是不可见的。这里的<strong>不可见是指基类的私有成员还是被继承到了派生类对象中，但是语法上限制派生类对象不管在类里面还是类外面都不能去访问它。</strong></li><li>基类private成员在派生类中是不能被访问，如果基类成员不想在类外直接被访问，但需要在派生类中能访问，就定义为protected。<strong>可以看出保护成员限定符是因继承才出现的。</strong></li><li>除了父类的私有成员在子类中都是不可见的，父类的其他成员在子类中的访问方式：<strong>成员在父类的访问限定符和继承方式中的较小的一个。</strong> public &gt; protected &gt; private。</li></ol> 
<h3><a id="_51"></a>二、父类和子类的对象赋值转换</h3> 
<ul><li><strong>子类对象</strong>可以赋值给 **父类的对象 / 基类的指针 / 基类的引用。**这里有个形象的说法叫切片或者切割。寓意把子类类中父类那部分切来赋值过去。</li><li>父类对象不能赋值给子类对象。</li><li>父类的指针可以通过强制类型转换赋值给子类的指针。但是必须是父类的指针是指向子类对象时才是安全的。</li></ul> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    string name <span class="token operator">=</span> <span class="token string">"小明"</span><span class="token punctuation">;</span>
    string _sex <span class="token operator">=</span> <span class="token string">"男"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> _age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> stu_id <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Student st<span class="token punctuation">;</span>
    <span class="token comment">// 1.子类对象可以赋值给父类对象/指针/引用</span>
    Person p1 <span class="token operator">=</span> st<span class="token punctuation">;</span>
    Person<span class="token operator">*</span> p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>st<span class="token punctuation">;</span>
    Person<span class="token operator">&amp;</span> p3 <span class="token operator">=</span> st<span class="token punctuation">;</span>
    <span class="token comment">//2.基类对象不能赋值给派生类对象</span>
    <span class="token comment">//st = p1;</span>
    <span class="token comment">//3.基类的指针可以通过强制类型转换赋值给派生类的指针，但是父类的指针必须是指向子类的地址的</span>
    Student<span class="token operator">*</span> st1 <span class="token operator">=</span> <span class="token punctuation">(</span>Student<span class="token operator">*</span><span class="token punctuation">)</span>p2<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>第三种情况因为p2本身指向的空间就是Student类型的空间，所以通过强制类型转换可以进行地址的赋值。</p> 
<h3><a id="_89"></a>三、继承中的作用域</h3> 
<p>在继承体系中，父类和子类都有独立的作用域，也就是说可以定义同名的函数和变量，互不冲突。</p> 
<p>子类和父类中有同名成员，<strong>子类成员将屏蔽父类对同名成员的直接访问，优先访问自己类内部的同名成员，这种情况叫隐藏，也叫重定义。</strong>（在子类成员函数中，可以<strong>使用 基类</strong>::<strong>基类成员 显示访问</strong>）</p> 
<p>如果是同名的成员函数，并不会构成函数重载，因为他们是在不同的作用域内，所以只要函数名相同，就构成隐藏。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    string name <span class="token operator">=</span> <span class="token string">"小明"</span><span class="token punctuation">;</span>
    string _sex <span class="token operator">=</span> <span class="token string">"男"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> _age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> _sex <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> _age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">int</span> stu_id <span class="token operator">=</span> <span class="token number">111</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> _age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Student st<span class="token punctuation">;</span>
    st<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/ea/er17YclS_o.png" alt=""></p> 
<p>子类会优先隐藏父类的同名成员，输出自己的同名成员，当要输出的成员子类没有的时候，回去父类中寻找。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"func()"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
		<span class="token class-name">A</span><span class="token operator">::</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		cout <span class="token operator">&lt;&lt;</span> <span class="token string">"func(int i)-&gt;"</span> <span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	B b<span class="token punctuation">;</span>
	b<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>B中的fun和A中的fun不是构成重载，因为不是在同一作用域； B中的fun和A中的fun构成隐藏，成员函数满足函数名相同就构成隐藏</p> 
<h3><a id="_159"></a>四、派生类的默认成员函数</h3> 
<ol><li>派生类的构造函数必须调用基类的构造函数初始化基类的那一部分成员。如果基类没有默认的构造函数，则必须在派生类构造函数的初始化列表阶段显示调用。</li><li>派生类的拷贝构造函数必须调用基类的拷贝构造完成基类的拷贝初始化。</li><li>派生类的operator=必须要调用基类的operator=完成基类的复制。</li><li>派生类的析构函数会在被调用完成后自动调用基类的析构函数清理基类成员。因为这样才能保证派生类对象先清理派生类成员再清理基类成员的顺序。</li><li>派生类对象初始化先调用基类构造再调派生类构造。</li><li>派生类对象析构清理先调用派生类析构再调基类的析构。</li></ol> 
<p><img src="https://images2.imgbox.com/1c/f6/m2X84gU3_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OVpzjMHy-1642685890218)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211214141825371.png)]"></p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span> <span class="token operator">:</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name <span class="token operator">=</span> <span class="token string">"peter"</span><span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_name</span><span class="token punctuation">(</span>name <span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Person()"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> p<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">_name</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>_name<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Person(const Person&amp; p)"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	Person<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person<span class="token operator">&amp;</span> p <span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Person operator=(const Person&amp; p)"</span><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>p<span class="token punctuation">)</span>
			_name <span class="token operator">=</span> p <span class="token punctuation">.</span>_name<span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"~Person()"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">protected</span> <span class="token operator">:</span>
	string _name <span class="token punctuation">;</span> <span class="token comment">// 姓名</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span> <span class="token operator">:</span>
    <span class="token comment">//会先调用父类的构造函数，完成父类那一部分的构造，再进行子类的构造。</span>
    <span class="token comment">//如果父类没有默认构造函数（编译器默认生成的，无参构造，全缺省构造），那么就需要子类在初始化参数列表显示调用</span>
	<span class="token function">Student</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">Person</span><span class="token punctuation">(</span>name <span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_num</span><span class="token punctuation">(</span>num <span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Student()"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    <span class="token comment">//必须调用父类的拷贝构造函数完成父类部分的拷贝构造</span>
	<span class="token function">Student</span><span class="token punctuation">(</span><span class="token keyword">const</span> Student<span class="token operator">&amp;</span> s<span class="token punctuation">)</span>
	<span class="token operator">:</span> <span class="token function">Person</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	<span class="token punctuation">,</span> <span class="token function">_num</span><span class="token punctuation">(</span>s <span class="token punctuation">.</span>_num<span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Student(const Student&amp; s)"</span> <span class="token operator">&lt;&lt;</span>endl <span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    <span class="token comment">//调用父类的operator= 完成父类部分的赋值，子类调用的时候必须加上作用域限定符，应为两个operator=为同名函数，会造成隐藏</span>
	Student<span class="token operator">&amp;</span> <span class="token keyword">operator</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Student<span class="token operator">&amp;</span> s <span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Student&amp; operator= (const Student&amp; s)"</span><span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">!=</span> <span class="token operator">&amp;</span>s<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			Person<span class="token operator">::</span><span class="token keyword">operator</span> <span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
            _num <span class="token operator">=</span> s <span class="token punctuation">.</span>_num<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span> <span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    <span class="token comment">//子类的析构函数会和父类的析构函数构成隐藏，他们的名字会被编译器统一处理成destructor()。</span>
    <span class="token comment">//在子类调用析构函数之后，会自动调用父类的析构函数。</span>
	<span class="token operator">~</span><span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		cout<span class="token operator">&lt;&lt;</span><span class="token string">"~Student()"</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token keyword">protected</span> <span class="token operator">:</span>
	<span class="token keyword">int</span> _num <span class="token punctuation">;</span> <span class="token comment">//学号</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2f/9c/wXIwKf42_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-zMYkKjRa-1642685890219)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211214145745474.png)]"></p> 
<h3><a id="_242"></a>五、继承与友元</h3> 
<p>友元关系不能继承，也就是说父类的友元不能访问子类私有和保护的成员。</p> 
<h3><a id="_246"></a>六、继承与静态成员</h3> 
<p>父类定义了static静态成员，则整个继承体系里面只有一个这样的成员。无论派生出多少个子类，都只有一个static成员实例。</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">Person</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span>
    string name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Person<span class="token operator">::</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token operator">:</span><span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Person</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> num<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Person p<span class="token punctuation">;</span>
    Student s<span class="token punctuation">;</span>
    p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"xiaoming"</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"xiaohong"</span><span class="token punctuation">;</span>
    <span class="token comment">//访问的count实际上是一个同一个</span>
    p<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>count <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>count <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f0/dc/qJPrTzGJ_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-tBnjq14B-1642685890219)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228153840451.png)]"></p> 
<h3><a id="_282"></a>七、菱形继承和虚拟继承</h3> 
<p>单继承：一个子类只有一个直接父类的时候称这个继承关系为单继承</p> 
<p><img src="https://images2.imgbox.com/11/c9/8XGeiMh0_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-PH5t1NnM-1642685890220)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228134603253.png)]"></p> 
<p>多继承：一个子类有两个或以上直接父类时称这个继承关系为多继承</p> 
<p><img src="https://images2.imgbox.com/67/15/9Y3Jg99E_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-OpGRhI0d-1642685890220)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228134706523.png)]"></p> 
<p>菱形继承</p> 
<p><img src="https://images2.imgbox.com/d5/79/aioGcRkB_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-PSrjEuk9-1642685890221)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228134754648.png)]"></p> 
<p>菱形继承会造成数据冗余和数据二义性的问题，class B和class C继承了class A，class D又继承的B和C，D中关于A的数据就会有两份，造成数据的二义性。</p> 
<p><img src="https://images2.imgbox.com/ea/4f/eJdUOBy5_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-dNQnaQxq-1642685890221)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228135205375.png)]"></p> 
<p>下面是菱形继承的内存对象成员模型</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// class B : public A</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span>  <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// class C : public A</span>
<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token operator">:</span>  <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">A</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">C</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _d<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    D d<span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>B<span class="token operator">::</span>_a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>C<span class="token operator">::</span>_a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_d <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b0/23/CUdQ3uj1_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ZNG7JiSf-1642685890221)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228154744678.png)]"></p> 
<p>虚继承：使用virtual关键字，可以解决菱形继承的二义性和数据冗余的问题</p> 
<pre><code class="prism language-cpp"><span class="token keyword">class</span> <span class="token class-name">A</span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// class B : public A</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">A</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// class C : public A</span>
<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">A</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _c<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">C</span></span>
<span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> _d<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    D d<span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>B<span class="token operator">::</span>_a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>C<span class="token operator">::</span>_a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_b <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_c <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    d<span class="token punctuation">.</span>_d <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5a/33/FQiP2hKT_o.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-1g99rJxk-1642685890222)(C:\Users\han\AppData\Roaming\Typora\typora-user-images\image-20211228162157403.png)]"></p> 
<p>这里是通过了B和C的两个指针，指向的一张表。这两个指针叫虚基表指针，这两个表叫虚基表。虚基表中存的偏移量。通过偏移量可以找到下面的A。</p> 
<h3><a id="_386"></a>八、总结</h3> 
<h4><a id="_388"></a>继承和组合</h4> 
<p>继承：是一种<strong>is-a</strong>的关系，也就是说每个派生类对象都是一个基类对象。继承允许你根据基类的实现来定义派生类的实现。这种通过生成派生类的复用通常被称为白箱复用(white-box reuse)。术语“白箱”是相对可视性而言：在继承方式中，基类的内部细节对子类可见 。继承一定程度破坏了基类的封装，基类的改变，对派生类有很大的影响。派生类和基类间的依赖关系很强，耦合度高。</p> 
<p>组合：是一种<strong>has-a</strong>的关系，对象组合是类继承之外的另一种复用选择。新的更复杂的功能可以通过组装或组合对象来获得。对象组合要求被组合的对象具有良好定义的接口。这种复用风格被称为黑箱复用(black-box reuse)，因为对象的内部细节是不可见的。对象只以“黑箱”的形式出现。 组合类之间没有很强的依赖关系，耦合度低。优先使用对象组合有助于你保持每个类被封装。</p> 
<p>实际尽量多去用组合。组合的耦合度低，代码维护性好。不过继承也有用武之地的，有些关系就适合继承那就用继承，另外要实现多态，也必须要继承。类之间的关系可以用继承，可以用组合，就用组合。</p> 
<h3><a id="_396"></a>九、面试题</h3> 
<h4><a id="1_398"></a>1.什么是菱形继承？菱形继承的问题是什么？</h4> 
<p>两个子类继承同一个父类，而又有子类同时继承这两个子类。会造成数据冗余和数据二义性的问题，class B和class C继承了class A，class D又继承的B和C，D中关于A的数据就会有两份，造成数据的二义性。</p> 
<h4><a id="2_402"></a>2.什么是菱形虚拟继承？如何解决数据冗余和二义性的</h4> 
<p>采用virtual关键字，进行虚拟继承。对于A，B，C，D四个类来说，B和C继承了A类，D类继承了B和C类，创建一个D类只会实际生成一个A类成员，并通过虚基表中存储的偏移量找到那一份基类的数据解决了数据的冗余和二义性。</p> 
<h4><a id="3_406"></a>3.继承和组合的区别？什么时候用继承？什么时候用组合</h4> 
<p>见上面的总结。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d37228f8791f190dd91def9de653bb10/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">耳机插上电脑没反应</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c5ac80c95aa798c59932343efba890b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[样本分析] TelsaCrypt勒索病毒</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>