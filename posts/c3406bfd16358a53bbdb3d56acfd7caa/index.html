<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Node中的FS核心模块(包括可读、可写传输流) - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Node中的FS核心模块(包括可读、可写传输流)" />
<meta property="og:description" content="FS核心模块(fileSystem) 在Nodejs中有一个文件系统，对计算机中的文件进行增删改查操作。
在nodejs中我们提供了一个模块，叫做fs模块系统，专门用于操作文件系统。
在nodejs中这个模块是可以直接使用的。
使用 引入文件系统 const fs = require(&#39;fs&#39;); 读取文件 fs.readFile(path, options ,(error, data) =&gt; {});
此方法用于读取文件，传入三个参数，
第一个参数是文件路径&#43;文件名，相较于自身文件来说
第二个参数是可配置项
第三个参数是回调函数，用于处理文件读取的结果操作，回调接收两个参数，一个是失败到的结果，一个是成功的结果
fs.readFile(&#39;../text/demo.txt&#39;, (error, data) =&gt; { if(error){ console.log(&#39;读取失败&#39;); return; } console.log(&#39;读取成功\n&#39;, data); }); // 读取成功 //&lt;Buffer 2b 20 e8 bf 99 e6 98 af e4 b8 80 e6 ae b5 e8 a2 ab e8 af bb e5 8f 96 e7 9a 84 e6 96 87 e4 bb b6&gt; 注意 在读取成功时，返回的是buffer对象保存的一段16进制的值。可以使用toString()来转成字符串。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/c3406bfd16358a53bbdb3d56acfd7caa/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-16T16:50:52+08:00" />
<meta property="article:modified_time" content="2022-03-16T16:50:52+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Node中的FS核心模块(包括可读、可写传输流)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="FSfileSystem_0"></a>FS核心模块(fileSystem)</h3> 
<p>在Nodejs中有一个文件系统，对计算机中的文件进行增删改查操作。</p> 
<p>在nodejs中我们提供了一个模块，叫做fs模块系统，专门用于操作文件系统。</p> 
<p>在nodejs中这个模块是可以直接使用的。</p> 
<hr> 
<h4><a id="_10"></a>使用</h4> 
<ul><li>引入文件系统</li></ul> 
<pre><code class="prism language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="_20"></a>读取文件</h4> 
<blockquote> 
 <p>fs.readFile(path, options ,(error, data) =&gt; {});</p> 
</blockquote> 
<p>此方法用于读取文件，传入三个参数，</p> 
<p>第一个参数是文件路径+文件名，相较于自身文件来说</p> 
<p>第二个参数是可配置项</p> 
<p>第三个参数是回调函数，用于处理文件读取的结果操作，回调接收两个参数，一个是失败到的结果，一个是成功的结果</p> 
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'../text/demo.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取成功\n'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 读取成功 </span>
<span class="token comment">//&lt;Buffer 2b 20 e8 bf 99 e6 98 af e4 b8 80 e6 ae b5 e8 a2 ab e8 af bb e5 8f 96 e7 9a 84 e6 96 87 e4 bb b6&gt;</span>
</code></pre> 
<p>注意 在读取成功时，返回的是buffer对象保存的一段16进制的值。可以使用toString()来转成字符串。</p> 
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'../text/demo.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取成功'</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//读取成功</span>
<span class="token comment">// + 这是一段被读取的文件</span>
</code></pre> 
<p>当路径出现错误或者文件读取出现未知的错误时，则会打印错误对象<code>error</code></p> 
<pre><code class="prism language-txt">   //      ---------读取成功
    //        date------数据
    //        error-----null
    //      ---------读取失败
    //        date------null
    //        error-----错误对象
</code></pre> 
<ul><li>同步读取文件</li></ul> 
<blockquote> 
 <p>let data = fs.readFileSync(path, option)</p> 
</blockquote> 
<p>和普通读取文件作用类似，只不过在读取文件操作时会阻塞同步代码的执行。</p> 
<hr> 
<ul><li><code>流式文件读取</code>(重要)</li></ul> 
<p>相较与简单文件读取的区别</p> 
<blockquote> 
 <p><strong>简单读取文件，即在读取文件时一次将文件读取，一步完成</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>流式文件读取，即先开启读取文件的通道(读取流)，后面可多次读取文件，多步完成</strong></p> 
</blockquote> 
<pre><code>// 普通文件读取
const fs = require('fs');
// 流式文件读取
const rs = fs.createReadStream(path, options);
</code></pre> 
<p>path : 读取路径和文件</p> 
<p>options : 可配置对象</p> 
<pre><code class="prism language-options">{

​	--- flags ：打开文件要执行的操作，默认值为'w'

​	--- encoding : 设置文件的编码方式，默认为utf8

​	--- mode : 设置文件的操作权限， 默认0o666 = 0o222 +0o444(即可被读取写入)

​	--- fd : 文件统一标识符，

​	--- autoClose ：自动关闭文件流  默认为true

​	--- emitClose ： 关闭(出现问题) --- 文件 ，默认为false

​	--- start ：读取文件的初始位置

​   --- end ：读取文件的结束位置
 
​   --- highWaterMark : 控制每次读取数据的大小， 默认值是 64 * 1024

}
</code></pre> 
<p>使用</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建可读流</span>
<span class="token keyword">const</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/text/newText.txt'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//检测可读流是否打开</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可读流打开了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//检测可读流是否关闭</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可读流关闭了'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//读取文件</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//获取到的每一段的buffer数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//data.length表示该buffer实例占用内存空间的大小</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//输出64 ---》 每一次读取64kb大小的数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//读取的时候如果文件读取完了，会自动关闭可读流</span>
</code></pre> 
<hr> 
<h4><a id="_164"></a>写入文件</h4> 
<blockquote> 
 <p>fs.writeFile(path, options, callback);</p> 
</blockquote> 
<p>此方法用于写入文件，传入三个参数，</p> 
<p>第一个参数是文件路径+文件名，相较于自身文件来说</p> 
<p>第二个参数是写入的文件内容。</p> 
<p>第三个参数是可配置项</p> 
<pre><code>
​		--- encoding: 设置文件的编码方式，默认为utf8

​		--- mode: 设置文件的操作权限， 默认0o666 = 0o222 +0o444(即可被读取写入)

​							-- 0o111 : 文件可被执行的权限

​							-- 0o222 ：文件可被写入的权限

​							-- 0o444 ：文件可被读取的权限

​		--- falg：打开文件要执行的操作，默认值为'w'

​							-- 'w' : 追加

​							-- ‘a’ : 写入
</code></pre> 
<p>第四个参数是回调函数，用于处理文件写入的结果操作，回调接收两个参数，一个是失败到的结果，一个是成功的结果</p> 
<pre><code class="prism language-js"><span class="token comment">// 写入文件</span>
fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./text/write.txt'</span><span class="token punctuation">,</span> <span class="token string">'这是一段写入的内容'</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>mode<span class="token punctuation">:</span> <span class="token number">0o222</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'写入失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//读取文件</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./text/write.txt'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>error<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'读取失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取成功\n'</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    
<span class="token comment">// 写入成功 undefined</span>
    
<span class="token comment">// 读取成功</span>
<span class="token comment">// 这是一段写入的内容</span>

</code></pre> 
<hr> 
<ul><li>同步写入文件</li></ul> 
<blockquote> 
 <p>let data = fs.writeFileSync(path, options);</p> 
</blockquote> 
<ul><li><code>流式文件写入</code>(重要)</li></ul> 
<p>相较与简单文件写入的区别</p> 
<blockquote> 
 <p><strong>简单写入文件，即在写入文件时一次将文件写入，一步完成</strong></p> 
</blockquote> 
<blockquote> 
 <p><strong>流式文件写入，即先开启写入文件的通道(可写流)，后面可多次写入文件，多步完成</strong></p> 
</blockquote> 
<p>使用<code>fs.createWriteStream(path, option)</code>创建写入文件流</p> 
<p>有两个参数</p> 
<p>第一个参数为写入的文件路径 + 文件名 + 文件名后缀</p> 
<p>第二个参数为可选配置对象</p> 
<pre><code class="prism language-option">{

​	--- flags ：打开文件要执行的操作，默认值为'w'

​	--- encoding : 设置文件的编码方式，默认为utf8

​	--- mode : 设置文件的操作权限， 默认0o666 = 0o222 +0o444(即可被读取写入)

​	--- fd : 文件统一标识符，

​	--- autoClose ：自动关闭文件流  默认为true

​	--- emitClose ： 关闭(出现问题) --- 文件 ，默认为false

​	--- start ：写入文件的初始位置

}
</code></pre> 
<p>使用文件读写</p> 
<pre><code class="prism language-js"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建写入流</span>
<span class="token keyword">let</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'demo.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检测可写流的状态(必须), 流打开时调用回调</span>
ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可写流打开'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 流关闭时调用回调</span>
ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可写流已关闭'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//使用可写流写入数据</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'第一段写入数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'写入的第二段数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'写入第三段的数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭可写流（避免创建的可写流过多，导致内存溢出）</span>

<span class="token comment">// 在node8中使用此方法关闭流会导致数据的丢失</span>
ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//node8版本中使用此方法</span>
ws<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<hr> 
<p>注意：</p> 
<p>简单读取和简单写入文件都试一次完成的，当读写的数据量过于庞大时，会出现内存溢出。</p> 
<p>如，当存入10gb的数据，而内存只有8gb时，读取的文件不能一次性放入内存中，那么就会出现错误，无法读取，当写入的数据量过于庞大时，内存中的文件数据一次性不能写入硬盘，也会出现写入错误。</p> 
<p>流式读取，流式写入可以避开这些问题，写入读取时可以分部执行。</p> 
<hr> 
<h4><a id="_320"></a>综合可读流，可写流案例。</h4> 
<pre><code class="prism language-js"><span class="token comment">// 案例：将text文件夹下的音频读取出来，然后写入到当前文件夹下</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建可写流</span>
<span class="token keyword">const</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/音频.mp3`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建可读流</span>
<span class="token keyword">const</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/text/橘子海 (Orange Ocean) - 夏日漱石 (Summer Cozy Rock).mp3`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span>
    highWaterMark<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">//每次读取10mb数据</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检测可写流</span>
ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可写流开启'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ws<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可写流关闭'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检测可读流</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可读流开启'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可读流关闭'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 在可读流关闭时关闭可写流</span>
    ws<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 读取数据</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 分流写入数据</span>
    ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<h4><a id="__366"></a>检测是文件还是目录(目录 文件是否存在)</h4> 
<pre><code class="prism language-js"><span class="token comment">// fs.stat 检测是文件还是目录 fs.statSync()同步获取stats对象,通过返回值接收。</span>
fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span><span class="token string">'./ttt'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span>stats<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件：'</span><span class="token operator">+</span>stats<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'目录：'</span><span class="token operator">+</span>stats<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_378"></a>写入追加文件</h4> 
<p><code>fs.appendFile</code></p> 
<pre><code class="prism language-js"><span class="token comment">// fs.appendFile 追加文件 </span>
fs<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span><span class="token string">'./index.txt'</span><span class="token punctuation">,</span><span class="token string">'新写入的'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_390"></a>删除文件</h4> 
<p><code>fs.unlink</code></p> 
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除文件成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_401"></a>创建文件目录</h4> 
<p><code>fs.mkdir</code></p> 
<pre><code class="prism language-js"><span class="token comment">//2. fs.mkdir 创建目录 </span>
fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string">'TEXT'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'创建目录成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_413"></a>读取目录</h4> 
<p>fs.readdir 读取目录下第一级内容<br> 把目录下面的文件和文件夹全部获取。</p> 
<pre><code class="prism language-js">fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span><span class="token string">'./TEXT'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//data是数组类型，包含文件夹以及文件的名字(只有第一级目录内容)。拿到一个文件夹下面的所有目录 </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_426"></a>删除文件目录</h4> 
<p><code>fs.rmdir</code> 删除目录</p> 
<pre><code class="prism language-js"><span class="token comment">// rmdir 这个方法只能删除目录，不能删除文件 </span>
fs<span class="token punctuation">.</span><span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token string">'/text'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'删除目录成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_438"></a>重命名</h4> 
<p>通过<code>fs.rename</code>实现</p> 
<pre><code class="prism language-js"><span class="token comment">// 1.改名 2.剪切文件(移动) </span>
fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span><span class="token string">'./n.html'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'修改名字成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f980e68b90ebd708cf011e0f2699ea4f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">IDEA关闭git提交代码时的代码检测</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/0f50e82314f9ccd5d977eb80d0894fd5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">计算机二级（C语言）备考</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>