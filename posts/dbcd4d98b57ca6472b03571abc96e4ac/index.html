<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>datepart函数 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="datepart函数" />
<meta property="og:description" content="DatePart Basic 语法和 Crystal 语法。
重载 DatePart (intervalType, inputDateTime) DatePart (intervalType, inputDateTime, firstDayOfWeek) DatePart (intervalType, inputDateTime, firstDayOfWeek, firstWeekOfYear) 参数 intervalType 是一个字符串表达式，用来指定要返回的日期部分。可能的值为： 间隔类型值 说明 yyyy
提取年份
q
季度（结果是 1、2、3 或 4）
m
月（结果是从 1 到 12 之间的数)
y
一年中的某天（从 1 到 365，闰年是从 1 到 366）
d
日期的天部分（1 到 31）
w
一周中的某天（1 到 7，其结果取决于 firstDayOfWeek）
ww
一年中的某周（1 到 53，firstDayOfWeek 和 firstWeekOfYear 确定一年中第一个日历周的确切天数）
h
提取给定日期时间的小时部分（0 到 23）
n
分钟部分（0 到 59）
s" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/dbcd4d98b57ca6472b03571abc96e4ac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2007-01-24T12:29:00+08:00" />
<meta property="article:modified_time" content="2007-01-24T12:29:00+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">datepart函数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h4 class="newpage">DatePart</h4> 
<p><a name="807592"></a>Basic 语法和 Crystal 语法。</p> 
<a name="807594"></a> 
<h6>重载</h6> 
<ul type="disc"><li><a name="807596"></a> 
 </li><li>DatePart (intervalType, inputDateTime) <a name="807598"></a></li><li>DatePart (intervalType, inputDateTime, firstDayOfWeek) <a name="807600"></a></li><li>DatePart (intervalType, inputDateTime, firstDayOfWeek, firstWeekOfYear) </li></ul> 
<a name="807602"></a> 
<h6>参数</h6> 
<ul type="disc"><li><a name="807604"></a> 
 </li><li>intervalType 是一个字符串表达式，用来指定要返回的日期部分。可能的值为： <p><a name="807607"></a> </p> 
  <table border="1"><tbody><tr><th align="left"><a name="789142"></a>间隔类型值 </th><th align="left"><a name="789144"></a>说明 </th></tr><tr><td align="left"> <p><a name="789150"></a>yyyy</p> </td><td align="left"> <p><a name="789152"></a>提取年份</p> </td></tr><tr><td align="left"> <p><a name="789158"></a>q</p> </td><td align="left"> <p><a name="789160"></a>季度（结果是 1、2、3 或 4）</p> </td></tr><tr><td align="left"> <p><a name="789166"></a>m</p> </td><td align="left"> <p><a name="789168"></a>月（结果是从 1 到 12 之间的数)</p> </td></tr><tr><td align="left"> <p><a name="789174"></a>y</p> </td><td align="left"> <p><a name="789176"></a>一年中的某天（从 1 到 365，闰年是从 1 到 366）</p> </td></tr><tr><td align="left"> <p><a name="789182"></a>d</p> </td><td align="left"> <p><a name="789184"></a>日期的天部分（1 到 31）</p> </td></tr><tr><td align="left"> <p><a name="789190"></a>w</p> </td><td align="left"> <p><a name="789192"></a>一周中的某天（1 到 7，其结果取决于 firstDayOfWeek）</p> </td></tr><tr><td align="left"> <p><a name="789198"></a>ww</p> </td><td align="left"> <p><a name="789200"></a>一年中的某周（1 到 53，firstDayOfWeek 和 firstWeekOfYear 确定一年中第一个日历周的确切天数）</p> </td></tr><tr><td align="left"> <p><a name="789206"></a>h</p> </td><td align="left"> <p><a name="789208"></a>提取给定日期时间的小时部分（0 到 23）</p> </td></tr><tr><td align="left"> <p><a name="789214"></a>n</p> </td><td align="left"> <p><a name="789216"></a>分钟部分（0 到 59）</p> </td></tr><tr><td align="left"> <p><a name="789222"></a>s</p> </td><td align="left"> <p><a name="789224"></a>秒钟部分（0 到 59）</p> </td></tr></tbody></table> <p></p> <a name="807609"></a></li><li>inputDateTime 是要从中提取部分内容的日期时间值。 <a name="807615"></a></li><li>firstDayOfWeek 是一个可选常量，用于指定一周的第一天。如果没有指定，则使用 crSunday。有关更多信息，请参阅 <a href="http://it.kuainiu.com/online/crystal/Operators71.html#483482" rel="nofollow">周中日常量</a>。 <a name="807621"></a></li><li>firstWeekOfYear 是一个可选常量，用于指定一年中的第一周。如果未指定，则假定第一周是 1 月 1 日所在的周 (crFirstJan1)。请参阅<a href="http://it.kuainiu.com/online/crystal/Operators72.html#483493" rel="nofollow">每年的第一周常量</a>。 </li></ul> 
<a name="807623"></a> 
<h6>返回</h6> 
<p><a name="807625"></a>一个数字值。</p> 
<a name="807627"></a> 
<h6>操作</h6> 
<p><a name="807629"></a>DatePart 返回一个数字，指定给定日期的给定部分。</p> 
<a name="807631"></a> 
<h6>示例</h6> 
<p><a name="807633"></a>下列示例适用于 Basic 语法和 Crystal 语法：</p> 
<p><code><a name="807635"></a>DatePart ("d", #August 15, 1999#)</code></p> 
<p class="example"><a name="807637"></a>返回 15。</p> 
<p><code><a name="807639"></a>DatePart ("m", #August 15, 1999#)</code></p> 
<p class="example"><a name="807641"></a>返回 8。</p> 
<p><code><a name="807643"></a>DatePart ("n", #10:35 am#)</code></p> 
<p class="example"><a name="807645"></a>返回 35。</p> 
<p><code><a name="807647"></a>DatePart ("q", #September 29, 1999#)</code></p> 
<p class="example"><a name="807649"></a>返回 3，因为 9 月 29 日属于该年的第三个季度。</p> 
<p><code><a name="807651"></a>DatePart ("ww", #September 14, 1997#)</code></p> 
<p class="example"><a name="807653"></a>返回 38，因为 1997 年 9 月 14 日属于 1997 年的第 38 周。</p> 
<p><a name="807655"></a>假定某家公司希望在其每件货物上标一个 id 号，以便于质量控制。此 id 由订单 id 后接一根短线、订单发运的周和年份的最后两位数字组成。如下示例公式产生这些 ID：</p> 
<p class="CodeFirst"><a name="807657"></a>Rem Basic 语法<br></p> 
<p class="Code"><a name="807659"></a>formula = CStr({订单.订单 ID}, 0, "") &amp; "-" &amp; _<br></p> 
<p class="Code"><a name="807661"></a>            CStr(DatePart("ww", {订单.发货日期}), 0) &amp; _<br></p> 
<p class="Code"><a name="807663"></a>            CStr({订单.发货日期}, "yy")<br></p> 
<p class="Code"><a name="807665"></a><br></p> 
<p class="Code"><a name="807667"></a>//Crystal 语法<br></p> 
<p class="Code"><a name="807669"></a>CStr({订单.订单 ID}, 0, "") &amp; "-" &amp;<br></p> 
<p class="Code"><a name="807671"></a>     CStr(DatePart("ww", {订单.发货日期}), 0) &amp;<br></p> 
<p class="CodeLast"><a name="807673"></a>     CStr({订单.发货日期}, "yy")<br></p> 
<p class="example"><a name="807675"></a>如果 {订单.订单 ID} 是 2082，{订单.发货日期} 是 1997 年 9 月 14 日，则返回字符串“2082 
 
   -3 
 897”。</p> 
<a name="807677"></a> 
<h6>注释</h6> 
<p><a name="807679"></a>此函数的使用类似 Visual Basic 的同名函数。</p> 
<p><a name="807681"></a>带有“yyyy”intervalType 参数的 DatePart 函数与 Year 函数相同。同样，带有“m”、“d”、“w”、“h”、“n”和“s”intervalType 参数的 DatePart 函数分别与 Month、Day、Weekday（或 DayOfWeek）、Hour、Minute 和 Second 函数相同。另一方面，对于“q”、“y”和“ww”intervalType 参数，除使用 DatePart 函数外没有其他简单的办法。</p> 
<p><a name="807683"></a>当间隔类型参数是“w”或“ww”时，firstDayOfWeek 参数会影响 DatePart 函数。对于所有其他 intervalType 参数值，将其忽略。</p> 
<p><a name="807685"></a>只有当 intervalType 参数是“ww”时，firstWeekOfYear 参数才影响 DatePart 函数。对于所有其他 intervalType 参数值，将其忽略。 </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3492139d4a9583ff559717ae2284de97/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">确定包含全角和半角字符的字符串长度（VB）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e046f3ecd2a6069c6cdd318167943660/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">系统设计模式一</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>