<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>LearnOpenGL学习笔记—入门06  附：关于四元数 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="LearnOpenGL学习笔记—入门06  附：关于四元数" />
<meta property="og:description" content="LearnOpenGL学习笔记—入门06 附：关于四元数 关于四元数1 四元数的可视化1.1 从一维到复数1.1.1 左为变换作用，右为点1.1.2 从一维看旋转？1.1.3 球极投影 1.2 从二维到球体旋转1.3 三维人看四元数1.3.1 四元数1.3.2 四元数的球极投影1.3.3 四元数的乘法 2 四元数与三维转动2.1 公式如何产生？2.2 四元数化为旋转矩阵形式2.3 实现 关于四元数 避免万向节死锁的真正解决方案是使用四元数(Quaternion)
本节关于四元数的理解以及它对三维旋转的作用，主要对3Blue1Brown的视频进行了描述和理解，可以从这两个视频找到它：四元数的可视化，四元数和三维转动
官方网站是这里，有互动视频可以实操一下。
1 四元数的可视化 这个视频中，3B1B给我们建立了直观印象，看四元数对四维空间都干了什么，以此来可以更好理解四元数的公式
视频中分了以下几个主题展开
1.怎样让一个只能理解一维的人来理解复数2.向只能理解二维的人描述三维旋转3.在三维的约束下，表现四元数在干什么 1.1 从一维到复数 假设一个一维人，“小莱”，它只能理解一维几何和实数，我们向他描述复数。
我们可以选择纯代数的方法来定义复数。
以及定义复数的乘法
但是这样，“小莱”并没有清楚复数的意义在几何和空间直觉，它那非常有用的作用究竟是什么。
1.1.1 左为变换作用，右为点 我们作为理解二维空间的人，可以这么理解复数乘法
如下图的Z·W，我们可以把Z看成是对这个平面的一个变换，1通过这个变换得到了Z，而0通过这个变换则没有改变
于是Z·W，是让W以及它所在的平面进行了这么个变换，得到了对应的结果，并且在二维空间中有且只有这一种拉伸旋转（Z这种变换）才能做到。
我们在接下来理解四元数乘法时，也需要用到这种思想，即左边是一个变换的“函数”，去变换右边的数，并且理解左边的这个“函数”，是怎么变换整个空间的。
对于复数是一种“作用”的理解，可以点击这里进行复习。
1.1.2 从一维看旋转？ 现在回到“小莱”的身上，作为一维人的它，非常熟悉拉伸的变换，也就是实数的乘法。
多维上，每一维度的变换本质上没什么不同，“小莱”都可以理解，难的是如何和“小莱”介绍旋转。
比如复平面上的单位圆，上面的点到0的距离都是1，所以乘上这些点就对应着纯旋转，我们要如何对“小莱”解释这些复数乘法呢？
我们可能会觉得很难考虑，毕竟旋转是一个二维的东西。
但是旋转只有一个自由度，只有代表角度的数字，每一个角度唯一确定一个旋转。
所以所有二维旋转的集合可以把它映射到一维的数轴上，那里就是“小莱”的家。
如何进行映射，有很多方法，这次使用的是“球极投影”。
球极投影可以将圆映射到直线，球映射到平面，乃至四维超球到三维空间
1.1.3 球极投影 从-1出发做直线，穿过单位圆上的每一个点，取这条线与纵轴的交点，这便是圆上的点被投影到的地方。
点1被映射到直线的中心保持不动，i与-i也是如此。从i到1上这个90度上的所有的点，被映射到，1的对应点和i的对应点之间。i到-1这个圆弧上的点，则被映射到，i的对应点与正无穷之间。-1到i的圆弧上的点，则被映射到，-i的对应点与负无穷之间。-1本来不会映射到上面去，但是我们可以说，-1被映射到了无穷远的点上，无论沿着什么方向，走到无穷远就能看到-1对应的位置。 而这组由映射点组成的线，就是“小莱”能看懂的东西了。
这根线，仅仅是复数中距离原点长度为1的那些，即单位圆，其他的复数比如0,1&#43;i,2等等，“小莱”并看不到。
但是没有关系，我们要做的，只是让“小莱”了解那些乘法中代表旋转的复数Z，所以只需要理解单位圆就可以了。
在圆上的旋转作用，映射到线上成为了变形的效果。
i·1=i → 1这个点进行了i这个变换（逆时针90度），对应到线上，1这个位置的点移动到了i的位置上。i·i=-1 → i这个点进行了i这个变换（逆时针90度），对应到线上，i这个位置的点移动到了-1，即移动到了无穷远。i·-1=-i → -1这个点进行了i这个变换（逆时针90度），对应到线上，-1这个位置的点移动到了-i，即从无穷远移到了-i。i·-i=1 → -i这个点进行了i这个变换（逆时针90度），对应到线上，-i这个位置的点移动到了1的位置上。 虽然是有些奇怪的运动，但是我们依靠这个方法传达了一些思想，比如，被i连乘了四次，对应着转了4次90度，我们会回到原来的地方。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/03b02d5ccafdd58599908ef605cccd63/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-24T01:53:20+08:00" />
<meta property="article:modified_time" content="2020-07-24T01:53:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">LearnOpenGL学习笔记—入门06  附：关于四元数</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>LearnOpenGL学习笔记—入门06 附：关于四元数</h4> 
 <ul><li><a href="#_1" rel="nofollow">关于四元数</a></li><li><a href="#1__5" rel="nofollow">1 四元数的可视化</a></li><li><ul><li><a href="#11__11" rel="nofollow">1.1 从一维到复数</a></li><li><ul><li><a href="#111__18" rel="nofollow">1.1.1 左为变换作用，右为点</a></li><li><a href="#112__28" rel="nofollow">1.1.2 从一维看旋转？</a></li><li><a href="#113__41" rel="nofollow">1.1.3 球极投影</a></li></ul> 
   </li><li><a href="#12__62" rel="nofollow">1.2 从二维到球体旋转</a></li><li><a href="#13__94" rel="nofollow">1.3 三维人看四元数</a></li><li><ul><li><a href="#131__95" rel="nofollow">1.3.1 四元数</a></li><li><a href="#132__108" rel="nofollow">1.3.2 四元数的球极投影</a></li><li><a href="#133__140" rel="nofollow">1.3.3 四元数的乘法</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2__198" rel="nofollow">2 四元数与三维转动</a></li><li><ul><li><a href="#21__214" rel="nofollow">2.1 公式如何产生？</a></li><li><a href="#22__271" rel="nofollow">2.2 四元数化为旋转矩阵形式</a></li><li><a href="#23__290" rel="nofollow">2.3 实现</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>关于四元数</h2> 
<p>避免万向节死锁的真正解决方案是使用<strong>四元数</strong>(Quaternion)<br> 本节关于四元数的理解以及它对三维旋转的作用，主要对3Blue1Brown的视频进行了描述和理解，可以从这两个视频找到它：<a href="https://www.bilibili.com/video/av33385105" rel="nofollow">四元数的可视化</a>，<a href="https://www.bilibili.com/video/BV1Lt411U7og" rel="nofollow">四元数和三维转动</a><br> 官方网站是<a href="https://eater.net/quaternions" rel="nofollow">这里</a>，有互动视频可以实操一下。</p> 
<h2><a id="1__5"></a>1 四元数的可视化</h2> 
<p>这个视频中，3B1B给我们建立了直观印象，看四元数对四维空间都干了什么，以此来可以更好理解四元数的公式<br> 视频中分了以下几个主题展开</p> 
<ul><li>1.怎样让一个只能理解一维的人来理解复数</li><li>2.向只能理解二维的人描述三维旋转</li><li>3.在三维的约束下，表现四元数在干什么</li></ul> 
<h3><a id="11__11"></a>1.1 从一维到复数</h3> 
<p>假设一个一维人，“小莱”，它只能理解一维几何和实数，我们向他描述复数。<br> 我们可以选择纯代数的方法来定义复数。<br> <img src="https://images2.imgbox.com/a1/80/1l01fjGI_o.png" alt="在这里插入图片描述"><br> 以及定义复数的乘法<br> <img src="https://images2.imgbox.com/e4/e0/hM2I566o_o.png" alt="在这里插入图片描述"><br> 但是这样，“小莱”并没有清楚复数的意义在几何和空间直觉，它那非常有用的作用究竟是什么。</p> 
<h4><a id="111__18"></a>1.1.1 左为变换作用，右为点</h4> 
<p>我们作为理解二维空间的人，可以这么理解复数乘法</p> 
<ul><li>如下图的Z·W，我们可以把Z看成是对这个平面的一个变换，1通过这个变换得到了Z，而0通过这个变换则没有改变<br> <img src="https://images2.imgbox.com/9c/e1/l7qNTAeD_o.png" alt="在这里插入图片描述"></li><li>于是Z·W，是让W以及它所在的平面进行了这么个变换，得到了对应的结果，并且在二维空间中有且只有这一种拉伸旋转（Z这种变换）才能做到。<br> <img src="https://images2.imgbox.com/8b/e6/mPH0yjvt_o.png" alt="在这里插入图片描述"></li></ul> 
<p>我们在接下来理解四元数乘法时，也需要用到这种思想，即左边是一个变换的“函数”，去变换右边的数，并且理解左边的这个“函数”，是怎么变换整个空间的。<br> <img src="https://images2.imgbox.com/56/c3/35yiZ0w1_o.png" alt="在这里插入图片描述"><br> 对于复数是一种“作用”的理解，可以点击<a href="https://www.bilibili.com/video/av11339177" rel="nofollow">这里</a>进行复习。</p> 
<h4><a id="112__28"></a>1.1.2 从一维看旋转？</h4> 
<p>现在回到“小莱”的身上，作为一维人的它，非常熟悉拉伸的变换，也就是实数的乘法。<br> 多维上，每一维度的变换本质上没什么不同，“小莱”都可以理解，难的是如何和“小莱”介绍旋转。<br> 比如复平面上的单位圆，上面的点到0的距离都是1，所以乘上这些点就对应着纯旋转，我们要如何对“小莱”解释这些复数乘法呢？<br> <img src="https://images2.imgbox.com/2e/25/DnhRq4KG_o.png" alt="在这里插入图片描述"></p> 
<p>我们可能会觉得很难考虑，毕竟旋转是一个二维的东西。<br> 但是旋转只有一个自由度，只有代表角度的数字，每一个角度唯一确定一个旋转。<br> 所以所有二维旋转的集合可以把它映射到一维的数轴上，那里就是“小莱”的家。<br> 如何进行映射，有很多方法，这次使用的是“球极投影”。<br> 球极投影可以将圆映射到直线，球映射到平面，乃至四维超球到三维空间<br> <img src="https://images2.imgbox.com/fe/43/A7t6AZZC_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/0b/0f/9VHB8oo1_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="113__41"></a>1.1.3 球极投影</h4> 
<p>从-1出发做直线，穿过单位圆上的每一个点，取这条线与纵轴的交点，这便是圆上的点被投影到的地方。<br> <img src="https://images2.imgbox.com/94/8e/OuiwUsOJ_o.png" alt="在这里插入图片描述"></p> 
<ul><li>点1被映射到直线的中心保持不动，i与-i也是如此。</li><li>从i到1上这个90度上的所有的点，被映射到，1的对应点和i的对应点之间。</li><li>i到-1这个圆弧上的点，则被映射到，i的对应点与正无穷之间。</li><li>-1到i的圆弧上的点，则被映射到，-i的对应点与负无穷之间。</li><li>-1本来不会映射到上面去，但是我们可以说，-1被映射到了无穷远的点上，无论沿着什么方向，走到无穷远就能看到-1对应的位置。</li></ul> 
<p>而这组由映射点组成的线，就是“小莱”能看懂的东西了。<br> <img src="https://images2.imgbox.com/3d/93/BNqc8BOq_o.png" alt="在这里插入图片描述"><br> 这根线，仅仅是复数中距离原点长度为1的那些，即单位圆，其他的复数比如0,1+i,2等等，“小莱”并看不到。<br> 但是没有关系，我们要做的，只是让“小莱”了解那些乘法中代表旋转的复数Z，所以只需要理解单位圆就可以了。<br> 在圆上的旋转作用，映射到线上成为了变形的效果。<br> <img src="https://images2.imgbox.com/dc/a0/kd9FuNMq_o.png" alt="在这里插入图片描述"></p> 
<ul><li>i·1=i → 1这个点进行了i这个变换（逆时针90度），对应到线上，1这个位置的点移动到了i的位置上。</li><li>i·i=-1 → i这个点进行了i这个变换（逆时针90度），对应到线上，i这个位置的点移动到了-1，即移动到了无穷远。</li><li>i·-1=-i → -1这个点进行了i这个变换（逆时针90度），对应到线上，-1这个位置的点移动到了-i，即从无穷远移到了-i。</li><li>i·-i=1 → -i这个点进行了i这个变换（逆时针90度），对应到线上，-i这个位置的点移动到了1的位置上。</li></ul> 
<p>虽然是有些奇怪的运动，但是我们依靠这个方法传达了一些思想，比如，被i连乘了四次，对应着转了4次90度，我们会回到原来的地方。</p> 
<h3><a id="12__62"></a>1.2 从二维到球体旋转</h3> 
<p>下面的这个纸片人“小菲”，它只能理解二维的几何，想象一下我们要如何向它解释球体的旋转<br> <img src="https://images2.imgbox.com/3f/1c/xQCIWhW4_o.png" alt="在这里插入图片描述"><br> 为了从二维的旋转过渡到四元数，我们拓展一下复数，在水平的实数轴和垂直的虚数轴上，加上第三条轴<br> <img src="https://images2.imgbox.com/c7/6f/YH394PG0_o.png" alt="在这里插入图片描述"><br> 我们让ij成为xy轴，实数轴则对应到Z轴的方向。<br> <img src="https://images2.imgbox.com/28/11/uwns11ot_o.png" alt="在这里插入图片描述"></p> 
<ul><li>这时候三维空间中的点，都可以用一个实数，加上另一个实数乘以i，再加上另一个实数乘以j来表示，如1.25+1.5i±j。</li></ul> 
<p>然而想要为这样一个三维数系定义一个乘法概念，让它满足平时的代数性质来构造出有用的乘法，根据群论的知识，这样构造出来的乘法是不封闭的，所以我们无法定义。</p> 
<p>我们想象一下向纸片人“小菲”描述这个坐标系中的三维旋转，单位球由所有到原点距离为1的数组成，即他们坐标的平方和为1。<br> <img src="https://images2.imgbox.com/73/7d/RUwqK1sf_o.png" alt="在这里插入图片描述"><br> 我们无法把三维旋转给“小菲”看，但是我们可以把这个球的二维投影进行展示。<br> 从南极处的-1开始，做一条直线穿过球上任意一点，这条线和ij平面的交点，就是球上该点的投影。<br> <img src="https://images2.imgbox.com/03/2b/OhRZsbHV_o.png" alt="在这里插入图片描述"></p> 
<ul><li>北极的1来到了平面中心，北半球的点映射到Ij平面上的单位圆内部。</li><li>通过i,j,-i,-j四点的单位圆映射后原地不动，这也是“小菲”和我们都能看见的，真实的单位球的一部分</li><li>所有南半球的点被映射到单位圆之外，同样的-1我们定义它被映射到无穷远</li></ul> 
<p>以下是映射图，粉色点代表北极旋转后的位置，黄色的圈代表赤道投影<br> <img src="https://images2.imgbox.com/e6/20/85TgGmBj_o.png" alt="在这里插入图片描述"><br> 我们可以关注于几个关键的参考点来识图追踪整个球体，<br> 经过-i,1,i,-1的单位圆，映射到了“小菲”所在的 虚平面的 i轴<br> 同时我们只是投影了单位球上的点，在三维真正的i轴上的点大部分是看不到<br> 同样的我们把经过1,j,-1,-j的单位圆，映射到了“小菲”所在的 虚平面的 j轴<br> <img src="https://images2.imgbox.com/0e/ea/R4HxPhGf_o.png" alt="在这里插入图片描述"></p> 
<ul><li>通过推理可以知道，“小菲”所在的平面上任意一个直线，都是在球面上过-1的圆的投影，某种意义上说，所有直线都是一个过无穷远的圆<img src="https://images2.imgbox.com/02/c4/19XZ5kXR_o.png" alt="在这里插入图片描述"></li><li>想象一下在“小菲”的视角中，把球体绕j轴旋转，我们把ij单位圆转到1j的单位圆<br> 在小菲的眼中就是，黄色的单位圆变成了垂直线，而红色的线变成了单位圆<br> <img src="https://images2.imgbox.com/06/59/4tpwZoSo_o.png" alt="在这里插入图片描述"><br> 我们看到的是旋转的运动，在“小菲”看来，就是比较扭曲的投影效果，从单位圆到水平直线的变化</li></ul> 
<h3><a id="13__94"></a>1.3 三维人看四元数</h3> 
<h4><a id="131__95"></a>1.3.1 四元数</h4> 
<p>复数有一个虚部，不存在的“三维复数”有两个虚部，四元数则有三个虚数维度<br> <img src="https://images2.imgbox.com/18/95/saMpKMf6_o.png" alt="在这里插入图片描述"><br> 这三个虚数维度都和实数轴垂直，同时它们自己也互相垂直<br> <img src="https://images2.imgbox.com/0e/64/qWGJ3deK_o.png" alt="在这里插入图片描述"><br> 四元数有四个实数，可以把它拆解成一个实部/标量，加上一个三维的虚部。<br> 这个三维的虚部，即没有标量部分的四元数，也就是向量（vector）。<br> 我们可以直接定义出四元数乘法，给出ijk的乘法规则，规定它们满足分配律的方式。<br> 这也是我们告诉计算机来算四元数的方式。<br> <img src="https://images2.imgbox.com/7b/c4/HGtEgYhI_o.png" alt="在这里插入图片描述"><br> 对于矩阵乘法，四元数乘法更加简洁，所以它在图形学编程和其他领域十分有用。<br> 我们也可以用点积和叉积的形式来表示<br> <img src="https://images2.imgbox.com/15/47/BrhKJbcu_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="132__108"></a>1.3.2 四元数的球极投影</h4> 
<p>但是正如深入理解复数乘法需要理解它的几何意义——乘一个复数代表进行了一个缩放与旋转的变换，我们需要明白四元数乘法的四维几何意义。<br> 与二维类似，四维上的点到原点的距离，依然是每个分量进行平方和后的平方根。<br> 四元数乘法，我们可以理解为，先对四元数进行了放缩，然后进行旋转。<br> 这个特殊的四维旋转规则，就是我们要理解的内容。<br> （下图字幕应为放大q2到q1）<br> <img src="https://images2.imgbox.com/3c/79/IciSkFzN_o.png" alt="在这里插入图片描述"><br> 与之对应的是到远点距离为1的四元数组成的四维超球，与之前从一维理解旋转，到二维理解球体，如今我们需要用三维理解四元数。<br> 不仅仅是因为，四维单位超球上的点的乘法是纯粹的四维旋转，而且也因为我们可以跟踪四维超球上的一些点，来理解这种四维作用，而不需要去理解整个四维空间的所有点。<br> <img src="https://images2.imgbox.com/25/42/DxecBIzI_o.png" alt="在这里插入图片描述"><br> 就像之前的投影，我们把四维超球投影到三维空间来。<br> 按照之前的规律，1这个点，来到了投影空间的正中<br> <img src="https://images2.imgbox.com/ab/1a/66Lb9O8Q_o.png" alt="在这里插入图片描述"><br> 并且正如</p> 
<ul><li>投影过后，在i这个轴上的点，在线人“小莱”的空间保持不变，即实部为0，虚部的部分</li><li>投影过后，在ij平面的单位圆，在纸片人“小菲”的空间保持不变，即实部为0，虚部的部分</li></ul> 
<p>那么投影过后，在ijk空间的单位球，在我们三维人的空间保持不变<br> 所以我们在三维空间看到的单位球，代表着四维超球投影到我们空间时，不变的那一部分，即实部为0，虚部的部分。<br> <img src="https://images2.imgbox.com/bf/6a/OnAkRBqU_o.png" alt="在这里插入图片描述"><br> 这个单位球代表着四维超球上所有实部为0的四元数，也被数学界称为单位向量</p> 
<ul><li>那些实部为0到1的单位四元数，投影到了球的内部，靠近中央的1</li><li>实部从-1到0的单位四元数，则投影到球的外部</li><li>-1这个点坐落在无穷远处，从任意一个方向都能走到</li><li>整个三维空间，都是一个四维单位超球的投影，只包括了满足四个分量的平方和等于1的四元数。<br> 所以三维空间上的每一点，所对应的四元数都有着同样的模，即在四维，它到0的距离都是1。</li><li>除此以外的其他四元数，我们看不到</li><li>与之前纸片人一样，每一个线，代表了一个过-1的圆</li><li>每一个平面，代表了四维超球上的一个三维球</li><li>如果他正好是通过了1,i,j,-i,-j,以及-1的三维球，那么他就会被投影到我们所谓的xy平面</li><li>正如同过-1和1的圆，变成了过中心的所有直线→过-1,1的三维球的投影，就是过中心的所有平面。</li><li>由此也知道了，所有平面，都是四维单位超球上，过-1的三维球的投影。</li></ul> 
<h4><a id="133__140"></a>1.3.3 四元数的乘法</h4> 
<p>现在取一个单位四元数，左乘另一个四元数，这种作用可以被理解为，两个独立的二维旋转，互相垂直，同时发生。</p> 
<ul><li>第一个例子 i乘以一个四元数<br> 我们已经知道，i·1=i，也就是一维上，1这个点，会运动到i的位置（二维上的含义是，1这个点旋转到i），同样的i·i=-1等等<br> 我们把他们看成数轴上的运动，1移到i，移到无穷远，移到-i，移回1<br> 在上文“小莱”部分已经讲过，不再赘述<br> 即数轴的移动，代表了经过球极投影的，在一个平面内的旋转<br> <img src="https://images2.imgbox.com/9e/a3/LqtWpnLt_o.png" alt="在这里插入图片描述"></li><li>我们再来看通过j,k的圆，它垂直于通过1,i的圆（因为四维每两个面都互相垂直）<br> 我们把这个通过1,i的圆，投影变成了一条直线（因为这个圆在实数轴和i轴的平面里，二维到一维投影完就是i轴，在四维到三维的投影中依然是i轴）。<br> 在虚平面上的j,k圆，依然像个圆，但是复平面上的圆，就是一个线了。<br> 所以以下是，两个圆的投影图<br> <img src="https://images2.imgbox.com/2c/98/43egC7yE_o.png" alt="在这里插入图片描述"></li><li>这就形成了一种很像右手定则的东西。<br> 在这里我们先缓一下<br> 一个二维的旋转，是两个互相垂直同时发生的一维的旋转<br> 一个三维的旋转，也可以看成三个一维的旋转，或者一个二维的平面旋转加上一个一维旋转（如欧拉角）<br> 一个四维旋转，可以看成两个互相垂直同时发生的二维旋转。<br> 即上图中的两个投影出来的互相垂直的圆，同时发生旋转，一个在转，一个在数轴上移动<br> （为什么不选其他两个虚轴的圆呢，因为那样就没有右手定则似的东西了嘛~）</li><li>所以此时我们再看四元数的乘法法则<br> i·j=k 对j应用 i这个四元数旋转 会得到k<br> 拆解成刚才的图，红圈j点转到k点转了90度，并且底下的线也进行90度代表的移动<br> i·k=-j i·-j=-k i·-k=j</li><li>从计算方面<br> 如果我们知道了一个四元数对1,i,j,k会做什么，那么我们也就知道了它会对任意四元数做什么，因为满足分配律。<br> 线性代数的方法来说就是，1 i j k是四维空间的基，我们知道了对基的变换，也就知道了这个空间的变换。（线性代数也可以去看3b1b大佬的视频）</li></ul> 
<p>几何上，一个四维生物可以看到这个两个互相垂直的旋转的作用效果，并且它能知道这两个旋转唯一确定了一个四维超球的刚体运动。<br> 到三维的投影就是一个球被里外里外的翻转了（在移动放大的同时在转）<br> 经过四次迭代会回到原来的位置<br> <img src="https://images2.imgbox.com/e2/1e/la0iqTNb_o.png" alt="在这里插入图片描述"><br> 比如对下图中手旁边的这个四元数（注意，这是被投影过的，所以是数轴上的点，它本来是实轴和i轴这个复平面上的点）<br> 这个四元数给其他乘上它的四元数所带来的变换，在我们看来是把1拉到它这个位置的投影，并且jk圆按照右手法则旋转了135度。<br> <img src="https://images2.imgbox.com/3a/85/4Pba8JfQ_o.png" alt="在这里插入图片描述"><br> 再比如j来左乘，1这个点要移到j，<br> 对应的j轴代表的圆，它会有个垂直的圆在ik上<br> 1到j，然后ik圆右手定则，产生了k到i的90度旋转<br> 投影从三维球被拉成了一个平面<br> 因为j·1=j k·i=j 这两个垂直方向上在同时进行，这样才能确定一个四元数的旋转<br> <img src="https://images2.imgbox.com/4e/0b/06PamMsd_o.png" alt="在这里插入图片描述"></p> 
<ul><li>通过右手定则，可以看着这个虚轴的3d图，把乘法规则记下来。<br> 比如j·i=?<br> 对i进行j的变换，我们先看看j的变换代表什么<br> 从1到j，右手定则i会被移动到-k，即这个变换的结果是-k<br> 所以j·i=-k.</li><li>这也意味着，四元数上乘法没有交换律<br> 类比来说，旋转也没有交换律</li></ul> 
<p>对于任意的单位四元数q<br> 首先我们在四维空间画一个过1 q -1的圆，对应过来就是一个过原点的直线<br> 然后在单位球上画一个垂直它的单位圆<br> 旋转这个圆，并且让1带动拉伸到q，这就是这个四元数代表的变换。<br> <img src="https://images2.imgbox.com/6e/03/e3pMpK6C_o.png" alt="在这里插入图片描述"><br> 目前展示了把四元数作为左乘作用的理解方式，即把i视为一个函数，扭曲了整个空间，j只是一个点<br> <img src="https://images2.imgbox.com/d9/4d/pSrK5UAP_o.png" alt="在这里插入图片描述"><br> 但是如果用右乘的方式来理解，就要用到左手了，理解左手的法则，对于如何用单位四元数描述三维旋转很有用，这也是下一节的内容。<br> <img src="https://images2.imgbox.com/ed/d8/mAWAmqKc_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="2__198"></a>2 四元数与三维转动</h2> 
<p>在上一节结束后，可能会怀疑，为什么要发明这种数学体系，和外星人用的一样。<br> 其实它对描述3d方位提供了一个很好的方法，而不会受到其他方法带来的错误以及边界效应。<br> 其他方法描述旋转也有，而且易于想像，比如线性代数的旋转矩阵，并且我们构建旋转矩阵时，往往是想像三根垂直的柱子，他们的旋转角也被叫做欧拉角<br> <img src="https://images2.imgbox.com/7e/9a/0ftZD6hA_o.png" alt="在这里插入图片描述"><br> 它的问题是万向节锁，也就是两条旋转轴重合时，系统会失去一个自由度，并且在两个不同方向上插值的时候，也会造成困难（关于这些问题网上也有很多资源描述）<br> 四元数不仅避免了万向节锁，而且也提供了三维方位中插值的平滑方法，避免了欧拉角的歧义，也避免了两个旋转矩阵中插值会出现的数值精度和整化问题。<br> 下面开始介绍用用四元数描述旋转</p> 
<ul><li>首先用一个单位向量定义想要旋转的这个轴，并且i j k 归一化处理，平方和为1</li><li>用想要旋转的角构建四元数q，用半角的余弦作为实部，半角的正弦乘上虚部</li><li>取一个三维点p，用i j k表示，如果想知道将这个点绕某个轴旋转某个角度以后会出现在哪里<br> 那么我们会用<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
            
         
        
          q 
         
        
          ⋅ 
         
        
          p 
         
        
          ⋅ 
         
         
         
           q 
          
          
          
            − 
           
          
            1 
           
          
         
        
       
         \ q·p·q^{-1} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">p</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>，展开算式就是结果了<br> <img src="https://images2.imgbox.com/71/8c/R7B70C6C_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/dd/74/wBhXCTMT_o.png" alt="在这里插入图片描述"><br> 强烈建议去视频它推荐的那个<a href="https://eater.net/quaternions/video/intro" rel="nofollow">互动视频</a>去实操一遍</li></ul> 
<h3><a id="21__214"></a>2.1 公式如何产生？</h3> 
<p>我们知道，一个单位四元数代表的变换，可以拆分成这个三维投影球的旋转与垂直方向的拉伸两个部分，我们需要把旋转部分拿出来，而不进行拉伸。<br> 提到旋转就会想到角度与三角函数，而三角函数和复数的关系，我们就想到了欧拉公式。</p> 
<p>首先利用欧拉公式对四元数进行推广</p> 
<ul><li>欧拉公式在复变函数中的证明，是从<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           e 
          
         
           x 
          
         
        
       
         e^x 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>的麦克劳林公式中，把<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          x 
         
        
       
         x 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>换成<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
          x 
         
        
       
         ix 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">x</span></span></span></span></span>，然后根据<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
       
         i 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>的运算规则与<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          c 
         
        
          o 
         
        
          s 
         
        
       
         cos 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          s 
         
        
          i 
         
        
          n 
         
        
       
         sin 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span></span></span>的麦克劳林公式，证明得到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           e 
          
         
           i 
          
         
        
          x 
         
        
          = 
         
        
          c 
         
        
          o 
         
        
          s 
         
        
          x 
         
        
          + 
         
        
          i 
         
        
          s 
         
        
          i 
         
        
          n 
         
        
          x 
         
        
       
         e^ix=cosx+isinx 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">x</span></span></span></span></span></li><li>那么当<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          i 
         
        
          x 
         
        
       
         ix 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">x</span></span></span></span></span>变成<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          b 
         
        
          i 
         
        
          + 
         
        
          c 
         
        
          j 
         
        
          + 
         
        
          d 
         
        
          k 
         
        
       
         bi+cj+dk 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>时，结果又会是多少，我们又该如何下手呢<br> 下图中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          q 
         
        
          = 
         
        
          a 
         
        
          + 
         
        
          b 
         
        
          i 
         
        
          + 
         
        
          c 
         
        
          j 
         
        
          + 
         
        
          d 
         
        
          k 
         
        
       
         q=a+bi+cj+dk 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span> 也记为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          ( 
         
        
          a 
         
        
          , 
         
         
         
           v 
          
         
           ⃗ 
          
         
        
          ) 
         
        
       
         (a,\vec{v}) 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
             <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
              <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
             </svg></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><br> <img src="https://images2.imgbox.com/a8/68/yX5E5KEm_o.png" alt="在这里插入图片描述"></li></ul> 
<p>于是我们用欧拉公式转换出代表纯旋转的四维向量（即让<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          e 
         
        
          q 
         
        
       
      
        e^q 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span></span></span></span></span></span></span></span>中<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         q 
        
       
      
        q 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span></span></span></span></span>的实部为0，利用欧拉公式可以得到一个单位四元数）</p> 
<ul><li>类比原始的欧拉公式，<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
      
       
        
         
         
           e 
          
          
          
            i 
           
          
            x 
           
          
         
        
          = 
         
        
          c 
         
        
          o 
         
        
          s 
         
        
          x 
         
        
          + 
         
        
          i 
         
        
          s 
         
        
          i 
         
        
          n 
         
        
          x 
         
        
       
         e^{ix}=cosx+isinx 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.824664em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">x</span></span></span></span></span>，这代表二维的旋转，e的指数中只有旋转量，实部为0。</li></ul> 
<p>所以我们可以假设的单位四元数为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
         = 
        
       
         c 
        
       
         o 
        
       
         s 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         + 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ( 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         / 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ) 
        
       
      
        q_1=cos|\vec {v}|+sin|\vec {v}|(\vec{v}/|\vec {v}|) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span><br> 它代表的旋转角度为<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
      
        |\vec {v}| 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p> 
<p>我们要变化的点<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         p 
        
       
         ( 
        
       
         a 
        
       
         , 
        
       
         b 
        
       
         , 
        
       
         c 
        
       
         ) 
        
       
      
        p(a,b,c) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span>,把它构造一个四元数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         p 
        
       
         = 
        
       
         a 
        
       
         i 
        
       
         + 
        
       
         b 
        
       
         j 
        
       
         + 
        
       
         c 
        
       
         k 
        
       
      
        p=ai+bj+ck 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.74285em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>，实部为0<br> 这时候我们看<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
         ⋅ 
        
       
         p 
        
       
      
        q_1·p 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.63889em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">p</span></span></span></span></span><br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
      
        q_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>对<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         p 
        
       
      
        p 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span>的作用，可以想象成对这个空间的作用</p> 
<p>按照我们之前对于任意的单位四元数的操作<br> 首先我们在四维空间画一个过1 <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
      
        q_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> -1的圆（实轴和一个点组成了一个二维），对应过来就是一个过原点的直线。<br> 这条直线，也就是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          ⃗ 
         
        
       
      
        \vec{v} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.714em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span></span></span></span></span>这个方向所在的直线</p> 
<ul><li>即把复数空间这个圆上的向量，都映射到虚轴组成的空间的这个方向的线上了</li></ul> 
<p>然后在单位球上画一个垂直它的单位圆<br> 这个四元数的变换，投影过来就是<br> 空间绕着这条直线，也就是绕着<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          ⃗ 
         
        
       
      
        \vec{v} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.714em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span></span></span></span></span>右手定则旋转这个球体，转<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
      
        |\vec {v}| 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span>度，并且把1带动拉伸到<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
      
        q_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的投影位置上。</p> 
<ul><li>所谓的拉伸其实也是旋转，只不过这个二维的旋转投影过来变成了一个线</li></ul> 
<p>如下图，旋转轴选择了i轴，也就是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          v 
         
        
          ⃗ 
         
        
       
         / 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         = 
        
       
         i 
        
       
      
        \vec{v}/|\vec {v}|=i 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathdefault">i</span></span></span></span></span>，这时候<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          2 
         
        
       
         = 
        
       
         1 
        
       
      
        q_2=1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>，没有影响，右手定则转动了45度，进行了对应的拉伸<br> <img src="https://images2.imgbox.com/77/cb/W1wZENSy_o.png" alt="在这里插入图片描述"><br> 但是我们不希望拉伸，但也不希望转回去，也就是否定了继续左乘的方法，那么我们就要寻找一种新的方法，来让它能拉伸回去，又不至于回到原位</p> 
<ul><li>我们知道左乘是代表把左边视为一个函数，扭曲了整个空间，右边只是一个点。</li><li>那我们看回之前i·j=k这个式子，<br> 根据之前说过的右手定则<br> i这个变换应用到j上<br> 我们看看i这个变换代表什么，把1拉到i，右手定则j会被移动到k，即这个变换的结果是k</li><li>接下来换一种思考方式<br> 看成j这个变换应用到i上<br> 我们看看j这个变换代表什么，把1拉到j，同时根据结果，i会移动到k，这样就出现了一个左手定则。<br> <img src="https://images2.imgbox.com/e9/72/sV7PIRTI_o.png" alt="在这里插入图片描述"></li></ul> 
<p>那么在遵守乘法法则的基础上，我们想把它拉回去不回原位，就无法左乘，需要右乘上一个东西</p> 
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
         = 
        
       
         c 
        
       
         o 
        
       
         s 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         + 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ( 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         / 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ) 
        
       
      
        q_1=cos|\vec {v}|+sin|\vec {v}|(\vec{v}/|\vec {v}|) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span> ，让点1拉到了<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
      
        q_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的投影位置上<br> 从投影位置拉回去则是<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
      
        q_1 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>的逆运算<br> 四元数的逆就是与其相乘为1，答案很显然<br> <span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
         
         
           − 
          
         
           1 
          
         
        
       
         = 
        
       
         c 
        
       
         o 
        
       
         s 
        
       
         ( 
        
       
         − 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ) 
        
       
         + 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
       
         − 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ) 
        
       
         ⋅ 
        
       
         ( 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         / 
        
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
         ) 
        
       
      
        q_1^{-1}=cos(-|\vec {v}|)+sin(-|\vec {v}|)·(\vec{v}/|\vec {v}|) 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.12055em; vertical-align: -0.266308em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.854239em;"><span class="" style="top: -2.43369em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.10313em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.266308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span></p> 
<p>左乘这个逆会回到原来的状态，但是右乘的话，按照左手定则，拉伸恢复原貌，但是会在原来转动方向的基础上，再转一样的度数。</p> 
<p>这下公式就出来了，效果正如下图所示，转动了90度，拉伸恢复原状。<br> <img src="https://images2.imgbox.com/13/21/bCvOZtFU_o.png" alt="在这里插入图片描述"><br> 即，要旋转θ度，我们在四元数里的<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         ∣ 
        
        
        
          v 
         
        
          ⃗ 
         
        
       
         ∣ 
        
       
      
        |\vec {v}| 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">∣</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.20772em;"><span class="overlay" style="height: 0.714em; width: 0.471em;"> 
            <svg width="0.471em" height="0.714em" style="width:0.471em" viewbox="0 0 471 714" preserveaspectratio="xMinYMin"> 
             <path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path> 
            </svg></span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span>就要变成θ/2，并且转动方向是绕着旋转轴的右手定则方向。<br> 没有特别地从代数上去证明，用这种比较直观的方式，希望可以对四元数的操作留下一些印象，</p> 
<h3><a id="22__271"></a>2.2 四元数化为旋转矩阵形式</h3> 
<p>在实际的应用中，我们可能会需要将旋转与平移和缩放进行复合，所以需要用到四元数旋转的矩阵形式．它可以很容易地从上面这个公式推导出来。<br> 在推到之前我们先讲一下四元数的矩阵表示</p> 
<p>可以看到，四元数的相乘其实也是一个线性组合，我们同样可以将它写成矩阵的形式<br> 如果有两个四元数<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          1 
         
        
       
         = 
        
       
         a 
        
       
         + 
        
       
         b 
        
       
         i 
        
       
         + 
        
       
         c 
        
       
         j 
        
       
         + 
        
       
         d 
        
       
         k 
        
       
      
        q_1=a+bi+cj+dk 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
        
        
          q 
         
        
          2 
         
        
       
         = 
        
       
         e 
        
       
         + 
        
       
         f 
        
       
         i 
        
       
         + 
        
       
         g 
        
       
         j 
        
       
         + 
        
       
         h 
        
       
         k 
        
       
      
        q_2=e+f i+gj+hk 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span>，那么它们的乘积为<br> <img src="https://images2.imgbox.com/b4/60/QqfuCoLz_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/ba/b6/bGhQreme_o.png" alt="在这里插入图片描述"></p> 
<ul><li>注意，这个矩阵所做出的变换等价于左乘q1。<br> 因为四元数不符合交换律，所以右乘q1的变换是一个不同的矩阵，它可以使用完全相同的方法推导而得，这里我直接给出结果。下面这个矩阵所做出的变换等价于右乘q1：<br> <img src="https://images2.imgbox.com/b2/ed/49rQRayP_o.png" alt="在这里插入图片描述"></li></ul> 
<p>由此我们得到了左乘与右乘的矩阵表示</p> 
<p>所以，我们可以利用这两个公式将<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         v 
        
       
         ′ 
        
       
         = 
        
       
           
        
       
         q 
        
       
         ⋅ 
        
       
         p 
        
       
         ⋅ 
        
        
        
          q 
         
         
         
           − 
          
         
           1 
          
         
        
       
      
        v′=\ q·p·q^{-1} 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.55556em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="mord">′</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace"> </span></span><span class="base"><span class="strut" style="height: 1.00855em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">p</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>写成矩阵形式．<br> 假设<span class="katex--inline"><span class="katex"><span class="katex-mathml"> 
     
      
       
       
         a 
        
       
         = 
        
       
         c 
        
       
         o 
        
       
         s 
        
       
         ( 
        
        
        
          1 
         
        
          2 
         
        
       
         θ 
        
       
         ) 
        
       
         ， 
        
       
         b 
        
       
         = 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
        
        
          1 
         
        
          2 
         
        
       
         θ 
        
       
         ) 
        
        
        
          v 
         
        
          x 
         
        
       
         ， 
        
       
         c 
        
       
         = 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
        
        
          1 
         
        
          2 
         
        
       
         θ 
        
       
         ) 
        
        
        
          v 
         
        
          y 
         
        
       
         ， 
        
       
         d 
        
       
         = 
        
       
         s 
        
       
         i 
        
       
         n 
        
       
         ( 
        
        
        
          1 
         
        
          2 
         
        
       
         θ 
        
       
         ) 
        
        
        
          v 
         
        
          z 
         
        
       
         ， 
        
       
         q 
        
       
         = 
        
       
         a 
        
       
         + 
        
       
         b 
        
       
         i 
        
       
         + 
        
       
         c 
        
       
         j 
        
       
         + 
        
       
         d 
        
       
         k 
        
       
      
        a=cos(\frac{1}{2}θ)，b=sin(\frac{1}{2}θ)v_x，c=sin(\frac{1}{2}θ)v_y，d=sin(\frac{1}{2}θ)v_z，q=a+bi+cj+dk 
       
      
    </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19011em; vertical-align: -0.345em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.845108em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.394em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.345em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right: 0.02778em;">θ</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right: 0.03588em;">q</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.85396em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault" style="margin-right: 0.05724em;">j</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span></span></span></span></span><br> 我们就能得到(下图中因为是正交矩阵，右边的求逆就是转置)：<br> <img src="https://images2.imgbox.com/70/c1/G2Maefxl_o.png" alt="在这里插入图片描述"><br> 这个矩阵就是旋转矩阵，可以直接应用到变换中</p> 
<h3><a id="23__290"></a>2.3 实现</h3> 
<p>接下来的博客的<a href="https://blog.csdn.net/weixin_43803133/article/details/107449570">第六节</a>会去代码实现四元数的转动。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/353b379b63944c04794700cd4ac6f378/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VR全景的制作与拍摄</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c87347350f690b55b81ca76065d89545/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java字符串或数组去掉前后的中括号标签</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>