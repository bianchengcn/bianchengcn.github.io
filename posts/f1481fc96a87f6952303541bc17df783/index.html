<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>X264 codec参数相关讲解 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="X264 codec参数相关讲解" />
<meta property="og:description" content="X264 codec相关讲解：可能有人注意到了我使用的是x264的tmod..何为mod版...就是民间菊苣在官方x264的基础上又自行进行了一些编译修改..提升强化了一部分功能..本帖提供的是taro大编译的x264..故为tmod版本..前面说到码率是重中之重...那么通常会见到的码率控制模式有ABR [ Average Bitrate ]（平均目标码率模式）CBR [ Constant Bitrate ]（固定码率模式）2pass..3pass..npass（二次..三次..n次编码模式..严格来说也属于平均目标码率模式.但其码率浮动较ABR高出不少.）CRF [ Constant Ratefactor ] （固定码率系数模式）QP [ Constant Quantizer ] （固定量化值模式）但x264只提供三种码率控制模式..至于其他怎么搞出来后面再写..三种模式为：qp模式...bitrate模式..crf模式下面挨个解释一下..需要注意的是三种码率控制方法不能共存，有其一不能有另外两个！qp模式即为固定量化值（Constant Quantizer）模式来编码视频..需要注意的是这里的量化参值为P帧的量化值..I 帧（IDR帧）和B帧的量化值又由ipratio和bpratio参数来确定..不过通常这两个参数无需手动设置..简单点说qp模式就是：相对于压缩前的原视频来说..每一个 P 帧 ..I 帧 .. B帧都会固定的损失一部分质量..损失判定是固定的.但由于I P B帧的插入是不确定的..所以最终文件的大小是无法确定的.设置为qp0时将产生无损的画面输出（输出文件一般会比源文件大出数倍以上）..并且相同视觉质量时..qp模式压出的视频文件比crf模式大..bitrate模式即为固定目标码率模式..（固定目标比特率模式）..x264会试图让最终文件的整体码率与给定的码率相等..这会使最终文件的大小是确定的..适用于精确控制体积..但由于这是一次编码..所以画质上不如同等体积的crf..故一般配合pass参数使用.crf模式即固定Ratefactor模式..如果说QP是固定量化器，bitrate是固定文件最终大小..那么crf则是则是固定“肉眼质量”..crf可以提供跟QP一样的视觉的质量..但是文件更小..crf是通过降低那些“不那么重要”的帧的质量做到这一切的~..“不那么重要”意思是过于耗费码率又难以用肉眼察觉的帧....省下来的码率会用在其它更有效的帧里..其实crf就是一个浮动qp模式..其按照特定的标准..根据人眼的需求..给予每帧不同的qp值 .但玩好crf模式..和aq..psy..qcomp等参数都脱不开关系..后面会讲到~需要注意的是crf模式无法预测最终文件体积..
-------------------------另一种解释----------------------------------------------------
码率控制
qp
默认值: 未设置
三种可用的码率控制方法之一。以恒定量化值（Constant Quantizer）方式编码。此选项的参数用于指定 P 帧量化值。I 和 B 帧的量化值由 --ipratio 和 --pbratio 控制。CQ 模式的目标是恒定的量化值，这就意味着最终文件大小不可知（尽管能用一些方法预测）。参数 0 表示无损输出。同等的视觉质量下， qp 比 --crf 产生的文件要大。由于固定量化值的缘故，qp 模式会关闭自适应量化。
本选项与 --bitrate 和 --crf 是互相排斥的，就是三选一的意思。欲详细了解码率控制，参见http://git.videolan.org/?p=x264.git;a=blob_plain;f=doc/ratecontrol.txt;hb=HEAD。
可以使用 --crf 代替 qp，不过 qp 模式不需要预分析会更快一些。
参照: --bitrate, --crf, --ipratio, --pbratio" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/f1481fc96a87f6952303541bc17df783/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-08-08T12:18:47+08:00" />
<meta property="article:modified_time" content="2017-08-08T12:18:47+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">X264 codec参数相关讲解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div class="artical-content-bak main-content editor-side-new"> 
 <div class="con editor-preview-side" id="result"> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">X264 codec相关讲解：</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><img class="BDE_Image" width="198" height="58" src="https://images2.imgbox.com/3c/93/8solaJT9_o.jpg" style="border:0px;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;" alt="ab4cbcc379310a55585c7566b44543a9832610a6"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">可能有人注意到了我使用的是x264的tmod..何为mod版...就是民间菊苣在官方x264的基础上又自行进行了一些编译修改..提升强化了一部分功能..本帖提供的是taro大编译的x264..故为tmod版本..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">前面说到码率是重中之重...</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">那么通常会见到的码率控制模式有</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">ABR [ Average Bitrate ]（平均目标码率模式）</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">CBR [ Constant Bitrate ]（固定码率模式）</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">2pass..3pass..npass（二次..三次..n次编码模式..严格来说也属于平均目标码率模式.但其码率浮动较ABR高出不少.）</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">CRF [ Constant Ratefactor ] （固定码率系数模式）</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">QP [ Constant Quantizer ] （固定量化值模式）</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">但x264只提供三种码率控制模式..至于其他怎么搞出来后面再写..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">三种模式为：</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">qp模式...bitrate模式..crf模式</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">下面挨个解释一下..需要注意的是三种码率控制方法不能共存，有其一不能有另外两个！</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">qp模式</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">即为固定量化值（Constant Quantizer）模式来编码视频..需要注意的是这里的量化参值为P帧的量化值..I 帧（IDR帧）和B帧的量化值又由ipratio和bpratio参数来确定..不过通常这两个参数无需手动设置..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">简单点说qp模式就是：相对于压缩前的原视频来说..每一个 P 帧 ..I 帧 .. B帧都会固定的损失一部分质量..损失判定是固定的.但由于I P B帧的插入是不确定的..所以最终文件的大小是无法确定的.</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">设置为qp0时将产生无损的画面输出（输出文件一般会比源文件大出数倍以上）..并且相同视觉质量时..qp模式压出的视频文件比crf模式大..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">bitrate模式</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">即为固定目标码率模式..（固定目标比特率模式）..x264会试图让最终文件的整体码率与给定的码率相等..这会使最终文件的大小是确定的..适用于精确控制体积..但由于这是一次编码..所以画质上不如同等体积的crf..故一般配合pass参数使用.</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">crf模式</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">即固定Ratefactor模式..如果说QP是固定量化器，bitrate是固定文件最终大小..那么crf则是则是固定“肉眼质量”..crf可以提供跟QP一样的视觉的质量..但是文件更小..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">crf是通过降低那些“不那么重要”的帧的质量做到这一切的~..“不那么重要”意思是过于耗费码率又难以用肉眼察觉的帧....省下来的码率会用在其它更有效的帧里..</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">其实crf就是一个浮动qp模式..其按照特定的标准..根据人眼的需求..给予每帧不同的qp值 .但玩好crf模式..和aq..psy..qcomp等参数都脱不开关系..后面会讲到~</span><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">需要注意的是crf模式无法预测最终文件体积..</span></p> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br></span></p> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">-------------------------另一种解释----------------------------------------------------</span></p> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><br></span></p> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"></span></p> 
  <h2 class="ts" style="font-family:Arial;color:rgb(51,51,51);line-height:26px;"><span style="font-family:SimSun;font-size:18px;"><span style="color:#FF0000;">码率控制</span><br>qp<br>默认值: 未设置<br>三种可用的码率控制方法之一。以恒定量化值（Constant Quantizer）方式编码。此选项的参数用于指定 P 帧量化值。I 和 B 帧的量化值由 --ipratio 和 --pbratio 控制。CQ 模式的目标是恒定的量化值，这就意味着最终文件大小不可知（尽管能用一些方法预测）。参数 0 表示无损输出。同等的视觉质量下， qp 比 --crf 产生的文件要大。由于固定量化值的缘故，qp 模式会关闭自适应量化。<br>本选项与 --bitrate 和 --crf 是互相排斥的，就是三选一的意思。欲详细了解码率控制，参见<a href="http://git.videolan.org/?p=x264.git" rel="nofollow" style="color:rgb(51,102,153);text-decoration:none;">http://git.videolan.org/?p=x264.git</a>;a=blob_plain;f=doc/ratecontrol.txt;hb=HEAD。<br>可以使用 --crf 代替 qp，不过 qp 模式不需要预分析会更快一些。<br>参照: --bitrate, --crf, --ipratio, --pbratio<br><br>bitrate<br>默认值: 未设置<br>码率控制方法之二。以比特率（bitrate）作为目标的编码方式。最终文件大小可知，但最终图像质量不可知。x264 把给定的比特率作为总平均值来作为目标，也就是说每帧的比特率可能不符合给定的比特率，但是总体平均比特率符合给定的比特率。比特率的单位是 kilobits/sec（8bits = 1字节）。需要注意的是 1 kilobit 是 1000 bits，而不是 1024 位。<br>这个选项常和 --pass 一起用于2遍编码。<br>本选项与 --qp 和 --crf 是互相排斥的，就是三选一的意思。欲详细了解码率控制，参见<a href="http://git.videolan.org/?p=x264.git" rel="nofollow" style="color:rgb(51,102,153);text-decoration:none;">http://git.videolan.org/?p=x264.git</a>;a=blob_plain;f=doc/ratecontrol.txt;hb=HEAD。<br>参照: --qp, --crf, --ratetol, --pass, --stats<br><br>crf<br>默认值: 23.0<br>最后的码率控制方法：恒定比例因子。（Constant Ratefactor。也叫恒定质量）。qp 的目标是确定的量化值，bitrate的目标是确定的文件大小，crf 的目标是确定的‘质量’。这个概念就是 crf n 能给人以 qp n 相同的视觉质量，仅仅体积小一些。crf 的单位是“ratefactor”。<br>crf 依靠降低‘不太重要’帧的质量来达到减小体积的目的。在这里，‘不太重要’是指帧包含复杂或高速运动的场景，在这些地方保持与其它地方相同质量的代价很高（即耗费比特）且又缺乏可视性（就是正常播放的时候看不清楚的意思），就增加它们的量化值（量化值越大图像质量越差）。把节省下的比特用到刀刃上。<br>crf 比2遍编码方式节省时间，因为它少了一次编码。另外，crf 的最终比特率是不可预测的，即文件大小不可知。使用哪种码率控制方式取决于你。<br>本选项与 qp 和 --bitrate 是互相排斥的，就是三选一的意思。欲详细了解码率控制，参见<a href="http://git.videolan.org/?p=x264.git" rel="nofollow" style="color:rgb(51,102,153);text-decoration:none;">http://git.videolan.org/?p=x264.git</a>;a=blob_plain;f=doc/ratecontrol.txt;hb=HEAD。<br>参照: --qp, --bitrate</span></h2> 
  <p><span style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"></span><br></p> 
 </div> 
</div> 
<p>转载于:https://blog.51cto.com/danielllf/1954443</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/801a460b1c484035be8a03c7b4b1cb48/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">常见工具总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c48c59e930da738231dfbfe66f268d57/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">工具 svn 介绍和简单用法</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>