<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>vue-cli2和vue-cli3下的lib-flexible适配（移动端&#43;大屏） - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="vue-cli2和vue-cli3下的lib-flexible适配（移动端&#43;大屏）" />
<meta property="og:description" content="前言 lib-flexible 是淘宝项目组开发的一个插件，用于移动端适配，但 lib-flexible 往往并不独立出现，而是搭配 px2rem-loader 自动将css中的px转换成rem来一起做适配方案。
1. 移动端适配 lib-flexible本身就是用来做移动端适配，故使用很简单，不需要修改什么。至于 px2rem-loader，笔者没有在移动端实践过，故只是在此记录一下使用步骤。
1.1 安装 lib-flexible npm install lib-flexible --save-dev 1.2 引入 lib-flexible 在入口文件中引入lib-flexible
// main.js import &#39;lib-flexible&#39; 1.3 安装 px2rem-loader npm install px2rem-loader --save-dev 1.4 配置 px2rem-loader 1.4.1 vue-cli 2.x 1、在build/utils.js下的exports.cssLoaders添加
// 增加代码，px转rem配置（需要将px2remloader添加进loaders数组中） const px2remLoader = { loader: &#39;px2rem-loader&#39;, options: { remUnit: 75, //以设计稿750为例， 750 / 10 } } 2、修改build/utils.js下generateLoaders中的loaders配置
// 注释掉这一行 // const loaders = options.usePostCSS ? [cssLoader, postcssLoader] : [cssLoader] // 修改为 const loaders = options." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/d4e2260515a2ea9bfbae59365ffc60f7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-25T20:58:37+08:00" />
<meta property="article:modified_time" content="2021-11-25T20:58:37+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">vue-cli2和vue-cli3下的lib-flexible适配（移动端&#43;大屏）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<p>lib-flexible 是淘宝项目组开发的一个插件，用于移动端适配，但 lib-flexible 往往并不独立出现，而是搭配 px2rem-loader 自动将css中的px转换成rem来一起做适配方案。</p> 
<h2><a id="1__2"></a>1. 移动端适配</h2> 
<p>lib-flexible本身就是用来做移动端适配，故使用很简单，不需要修改什么。至于 px2rem-loader，笔者没有在移动端实践过，故只是在此记录一下使用步骤。</p> 
<h3><a id="11__libflexible_4"></a>1.1 安装 lib-flexible</h3> 
<pre><code class="prism language-javascript">npm install lib<span class="token operator">-</span>flexible <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre> 
<h3><a id="12__libflexible_9"></a>1.2 引入 lib-flexible</h3> 
<p>在入口文件中引入lib-flexible</p> 
<pre><code class="prism language-javascript"><span class="token comment">// main.js</span>
<span class="token keyword">import</span> <span class="token string">'lib-flexible'</span>
</code></pre> 
<h3><a id="13__px2remloader_16"></a>1.3 安装 px2rem-loader</h3> 
<pre><code class="prism language-javascript">npm install px2rem<span class="token operator">-</span>loader <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre> 
<h3><a id="14__px2remloader_21"></a>1.4 配置 px2rem-loader</h3> 
<h4><a id="141_vuecli_2x_22"></a>1.4.1 vue-cli 2.x</h4> 
<p>1、在<code>build/utils.js</code>下的<code>exports.cssLoaders</code>添加</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 增加代码，px转rem配置（需要将px2remloader添加进loaders数组中）</span>
  <span class="token keyword">const</span> px2remLoader <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    loader<span class="token operator">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      remUnit<span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span>  <span class="token comment">//以设计稿750为例， 750 / 10</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p>2、修改<code>build/utils.js</code>下<code>generateLoaders</code>中的<code>loaders</code>配置</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 注释掉这一行</span>
<span class="token comment">// const loaders = options.usePostCSS ? [cssLoader, postcssLoader] : [cssLoader]</span>
<span class="token comment">// 修改为</span>
<span class="token keyword">const</span> loaders <span class="token operator">=</span> options<span class="token punctuation">.</span>usePostCSS <span class="token operator">?</span> <span class="token punctuation">[</span>cssLoader<span class="token punctuation">,</span> postcssLoader<span class="token punctuation">,</span> px2remLoader<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span>cssLoader<span class="token punctuation">,</span> px2remLoader<span class="token punctuation">]</span>
</code></pre> 
<p>3、重新<code>npm run dev</code></p> 
<h4><a id="142_vuecli_3x_43"></a>1.4.2 vue-cli 3.x</h4> 
<p>3.x版本需要自己配置，在项目根目录新建的vue.config.js下，添加如下配置后重新启动</p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">oneOf</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">resourceQuery</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\?vue</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'px2rem'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">'px2rem-loader'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        remUnit<span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h2><a id="2__63"></a>2. 大屏适配</h2> 
<p>此次主要是在大屏适配的实践中遇到的问题。<br> 步骤与移动端适配类似，主要区别如下。<br> 我的屏幕分辨率是<code>1920 x 1080</code>，以此为例，配置<code>px2rem-loader</code>时把remUnit的值修改为192，发现页面布局出现问题。找到<code>./node_modules/lib-flexible/flexible.js</code>查看源码发现下面代码片段：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">refreshRem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span> width <span class="token punctuation">}</span> <span class="token operator">=</span> docEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">/</span> dpr <span class="token operator">&gt;</span> <span class="token number">540</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      width <span class="token operator">=</span> <span class="token number">540</span> <span class="token operator">*</span> dpr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> rem <span class="token operator">=</span> width <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    docEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>rem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    flexible<span class="token punctuation">.</span>rem <span class="token operator">=</span> win<span class="token punctuation">.</span>rem <span class="token operator">=</span> rem<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p>原来屏幕宽度除以dpr（dpr是一个倍数，此处一般为1）大于540时，就不再进行适配了。修改源码如下：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">function</span> <span class="token function">refreshRem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> <span class="token punctuation">{<!-- --></span> width <span class="token punctuation">}</span> <span class="token operator">=</span> docEl<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>width <span class="token operator">/</span> dpr <span class="token operator">&gt;</span> <span class="token number">540</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      width <span class="token operator">*=</span> dpr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> rem <span class="token operator">=</span> width <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    docEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${<!-- --></span>rem<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    flexible<span class="token punctuation">.</span>rem <span class="token operator">=</span> win<span class="token punctuation">.</span>rem <span class="token operator">=</span> rem<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p>配置<code>px2rem-loader</code>如下：</p> 
<h4><a id="vuecli_2x_93"></a>vue-cli 2.x</h4> 
<p>1、在<code>build/utils.js</code>下的<code>exports.cssLoaders</code>添加</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 增加代码，px转rem配置（需要将px2remloader添加进loaders数组中）</span>
  <span class="token keyword">const</span> px2remLoader <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    loader<span class="token operator">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
    options<span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
      remUnit<span class="token operator">:</span> <span class="token number">192</span><span class="token punctuation">,</span>  <span class="token comment">//根据视觉稿，rem为px的十分之一，1920px  192 rem</span>
      remPrecision<span class="token operator">:</span> <span class="token number">8</span><span class="token comment">//换算的rem保留几位小数点</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> 
<p>2、修改<code>build/utils.js</code>下<code>generateLoaders</code>中的<code>loaders</code>配置</p> 
<pre><code class="prism language-javascript"><span class="token comment">// 注释掉这一行</span>
<span class="token comment">// const loaders = options.usePostCSS ? [cssLoader, postcssLoader] : [cssLoader]</span>
<span class="token comment">// 修改为</span>
<span class="token keyword">const</span> loaders <span class="token operator">=</span> options<span class="token punctuation">.</span>usePostCSS <span class="token operator">?</span> <span class="token punctuation">[</span>cssLoader<span class="token punctuation">,</span> postcssLoader<span class="token punctuation">,</span> px2remLoader<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">[</span>cssLoader<span class="token punctuation">,</span> px2remLoader<span class="token punctuation">]</span>
</code></pre> 
<p>3、重新<code>npm run dev</code></p> 
<h4><a id="vuecli_3x_115"></a>vue-cli 3.x</h4> 
<p>跟移动端一样，在项目根目录新建的vue.config.js下，添加如下配置，但查看页面后发现<strong>并未生效</strong>。</p> 
<pre><code class="prism language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    config<span class="token punctuation">.</span>module
      <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">oneOf</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">resourceQuery</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\?vue</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'px2rem'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">'px2rem-loader'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        remUnit<span class="token operator">:</span> <span class="token number">192</span><span class="token punctuation">,</span>  <span class="token comment">//根据视觉稿，rem为px的十分之一，1920px  192 rem</span>
      	remPrecision<span class="token operator">:</span> <span class="token number">8</span><span class="token comment">//换算的rem保留几位小数点</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>目前还未清楚什么原因，因此使用了另一个插件成功实现了适配。步骤如下：<br> 1、安装<code>postcss-px2rem</code>插件</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> <span class="token function">install</span> postcss-px2rem --save-dev
</code></pre> 
<p>2、在vue.config.js中配置如下</p> 
<pre><code class="prism language-bash">module.exports <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
  css: <span class="token punctuation">{<!-- --></span>
    loaderOptions: <span class="token punctuation">{<!-- --></span>   
      postcss: <span class="token punctuation">{<!-- --></span>
        plugins: <span class="token punctuation">[</span>
          require<span class="token punctuation">(</span><span class="token string">'postcss-px2rem'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            //根据视觉稿，rem为px的十分之一，1920px  <span class="token number">192</span> rem
            remUnit: <span class="token number">192</span>,
            //换算的rem保留几位小数点
            remPrecision: <span class="token number">8</span>,
          <span class="token punctuation">}</span><span class="token punctuation">)</span>,
        <span class="token punctuation">]</span>,
      <span class="token punctuation">}</span>,
    <span class="token punctuation">}</span>,
  <span class="token punctuation">}</span>,
<span class="token punctuation">}</span>
</code></pre> 
<p>重新启动项目就成功啦~</p> 
<hr> 
<p>补充：重新<code>npm install</code>项目依赖时需要重新修改flexible.js，方便起见个人建议可以把flexible.js复制一份修改之后在main.js引入，这样就不用每个项目成员都修改了。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0a60f9bb064619c07b4a5725ba7ae9cb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">编译原理 实验4 语义分析（基于PL/0，使用C&#43;&#43;代码编写）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/fe6b9d233c7402951ca6efd1e988b67c/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">EasyTouch对图片进行缩放 设置缩放的大小</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>