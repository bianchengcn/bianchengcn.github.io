<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【linux下编程】MakeFile - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="【linux下编程】MakeFile" />
<meta property="og:description" content="看了几篇文章，整理一下心得
原文链接
http://www.itokit.com/2012/0312/73300.html 在linux上开发c&#43;&#43;
http://blog.csdn.net/liigo/article/details/582231 gdb十分钟教程
http://blog.csdn.net/liang13664759/article/details/1771246 关于MakeFile
一些重点：
1.makefile
2.man：help
3.gdb调试器的命令
关键词：GTK（类似一个跨平台的MFC）, QT, SHELL, GDB, GCC, makefile,STL
编程步骤：
1，使用gedit，或者任何文本编辑器（最好有语法高亮，自动缩进功能）编写您的代码。
2，编写代码时，使用标准库的函数和数据结构，或者其它已经实现的模块，或者linux系统API调用。
3，碰到不知道的标准库，或者linux API，使用man命令查询，没有的话，到网上查询。
4，编写makefile.
5，在g&#43;&#43;上添加 -g参数，加入调试符号。
6，使用gdb调试或者打印log测试。
7，去掉-g参数，release。
8，结束。
Makefile
首先要知道，源程序-&gt;编译(.o)-&gt;链接-&gt;可执行文件-&gt;运行
粗略地看一看Makefile的规则。
target ... : prerequisites ...
command
...
...
target：一个目标文件，可以是Object File，也可以是执行文件。还可以是一个标签（Label），对于标签这种特性，在后续的“伪目标”章节中会有叙述。
prerequisites：要生成那个target所需要的文件或是目标。
command：make需要执行的命令。（任意的Shell命令）
核心：target这一个或多个的目标文件依赖于prerequisites中的文件，其生成规则定义在command中。说白一点就是说，prerequisites中如果有一个以上的文件比target文件要新的话，command所定义的命令就会被执行。这就是Makefile的规则。
make
根据Makefile文件编译源代码、连接、生成目标文件、可执行文件。
make clean
清除上次的make命令所产生的object文件（后缀为“.o”的文件）及可执行文件。
make install
将编译成功的可执行文件安装到系统目录中，一般为/usr/local/bin目录。
make是如何工作的 在默认的方式下，也就是我们只输入make命令。那么， 1、make会在当前目录下找名字叫“Makefile”或“makefile”的文件。 2、如果找到，它会找文件中的第一个目标文件（target），在上面的例子中，他会找到“edit”这个文件，并把这个文件作为最终的目标文件。 3、如果edit文件不存在，或是edit所依赖的后面的 .o 文件的文件修改时间要比edit这个文件新，那么，他就会执行后面所定义的命令来生成edit这个文件。 4、如果edit所依赖的.o文件也不存在，那么make会在当前文件中找目标为.o文件的依赖性，如果找到则再根据那一个规则生成.o文件。（这有点像一个堆栈的过程） 5、当然，你的C文件和H文件是存在的啦，于是make会生成 .o 文件，然后再用 .o 文件生命make的终极任务，也就是执行文件edit了。
MakeFile的一个示例 正如前面所说的，如果一个工程有3个头文件，和8个C文件，我们为了完成前面所述的那三个规则，我们的Makefile应该是下面的这个样子的。 edit : main." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/5c177c3a047a276bd5196f3428711d20/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-07-18T22:43:46+08:00" />
<meta property="article:modified_time" content="2015-07-18T22:43:46+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【linux下编程】MakeFile</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>看了几篇文章，整理一下心得</p> 
<p>原文链接</p> 
<p>http://www.itokit.com/2012/0312/73300.html 在linux上开发c++<br> http://blog.csdn.net/liigo/article/details/582231 gdb十分钟教程</p> 
<p>http://blog.csdn.net/liang13664759/article/details/1771246 关于MakeFile<br> <br> 一些重点：<br> 1.makefile<br> 2.man：help<br> 3.gdb调试器的命令<br> 关键词：GTK（类似一个跨平台的MFC）, QT, SHELL, GDB, GCC, makefile,STL<br> <br> <br> 编程步骤：<br>    1，使用gedit，或者任何文本编辑器（最好有语法高亮，自动缩进功能）编写您的代码。<br>    2，编写代码时，使用标准库的函数和数据结构，或者其它已经实现的模块，或者linux系统API调用。<br>    3，碰到不知道的标准库，或者linux API，使用man命令查询，没有的话，到网上查询。<br>    4，编写makefile.<br>    5，在g++上添加 -g参数，加入调试符号。<br>    6，使用gdb调试或者打印log测试。<br>    7，去掉-g参数，release。<br>    8，结束。<br> </p> 
<p><br> </p> 
<p>Makefile</p> 
<p>首先要知道，源程序-&gt;编译(.o)-&gt;链接-&gt;可执行文件-&gt;运行</p> 
<p><br> </p> 
<p>粗略地看一看Makefile的规则。<br> <br> <br> target ... : prerequisites ...<br> command<br> ...<br> ...<br> <br> <br> target：一个目标文件，可以是Object File，也可以是执行文件。还可以是一个标签（Label），对于标签这种特性，在后续的“伪目标”章节中会有叙述。</p> 
<p><br> prerequisites：要生成那个target所需要的文件或是目标。<br> <br> command：make需要执行的命令。（任意的Shell命令）</p> 
<p><br> </p> 
<p><strong>核心：target这一个或多个的目标文件依赖于prerequisites中的文件，其生成规则定义在command中。说白一点就是说，prerequisites中如果有一个以上的文件比target文件要新的话，command所定义的命令就会被执行。这就是Makefile的规则。</strong></p> 
<p><strong><br> </strong></p> 
<p></p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <span style="color:#cc33cc">make</span></p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> 根据Makefile文件编译源代码、连接、生成目标文件、可执行文件。</p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <span style="color:#993399">make clean</span></p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> 清除上次的make命令所产生的object文件（后缀为“.o”的文件）及可执行文件。</p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <span style="color:#cc33cc">make install</span></p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> 将编译成功的可执行文件安装到系统目录中，一般为/usr/local/bin目录。</p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <br> </p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"><strong>make是如何工作的</strong></span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">在默认的方式下，也就是我们只输入make命令。那么，</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">1、make会在当前目录下找名字叫“Makefile”或“makefile”的文件。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">2、如果找到，它会找文件中的第一个目标文件（target），在上面的例子中，他会找到“edit”这个文件，并把这个文件作为最终的目标文件。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">3、如果edit文件不存在，或是edit所依赖的后面的 .o 文件的文件修改时间要比edit这个文件新，那么，他就会执行后面所定义的命令来生成edit这个文件。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">4、如果edit所依赖的.o文件也不存在，那么make会在当前文件中找目标为.o文件的依赖性，如果找到则再根据那一个规则生成.o文件。（这有点像一个堆栈的过程）</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">5、当然，你的C文件和H文件是存在的啦，于是make会生成 .o 文件，然后再用 .o 文件生命make的终极任务，也就是执行文件edit了。</span><br> </p> 
<p style="margin:10px auto; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; font-size:12.727272033691406px; line-height:17.27272605895996px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"><strong>MakeFile的一个示例</strong></span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">正如前面所说的，如果一个工程有3个头文件，和8个C文件，我们为了完成前面所述的那三个规则，我们的Makefile应该是下面的这个样子的。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">edit : main.o kbd.o command.o display.o /</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">insert.o search.o files.o utils.o</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -o edit main.o kbd.o command.o display.o /</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">insert.o search.o files.o utils.o</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">main.o : main.c defs.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c main.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">kbd.o : kbd.c defs.h command.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c kbd.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">command.o : command.c defs.h command.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c command.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">display.o : display.c defs.h buffer.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c display.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">insert.o : insert.c defs.h buffer.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c insert.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">search.o : search.c defs.h buffer.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c search.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">files.o : files.c defs.h buffer.h command.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c files.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">utils.o : utils.c defs.h</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">cc -c utils.c</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">clean :</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">rm edit main.o kbd.o command.o display.o /</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">insert.o search.o files.o utils.o</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">反斜杠（/）是换行符的意思。这样比较便于Makefile的易读。我们可以把这个内容保存在文件为“Makefile”或“makefile”的文件中，然后在该目录下直接输入命令“make”就可以生成执行文件edit。如果要删除执行文件和所有的中间目标文件，那么，只要简单地执行一下“make clean”就可以了。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">在这个makefile中，目标文件（target）包含：执行文件edit和中间目标文件（*.o），依赖文件（prerequisites）就是冒号后面的那些 .c 文件和 .h文件。每一个 .o 文件都有一组依赖文件，而这些 .o 文件又是执行文件 edit 的依赖文件。依赖关系的实质上就是说明了目标文件是由哪些文件生成的，换言之，目标文件是哪些文件更新的。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">在定义好依赖关系后，后续的那一行定义了如何生成目标文件的操作系统命令，一定要以一个Tab键作为开头。记住，make并不管命令是怎么工作的，他只管执行所定义的命令。make会比较targets文件和prerequisites文件的修改日期，如果prerequisites文件的日期要比targets文件的日期要新，或者target不存在的话，那么，make就会执行后续定义的命令。</span><br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <br style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px"> <span style="color:rgb(51,51,51); font-family:Verdana; font-size:14px; line-height:26px">这里要说明一点的是，clean不是一个文件，它只不过是一个动作名字，有点像C语言中的lable一样，其冒号后什么也没有，那么，make就不会自动去找文件的依赖性，也就不会自动执行其后所定义的命令。要执行其后的命令，就要在make命令后明显得指出这个lable的名字。这样的方法非常有用，我们可以在一个makefile中定义不用的编译或是和编译无关的命令，比如程序的打包，程序的备份，等等。</span><br> </p> 
<br> 
<br>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/215e5d67912fee878b7afe0063f24951/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">二叉树，完全二叉树，满二叉树，二叉排序树</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5a77edefca8af5b4c4a252466253a9ed/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">对于java反射的一些学习理解和认知</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>