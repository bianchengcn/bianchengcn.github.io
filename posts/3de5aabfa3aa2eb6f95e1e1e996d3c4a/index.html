<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Unity渲染(一):Shader着色器基础入门之纯色Shader - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Unity渲染(一):Shader着色器基础入门之纯色Shader" />
<meta property="og:description" content="Unity渲染(一):纯色Shader 通过这里，你可以学习到UnityShader基本语法，CG语义，GPU渲染流水线等编写着色器的基础知识
开发环境：Unity5.0或者更高
最终效果 概述 1. Unity shader 基本语法 2. 顶点着色器与片元着色器参数传递 3. 基本shader语义 4. GPU渲染流水线 1.1 开始 创建场景并取名为SolidColor并在场景中添加Camera与Cube Hierachy 创建Material 和Shader 删除Shader中所有代码后，写入如下代码， 这是shader的基本结构 Shader &#34;Toturial/SolidColor&#34; { SubShader { Pass { CGPROGRAM ENDCG } } } 此时Console出现了两条警告信息,第一条表示该Shader代码中的所有SubShader都不支持,第二条表示需要该Shader对GPU顶点着色器和片元着色器进行编程，在
Shader warning in &#39;Toturial/SolidColor&#39;: Toturial/SolidColor shader is not supported on this GPU (none of subshaders/fallbacks are suitable)
Shader warning in &#39;Toturial/SolidColor&#39;: Both vertex and fragment programs must be present in a shader snippet. Excluding it from compilation" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/3de5aabfa3aa2eb6f95e1e1e996d3c4a/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-21T09:51:49+08:00" />
<meta property="article:modified_time" content="2021-12-21T09:51:49+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Unity渲染(一):Shader着色器基础入门之纯色Shader</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="UnityShader_0"></a>Unity渲染(一):纯色Shader</h2> 
<p>通过这里，你可以学习到UnityShader基本语法，CG语义，GPU渲染流水线等编写着色器的基础知识</p> 
<blockquote> 
 <p>开发环境：Unity5.0或者更高</p> 
</blockquote> 
<hr> 
<p><img src="https://images2.imgbox.com/43/d7/Kn5ZkjM2_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">最终效果</font></i> 
</center> 
<hr> 
<h3><a id="_11"></a>概述</h3> 
<pre><code>1. Unity shader 基本语法
2. 顶点着色器与片元着色器参数传递
3. 基本shader语义
4. GPU渲染流水线
</code></pre> 
<hr> 
<h3><a id="11__17"></a>1.1 开始</h3> 
<ul><li>创建场景并取名为SolidColor并在场景中添加<code>Camera</code>与<code>Cube</code></li></ul> 
<p><img src="https://images2.imgbox.com/39/75/32OxcfiY_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">Hierachy</font></i> 
</center> 
<ul><li>创建<code>Material</code> 和<code>Shader</code></li></ul> 
<p><img src="https://images2.imgbox.com/4d/52/SrCGJDyd_o.png" alt="在这里插入图片描述"></p> 
<ul><li>删除Shader中所有代码后，写入如下代码， 这是shader的基本结构</li></ul> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Toturial/SolidColor"</span>
<span class="token punctuation">{<!-- --></span>
	SubShader
    <span class="token punctuation">{<!-- --></span>
        Pass
        <span class="token punctuation">{<!-- --></span>
            CGPROGRAM
            
            ENDCG
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>此时Console出现了两条警告信息,第一条表示该Shader代码中的所有SubShader都不支持,第二条表示需要该Shader对GPU顶点着色器和片元着色器进行编程，在</p> 
<p><code>Shader warning in 'Toturial/SolidColor': Toturial/SolidColor shader is not supported on this GPU (none of subshaders/fallbacks are suitable)</code><br> <code>Shader warning in 'Toturial/SolidColor': Both vertex and fragment programs must be present in a shader snippet. Excluding it from compilation</code></p> 
<blockquote> 
 <h5><a id="_47"></a>代码说明</h5> 
 <ol><li><code>Shader "xx/xx"</code>表示在Unity材质面板的路径<br> <img src="https://images2.imgbox.com/c0/d4/009zlePk_o.png" alt="d"></li><li><code>SubShader{ ... }</code> 中编写着色代码，可以写多个，GPU会选择一个最合适的来进行渲染</li><li><code>Pass{ ... }</code> 写在SubShader中 ，渲染逻辑和渲染配置写在这里面，可以写多个，有几个就会渲染几次</li><li><code>CGPROGRAM ... ENDCG</code> CG代码，渲染逻辑写在这里面</li></ol> 
</blockquote> 
<hr> 
<h3><a id="12_GPU_56"></a>1.2 简化的GPU渲染管线</h3> 
<p><img src="https://images2.imgbox.com/79/26/MUAPww5b_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">简化的GPU渲染管线</font></i> 
</center> 
<p></p> 
<blockquote> 
 <h5><a id="_59"></a>管线说明（重要！！！）</h5> 
 <ol><li>Unity将顶点数据、顶点颜色等属性传入Shader ,进入GPU顶点着色器处理，之后进入裁剪阶段，裁剪完成后数据将进入片元着色器，最后输出到屏幕</li><li>其中顶点着色器和片元着色器是可编程的(<code>表示可以在Shader中写代码进行控制</code>)</li><li>裁剪阶段是可配置的(<code>表示可以在Shader中使用一些特定的语法进行设置 例如 Cut off</code>)</li></ol> 
</blockquote> 
<h3><a id="13__65"></a>1.3 顶点着色器和片元着色器</h3> 
<p>在我们对顶点着色器(Vertex Shader)以及片元着色器(Fragment Shader)进行编程之前，需要先从获取对象的属性，例如图片的顶点位置和颜色，模型的顶点位置、法线方向、颜色等。</p> 
<p>我们通过语义绑定来获取模型数据或者图片的位置和颜色</p> 
<blockquote> 
 <h5><a id="_70"></a>语义说明</h5> 
 <ol><li><code>类型 变量名 :POSITION;</code> 获取输入的顶点 <code>(例如:float4 vertex : POSITION)</code></li><li><code>类型 变量名 : COLOR</code> 获取输入的颜色，SpriteRenderer 和Image组件上的Color</li><li><code>:SV_POSITION</code> 顶点着色器输出的顶点位置，SV表示System Value的缩写</li><li><code>:SV_TARGET</code> 片元着色器输出的值</li></ol> 
</blockquote> 
<p>了解了语义之后，我们需要定义函数为顶点着色器和片元着色器进行编程控制。</p> 
<blockquote> 
 <h5><a id="_77"></a>宏定义</h5> 
 <p><code>#pragma vertex vert</code> 定义顶点着色器，vert为函数名 可以改成其他的<br> <code>#pragma fragment frag</code> 定义片元着色器 ，frag为函数名 可以改成其他的</p> 
</blockquote> 
<p>之后我们在CGPROGRAM … ENDCG中写入如下代码:</p> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Toturial/SolidColor"</span>
<span class="token punctuation">{<!-- --></span>
	SubShader
    <span class="token punctuation">{<!-- --></span>
        Pass
        <span class="token punctuation">{<!-- --></span>
            CGPROGRAM
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag </span>
            
            <span class="token return-type class-name">float4</span> <span class="token function">vert</span><span class="token punctuation">(</span><span class="token class-name">float4</span> vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">)</span><span class="token punctuation">:</span> SV_POSITION
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token function">fixed4</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            ENDCG
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>其中UnityObjectToClipPos(vertex)表示将顶点位置从对象空间转换到裁剪空间，这一步是为了将3D的场景最终输出到一张2D的屏幕上。参考Unity官方文档 <a href="https://docs.unity3d.com/cn/current/Manual/SL-BuiltinFunctions.html" rel="nofollow">https://docs.unity3d.com/cn/current/Manual/SL-BuiltinFunctions.html</a></p> 
<p>最终返回了蓝色<code>fixed4(0,0,1,1);</code>,之后给场景中的Cube添加材质Custom_SolidColor</p> 
<p><img src="https://images2.imgbox.com/15/e8/Owd1BgiH_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">最终效果</font></i> 
</center> 
<h3><a id="14__114"></a>1.4 代码结构优化</h3> 
<p>上面的代码中我们只用到了<code>顶点位置:POSITION</code>语义，当我们需要多个参数的时候，例如还需要颜色，法线方向等我们可以使用<code>结构体</code>给顶点着色器函数传参</p> 
<p>修改 CGPROGRAM … ENDCG 中的代码，首先我们定义一个结构体名为a2v,他是application to vertex 的缩写，意思是表示数据从应用传递到顶点着色器</p> 
<pre><code class="prism language-csharp"><span class="token keyword">struct</span> <span class="token class-name">a2v</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token class-name">float4</span> vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">;</span>
	<span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>我们再定义一个结构体用于将数据从顶点着色器输出后传递到片元着色器，结构体名为v2f ，它是vertex to fragment的缩写，</p> 
<pre><code class="prism language-csharp"><span class="token keyword">struct</span> <span class="token class-name">v2f</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token class-name">float4</span> pos <span class="token punctuation">:</span> SV_POSITION<span class="token punctuation">;</span>
	<span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>之后修改顶点着色器函数返回值和参数</p> 
<pre><code class="prism language-csharp"><span class="token return-type class-name">v2f</span> <span class="token function">vert</span><span class="token punctuation">(</span><span class="token class-name">a2v</span> v<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">v2f</span> o<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>pos <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>color <span class="token operator">=</span> v<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>完整代码</p> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Toturial/SolidColor"</span>
<span class="token punctuation">{<!-- --></span>
    SubShader
    <span class="token punctuation">{<!-- --></span>
        Pass
        <span class="token punctuation">{<!-- --></span>
            CGPROGRAM
            
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag </span>

            <span class="token keyword">struct</span> <span class="token class-name">a2v</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">struct</span> <span class="token class-name">v2f</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> pos <span class="token punctuation">:</span> SV_POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token return-type class-name">v2f</span> <span class="token function">vert</span><span class="token punctuation">(</span><span class="token class-name">a2v</span> v<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">v2f</span> o<span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>pos <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>color <span class="token operator">=</span> v<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                <span class="token keyword">return</span> o<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token class-name">v2f</span> i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">return</span> <span class="token function">fixed4</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            ENDCG
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>最终结果<br> <img src="https://images2.imgbox.com/10/53/lmtrNQC8_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">最终效果</font></i> 
</center> 
<h3><a id="15_Properties_191"></a>1.5 使用Properties属性</h3> 
<p>在场景中创建一个Image与2D Sprite</p> 
<p><img src="https://images2.imgbox.com/27/99/vzVlkjSE_o.png" alt="在这里插入图片描述"><br> 将<code>Image</code>组件的Material设置为<code>Custom_SolidColor</code><br> 将<code>SpriteRenderer</code> 的Material设置为<code>Custom_SolidColor</code></p> 
<p>此时出现了一个报错</p> 
<blockquote> 
 <p><code>Material 'Custom_SolidColor' with Shader 'Toturial/SolidColor' doesn't have a texture property '_MainTex'</code></p> 
</blockquote> 
<p>这是因为图片组件会将Sprite设置给Shader中的_MainTex，所以我们在Properties中需要定义一个变量名为_MainTex类型为2D的参数，将以下代码写在SubShader上面。</p> 
<pre><code class="prism language-csharp">Properties
<span class="token punctuation">{<!-- --></span>
    <span class="token function">_MainTex</span><span class="token punctuation">(</span><span class="token string">"MainTex"</span><span class="token punctuation">,</span><span class="token number">2D</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <h5><a id="_211"></a>代码说明</h5> 
 <ol><li><code>Properties{...}</code> 代码块定义材质属性。<a href="https://docs.unity.cn/cn/current/Manual/SL-Properties.html" rel="nofollow">参阅 ShaderLab：定义材质属性</a><br> 这部分的参数会显示在材质面板上<br> <img src="https://images2.imgbox.com/b0/ae/a6y3rC6x_o.png" alt="在这里插入图片描述"></li><li><code>_MainTex("MainTex",2D) = "white"{}</code> _MainTex表示变量名，用于在C#访问，"MainTex"表示在材质面板上的名字，2D为参数类型，“white”{}为默认值</li></ol> 
</blockquote> 
<p>接下来我们给材质属性添加一个设置颜色的功能，首先在Properties属性添加Color</p> 
<pre><code class="prism language-csharp">   Properties
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">_MainTex</span><span class="token punctuation">(</span><span class="token string">"MainTex"</span><span class="token punctuation">,</span><span class="token number">2D</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token function">_Color</span><span class="token punctuation">(</span><span class="token string">"Color"</span><span class="token punctuation">,</span>Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p>之后我们需要在CGPROGRAM… ENDCG 中定义变量用来获取Properties里的_Color值，在 struct a2v上面定义</p> 
<pre><code class="prism language-csharp"><span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
<span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag </span>

<span class="token class-name">fixed4</span> _Color<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">a2v</span>
<span class="token punctuation">{<!-- --></span>
</code></pre> 
<p>修改frag函数</p> 
<pre><code class="prism language-csharp"><span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token class-name">v2f</span> i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
<span class="token punctuation">{<!-- --></span>
     <span class="token keyword">return</span> _Color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>修改材质界面的Color<br> <img src="https://images2.imgbox.com/93/dd/yfK1MjPZ_o.png" alt="在这里插入图片描述"><br> 完整代码:</p> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Toturial/SolidColor"</span>
<span class="token punctuation">{<!-- --></span>
    Properties
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">_MainTex</span><span class="token punctuation">(</span><span class="token string">"MainTex"</span><span class="token punctuation">,</span><span class="token number">2D</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token function">_Color</span><span class="token punctuation">(</span><span class="token string">"Color"</span><span class="token punctuation">,</span>Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    SubShader
    <span class="token punctuation">{<!-- --></span>
        Pass
        <span class="token punctuation">{<!-- --></span>
            CGPROGRAM
            
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag </span>

            <span class="token class-name">fixed4</span> _Color<span class="token punctuation">;</span>

            <span class="token keyword">struct</span> <span class="token class-name">a2v</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">struct</span> <span class="token class-name">v2f</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> pos <span class="token punctuation">:</span> SV_POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token return-type class-name">v2f</span> <span class="token function">vert</span><span class="token punctuation">(</span><span class="token class-name">a2v</span> v<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">v2f</span> o<span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>pos <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>color <span class="token operator">=</span> v<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                <span class="token keyword">return</span> o<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token class-name">v2f</span> i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
            <span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">return</span> _Color<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            ENDCG
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>最终看到效果</p> 
<p><img src="https://images2.imgbox.com/08/06/6lGXI0qp_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">最终效果</font></i> 
</center> 
<hr> 
<p>接下来我们将使用Image.Color和SpriteRenderer修改材质的颜色，因为我们在<code>a2v</code>结构体中对<code>color</code>进行了<code>:Color</code>语义绑定，之后将a2v结构体传入<code>顶点着色器vert,</code>在顶点着色器中实例化了一个<code>v2f</code>结构体并对<code>color</code>进行赋值，之后将<code>v2f传递到片元着色器</code>中，所以我们需要把<code>片元着色器frag</code>中的返回值修改为<code>i.color</code>就可以达到效果。</p> 
<pre><code class="prism language-csharp"><span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token class-name">v2f</span> i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
<span class="token punctuation">{<!-- --></span>
     <span class="token keyword">return</span> i<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>修改完后我们修改场景中的Image组件上的颜色为<code>#FFDA00</code> ，将SpriteRenderer上的颜色修改为#3889F1</p> 
<p><img src="https://images2.imgbox.com/31/a7/euisRLNb_o.png" alt="在这里插入图片描述"></p> 
<center> 
 <i><font size="2">最终效果</font></i> 
</center> 
<h3><a id="16__317"></a>1.6 完整代码</h3> 
<pre><code class="prism language-csharp">Shader <span class="token string">"Toturial/SolidColor"</span>
<span class="token punctuation">{<!-- --></span>
    Properties
    <span class="token punctuation">{<!-- --></span>
        <span class="token function">_MainTex</span><span class="token punctuation">(</span><span class="token string">"MainTex"</span><span class="token punctuation">,</span><span class="token number">2D</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
        <span class="token function">_Color</span><span class="token punctuation">(</span><span class="token string">"Color"</span><span class="token punctuation">,</span>Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    SubShader
    <span class="token punctuation">{<!-- --></span>
        Pass
        <span class="token punctuation">{<!-- --></span>
            CGPROGRAM
            
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> vertex vert</span>
            <span class="token preprocessor property">#<span class="token directive keyword">pragma</span> fragment frag </span>

            <span class="token class-name">fixed4</span> _Color<span class="token punctuation">;</span>

            <span class="token keyword">struct</span> <span class="token class-name">a2v</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> vertex <span class="token punctuation">:</span> POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token keyword">struct</span> <span class="token class-name">v2f</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">float4</span> pos <span class="token punctuation">:</span> SV_POSITION<span class="token punctuation">;</span>
                <span class="token class-name">fixed4</span> color <span class="token punctuation">:</span> COLOR<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>

            <span class="token return-type class-name">v2f</span> <span class="token function">vert</span><span class="token punctuation">(</span><span class="token class-name">a2v</span> v<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">v2f</span> o<span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>pos <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                o<span class="token punctuation">.</span>color <span class="token operator">=</span> v<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
                <span class="token keyword">return</span> o<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token return-type class-name">fixed4</span> <span class="token function">frag</span><span class="token punctuation">(</span><span class="token class-name">v2f</span> i<span class="token punctuation">)</span> <span class="token punctuation">:</span> SV_TARGET
            <span class="token punctuation">{<!-- --></span>
                 <span class="token keyword">return</span> i<span class="token punctuation">.</span>color<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            ENDCG
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/82a896dffa24f7d790eec441682c7cfe/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">微信小程序新版canvas画圆形进度条</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/ef7175d64f25a6826e68f64eb1b6b233/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">gitee开源程序kkFileView踩坑及解决方案</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>