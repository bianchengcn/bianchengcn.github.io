<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>pytorch 卷积神经网络CNN - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="pytorch 卷积神经网络CNN" />
<meta property="og:description" content="www.ai-xlab.com AI MOOC 卷积神经网络CNN 1 www.ai-xlab.com AI MOOC 卷积神经网络是近年发展起来，并广泛应用于图像处理，NLP等领域的一 种多层神经网络。 传统BP处理图像时的问题： 1.权值太多，计算量太大 2.权值太多，需要大量样本 进行训练。 CNN www.ai-xlab.com AI MOOC 1962年哈佛医学院神经生理学家Hubel和Wiesel通过对猫视觉皮层细 胞的研究，提出了感受野(receptive field)的概念，1984年日本学者 Fukushima基于感受野概念提出的神经认知机(neocognitron)可以看 作是卷积神经网络的第一个实现网络，也是感受野概念在人工神经网 络领域的首次应用。 局部感受野 www.ai-xlab.com AI MOOC CNN通过 局部感受野 和 权值共享 减少了神经网络需要训练的参数个数 局部感受野和权值共享 www.ai-xlab.com AI MOOC 1*1&#43;1*0&#43;1*1&#43;0*0&#43;1*1&#43;1*0&#43;0*1&#43;0*0&#43;1*1 = 4 特征图:feature map 卷积核/滤波器 卷积计算 www.ai-xlab.com AI MOOC 步长为1 步长为2 不同步长的卷积 www.ai-xlab.com AI MOOC 滤波器 www.ai-xlab.com AI MOOC Pooling常用的三种方式： 1.max-pooling 2.mean-pooling 3.stochastic pooling 池化Pooling www.ai-xlab.com AI MOOC SAME PADDING: 给平面外部补0 卷积窗口采样后得到一个跟原来大小相同的平面 VALID PADDING: 不会超出平面外部 卷积窗口采样后得到一个比原来平面小的平面 VALID PADDING SAME PADDING Padding www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/66bc48bb1b0393778c8d16adbda37250/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-27T23:45:32+08:00" />
<meta property="article:modified_time" content="2024-01-27T23:45:32+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">pytorch 卷积神经网络CNN</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <div> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>卷积神经网络CNN </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">1</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">卷积神经网络是近年发展起来，并广泛应用于图像处理，NLP等领域的一 </span> 
</div> 
<div> 
 <span style="color:#595959;">种多层神经网络。 </span> 
</div> 
<div> 
 <span style="color:#595959;">传统BP处理图像时的问题： </span> 
</div> 
<div> 
 <span style="color:#595959;">1.权值太多，计算量太大 </span> 
</div> 
<div> 
 <span style="color:#595959;">2.权值太多，需要大量样本 </span> 
</div> 
<div> 
 <span style="color:#595959;">进行训练。 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>CNN</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">1962年哈佛医学院神经生理学家Hubel和Wiesel通过对猫视觉皮层细 </span> 
</div> 
<div> 
 <span style="color:#595959;">胞的研究，提出了感受野(receptive field)的概念，1984年日本学者 </span> 
</div> 
<div> 
 <span style="color:#595959;">Fukushima基于感受野概念提出的神经认知机(neocognitron)可以看 </span> 
</div> 
<div> 
 <span style="color:#595959;">作是卷积神经网络的第一个实现网络，也是感受野概念在人工神经网 </span> 
</div> 
<div> 
 <span style="color:#595959;">络领域的首次应用。 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>局部感受野</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">CNN通过</span> 
 <span style="color:#ff0000;">局部感受野</span> 
 <span style="color:#595959;">和</span> 
 <span style="color:#ff0000;">权值共享</span> 
 <span style="color:#595959;">减少了神经网络需要训练的参数个数 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>局部感受野和权值共享</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#000000;">1*1+1*0+1*1+0*0+1*1+1*0+0*1+0*0+1*1 = 4 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">特征图:feature map </span> 
</div> 
<div> 
 <span style="color:#ff2600;">卷积核/滤波器 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>卷积计算</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">步长为1 </span> 
</div> 
<div> 
 <span style="color:#595959;">步长为2 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>不同步长的卷积</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>滤波器</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">Pooling常用的三种方式： </span> 
</div> 
<div> 
 <span style="color:#ff0000;">1.max-pooling </span> 
</div> 
<div> 
 <span style="color:#ff0000;">2.mean-pooling </span> 
</div> 
<div> 
 <span style="color:#ff0000;">3.stochastic pooling </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>池化Pooling</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#ff0000;">SAME PADDING: </span> 
</div> 
<div> 
 <span style="color:#595959;">给平面外部补0 </span> 
</div> 
<div> 
 <span style="color:#595959;">卷积窗口采样后得到一个跟原来大小相同的平面 </span> 
</div> 
<div> 
 <span style="color:#ff0000;">VALID PADDING: </span> 
</div> 
<div> 
 <span style="color:#595959;">不会超出平面外部 </span> 
</div> 
<div> 
 <span style="color:#595959;">卷积窗口采样后得到一个比原来平面小的平面 </span> 
</div> 
<div> 
 <span style="color:#ff0000;">VALID PADDING </span> 
</div> 
<div> 
 <span style="color:#ff0000;">SAME PADDING </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>Padding</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#ff2600;">SAME PADDING </span> 
</div> 
<div> 
 <span style="color:#ff2600;">VALID PADDING </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>Padding</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#ff2600;">SAME PADDING:可能会给平面外部补0 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">VALID PADDING:不会超出平面外部 </span> 
</div> 
<div> 
 <span style="color:#595959;">假如有一个28*28的平面，用2*2步长为2的窗口对其进行卷积/池化操作 </span> 
</div> 
<div> 
 <span style="color:#595959;">使用SAME PADDING的方式，得到14*14的平面 </span> 
</div> 
<div> 
 <span style="color:#595959;">使用VALID PADDING的方式，得到14*14的平面 </span> 
</div> 
<div> 
 <span style="color:#595959;">假如有一个2*3的平面，用2*2步长为2的窗口对其进行卷积/池化操作 </span> 
</div> 
<div> 
 <span style="color:#595959;">使用SAME PADDING的方式，得到1*2的平面 </span> 
</div> 
<div> 
 <span style="color:#595959;">使用VALID PADDING的方式，得到1*1的平面 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>Padding</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#0563c1;">LeNET-5</span> 
 <span style="color:#595959;">是最早的卷积神经网络之一，曾广泛用于美国银行。手写 </span> 
</div> 
<div> 
 <span style="color:#595959;">数字识别正确率在99%以上。 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">卷积窗口:5*5 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">步长:1 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">池化窗口:2*2 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">步长:2 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">卷积窗口:5*5 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">步长:1 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">池化窗口:2*2 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">步长:2 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">卷积层 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">池化层 卷积层 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">池化层 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">输入层 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">全链接层 </span> 
 <span style="color:#ff2600;">全链接层 </span> 
</div> 
<div> 
 <span style="color:#ff2600;">输出层 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>LeNET-5</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#0563c1;">可视化： </span> 
</div> 
<div> 
 <span style="color:#0563c1;">http://scs.ryerson.ca/~aharley/vis/conv/ </span> 
</div> 
<div> 
 <span style="color:#0563c1;">http://scs.ryerson.ca/~aharley/vis/conv/flat.html </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>LeNET-5</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>ImageNet介绍 </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">2</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">ImageNet是一个计算机视觉系统识别项目，是目前世界上图像识别最大 </span> 
</div> 
<div> 
 <span style="color:#595959;">的数据库。一共有1500万张左右的图片，被分为22000个左右的类。是 </span> 
</div> 
<div> 
 <span style="color:#595959;">由斯坦福教授李飞飞领导建立的。 </span> 
</div> 
<div> 
 <span style="color:#0563c1;">TED演讲：我们怎么教计算机理解图片？ </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>ImageNet</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">1976年出生于北京，长在四川，16岁随父母移居美国新泽西州。 </span> 
</div> 
<div> 
 <span style="color:#595959;">1999年毕业于普林斯顿大学，2005年获得加州理工学院电子工程博士。 </span> 
</div> 
<div> 
 <span style="color:#595959;">2009年加入斯坦福大学担任助理教授，并于2012年担任副教授（终生教授），和 </span> 
</div> 
<div> 
 <span style="color:#595959;">斯坦福人工智能实验室与视觉实验室主任。 </span> 
</div> 
<div> 
 <span style="color:#595959;">2017年1月入职Google，担任谷歌云首席科学家</span> 
 <span style="color:#000000;">。 </span> 
</div> 
<div> 
 <span style="color:#595959;">2018年9月卸任谷歌云首席科学家，回归斯坦福大学当教授。 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>李飞飞</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">ILSVRC:ImageNet Large Scale Visual Recognition Challenge </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>ILSVRC</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">ILSVRC:ImageNet Large Scale Visual Recognition Challenge </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>ILSVRC</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>序列模型 </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">3</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>RNN（Recurrent Neural Network） </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">1986年 Rumelhart 等人提出循环神经网络(recurrent neural network)，简称RNN。RNN </span> 
</div> 
<div> 
 <span style="color:#595959;">跟我们之前学习过的神经网络都不太一样，它是一种序列模型。比如卷积网络是专门用来处 </span> 
</div> 
<div> 
 <span style="color:#595959;">理网格化数据（例如图像数据）的神经网络，RNN是专门用来处理序列数据的神经网络。所 </span> 
</div> 
<div> 
 <span style="color:#595959;">谓的序列数据指的是跟序列相关的数据，比如一段语音，一首歌曲，一段文字，一段录像等。</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>序列模型应用：语音识别 </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">把语音转换成为文字</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>序列模型应用：文本分类 </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">把文章，邮件或用户评论等文本数据做分类</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>序列模型应用：机器翻译 </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">例如把中文翻译成英文</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>序列模型应用：分词标注 </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">给一段文字做分词标注，标注每个字对应的标号。假如使用4-tag(BMES)标注标签， </span> 
</div> 
<div> 
 <span style="color:#595959;">B表示词的起始位置，M表示词的中间位置，E表示词的结束位置，S表示单字词。 </span> 
</div> 
<div> 
 <span style="color:#595959;">可以得到类似如下结果： </span> 
</div> 
<div> 
 <span style="color:#595959;">“人/B 们/E 常/S 说/S 生/B 活/E 是/S 一/S 部/S 教/B 科/M 书/E ”</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>RNN（Recurrent Neural Network）</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>RNN（Recurrent Neural Network） </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">隐层 h</span> 
 <span style="color:#595959;">t</span> 
 <span style="color:#595959;">接收的是上时刻的隐层（hidden layer） </span> 
</div> 
<div> 
 <span style="color:#595959;">h</span> 
 <span style="color:#595959;">t−1 </span> 
</div> 
<div> 
 <span style="color:#595959;">还是上时刻的输出（output layer）y</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">， </span> 
</div> 
<div> 
 <span style="color:#595959;">可以分成了两种 RNN： </span> 
</div> 
<div> 
 <span style="color:#595959;">Elman network 接收上时刻的隐层 h</span> 
 <span style="color:#595959;">t−1 </span> 
</div> 
<div> 
 <span style="color:#595959;">Jordan network 接收上时刻的输出 y</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">RNN一个重要的用法就是通过之前的信息来决策当前的问题。 </span> 
</div> 
<div> 
 <span style="color:#595959;">比如就像我们看电影，我们要根据电影之前的情节，才能理解现在的情节。 </span> 
</div> 
<div> 
 <span style="color:#595959;">例子1：有一朵云飘在（） </span> 
</div> 
<div> 
 <span style="color:#595959;">例子2：我从小生长在美国。。。我可以说一口流利的（） </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>RNN（Recurrent Neural Network）</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>RNN（Recurrent Neural Network）</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>长短时记忆网络LSTM </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">4</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">i</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">输入门信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">f</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">忘记门信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">ǁ </span> 
</div> 
<div> 
 <span style="color:#595959;">𝑐</span> 
</div> 
<div> 
 <span style="color:#595959;">𝑡 </span> 
 <span style="color:#595959;">Cell输入信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">c</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">Cell输出信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">o</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">输出门信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">h</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">block输出信号 </span> 
</div> 
<div> 
 <span style="color:#595959;">x</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">第t个序列输入 </span> 
</div> 
<div> 
 <span style="color:#595959;">h</span> 
 <span style="color:#595959;">t-1 </span> 
 <span style="color:#595959;">第t-1个序列输出 </span> 
</div> 
<div> 
 <span style="color:#595959;">σ</span> 
 <span style="color:#595959;">g </span> 
 <span style="color:#595959;">sigmoid函数 </span> 
</div> 
<div> 
 <span style="color:#595959;">σ</span> 
 <span style="color:#595959;">c </span> 
 <span style="color:#595959;">tanh函数 </span> 
</div> 
<div> 
 <span style="color:#595959;">σ</span> 
 <span style="color:#595959;">h </span> 
 <span style="color:#595959;">tanh函数或线性函数 </span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>LSTM(Long Short Term Memory)</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>Peephole LSTM </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">和之前的公式做比较，发现只是把 h</span> 
 <span style="color:#595959;">t−1 </span> 
 <span style="color:#595959;">都换成 </span> 
</div> 
<div> 
 <span style="color:#595959;">了 c</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">，即三个门的输入都改成了 [x</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">,c</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">] 。因 </span> 
</div> 
<div> 
 <span style="color:#595959;">为是从 cell state 里取得信息，所以叫窥视孔（ </span> 
</div> 
<div> 
 <span style="color:#595959;">peephole）。</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>FC-LSTM(Fully-connected LSTM ) </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">三个输入分别是 [x</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">,h</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">,c</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">] </span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>LSTM(Long Short Term Memory)</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>LSTM(Long Short Term Memory)</strong></span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>门控循环单元GRU </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">5</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>GRU(Gated Recurrent Unit) </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">GRU 这个结构是 2014 年才出现的，效果跟 </span> 
</div> 
<div> 
 <span style="color:#595959;">LSTM差不多，但是用到的参数更少。将忘记 </span> 
</div> 
<div> 
 <span style="color:#595959;">门和输入门合成了一个单一的更新门。 </span> 
</div> 
<div> 
 <span style="color:#595959;">z</span> 
 <span style="color:#595959;">t</span> 
 <span style="color:#595959;">是更新门(update gate)，决定h</span> 
 <span style="color:#595959;">t</span> 
 <span style="color:#595959;">的更新情况 </span> 
</div> 
<div> 
 <span style="color:#595959;">r</span> 
 <span style="color:#595959;">t</span> 
 <span style="color:#595959;">是重置门(reset gate)，决定是否要放弃h</span> 
 <span style="color:#595959;">t-1 </span> 
</div> 
<div> 
 <span style="color:#595959;">෨</span> 
</div> 
<div> 
 <span style="color:#595959;">ℎ</span> 
</div> 
<div> 
 <span style="color:#595959;">𝑡 </span> 
 <span style="color:#595959;">是候选输出，接收 [x</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">,h</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">] </span> 
</div> 
<div> 
 <span style="color:#595959;">h</span> 
 <span style="color:#595959;">t </span> 
 <span style="color:#595959;">是当前输出，接收 [h</span> 
 <span style="color:#595959;">t−1</span> 
 <span style="color:#595959;">, </span> 
</div> 
<div> 
 <span style="color:#595959;">෨</span> 
</div> 
<div> 
 <span style="color:#595959;">ℎ</span> 
</div> 
<div> 
 <span style="color:#595959;">𝑡 </span> 
 <span style="color:#595959;">]</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>其他RNN模型 </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;">6</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>双向RNN(Bidirectional RNNs) </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">双向的 RNN 是同时考虑“过去”和“未来”的信息，输入（黑色点）沿着黑色的实线箭 </span> 
</div> 
<div> 
 <span style="color:#595959;">头传输到隐层（黄色点），再沿着红色实线传到输出（红色点）。黑色实线做完前向传播 </span> 
</div> 
<div> 
 <span style="color:#595959;">后，在 Bidirectional RNNs 却先不急着后向传播，而是从末尾的时刻沿着虚线的方向再回 </span> 
</div> 
<div> 
 <span style="color:#595959;">传回来。</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>Stacked Bidirectional RNNs </strong></span> 
</div> 
<div> 
 <span style="color:#595959;">图中是双向的三层 RNNs，堆叠多层的RNN网络，可以增加模型的参数，提高模型的拟合 </span> 
</div> 
<div> 
 <span style="color:#595959;">能力。每层的 hidden state 不仅要输给下一时刻，还是当做是此时刻下一层的输入。</span> 
 <span style="color:#ffffff;"><strong>www.ai-xlab.com </strong></span> 
</div> 
<div> 
 <span style="color:#ffffff;"><strong>AI MOOC </strong></span> 
</div> 
<div> 
 <span style="color:#595959;"><strong>THANKS</strong></span> 
</div>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/8769be99aff81823d0be30db2c4715f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">C语言与操作符相关的经典例题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/dd534c63b4f0c0ed5126ef400031618a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">操作系统（6）----线程相关</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>