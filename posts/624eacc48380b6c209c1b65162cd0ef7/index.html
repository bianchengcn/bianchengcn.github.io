<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>模仿QQ登录头像的切换 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="模仿QQ登录头像的切换" />
<meta property="og:description" content="模仿QQ登录头像的切换
开发工具与关键技术：SQL Server 2014 Management Studio 如何切换登录的头像
作者：李国旭
撰写时间：2019年7月6日
我们平时如果注意的话会发现QQ登录的头像会随着我们的帐号的切换而切换，还有就是微信的登陆也是这样都会随着我们的账号的变化而变化；就觉得很神奇，那么他是怎样实现这样的登录的效果的呢？我们一起来看一下它的神奇之处！
就用我现在做的这个项目为例：首先，就要把它员工或者是管理员的账号、密码通过新增进数据库中，把账号和密码一起保存在数据库中。注意：密码不能用明文保存在数据库，一定要加密后再保存进数据库里，要不然明文的密码和容易给别人窃取，而且这样做很危险，所以一定要进行加密后再保存到数据库中。
那么先判断我们的输入账号显示用户的头像，获取它账号的值，判断它的账号不等于空；然后For…in…循环i&#43;&#43;，从控制器那边获取到账号的值，拼接账号加上它的参数来传参，然后再new一个时间；然后就是把图片show出来，否则就是hide隐藏起来，如下图所示：
当然啦，我们也要在控制器那边判断我们选择的角色的类型对不对，，对用户输入的密码加密，然后再判断加密后的密码和数据库中的密码比较，之后就是验证选择的角色是否正确，把用户的数据放入session中，获取用户类型的名称和ID
最后就是设置session，传递用户ID和用户类型的ID
下面的就是判断它的用户的角色类型的选择是否正确的代码
//对用户输入的密码加密 string PassWord = AESEncryptHelper.Encrypt(strPassWord); //用加密后的密码和数据库查询到的密码比较 if (PassWord == dbUser.PassWord) { //==验证选择的角色是否正确 var listUserType = (from tbUser in myModels.S_User join tbUserRoleDetail in myModels.S_UserRoleDetail on tbUser.UserID equals tbUserRoleDetail.UserID join tbUserType in myModels.S_UserType on tbUserRoleDetail.UserTypeID equals tbUserType.UserTypeID join tbemployee in myModels.S_Employee on tbUser.UserID equals tbemployee.UserID where tbUser.UserID == dbUser.UserID &amp;&amp; tbUserType.typeClass == strUserType.Trim() select new { tbUserType." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/624eacc48380b6c209c1b65162cd0ef7/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-06T16:22:44+08:00" />
<meta property="article:modified_time" content="2019-07-06T16:22:44+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">模仿QQ登录头像的切换</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>模仿QQ登录头像的切换</p> 
<p>开发工具与关键技术：SQL Server 2014 Management Studio 如何切换登录的头像<br> 作者：李国旭<br> 撰写时间：2019年7月6日</p> 
<p>我们平时如果注意的话会发现QQ登录的头像会随着我们的帐号的切换而切换，还有就是微信的登陆也是这样都会随着我们的账号的变化而变化；就觉得很神奇，那么他是怎样实现这样的登录的效果的呢？我们一起来看一下它的神奇之处！<br> 就用我现在做的这个项目为例：首先，就要把它员工或者是管理员的账号、密码通过新增进数据库中，把账号和密码一起保存在数据库中。注意：密码不能用明文保存在数据库，一定要加密后再保存进数据库里，要不然明文的密码和容易给别人窃取，而且这样做很危险，所以一定要进行加密后再保存到数据库中。</p> 
<p>那么先判断我们的输入账号显示用户的头像，获取它账号的值，判断它的账号不等于空；然后For…in…循环i++，从控制器那边获取到账号的值，拼接账号加上它的参数来传参，然后再new一个时间；然后就是把图片show出来，否则就是hide隐藏起来，如下图所示：<br> <img src="https://images2.imgbox.com/56/12/4RjgcKJl_o.png" alt="在这里插入图片描述"></p> 
<p>当然啦，我们也要在控制器那边判断我们选择的角色的类型对不对，，对用户输入的密码加密，然后再判断加密后的密码和数据库中的密码比较，之后就是验证选择的角色是否正确，把用户的数据放入session中，获取用户类型的名称和ID<br> 最后就是设置session，传递用户ID和用户类型的ID<br> 下面的就是判断它的用户的角色类型的选择是否正确的代码</p> 
<pre><code>//对用户输入的密码加密
string PassWord = AESEncryptHelper.Encrypt(strPassWord);
//用加密后的密码和数据库查询到的密码比较
if (PassWord == dbUser.PassWord)
{
//==验证选择的角色是否正确
var listUserType = (from tbUser in myModels.S_User
join tbUserRoleDetail in myModels.S_UserRoleDetail on tbUser.UserID equals tbUserRoleDetail.UserID
join tbUserType in myModels.S_UserType on tbUserRoleDetail.UserTypeID equals tbUserType.UserTypeID
join tbemployee in myModels.S_Employee on tbUser.UserID equals tbemployee.UserID
where tbUser.UserID == dbUser.UserID &amp;&amp; tbUserType.typeClass == strUserType.Trim()
select new
{
tbUserType.UserTypeID,
tbUserType.UserType
}).ToList();
if (listUserType.Count &gt; 0)
{
//===确认身份正确

//把用户数据放到session中
//获取用户类型名称
string userTypeName = listUserType[0].UserType.Trim();
//获取用户类型ID
int userTypeId = listUserType[0].UserTypeID;

//设置session
Session["UserID"] = dbUser.UserID; // 传递 UserID
Session["UserTypeID"] = userTypeId;// 传递 UserTypeID
Session["ServerTime"] = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss") ;//登录时间
Session["UserType"] = strUserType;//用户的类型 1-客户；2-员工；3-管理
</code></pre> 
<p>判断用户的账号不等于空和它的账号名的长度大于或等于3，查询员工的数据和员工的图片，用byte[] EmployeePicture = empImage.EmployeePicture;来装图片，然后再判断员工的图片不等于空就返回图片的文件，为了避免有一些员工的图片是空所以有些它就会不显示，否则就是返回一个空的值。如下图片所示：<br> <img src="https://images2.imgbox.com/28/17/TozeJbUH_o.png" alt="在这里插入图片描述"><br> 就好像上图一样，我给它一个放置装图片的框，然后当我们在输入账号的时候它就会显示出来，没输入的时候它就会自动的隐藏起来，当我们再次输入完整的账号的时候，它才会真正的显示出来<br> 下面呢就是效果图了，每一次输入的账号不同它的头像都会不一样都会随着账号的变化而变化。<br> 如图所示：</p> 
<p><img src="https://images2.imgbox.com/48/84/gYkCik5C_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/1980c7d6b126818258caccd064b8b34f/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">把数据导出到Excel</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/07614b796711d725cf0d52a4344772fe/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">autojs安卓免root脚本代码UI选择文件源码</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>