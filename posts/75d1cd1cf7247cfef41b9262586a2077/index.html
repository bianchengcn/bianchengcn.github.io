<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何同步 Github 和 Gitee的仓库代码 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="如何同步 Github 和 Gitee的仓库代码" />
<meta property="og:description" content="一、从github导入仓库，手动同步 在 Gitee 的项目主页，导入的仓库会会有一个同步的按钮，你只用点一下，即可与 Github 同步更新，但是注意这里的同步功能默认是强制同步。有点麻烦的是，我们需要在推送到 Github 后，再到 Gitee 项目主页手动点击一下。
二、推送两个仓库 可以通过本地仓库的形式，同时推送到github和gitee，相当于执行两次commit的操作，push两次。但显然也不是我想要的。
git remote add 远程库名 远程库地址 eg: git remote add gitee git@github.com:xxx/xxx.git 除此之外我们还可以在sh脚本文件里deploy.sh直接推送2个仓库
#!/usr/bin/env sh # 确保脚本抛出遇到的错误 set -e # 定义变量 dist_path=docs/.vuepress/dist # 打包生成的文件夹路径 # 生成静态文件 npm run docs:build # 进入生成的文件夹 cd $dist_path git init git add -A git commit -m &#39;deploy&#39; # 如果发布到 https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt; git push -f git@github.com:ytking/test.git master:gh-pages git push -f git@gitee.com:ytanck/test.git master:gh-pages cd - rm -rf $dist_path 当我们执行 sh deploy." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/75d1cd1cf7247cfef41b9262586a2077/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-18T17:37:40+08:00" />
<meta property="article:modified_time" content="2023-10-18T17:37:40+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何同步 Github 和 Gitee的仓库代码</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="github_0"></a>一、从github导入仓库，手动同步</h3> 
<p><img src="https://images2.imgbox.com/3b/bc/VyJRtyw5_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/da/2b/JmjG59BR_o.png" alt="在这里插入图片描述"><br> 在 Gitee 的项目主页，导入的仓库会会有一个同步的按钮，你只用点一下，即可与 Github 同步更新，但是注意这里的同步功能默认是强制同步。有点麻烦的是，我们需要在推送到 Github 后，再到 Gitee 项目主页手动点击一下。</p> 
<h3><a id="_6"></a>二、推送两个仓库</h3> 
<p>可以通过本地仓库的形式，同时推送到github和gitee，相当于执行两次commit的操作，push两次。但显然也不是我想要的。<br> <img src="https://images2.imgbox.com/2a/16/CdWox9Je_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript">git remote add 远程库名 远程库地址
<span class="token literal-property property">eg</span><span class="token operator">:</span> git remote add gitee git@github<span class="token punctuation">.</span>com<span class="token operator">:</span>xxx<span class="token operator">/</span>xxx<span class="token punctuation">.</span>git
</code></pre> 
<p>除此之外我们还可以在sh脚本文件里<code>deploy.sh</code>直接推送2个仓库</p> 
<pre><code class="prism language-javascript"><span class="token hashbang comment">#!/usr/bin/env sh</span>

# 确保脚本抛出遇到的错误
set <span class="token operator">-</span>e
# 定义变量
dist_path<span class="token operator">=</span>docs<span class="token operator">/</span><span class="token punctuation">.</span>vuepress<span class="token operator">/</span>dist # 打包生成的文件夹路径

# 生成静态文件
npm run docs<span class="token operator">:</span>build

# 进入生成的文件夹
cd $dist_path

git init
git add <span class="token operator">-</span><span class="token constant">A</span>
git commit <span class="token operator">-</span>m <span class="token string">'deploy'</span>

# 如果发布到 https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token constant">USERNAME</span><span class="token operator">&gt;</span><span class="token punctuation">.</span>github<span class="token punctuation">.</span>io<span class="token operator">/</span><span class="token operator">&lt;</span><span class="token constant">REPO</span><span class="token operator">&gt;</span>
git push <span class="token operator">-</span>f git@github<span class="token punctuation">.</span>com<span class="token operator">:</span>ytking<span class="token operator">/</span>test<span class="token punctuation">.</span>git master<span class="token operator">:</span>gh<span class="token operator">-</span>pages
git push <span class="token operator">-</span>f git@gitee<span class="token punctuation">.</span>com<span class="token operator">:</span>ytanck<span class="token operator">/</span>test<span class="token punctuation">.</span>git master<span class="token operator">:</span>gh<span class="token operator">-</span>pages

cd <span class="token operator">-</span>
rm <span class="token operator">-</span>rf $dist_path
</code></pre> 
<p>当我们执行 sh deploy.sh 的时候，就会自动往两个仓库里推送。</p> 
<h3><a id="Github_Actions__42"></a>三、Github Actions 自动同步</h3> 
<p>官方的Action方法Github Action。可以参考阮一峰老师的<a href="https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" rel="nofollow">《GitHub Actions 入门教程》</a></p> 
<p>运用CI/CD的思想，从github中自动化的执行流程，完美符合我们的预期。<br> 需要将SSH公钥传到 Gitee和GitHub 上，这样就可以实现 GitHub 和 Gitee 的通信。</p> 
<p><strong>Actions方法1</strong>：使用<a href="https://github.com/Yikun/hub-mirror-action">Yikun/hub-mirror-action@master</a><br> 需要SSH私钥和gitee私人令牌<br> 在项目根目录新建.github/workflows/syncToGitee.yml脚本如下：</p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">name</span><span class="token operator">:</span> Sync to Gitee

<span class="token literal-property property">on</span><span class="token operator">:</span>
  <span class="token literal-property property">push</span><span class="token operator">:</span>
    <span class="token literal-property property">branches</span><span class="token operator">:</span> <span class="token punctuation">[</span>master<span class="token punctuation">,</span> gh<span class="token operator">-</span>pages<span class="token punctuation">]</span>

  <span class="token literal-property property">workflow_dispatch</span><span class="token operator">:</span>

<span class="token literal-property property">jobs</span><span class="token operator">:</span>
  <span class="token literal-property property">build</span><span class="token operator">:</span>
    runs<span class="token operator">-</span>on<span class="token operator">:</span> ubuntu<span class="token operator">-</span>latest
    <span class="token literal-property property">steps</span><span class="token operator">:</span>
      <span class="token operator">-</span> name<span class="token operator">:</span> Sync to Gitee
        <span class="token literal-property property">uses</span><span class="token operator">:</span> Yikun<span class="token operator">/</span>hub<span class="token operator">-</span>mirror<span class="token operator">-</span>action@master
        <span class="token keyword">with</span><span class="token operator">:</span>
          # 必选，需要同步的Github用户（源）
          <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">'github/ytking'</span>
          # 必选，需要同步到的Gitee的用户（目的）
          <span class="token literal-property property">dst</span><span class="token operator">:</span> <span class="token string">'gitee/ytanck'</span>
          # 必选，Gitee公钥对应的私钥
          <span class="token literal-property property">dst_key</span><span class="token operator">:</span> $<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> secrets<span class="token punctuation">.</span><span class="token constant">GITEE_PRIVATE_KEY</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          # 必选，Gitee对应的用于创建仓库的token
          <span class="token literal-property property">dst_token</span><span class="token operator">:</span>  $<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> secrets<span class="token punctuation">.</span><span class="token constant">GITEE_TOKEN</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
          # static_list 仓库名称 单一仓库同步
          <span class="token literal-property property">static_list</span><span class="token operator">:</span> <span class="token string">"ytking"</span>
          # 如果是组织，指定组织即可，默认为用户user
          # account_type<span class="token operator">:</span> org
          # 还有黑、白名单，静态名单机制，可以用于更新某些指定库
          # static_list<span class="token operator">:</span> repo_name
          # black_list<span class="token operator">:</span> <span class="token string">'repo_name,repo_name2'</span>
          # white_list<span class="token operator">:</span> <span class="token string">'repo_name,repo_name2'</span>
          # force_update 表示启用 git push <span class="token operator">-</span>f 强制同步
          <span class="token literal-property property">force_update</span><span class="token operator">:</span> <span class="token boolean">true</span>
          # debug 为 <span class="token boolean">true</span> 表示启用 debug 开关，会显示所有执行命令
          <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">true</span>

</code></pre> 
<p><code>src </code>表示需要被同步的源端账户名，即我们 Github 的账户名，因为我的 Github ID 是 <code>ytking</code>，所以这里我应该改成 <code>github/ytking</code>。</p> 
<p><code>dst</code> 表示需要同步到的目的端账户名，即我们 Gitee 的账户名，因为我的 Gitee ID 也是 <code>ytanck</code>，所以这里我应该改成 <code>gitee/ytanck</code>。</p> 
<p><code>dst_key</code> 表示用于在目的端上传代码的私钥SSH，然后将其保存在 Secrets 中。如何获取SSH请自行百度</p> 
<p>复制私钥内容，然后在要同步的 Github 仓库中，选择 “Setting” -&gt; “Secrets” -&gt; “New repository secret”<br> <img src="https://images2.imgbox.com/cb/99/EDQF4Bnq_o.png" alt="在这里插入图片描述"><br> 如何获取<code>GITEEN_TOKEN</code>，在 Gitee 上创建一个私人令牌（token），这个记得保存，因为它只会出现一次</p> 
<p><img src="https://images2.imgbox.com/4c/1a/IbJyhyoT_o.png" alt="在这里插入图片描述"><br> 配置完成后我们push分支，使用Sync to Gitee的 Action的workflow已经运行起来了<br> <img src="https://images2.imgbox.com/57/da/yrq743RL_o.png" alt="在这里插入图片描述"></p> 
<p><strong>Actions方法二</strong>：<br> 使用 <a href="https://github.com/wearerequired/git-mirror-action">wearerequired/git-mirror-action@v1</a><br> 在项目根目录新建.github/workflows/sync-gitee.yml脚本</p> 
<pre><code class="prism language-javascript"><span class="token literal-property property">name</span><span class="token operator">:</span> Sync to Gitee

<span class="token literal-property property">on</span><span class="token operator">:</span>
  <span class="token literal-property property">push</span><span class="token operator">:</span>
    <span class="token literal-property property">branches</span><span class="token operator">:</span> <span class="token punctuation">[</span>master<span class="token punctuation">,</span> gh<span class="token operator">-</span>pages<span class="token punctuation">]</span>

  <span class="token literal-property property">workflow_dispatch</span><span class="token operator">:</span>

<span class="token literal-property property">jobs</span><span class="token operator">:</span>
  <span class="token literal-property property">build</span><span class="token operator">:</span>
    runs<span class="token operator">-</span>on<span class="token operator">:</span> ubuntu<span class="token operator">-</span>latest
    <span class="token literal-property property">steps</span><span class="token operator">:</span>
      <span class="token operator">-</span> name<span class="token operator">:</span> Sync to Gitee
        <span class="token literal-property property">uses</span><span class="token operator">:</span> wearerequired<span class="token operator">/</span>git<span class="token operator">-</span>mirror<span class="token operator">-</span>action@v1
        <span class="token literal-property property">env</span><span class="token operator">:</span>
          # 在 Settings<span class="token operator">-</span><span class="token operator">&gt;</span>Secrets 配置 <span class="token constant">GITEE_PRIVATE_KEY</span>
          <span class="token constant">SSH_PRIVATE_KEY</span><span class="token operator">:</span> $<span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> secrets<span class="token punctuation">.</span><span class="token constant">GITEE_PRIVATE_KEY</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token keyword">with</span><span class="token operator">:</span>
          # GitHub 源仓库地址
          source<span class="token operator">-</span>repo<span class="token operator">:</span> git@github<span class="token punctuation">.</span>com<span class="token operator">:</span>ytking<span class="token operator">/</span>monorepo<span class="token operator">-</span>pnpm<span class="token punctuation">.</span>git
          # Gitee 目标仓库地址
          destination<span class="token operator">-</span>repo<span class="token operator">:</span> git@gitee<span class="token punctuation">.</span>com<span class="token operator">:</span>ytanck<span class="token operator">/</span>monorepo<span class="token operator">-</span>pnpm<span class="token punctuation">.</span>git
          
</code></pre> 
<p><code>GITEE_PRIVATE_KEY</code>就是<code>SSH私钥</code>，如何获取shh请自行百度。另外方法二需要配置公钥，方法如下：复制<code>id_rsa.pub</code>，<br> <img src="https://images2.imgbox.com/44/99/QPpKxgQS_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/08/50/gbeybTNL_o.png" alt="在这里插入图片描述"><br> 配置完成后，但你再push master分支时就会触发工作流的Action<br> <img src="https://images2.imgbox.com/a7/dc/n5tvjcwU_o.png" alt="在这里插入图片描述"><br> 此时就会发现Gitee也同步更新了<br> <img src="https://images2.imgbox.com/38/49/OjM4zfqD_o.png" alt="在这里插入图片描述"><br> <mark>注：方法一如果不指定仓库，会自动同步所有仓库，方法二是针对某一仓库去同步，前提要在Gitee里提前创建好了指定名字的空仓库。</mark></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e57fc01353c5ca782358c7eb291d4ef5/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">电脑不能调节亮度了</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/87fbc02c9f2acc9cb4187b31931bd6b9/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Java中 Map集合 compute 、computeIfAbsent 、 computeIfPresent、putIfAbsent 、getOrDefault 方法的区别</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>