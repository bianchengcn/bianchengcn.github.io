<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python 读取 Excel 详解（openyxl） - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Python 读取 Excel 详解（openyxl）" />
<meta property="og:description" content="文章目录 1 概述1.1 图示1.2 安装第三方库 2 工作簿 workbook2.1 创建：Workbook()2.2 常用属性：load_workbook()2.3 获取 sheet2.4 创建 sheet2.5 复制 sheet2.6 删除 sheet2.7 移动 sheet2.8 重命名 Sheet 3 工作表 sheet3.1 追加数据3.2 查询数据3.3 修改数据3.4 删除数据3.5 获取表头3.6 遍历数据 4 单元格 cell4.1 查询4.2 修改 1 概述 1.1 图示 import openyxl 非内置模块，需安装：pip install openpyxl 适用对象：Excel 2007 及以上 （*.xlsx） 常用对象：工作簿、工作表、单元格 1.2 安装第三方库 若执行 pip install openpyxl 提示失败，则请看以下博客CSDN 博客：https://blog.csdn.net/qq_34745941/article/details/106341898 2 工作簿 workbook 2.1 创建：Workbook() import openpyxl class Excel(object): def __init__(self): pass def create_workbook(self, filename): &#34;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/26faf549ba9649c574af139a136070e6/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-13T15:55:04+08:00" />
<meta property="article:modified_time" content="2023-12-13T15:55:04+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python 读取 Excel 详解（openyxl）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#1__2" rel="nofollow">1 概述</a></li><li><ul><li><a href="#11__3" rel="nofollow">1.1 图示</a></li><li><a href="#12__10" rel="nofollow">1.2 安装第三方库</a></li></ul> 
  </li><li><a href="#2__workbook_16" rel="nofollow">2 工作簿 workbook</a></li><li><ul><li><a href="#21_Workbook_17" rel="nofollow">2.1 创建：Workbook()</a></li><li><a href="#22_load_workbook_45" rel="nofollow">2.2 常用属性：load_workbook()</a></li><li><a href="#23__sheet_79" rel="nofollow">2.3 获取 sheet</a></li><li><a href="#24__sheet_107" rel="nofollow">2.4 创建 sheet</a></li><li><a href="#25__sheet_137" rel="nofollow">2.5 复制 sheet</a></li><li><a href="#26__sheet_165" rel="nofollow">2.6 删除 sheet</a></li><li><a href="#27__sheet_190" rel="nofollow">2.7 移动 sheet</a></li><li><a href="#28__Sheet_215" rel="nofollow">2.8 重命名 Sheet</a></li></ul> 
  </li><li><a href="#3__sheet_238" rel="nofollow">3 工作表 sheet</a></li><li><ul><li><a href="#31__239" rel="nofollow">3.1 追加数据</a></li><li><a href="#32__275" rel="nofollow">3.2 查询数据</a></li><li><a href="#33__317" rel="nofollow">3.3 修改数据</a></li><li><a href="#34__349" rel="nofollow">3.4 删除数据</a></li><li><a href="#35__380" rel="nofollow">3.5 获取表头</a></li><li><a href="#36__408" rel="nofollow">3.6 遍历数据</a></li></ul> 
  </li><li><a href="#4__cell_442" rel="nofollow">4 单元格 cell</a></li><li><ul><li><a href="#41__444" rel="nofollow">4.1 查询</a></li><li><a href="#42__481" rel="nofollow">4.2 修改</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1__2"></a>1 概述</h2> 
<h3><a id="11__3"></a>1.1 图示</h3> 
<div class="mermaid"> 
 <svg id="mermaid-svg-IHXXi8VoWRRv9uA8" width="514.8666381835938" xmlns="http://www.w3.org/2000/svg" height="254" viewbox="0 0 514.8666381835938 254" class="mermaid-svg"> 
  <style>#mermaid-svg-IHXXi8VoWRRv9uA8 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .error-icon{fill:#552222;}#mermaid-svg-IHXXi8VoWRRv9uA8 .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-IHXXi8VoWRRv9uA8 .marker{fill:#333333;stroke:#333333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .marker.cross{stroke:#333333;}#mermaid-svg-IHXXi8VoWRRv9uA8 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .cluster-label text{fill:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .cluster-label span{color:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .label text,#mermaid-svg-IHXXi8VoWRRv9uA8 span{fill:#333;color:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .node rect,#mermaid-svg-IHXXi8VoWRRv9uA8 .node circle,#mermaid-svg-IHXXi8VoWRRv9uA8 .node ellipse,#mermaid-svg-IHXXi8VoWRRv9uA8 .node polygon,#mermaid-svg-IHXXi8VoWRRv9uA8 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .node .label{text-align:center;}#mermaid-svg-IHXXi8VoWRRv9uA8 .node.clickable{cursor:pointer;}#mermaid-svg-IHXXi8VoWRRv9uA8 .arrowheadPath{fill:#333333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg-IHXXi8VoWRRv9uA8 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg-IHXXi8VoWRRv9uA8 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg-IHXXi8VoWRRv9uA8 .cluster text{fill:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 .cluster span{color:#333;}#mermaid-svg-IHXXi8VoWRRv9uA8 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-IHXXi8VoWRRv9uA8 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style> 
  <g> 
   <g class="output"> 
    <g class="clusters"></g> 
    <g class="edgePaths"> 
     <g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"> 
      <path class="path" d="M93.52951073646545,104L104.83014698823293,91.83333333333333C116.13078324000041,79.66666666666667,138.73205574353537,55.333333333333336,154.1993586619695,43.166666666666664C169.66666158040366,31,177.99999491373697,31,182.16666158040366,31L186.3333282470703,31" marker-end="url(#arrowhead31)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead31" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"> 
      <path class="path" d="M136.3333282470703,127L140.49999491373697,127C144.66666158040366,127,152.99999491373697,127,162.6333262125651,127C172.26665751139322,127,183.19998677571616,127,188.6666514078776,127L194.13331604003906,127" marker-end="url(#arrowhead32)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead32" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path> 
       </marker> 
      </defs> 
     </g> 
     <g class="edgePath LS-A LE-D" style="opacity: 1;" id="L-A-D"> 
      <path class="path" d="M93.52951073646545,150L104.83014698823293,162.16666666666666C116.13078324000041,174.33333333333334,138.73205574353537,198.66666666666666,157.9104690949122,210.83333333333334C177.08888244628906,223,192.8444366455078,223,200.7222137451172,223L208.59999084472656,223" marker-end="url(#arrowhead33)" style="fill:none"></path> 
      <defs> 
       <marker id="arrowhead33" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"> 
        <path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path> 
       </marker> 
      </defs> 
     </g> 
    </g> 
    <g class="edgeLabels"> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
     <g class="edgeLabel" style="opacity: 1;" transform=""> 
      <g transform="translate(0,0)" class="label"> 
       <rect rx="0" ry="0" width="0" height="0"></rect> 
       <foreignobject width="0" height="0"> 
        <div style="display: inline-block; white-space: nowrap;"> 
         <span id="L-L-A-D" class="edgeLabel L-LS-A' L-LE-D"></span> 
        </div> 
       </foreignobject> 
      </g> 
     </g> 
    </g> 
    <g class="nodes"> 
     <g class="node default" style="opacity: 1;" id="flowchart-A-30" transform="translate(72.16666412353516,127)"> 
      <rect rx="0" ry="0" x="-64.16666412353516" y="-23" width="128.3333282470703" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-54.166664123535156,-13)"> 
        <foreignobject width="108.33332824707031" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           import openyxl 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-B-31" transform="translate(346.59999084472656,31)"> 
      <rect rx="5" ry="5" x="-160.26666259765625" y="-23" width="320.5333251953125" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-150.26666259765625,-13)"> 
        <foreignobject width="300.5333251953125" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           非内置模块，需安装：pip install openpyxl 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-C-33" transform="translate(346.59999084472656,127)"> 
      <rect rx="5" ry="5" x="-152.4666748046875" y="-23" width="304.933349609375" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-142.4666748046875,-13)"> 
        <foreignobject width="284.933349609375" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           适用对象：Excel 2007 及以上 （*.xlsx） 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
     <g class="node default" style="opacity: 1;" id="flowchart-D-35" transform="translate(346.59999084472656,223)"> 
      <rect rx="5" ry="5" x="-138" y="-23" width="276" height="46" class="label-container"></rect> 
      <g class="label" transform="translate(0,0)"> 
       <g transform="translate(-128,-13)"> 
        <foreignobject width="256" height="26"> 
         <div style="display: inline-block; white-space: nowrap;">
           常用对象：工作簿、工作表、单元格 
         </div> 
        </foreignobject> 
       </g> 
      </g> 
     </g> 
    </g> 
   </g> 
  </g> 
 </svg> 
</div> 
<h3><a id="12__10"></a>1.2 安装第三方库</h3> 
<ul><li>若执行 <code>pip install openpyxl</code> 提示失败，则请看以下博客</li><li><a href="https://blog.csdn.net/qq_34745941/article/details/106341898">CSDN 博客：https://blog.csdn.net/qq_34745941/article/details/106341898</a></li></ul> 
<h2><a id="2__workbook_16"></a>2 工作簿 workbook</h2> 
<h3><a id="21_Workbook_17"></a>2.1 创建：Workbook()</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">create_workbook</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        创建工作簿对象：workbook
        :param filename: 文件名（相对路径 或 绝对路径）
        :return:
        """</span>
        <span class="token comment"># 1.声明 工作簿 对象</span>
        workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># 2.保存 工作簿（若已存在，则覆盖）</span>
        workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>create_workbook<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/73/ab/wA17l6wm_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="22_load_workbook_45"></a>2.2 常用属性：load_workbook()</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">load_workbook</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取工作簿对象（获取属性前，先要加载工作簿）</span>
        workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>

        <span class="token comment"># 2.查看工作簿支持的方法和属性</span>
        <span class="token comment"># print(help(workbook))</span>

        <span class="token comment"># 3.常用的属性</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'active: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>active<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 当前活动的 sheet 页</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'read_only: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>read_only<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 是否以只读方式打开</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'encoding: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>encoding<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 编码</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'properties: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>properties<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 属性类，如：标题、作者、创建日期 等</span>
        <span class="token comment"># 单个的属性信息，可通过下列形式 "." 出来</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'title: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>title<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 标题</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'creator: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>creator<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 作者</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'created: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>workbook<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>created<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 创建日期</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="23__sheet_79"></a>2.3 获取 sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_sheets</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 列表</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>sheetnames<span class="token punctuation">)</span>  <span class="token comment"># 如：['Sheet', 'Sheet1']</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>worksheets<span class="token punctuation">)</span>  <span class="token comment"># 如：[&lt;Worksheet "Sheet"&gt;, &lt;Worksheet "Sheet1"&gt;]</span>
        <span class="token comment"># print(self.workbook.get_sheet_names())  # deprecated function 已弃用</span>

        <span class="token comment"># 2.获取单个 sheet</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 根据名称</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>sheetnames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 根据下标，如：Sheet</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>worksheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 根据下标，如：&lt;Worksheet "Sheet"&gt;</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>get_sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="24__sheet_107"></a>2.4 创建 sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">create_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.末尾追加</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">'Sheet3'</span><span class="token punctuation">)</span>

        <span class="token comment"># 2.指定位置添加（index 从 0 开始，默认末尾）</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">'Sheet4'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

        <span class="token comment"># 3.注意：若 Sheet 已存在，会默认在名称后面追加数字，如：Sheet31、Sheet32</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">'Sheet3'</span><span class="token punctuation">)</span>

        <span class="token comment"># 4.保存（只有保存后，才会生效哦）</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="25__sheet_137"></a>2.5 复制 sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">copy_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>

        <span class="token comment"># 2.复制 sheet（默认名称 + copy，如：Sheet Copy）</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>copy_worksheet<span class="token punctuation">(</span>sheet<span class="token punctuation">)</span>

        <span class="token comment"># 3.保存（只有保存后，才会生效哦）</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>copy_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="26__sheet_165"></a>2.6 删除 sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">delete_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.删除 sheet</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet Copy'</span><span class="token punctuation">]</span>

        <span class="token comment"># 2.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>delete_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="27__sheet_190"></a>2.7 移动 sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">move_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.移动 sheet（负数=向左移动、正数=向右移动、数值=移动位置的个数）</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>move_sheet<span class="token punctuation">(</span><span class="token string">'Sheet'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

        <span class="token comment"># 2.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>move_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="28__Sheet_215"></a>2.8 重命名 Sheet</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">rename_sheet</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.重命名 sheet</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'Sheet111'</span>

        <span class="token comment"># 2.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>rename_sheet<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="3__sheet_238"></a>3 工作表 sheet</h2> 
<h3><a id="31__239"></a>3.1 追加数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">append_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取要添加数据的 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.追加数据</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'姓名'</span><span class="token punctuation">,</span> <span class="token string">'性别'</span><span class="token punctuation">,</span> <span class="token string">'年龄'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'李四'</span><span class="token punctuation">,</span> <span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'王五'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># 3.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>append_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7e/1a/cGCvrRNH_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="32__275"></a>3.2 查询数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">select_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.查询属性</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'title: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>title<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 标题，如：Sheet</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'dimensions: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>dimensions<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 表格大小，如：A1:B3</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'min_row: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>min_row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 最小行 1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'max_row: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 最大行 3</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'rows: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>rows<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 行对象</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'min_column: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>min_column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 最小列 1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'max_column: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>max_column<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 最大列 2</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'columns: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>sheet<span class="token punctuation">.</span>columns<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>  <span class="token comment"># 列对象</span>

        <span class="token comment"># 3.查询单元格数据</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>

        <span class="token comment"># 4.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>select_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="33__317"></a>3.3 修改数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">update_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.修改数据</span>
        sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'我是A1'</span>
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'我是A2'</span>
        sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'我是A3'</span><span class="token punctuation">)</span>

        <span class="token comment"># 3.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>update_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="34__349"></a>3.4 删除数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">update_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.删除数据</span>
        sheet<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span>idx<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> amount<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># idx 行开始(含)，往下删除 amount 行</span>
        sheet<span class="token punctuation">.</span>delete_cols<span class="token punctuation">(</span>idx<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> amount<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># idx 列开始(含)，往右删除 amount 行</span>

        <span class="token comment"># 3.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>update_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="35__380"></a>3.5 获取表头</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">get_sheet_head</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.获取表头，其中：values_only=True 表示只获取值</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_cols<span class="token punctuation">(</span>min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>get_sheet_head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="36__408"></a>3.6 遍历数据</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">def</span> <span class="token function">read_excel</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    遍历 sheet 中的数据
    :param filename: 文件名
    """</span>
    lwb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>

    <span class="token comment"># sheet 列表</span>
    <span class="token comment"># sheet = lwb['Sheet']</span>
    sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> lwb<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>  <span class="token comment"># 手动指定类型，可用代码提示</span>

    <span class="token comment"># 遍历方式1：按行遍历</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>column<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'------------------ 分割线1 -----------------'</span><span class="token punctuation">)</span>

    <span class="token comment"># 遍历方式2：按列遍历</span>
    <span class="token keyword">for</span> col <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_cols<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> cell <span class="token keyword">in</span> col<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>column<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    fileName <span class="token operator">=</span> <span class="token string">'1.xlsx'</span>
    read_excel<span class="token punctuation">(</span>fileName<span class="token punctuation">)</span>
</code></pre> 
<h2><a id="4__cell_442"></a>4 单元格 cell</h2> 
<h3><a id="41__444"></a>4.1 查询</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">get_cell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 2.获取单个单元格数据</span>
        cell1 <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span>  <span class="token comment"># A1 单元格</span>
        cell2 <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 效果同上</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell1<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>cell2<span class="token punctuation">.</span>value<span class="token punctuation">)</span>

        <span class="token comment"># 3.查询多个单元格数据</span>
        cells <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">'A1:B2'</span><span class="token punctuation">]</span>

        <span class="token keyword">for</span> item <span class="token keyword">in</span> cells<span class="token punctuation">:</span>
            <span class="token keyword">for</span> cell <span class="token keyword">in</span> item<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>column<span class="token punctuation">,</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>get_cell<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="42__481"></a>4.2 修改</h3> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>worksheet <span class="token keyword">import</span> Worksheet


<span class="token keyword">class</span> <span class="token class-name">Excel</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>workbook <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>filename <span class="token operator">=</span> filename

    <span class="token keyword">def</span> <span class="token function">update_cell</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 1.获取 sheet 对象</span>
        sheet<span class="token punctuation">:</span> Worksheet <span class="token operator">=</span> self<span class="token punctuation">.</span>workbook<span class="token punctuation">[</span><span class="token string">'Sheet'</span><span class="token punctuation">]</span>
        <span class="token comment"># 与下列写法等价，只是多了 "代码提示"</span>
        <span class="token comment"># sheet = self.workbook['Sheet']</span>

        <span class="token comment"># 3.修改 单元格 A1 的值为 'A1'</span>
        cell1 <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span>  <span class="token comment"># A1 单元格</span>
        cell1<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'A1'</span>  <span class="token comment"># 赋值</span>

        <span class="token comment"># 3.保存后生效</span>
        self<span class="token punctuation">.</span>workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>self<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    test <span class="token operator">=</span> Excel<span class="token punctuation">(</span><span class="token string">'1.xlsx'</span><span class="token punctuation">)</span>
    <span class="token comment"># C:\Users\Administrator\Desktop\Temp\1.xlsx</span>
    test<span class="token punctuation">.</span>update_cell<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e53bc5bd79e2a4f7eafcb867c8745b9b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Spring-Security取消验证-Get请求接口正常，Post请求报错403</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/756cbc59e7c3b5f76cfc60b5ced73e56/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Uniapp微信小程序使用插件跳转外部小程序（无需用户同意）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>