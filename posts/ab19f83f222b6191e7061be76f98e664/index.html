<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>php  base64图片保存到服务器 - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="php  base64图片保存到服务器" />
<meta property="og:description" content="html &lt;form enctype=&#34;multipart/form-data&#34; id=&#34;oForm&#34;&gt; &lt;input type=&#34;file&#34; name=&#34;file&#34; id=&#34;file&#34; onchange=&#34;readAsDataURL()&#34; /&gt; &lt;input type=&#34;button&#34; value=&#34;提交&#34; onclick=&#34;doUpload()&#34; /&gt; &lt;/form&gt; &lt;div&gt; &lt;img alt=&#34;&#34; id=&#34;img&#34;/&gt; &lt;/div&gt; script function doUpload() { var data = $(&#39;#img&#39;).attr(&#39;src&#39;); $.post(&#39;1.php&#39;,{data:data},function(res){ console.log(res) }); } function readAsDataURL(){ //检验是否为图像文件 var file = document.getElementById(&#34;file&#34;).files[0]; if(!/image\/\w&#43;/.test(file.type)){ alert(&#34;看清楚，这个需要图片！&#34;); return false; }else{ var reader = new FileReader(); //将文件以Data URL形式读入页面 reader.readAsDataURL(file); reader.onload=function(e){ var result=document.getElementById(&#34;img&#34;); //显示文件 result.src= this.result ; } } } php $base64 = $_POST[&#39;data&#39;]; $arr = explode(&#39;,&#39;,$base64); $base64Str = $arr[1]; $ext = base64Ext($arr[0]); $file = base64_decode($base64Str); $name = time(); $r = file_put_contents(&#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ab19f83f222b6191e7061be76f98e664/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-07-31T12:56:59+08:00" />
<meta property="article:modified_time" content="2018-07-31T12:56:59+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">php  base64图片保存到服务器</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2>html</h2> 
<pre class="has"><code>&lt;form enctype="multipart/form-data" id="oForm"&gt;
  		&lt;input type="file" name="file" id="file" onchange="readAsDataURL()" /&gt;
  		&lt;input type="button" value="提交" onclick="doUpload()" /&gt;
&lt;/form&gt;
&lt;div&gt;
	&lt;img alt="" id="img"/&gt;
&lt;/div&gt;

</code></pre> 
<h2>script</h2> 
<pre class="has"><code>function doUpload() { 
   	var data = $('#img').attr('src');
   	$.post('1.php',{data:data},function(res){
   		console.log(res)
   	});
	} 
function readAsDataURL(){
  //检验是否为图像文件
    var file = document.getElementById("file").files[0];
    if(!/image\/\w+/.test(file.type)){
      alert("看清楚，这个需要图片！");
      return false;
    }else{
    var reader = new FileReader();
    //将文件以Data URL形式读入页面
    reader.readAsDataURL(file);
    reader.onload=function(e){
      var result=document.getElementById("img");
      //显示文件
      result.src= this.result ;
    }
  }
}</code></pre> 
<h2>php</h2> 
<pre class="has"><code>	$base64 = $_POST['data'];

	$arr = explode(',',$base64);

	$base64Str = $arr[1];
	$ext = base64Ext($arr[0]);

	$file = base64_decode($base64Str);
	$name = time();
	$r = file_put_contents('./'.$name.'.'.$ext, $file);
	if($r){
		echo 1;
	}else{
		echo 2;
	}
	// 传入base64前部分带有照片后缀的字符串
	function base64Ext($str){       
		$step1 = explode('/', $str);
		$step2 = explode(';', $step1[1]);
		return $step2[0];
	}</code></pre> 
<p> </p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/64d1f58633a36a1dc3dfd8bcc2f11262/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">模型过拟合问题</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9acf3ccbc532f2c96934b49c55ef70fd/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">SQL学习-数据库的备份和还原  分离和附加</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>