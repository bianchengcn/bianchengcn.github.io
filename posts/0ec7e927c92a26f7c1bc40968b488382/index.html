<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tplmap的安装与用法（内包含解决缺少库报错的处理教程） - 编程中国的博客</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Tplmap的安装与用法（内包含解决缺少库报错的处理教程）" />
<meta property="og:description" content="Tplmap简介 Tplmap是一个python工具，可以通过使用沙箱转义技术找到代码注入和服务器端模板注入（SSTI）漏洞。该工具能够在许多模板引擎中利用SSTI来访问目标文件或操作系统。一些受支持的模板引擎包括PHP（代码评估），Ruby（代码评估），JaveScript（代码评估），Python（代码评估），ERB，Jinja2和Tornado。该工具可以执行对这些模板引擎的盲注入，并具有执行远程命令的能力。
Tplmap的安装步骤 在kali打开终端，输入
git clone https://github.com/epinna/tplmap
关于git，如没有该命令，则需要安装：（该命令需要在root权限下运行）
apt-get install git
有了git，以后github上下载项目都可以用git clone url这种形式来获取了
目录内容如下图
关于缺少库报错的处理 关于缺少库，在Tplmap目录下有一个名为requirements.txt的文本文件，内容如下：
PyYAML==5.1.2 certifi==2018.10.15 chardet==3.0.4 idna==2.8 requests==2.22.0 urllib3==1.24.1 wsgiref==0.1.2 这些就是tplmap所需要的库，在该文本明确的标出了库名与版本号，我们可以用pip命令指定该文本进行安装。
进入该目录，用以下指令进行安装：
pip install -r requirements.txt
用法 Usage: python tplmap.py [options] 选项: -h, --help 显示帮助并退出 目标: -u URL, --url=URL 目标 URL -X REQUEST, --re.. 强制使用给定的HTTP方法 (e.g. PUT) 请求: -d DATA, --data=.. 通过POST发送的数据字符串 它必须作为查询字符串: param1=value1&amp;param2=value2 -H HEADERS, --he.. 附加标头 (e.g. &#39;Header1: Value1&#39;) 多次使用以添加新的标头 -c COOKIES, --co.. Cookies (e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/0ec7e927c92a26f7c1bc40968b488382/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-11-15T21:19:20+08:00" />
<meta property="article:modified_time" content="2020-11-15T21:19:20+08:00" />


	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程中国的博客" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程中国的博客</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Tplmap的安装与用法（内包含解决缺少库报错的处理教程）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h3><a id="Tplmap_0"></a>Tplmap简介</h3> 
<p>Tplmap是一个python工具，可以通过使用沙箱转义技术找到代码注入和服务器端模板注入（SSTI）漏洞。该工具能够在许多模板引擎中利用SSTI来访问目标文件或操作系统。一些受支持的模板引擎包括PHP（代码评估），Ruby（代码评估），JaveScript（代码评估），Python（代码评估），ERB，Jinja2和Tornado。该工具可以执行对这些模板引擎的盲注入，并具有执行远程命令的能力。</p> 
<h3><a id="Tplmap_2"></a>Tplmap的安装步骤</h3> 
<p>在kali打开终端，输入</p> 
<blockquote> 
 <p>git clone https://github.com/epinna/tplmap</p> 
</blockquote> 
<p>关于git，如没有该命令，则需要安装：（该命令需要在root权限下运行）</p> 
<blockquote> 
 <p>apt-get install git</p> 
</blockquote> 
<p>有了git，以后github上下载项目都可以用git clone url这种形式来获取了<br> 目录内容如下图<br> <img src="https://images2.imgbox.com/16/f2/1iDIVFFZ_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_15"></a>关于缺少库报错的处理</h3> 
<p>关于缺少库，在Tplmap目录下有一个名为<code>requirements.txt</code>的文本文件，内容如下：</p> 
<pre><code class="prism language-php">PyYAML<span class="token operator">==</span><span class="token number">5.1</span><span class="token number">.2</span>
certifi<span class="token operator">==</span><span class="token number">2018.10</span><span class="token number">.15</span>
chardet<span class="token operator">==</span><span class="token number">3.0</span><span class="token number">.4</span>
idna<span class="token operator">==</span><span class="token number">2.8</span>
requests<span class="token operator">==</span><span class="token number">2.22</span><span class="token number">.0</span>
urllib3<span class="token operator">==</span><span class="token number">1.24</span><span class="token number">.1</span>
wsgiref<span class="token operator">==</span><span class="token number">0.1</span><span class="token number">.2</span>
</code></pre> 
<p>这些就是tplmap所需要的库，在该文本明确的标出了库名与版本号，我们可以用pip命令指定该文本进行安装。<br> <img src="https://images2.imgbox.com/3a/10/iJToXolb_o.png" alt="在这里插入图片描述"></p> 
<p>进入该目录，用以下指令进行安装：</p> 
<blockquote> 
 <p>pip install -r requirements.txt</p> 
</blockquote> 
<h3><a id="_34"></a>用法</h3> 
<pre><code class="prism language-php">Usage<span class="token punctuation">:</span> python tplmap<span class="token punctuation">.</span>py <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

选项<span class="token punctuation">:</span>
  <span class="token operator">-</span>h<span class="token punctuation">,</span> <span class="token operator">--</span>help          显示帮助并退出

目标<span class="token punctuation">:</span>
  <span class="token operator">-</span>u <span class="token constant">URL</span><span class="token punctuation">,</span> <span class="token operator">--</span>url<span class="token operator">=</span><span class="token constant">URL</span>   目标 <span class="token constant">URL</span>
  <span class="token operator">-</span>X <span class="token constant">REQUEST</span><span class="token punctuation">,</span> <span class="token operator">--</span>re<span class="token punctuation">.</span><span class="token punctuation">.</span>  强制使用给定的<span class="token constant">HTTP</span>方法 <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token constant">PUT</span><span class="token punctuation">)</span>

请求<span class="token punctuation">:</span>
  <span class="token operator">-</span>d <span class="token constant">DATA</span><span class="token punctuation">,</span> <span class="token operator">--</span>data<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  通过<span class="token constant">POST</span>发送的数据字符串 它必须作为查询字符串<span class="token punctuation">:</span> param1<span class="token operator">=</span>value1<span class="token operator">&amp;</span>param2<span class="token operator">=</span>value2
  <span class="token operator">-</span>H <span class="token constant">HEADERS</span><span class="token punctuation">,</span> <span class="token operator">--</span>he<span class="token punctuation">.</span><span class="token punctuation">.</span>  附加标头 <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token single-quoted-string string">'Header1: Value1'</span><span class="token punctuation">)</span> 多次使用以添加新的标头
  <span class="token operator">-</span>c <span class="token constant">COOKIES</span><span class="token punctuation">,</span> <span class="token operator">--</span>co<span class="token punctuation">.</span><span class="token punctuation">.</span>  Cookies <span class="token punctuation">(</span>e<span class="token punctuation">.</span>g<span class="token punctuation">.</span> <span class="token single-quoted-string string">'Field1=Value1'</span><span class="token punctuation">)</span> 多次使用以添加新的Cookie
  <span class="token operator">-</span>A <span class="token constant">USER_AGENT</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  <span class="token constant">HTTP</span> User<span class="token operator">-</span>Agent 标头的值
  <span class="token operator">--</span>proxy<span class="token operator">=</span><span class="token constant">PROXY</span>       使用代理连接到目标<span class="token constant">URL</span>

检测<span class="token punctuation">:</span>
  <span class="token operator">--</span>level<span class="token operator">=</span><span class="token constant">LEVEL</span>       要执行的代码上下文转义级别 <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token keyword">Default</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token operator">-</span>e <span class="token constant">ENGINE</span><span class="token punctuation">,</span> <span class="token operator">--</span>eng<span class="token punctuation">.</span><span class="token punctuation">.</span>  强制将后端模板引擎设置为此值
  <span class="token operator">-</span>t <span class="token constant">TECHNIQUE</span><span class="token punctuation">,</span> <span class="token operator">--</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  技术 R<span class="token punctuation">:</span>渲染 T<span class="token punctuation">:</span>基于时间的盲注 <span class="token keyword">Default</span><span class="token punctuation">:</span> <span class="token constant">RT</span>

操作系统访问<span class="token punctuation">:</span>
  <span class="token operator">--</span>os<span class="token operator">-</span>cmd<span class="token operator">=</span><span class="token constant">OS_CMD</span>     执行操作系统命令
  <span class="token operator">--</span>os<span class="token operator">-</span>shell          提示交互式操作系统Shell
  <span class="token operator">--</span>upload<span class="token operator">=</span><span class="token constant">UPLOAD</span>     上传本地文件到远程主机
  <span class="token operator">--</span>force<span class="token operator">-</span>overwrite   上传时强制覆盖文件
  <span class="token operator">--</span>download<span class="token operator">=</span><span class="token constant">DOWNL</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  下载远程文件到本地主机
  <span class="token operator">--</span>bind<span class="token operator">-</span>shell<span class="token operator">=</span><span class="token constant">BIN</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  在目标的<span class="token constant">TCP</span>端口上生成系统Shell并连接到它
  <span class="token operator">--</span>reverse<span class="token operator">-</span>shell<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  运行系统Shell并反向连接到本地主机端口

模板检查<span class="token punctuation">:</span>
  <span class="token operator">--</span>tpl<span class="token operator">-</span>shell         在模板引擎上提示交互式Shell
  <span class="token operator">--</span>tpl<span class="token operator">-</span>code<span class="token operator">=</span><span class="token constant">TPL_C</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  在模板引擎中注入代码

常规<span class="token punctuation">:</span>
  <span class="token operator">--</span>force<span class="token operator">-</span>level<span class="token operator">=</span><span class="token constant">FO</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  强制将测试级别设置为此值
  <span class="token operator">--</span>injection<span class="token operator">-</span>tag<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  使用字符串作为注入标签 <span class="token punctuation">(</span><span class="token keyword">default</span> <span class="token single-quoted-string string">'*'</span><span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/e3650e0e159718bc53e8e14425367a96/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">第一章-介绍</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/25809410ce3238033431b4834df0738a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">vue调用打印机（vue-print-nb）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程中国的博客.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>